---
title: sqlmode å­¦ä¹ 
date: 2022-10-24 09:49:14
tags:
- python
- sql
categories:
- ç¼–ç¨‹
- python
---

`sqlmodel` æ˜¯å°† `sqlalchemy` å’Œ `pydantic` ç»“åˆèµ·æ¥çš„äº§ç‰©ï¼Œåœ¨å¾ˆå¤šé…ç½®ä¸Šä¸ `sqlalchemy` ä¸€è‡´ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨ä¸Šæ›´åŠ ç®€å•ã€‚å¹¶ä¸”åšäº†éå¸¸å¥½çš„autocompleteæ”¯æŒã€‚

[Github](https://github.com/tiangolo/sqlmodel)
[æ–‡æ¡£](https://sqlmodel.tiangolo.com/)

## å®‰è£…

```bash
pip install pymodel
```

## ä»‹ç»

### engine å’Œ session çš„åŒºåˆ«

engineæ˜¯å…¨å±€å•ä¸€çš„ï¼Œsession æ˜¯æ¯æ¬¡è¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ã€‚

> We would re-use the same engine in all the code, everywhere in the application (shared by all the requests). But for each request, we would create and use a new session. And once the request is done, we would close the session.

## å¤šå¯¹ä¸€ ä¸€å¯¹å¤š

### Relationship ä¸­çš„ `back_populates`

æ„ä¹‰æ˜¯åœ¨commitä¹‹å‰ï¼Œå¯ä»¥è¿›è¡ŒåŒæ­¥ä¿®æ”¹å†…å®¹

> [è§£é‡Š](https://sqlmodel.tiangolo.com/tutorial/relationship-attributes/back-populates/)

è®°å¿†æŠ€å·§ï¼š

`back_populates`å‚æ•°æ€»æ˜¯ä¸è‡ªèº«`Model`ç›¸å…³

> A mental trick you can use to remember is that the string in back_populates is always about the current model class you are editing. ğŸ¤“

## å¤šå¯¹å¤š

### ä¸­é—´è¡¨åªæœ‰ä¸¤ä¸ªå­—æ®µ

å¤šå¯¹å¤šçš„è¦ç‚¹æ˜¯å»ºç«‹ä¸€ä¸ªä¸­é—´è¡¨ï¼Œç„¶ååœ¨ä¸­é—´è¡¨ä¸­å»ºç«‹ä¸¤ä¸ªå¤–é”®ã€‚ï¼ˆä¸éœ€è¦å•ç‹¬ä¸€åˆ—ä½œä¸º primary_keyï¼‰

> A primary key is a way to uniquely identify a particular row in a single table. But it doesn't have to be a single column.
> A primary key can be a group of the columns in a table, which combined are unique in this table.

### ä¸­é—´è¡¨æœ‰é¢å¤–çš„å­—æ®µ

## æ–‡ä»¶ç»“æ„

ä¸ºäº†é˜²æ­¢å¾ªç¯å¼•å…¥ï¼Œå»ºè®®çš„æ–‡ä»¶ç»“æ„

```text
â”œâ”€â”€ project
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ app.py
    â”œâ”€â”€ database.py
    â””â”€â”€ models.py
```

`models.py`å­˜æ”¾æ‰€æœ‰çš„SQLæ¨¡å‹ï¼Œ`database.py`å­˜æ”¾æ‰€æœ‰çš„engine